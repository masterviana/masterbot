/*! Version=16.0.6820.2201 */
if(typeof IEnumerable=="undefined"){IEnumerable=function(){};IEnumerable.registerInterface("IEnumerable")}if(typeof IEnumerator=="undefined"){IEnumerator=function(){};IEnumerator.registerInterface("IEnumerator")}typeof Sys=="undefined"&&Type.registerNamespace("Sys");if(typeof Sys.IEnumerable$1=="undefined"){Sys.IEnumerable$1=function(){};Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1")}if(typeof Sys.IEnumerator$1=="undefined"){Sys.IEnumerator$1=function(){};Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1")}Type.registerNamespace("NLRT");NLRT.$pV=function(){};NLRT.$pV.registerInterface("NLRT.$pV");NLRT.$q5=function(){};NLRT.$q5.registerInterface("NLRT.$q5");NLRT.$pX=function(){};NLRT.$pX.registerInterface("NLRT.$pX");NLRT.$pb=function(){};NLRT.$pb.registerInterface("NLRT.$pb");NLRT.$RP=function(){};NLRT.$RP.registerInterface("NLRT.$RP");NLRT.$Dn=function(){};NLRT.$Dn.registerInterface("NLRT.$Dn");NLRT.$J7=function(){};NLRT.$J7.registerInterface("NLRT.$J7");NLRT.$77=function(){};NLRT.$77.registerInterface("NLRT.$77");NLRT.$pC=function(){};NLRT.$pC.registerInterface("NLRT.$pC");NLRT.$pE=function(){};NLRT.$pE.registerInterface("NLRT.$pE");NLRT.$pG=function(){};NLRT.$pG.registerInterface("NLRT.$pG");NLRT.$pH=function(){};NLRT.$pH.registerInterface("NLRT.$pH");NLRT.$pJ=function(){};NLRT.$pJ.registerInterface("NLRT.$pJ");NLRT.$pK=function(){};NLRT.$pK.registerInterface("NLRT.$pK");NLRT.$pL=function(){};NLRT.$pL.registerInterface("NLRT.$pL");NLRT.$pf=function(){};NLRT.$pf.registerInterface("NLRT.$pf");NLRT.$pr=function(){};NLRT.$pr.registerInterface("NLRT.$pr");NLRT.$pt=function(){};NLRT.$pt.registerInterface("NLRT.$pt");NLRT.$pv=function(){};NLRT.$pv.registerInterface("NLRT.$pv");NLRT.$pz=function(){};NLRT.$pz.registerInterface("NLRT.$pz");NLRT.$c4=function(){};NLRT.$c4.$$=function(c){var a="$c4$"+c.getName().replace(/\./g,"_");if(!NLRT[a]){var b=NLRT[a]=function(){};b.registerInterface("NLRT."+a)}return NLRT[a]};NLRT.$G9=function(a){this.$S=a};NLRT.$G9.$3Jg=function(h,b,c,a){if(c===a)return b;if(NLRT.$1G.$Gb(c)&&NLRT.$1G.$Gb(a)){for(var j=NLRT.$1G.$uU(c),f=NLRT.$1G.$uU(a),k=b,g=new NLRT.$4s(h,f),e=k.get_$1x(),i=e.length,d=0;d<i;++d){var l=e[d];Array.add(g.get_$1x(),NLRT.$G9.$3Jg(h,l,j,f))}return g}else if(c===3){if(a===5)return b;else if(a===1)return b.toString()}else if(c===5){if(a===3)return Math.floor(b);else if(a===1)return b.toString()}else if(c===1)if(a===3)return parseInt(b);else if(a===5)return parseFloat(b);throw Error.invalidOperation("Type conversion failure in query step");};NLRT.$G9.prototype={get_$3de:function(){return this.$S.$E1},get_$jo:function(){return this.$S.$16K},get_$3zI:function(){return this.$S.$2TN},get_$3ev:function(){return this.$S.$2RT},$Sa:function(a,b){return this.$99(a,!a?b:new NLRT.$98("root",a,b))},$99:function(c,d){if(!this.get_$3ev()&&!this.$S.$2t.$1Sp(this.get_$3de(),c))throw Error.argument("input","Input value not of expected type");var b=c,a=this.$S.$1sB;while(a){b=a.$Sa(b,d);a=a.get_$Dt()}return b},$1qA:function(a,b,c,d){if(!this.get_$3zI())throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.get_$3ev()&&!this.$S.$2t.$1Sp(this.get_$3de(),a))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.$S.$2t.$1Sp(this.get_$jo(),b))throw Error.argument("rvalue","Rvalue not of expected type");return this.$S.$1sB.$Be(a,b,c,d)},$S:null};NLRT.$KQ=function(b,k){if(!b)return;this.$2t=k.get_$Dc();var a=0;this.$E1=b.get_$5(a);++a;this.$16K=b.get_$5(a);++a;this.$2TN=b.get_$5(a)===1;++a;this.$2RT=b.get_$5(a)===1;++a;var d=b.get_$5(a);++a;if(!d)return;for(var h=a,l=a+d,g=a+2*d,i=a+3*d,m=b.get_$14()-i,f=null,c=0;c<d;++c){var n=i+b.get_$5(g+c),o=(c===d-1?m:b.get_$5(g+c+1))-b.get_$5(g+c),j=new(NLRT.$95.$$(Number));j.$11p(b,n,o);var e=NLRT.$KQ.$59H(b.get_$5(l+c),j,k);e.$E1=b.get_$5(h+c);e.$16K=c===d-1?this.$16K:b.get_$5(h+c+1);if(!f){this.$1sB=e;f=e}else{f.set_$Dt(e);f=e}}};NLRT.$KQ.$59H=function(c,b,a){switch(c){case 1:return new NLRT.$a7(new NLRT.$QZ(b,a));case 2:return new NLRT.$c8(new NLRT.$QZ(b,a));case 3:return new NLRT.$WI(new NLRT.$WJ(b,a.get_$Dc()));case 4:return new NLRT.$ZJ(new NLRT.$ZK(b,a.get_$Dc()));case 5:return new NLRT.$b9(new NLRT.$bH(b,a));case 6:return new NLRT.$cy(new NLRT.$Jp(b,a));case 43:return new NLRT.$cz(new NLRT.$Jp(b,a));case 45:return new NLRT.$Vv(new NLRT.$Vz(b,a));case 49:return new NLRT.$Vx(new NLRT.$Vy(b,a));case 46:return new NLRT.$iv(new NLRT.$iw(b,a.get_$Dc()));case 51:return new NLRT.$X1(new NLRT.$X2(b,a));case 52:return new NLRT.$fB(new NLRT.$OJ(b,a));case 53:return new NLRT.$Xo(new NLRT.$GA(a.get_$Dc()));case 13:return new NLRT.$cK(new NLRT.$Ay(b,a));case 14:return new NLRT.$cj(new NLRT.$gy(b,a));case 15:return new NLRT.$Xs;case 18:return new NLRT.$ZS(new NLRT.$Jp(b,a));case 16:return new NLRT.$Zr(new NLRT.$Uo(b,a));case 17:return new NLRT.$ZA(new NLRT.$Uo(b,a));case 22:return new NLRT.$bj(new NLRT.$bi(b,a));case 24:return new NLRT.$Vs(new NLRT.$Ay(b,a));case 26:return new NLRT.$hc(new NLRT.$OJ(b,a));case 27:return new NLRT.$cL(new NLRT.$Jp(b,a));case 30:return new NLRT.$iP(new NLRT.$GA(a.get_$Dc()));case 31:return new NLRT.$hf(new NLRT.$OJ(b,a));case 32:return new NLRT.$XV(new NLRT.$Ay(b,a));case 47:return new NLRT.$cl(new NLRT.$GA(a.get_$Dc()));case 48:return new NLRT.$iJ(new NLRT.$GA(a.get_$Dc()));case 34:return new NLRT.$VI(new NLRT.$Ay(b,a));case 35:return new NLRT.$hg(new NLRT.$Ay(b,a));case 36:return new NLRT.$dK(new NLRT.$Ay(b,a));case 37:return new NLRT.$Ya(new NLRT.$Ay(b,a));case 38:return new NLRT.$dD(new NLRT.$Ay(b,a));case 39:return new NLRT.$ZB(new NLRT.$Ay(b,a));case 40:return new NLRT.$Vk(new NLRT.$Ay(b,a));case 41:return new NLRT.$du(new NLRT.$Ay(b,a));case 42:return new NLRT.$dV(new NLRT.$GA(a.get_$Dc()));default:throw Error.argument("currStepInitData");}};NLRT.$KQ.prototype={$2t:null,$E1:0,$16K:0,$2TN:false,$2RT:false,$1sB:null};NLRT.$Vm=function(a,b){this.$2QL=a;this.$2Se=b};NLRT.$Vm.prototype={$2QL:null,get_$3Kc:function(){return this.$2QL},$2Se:null,get_$3og:function(){return this.$2Se}};NLRT.$1G=function(b,d){if(!b)throw Error.argumentNull("initData");if(!d)throw Error.argumentNull("objectFetcher");this.$2zb=d.get_$4oT();var a=0,o=d.$12X(b.get_$5(a));++a;this.$1TY=new NLRT.$OP(new NLRT.$OQ(o));this.$1HH=b.get_$5(a);++a;this.$2Hm=new Array(this.$1HH);this.$1Ek=new Array(this.$1HH);this.$ol=new Array(this.$1HH);for(var g=0;g<this.$1HH;++g){this.$2Hm[g]=d.$CH(b.get_$5(a));++a;this.$1Ek[g]=b.get_$5(a);++a;var n=b.get_$5(a);++a;this.$ol[g]=new Array(n);for(var i=0;i<n;++i){this.$ol[g][i]=d.$CH(b.get_$5(a));++a}}this.$16T=b.get_$5(a);++a;this.$2Hy=new Array(this.$16T);this.$1Ta=new Array(this.$16T);this.$1Tb=new Array(this.$16T);this.$1TZ=new Array(this.$16T);for(var c=0;c<this.$16T;++c){this.$2Hy[c]=d.$CH(b.get_$5(a));++a;var h=b.get_$5(a);++a;this.$1Ta[c]=new Array(h);this.$1Tb[c]=new Array(h);this.$1TZ[c]=new Array(h);for(var e=0;e<h;++e){this.$1Ta[c][e]=d.$CH(b.get_$5(a));++a;this.$1Tb[c][e]=b.get_$5(a);++a;var j,k;this.$1TZ[c][e]=(k=this.$tM(this.$1Tb[c][e],b,j={val:a},null,null,null),a=j.val,k);NLRT.$1G.$1Eg(this.$1TZ[c][e])}}this.$wp=b.get_$5(a);++a;this.$1mx=new Array(this.$wp);this.$1my=new Array(this.$wp);this.$1mw=new Array(this.$wp);for(var f=0;f<this.$wp;++f){this.$1mx[f]=d.$CH(b.get_$5(a));++a;this.$1my[f]=b.get_$5(a);++a;var l,m;this.$1mw[f]=(m=this.$tM(this.$1my[f],b,l={val:a},null,null,null),a=l.val,m);NLRT.$1G.$1Eg(this.$1mw[f])}};NLRT.$1G.$1qr=function(a){return(a&16383)>=16&&(a&16384)!==16384&&(a&32768)!==32768};NLRT.$1G.$41D=function(a){return(a&16383)>=16&&(a&16384)===16384&&(a&32768)!==32768};NLRT.$1G.$Gb=function(a){return(a&32768)===32768};NLRT.$1G.$58f=function(a){if(NLRT.$1G.$Gb(a))throw Error.argument("nonListTypeID","Non-list type ID required");return a|32768};NLRT.$1G.$uU=function(a){if(!NLRT.$1G.$Gb(a))throw Error.argument("listTypeID","List type ID required");return a&~32768};NLRT.$1G.$15f=function(c,a,b){switch(c){case 1:case 2:case 3:case 5:return a===b;case 9:return a.$ST(b);default:return NLRT.$1G.$Gb(c)?a.$ST(b):NLRT.$1G.$1qr(c)?a===b:a.$ST(b)}};NLRT.$1G.$1Eg=function(a){NLRT.$RP.isInstanceOfType(a)&&a.$5Rm()};NLRT.$1G.$Q4=function(a){return NLRT.$RP.isInstanceOfType(a)?a.$Q4():a};NLRT.$1G.$2pO=function(a){return a-16};NLRT.$1G.$1qD=function(a){return(a&~16384)-16};NLRT.$1G.prototype={$1k8:function(b){for(var a=0;a<this.$wp;++a)if(this.$1mx[a]===b)return a;return-1},$3WV:function(a){if(!this.$1T7(a))throw Error.argument("attrID","Invalid attribute ID");return this.$1mx[a]},$1DA:function(a){if(!this.$1T7(a))throw Error.argument("attrID","Invalid attribute ID");return this.$1my[a]},$1Da:function(c,a){if(!this.$1T8(c))throw Error.argument("structTypeID","Invalid struct type ID");var b=this.$1Tb[NLRT.$1G.$1qD(c)];if(a<0||a>=b.length)throw Error.argument("iField","Invalid field index");return b[a]},$bL:function(c,a){if(!this.$2yf(c))throw Error.argument("typeID","Invalid type ID");if(!this.$1Sp(c,a))throw Error.argument("value","Value is not of the correct type");switch(c){case 1:return a;case 2:return a?"True":"False";case 3:case 5:return a.toString();case 9:return a.$bL();default:if(NLRT.$1G.$Gb(c))return a.$bL();else if(NLRT.$1G.$1qr(c)){var d=a,b=NLRT.$1G.$2pO(c),i=this.$ol[b].length;switch(this.$1Ek[b]){case 0:return this.$ol[b][d];case 1:if(!d)return this.$ol[b][0];else{for(var e="",f=1;f<i;++f)if(d&1<<f-1){if(e.length>0)e+=" & ";e+=this.$ol[b][f]}return e}case 2:for(var g="",h=0;h<i;++h)if(d&1<<h){if(g.length>0)g+=" & ";g+=this.$ol[b][h]}return g;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.$1Ek[b]);}}else return a.$bL()}},$2yf:function(a){switch(a){case 1:case 2:case 3:case 5:case 9:return true;default:return NLRT.$1G.$Gb(a)?this.$2yf(NLRT.$1G.$uU(a)):NLRT.$1G.$1qr(a)?this.$5PU(a):this.$1T8(a)}},$5PU:function(b){var a=NLRT.$1G.$2pO(b);return a>=0&&a<this.$2Hm.length},$1T8:function(b){var a=NLRT.$1G.$1qD(b);return a>=0&&a<this.$2Hy.length},$1T7:function(a){return a>=0&&a<this.$wp},$1Sp:function(b,a){if(a==null)return false;switch(b){case 1:return String.isInstanceOfType(a);case 2:return Boolean.isInstanceOfType(a);case 3:return Number.isInstanceOfType(a);case 5:return Number.isInstanceOfType(a);case 9:return NLRT.$Dn.isInstanceOfType(a);default:if(NLRT.$1G.$Gb(b))return NLRT.$77.isInstanceOfType(a)&&a.get_$f1()===NLRT.$1G.$uU(b);else if(NLRT.$1G.$1qr(b)){if(!Number.isInstanceOfType(a))return false;var c=a,d=NLRT.$1G.$2pO(b),e=this.$ol[d].length;switch(this.$1Ek[d]){case 0:return c>=0&&c<e;case 1:return!(c&-1<<e-1);case 2:return!!c&&!(c&-1<<e);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.$1Ek[d]);}}else return NLRT.$J7.isInstanceOfType(a)&&a.get_$3z1()===b}},$wp:0,$1HH:0,$16T:0,$538:function(a){if(!this.$1T7(a))throw Error.argument("attrID","Invalid attribute ID");return this.$1mw[a]},$3Zn:function(a){if(!this.$1T8(a))throw Error.argument("structTypeID","Invalid struct type ID");return this.$1Ta[NLRT.$1G.$1qD(a)].length},$3b8:function(a,b){if(!this.$1T8(a))throw Error.argument("structTypeID","Invalid struct type ID");return this.$1Ta[NLRT.$1G.$1qD(a)][b]},$3b7:function(c,a){if(!this.$1T8(c))throw Error.argument("structTypeID","Invalid struct type ID");var b=this.$1TZ[NLRT.$1G.$1qD(c)];if(a<0||a>=b.length)throw Error.argument("iField","Invalid field index");return b[a]},$tM:function(c,b,a,f,g,d){if(!b)throw Error.argumentNull("initData");if(NLRT.$1G.$Gb(c)){var p=b.get_$5(a.val);++a.val;for(var h=NLRT.$1G.$uU(c),i=new NLRT.$4s(this,h),j=0;j<p;++j)Array.add(i.get_$1x(),this.$tM(h,b,a,f,g,d));return i}else switch(c){case 1:return(f||this.$1TY).$CH(b.get_$5(a.val++));case 2:return b.get_$5(a.val++)===1;case 3:return b.get_$5(a.val++);case 5:return(g||this.$2zb)[b.get_$5(a.val++)];case 9:for(var q=b.get_$5(a.val++),k=new NLRT.$6P(this),l=0;l<q;++l){var e=b.get_$5(a.val);++a.val;if(d)e=d[e];k.$Bc(e,this.$tM(this.$1DA(e),b,a,f,g,d))}return k;default:if(NLRT.$1G.$1qr(c))return b.get_$5(a.val++);else if(NLRT.$1G.$41D(c)){for(var r=b.get_$5(a.val++),m=new NLRT.$UK(this,c),n=0;n<r;++n){var o=b.get_$5(a.val);++a.val;m.$36A(o,this.$tM(this.$1Da(c,o),b,a,f,g,d))}return m}else throw Error.argument("typeID","Invalid type ID");}},$1TY:null,$2zb:null,$1mx:null,$1my:null,$1mw:null,$2Hm:null,$1Ek:null,$ol:null,$2Hy:null,$1Tb:null,$1Ta:null,$1TZ:null};NLRT.$6P=function(a){if(!a)throw Error.argumentNull("annotations");this.$9N=a;this.$LM=new Array(0)};NLRT.$6P.$2pU=function(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")};NLRT.$6P.prototype={get_$26r:function(){return this.$9N},$Nk:false,get_$1EL:function(){return this.$Nk},get_$2vs:function(){return this.$LM.length>0},$8L:function(b,e,f){if(!this.$9N.$1T7(e))throw Error.argument("attributeID","Invalid attribute ID");for(var c=this.$LM,g=c.length,a=0;a<g;++a){var d=c[a];if(e===d.$kI){f.val=d.$Bg;return true}}f.val=b===Number||Type.isEnum(b)?0:b===Boolean?false:null;return false},$Bc:function(a,b){if(this.$Nk)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.$9N.$1T7(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.$9N.$1Sp(this.$9N.$1DA(a),b))throw Error.argument("value","Value is not of the correct type for the specified attribute");NLRT.$1G.$1Eg(b);for(var c=0;c<this.$LM.length;++c){var d=this.$LM[c];if(a===d.$kI){d.$Bg=b;return}}Array.add(this.$LM,new NLRT.$6P.$4I7(a,b))},$2Kp:function(b){if(this.$Nk)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.$9N.$1T7(b))throw Error.argument("attributeID","Invalid attribute ID");for(var a=0;a<this.$LM.length;++a)if(b===this.$LM[a].$kI){Array.removeAt(this.$LM,a);break}},$2Au:function(d){if(!d)throw Error.argumentNull("action");for(var b=this.$LM,e=b.length,a=0;a<e;++a){var c=b[a];d(c.$kI,c.$Bg)}},$3l:function(){var a=new NLRT.$6P(this.$9N);a.$tF(this);return a},$tF:function(a){if(this.$Nk)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.get_$26r()!==this.$9N)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.$LM);var b=this;a.$2Au(function(a,c){b.$Bc(a,c)})},$bL:function(){for(var a="[",e=true,d=this.$LM,h=d.length,b=0;b<h;++b){var c=d[b];if(!e)a+=", ";else e=false;a+=this.$9N.$3WV(c.$kI);a+="=";var f=this.$9N.$1DA(c.$kI),g=this.$9N.$bL(f,c.$Bg);if(f===1){a+='"';a+=NLRT.$6P.$2pU(g);a+='"'}else a+=g}a+="]";return a},$ST:function(a){if(!a)throw Error.argumentNull("other");if(this===a)return true;if(!a||this.$9N!==a.get_$26r())return false;if(this.get_$2vs()!==a.get_$2vs())return false;var f=0,c=null,e=false,d=this;a.$2Au(function(g,h){++f;if(e)return;for(var b=-1,a=0,i=d.$LM.length;a<i;++a)if(d.$LM[a].$kI===g){b=a;break}if(b<0)e=true;else{if(!c)c=new Array(d.$LM.length);c[b]=h}});if(this.$LM.length!==f||e)return false;for(var b=0,g=this.$LM.length;b<g;++b)if(!NLRT.$1G.$15f(this.$9N.$1DA(this.$LM[b].$kI),this.$LM[b].$Bg,c[b]))return false;return true},$Q4:function(){return this.$Nk?this.$3l():this},$5Rm:function(){if(this.$Nk)return;this.$Nk=true;for(var b=this.$LM,c=b.length,a=0;a<c;++a){var d=b[a];NLRT.$1G.$1Eg(d.$Bg)}},toString:function(){return this.$bL()},$9N:null,$LM:null};NLRT.$6P.$4I7=function(a,b){this.$kI=a;this.$Bg=b};NLRT.$6P.$4I7.prototype={$kI:0,$Bg:null};NLRT.$UK=function(a,b){if(!a)throw Error.argumentNull("annotations");if(!a.$1T8(b))throw Error.argument("structTypeID","Invalid struct type ID");this.$9N=a;this.$13o=this.$9N.$3Zn(b);this.$g4=b};NLRT.$UK.prototype={get_$26r:function(){return this.$9N},$Nk:false,get_$1EL:function(){return this.$Nk},$g4:0,get_$3z1:function(){return this.$g4},$12d:function(a){if(a<0||a>=this.$13o)throw Error.argument("iField","Invalid field index");return this.$Uc&&!(this.$Uc[a]==null)?this.$Uc[a]:this.$9N.$3b7(this.$g4,a)},$36A:function(a,b){if(this.$Nk)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(a<0||a>=this.$13o)throw Error.argument("iField","Invalid field index");if(!this.$9N.$1Sp(this.$9N.$1Da(this.$g4,a),b))throw Error.argument("value","Value is not of the correct type for the specified field");(this.$Uc||(this.$Uc=new Array(this.$13o)))[a]=b},$bL:function(){var a="[";if(this.$Uc)for(var d=true,b=0;b<this.$13o;++b){if(this.$Uc[b]==null)continue;var c=this.$9N.$1Da(this.$g4,b);if(NLRT.$1G.$15f(c,this.$Uc[b],this.$9N.$3b7(this.$g4,b)))continue;if(!d)a+=", ";else d=false;a+=this.$9N.$3b8(this.$g4,b);a+="=";var e=this.$9N.$bL(c,this.$Uc[b]);if(c===1){a+='"';a+=NLRT.$6P.$2pU(e);a+='"'}else a+=e}a+="]";return a},$ST:function(b){if(this===b)return true;if(!b||this.$9N!==b.get_$26r()||this.$g4!==b.get_$3z1())return false;for(var a=0;a<this.$13o;++a)if(!NLRT.$1G.$15f(this.$9N.$1Da(this.$g4,a),this.$12d(a),b.$12d(a)))return false;return true},$3l:function(){var a=new NLRT.$UK(this.$9N,this.$g4);if(this.$Uc)a.$Uc=Array.clone(this.$Uc);return a},$Q4:function(){return this.$Nk?this.$3l():this},$5Rm:function(){if(this.$Nk)return;this.$Nk=true;if(this.$Uc)for(var a=0;a<this.$13o;++a){var b=this.$Uc[a];!(b==null)&&NLRT.$1G.$1Eg(b)}},toString:function(){return this.$bL()},$9N:null,$13o:0,$Uc:null};NLRT.$4s=function(a,b){if(!a)throw Error.argumentNull("annotations");if(!a.$2yf(b))throw Error.argument("memberTypeID","Invalid type ID");if(NLRT.$1G.$Gb(b))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.$9N=a;this.$xA=b;this.$fv=[]};NLRT.$4s.prototype={get_$26r:function(){return this.$9N},$Nk:false,$xA:0,get_$f1:function(){return this.$xA},$fv:null,get_$1x:function(){return this.$fv},$bL:function(){for(var a="[",b=0,d=this.$fv.length;b<d;++b){if(b>0)a+=", ";var c=this.$9N.$bL(this.$xA,this.$fv[b]);if(this.$xA===1){a+='"';a+=NLRT.$6P.$2pU(c);a+='"'}else a+=c}a+="]";return a},$ST:function(a){if(this===a)return true;if(!a||a.get_$26r()!==this.$9N||a.get_$f1()!==this.$xA||a.get_$1x().length!==this.$fv.length)return false;for(var b=0;b<this.$fv.length;++b)if(!NLRT.$1G.$15f(this.$xA,this.$fv[b],a.get_$1x()[b]))return false;return true},$3l:function(){var a=new NLRT.$4s(this.$9N,this.$xA);Array.addRange(a.get_$1x(),this.$fv);return a},$Q4:function(){return this.$Nk?this.$3l():this},$5Rm:function(){if(this.$Nk)return;this.$Nk=true;for(var b=this.$fv,c=b.length,a=0;a<c;++a){var d=b[a];NLRT.$1G.$1Eg(d)}},toString:function(){return this.$bL()},$9N:null};NLRT.$98=function(a,b,c){this.$2zy=a;this.$2Ho=b;this.$ex=c};NLRT.$98.prototype={$2lL:function(a){this.$2Ho=a},$2DR:function(a){if(!a)throw Error.argument("name","Invalid named feature bundle reference");var b=a.charCodeAt(0),c=a.substr(1);return b===1&&c===this.$2zy?this.$2Ho:!this.$ex?null:this.$ex.$2DR(a)},get_$5OJ:function(){return!this.$ex?false:this.$ex.get_$5OJ()},get_$4I4:function(){return!this.$ex?-1:this.$ex.get_$4I4()},get_$4I3:function(){return!this.$ex?-1:this.$ex.get_$4I3()},get_$4I5:function(){return!this.$ex?-1:this.$ex.get_$4I5()},$2zy:null,$2Ho:null,$ex:null};NLRT.$Vn=function(a){this.$S=a};NLRT.$Vn.prototype={$46:function(a,b){this.$1CE(a,!a?b:new NLRT.$98("root",a,b))},$1CE:function(g,d){for(var b=this.$S.$1ri,e=b.length,a=0;a<e;++a){var f=b[a],c;f.$46(g,c={val:d}),d=c.val}},$S:null};NLRT.$KR=function(b,l){if(!b)return;var d=0,c=b.get_$5(d);++d;if(!c)return;var h=d,e=d+c,f=d+2*c,i=b.get_$14()-f;this.$1ri=new Array(c);for(var a=0;a<c;++a){var j=f+b.get_$5(e+a),k=(a===c-1?i:b.get_$5(e+a+1))-b.get_$5(e+a),g=new(NLRT.$95.$$(Number));g.$11p(b,j,k);this.$1ri[a]=NLRT.$KR.$59D(b.get_$5(h+a),g,l)}};NLRT.$KR.$59D=function(c,a,b){switch(c){case 1:return new NLRT.$WC(new NLRT.$N8(a,b));case 2:return new NLRT.$dC(new NLRT.$N8(a,b));case 3:return new NLRT.$fN(new NLRT.$fO(a,b));case 6:return new NLRT.$dM(new NLRT.$dO(a,b));case 7:return new NLRT.$Yx(new NLRT.$Yy(a,b));case 8:return new NLRT.$bA(new NLRT.$bK(a,b));case 9:return new NLRT.$Xp(new NLRT.$N8(a,b));case 10:return new NLRT.$Vw(new NLRT.$W0(a,b));default:throw Error.argument("initData");}};NLRT.$KR.prototype={$1ri:null};NLRT.$LM=function(a,b,c,d,e){this.$kP=a;this.$87=b;this.$1HK=c;this.$KH=d;this.$Y1=e};NLRT.$LM.prototype={$kP:0,$87:0,$1HK:false,$KH:0,$Y1:0};NLRT.$Od=function(a,b,c,d){this.$Mi=a||new NLRT.$DM.$2OF;this.$kQ=b;this.$KH=c;this.$Y1=d};NLRT.$Od.prototype={$Mi:null,$kQ:0,$KH:0,$Y1:0,$583:function(){return this.$Mi.$Ea.toString()+":"+this.$kQ.toString()}};NLRT.$9I=function(a,b){this.$ez=a;this.$1n7=b};NLRT.$9I.$2Oh=function(a,c){var b=a.$583();if(b in c){var d=c[b];d.$KH=Math.min(d.$KH,a.$KH)}else c[b]=new NLRT.$Od(NLRT.$DM.$2lj(a.$Mi),a.$kQ,a.$KH,a.$Y1)};NLRT.$9I.$40a=function(d,e,i){var b=e[d],a=b.$kP,g=a+b.$87,c=1,h=b.$1HK;while(d+c<e.length&&e[d+c].$kP<g){var f=e[d+c];if(f.$kP>a){Array.add(i,new NLRT.$LM(a,f.$kP-a,h,b.$KH,b.$Y1));h=false}c+=NLRT.$9I.$40a(d+c,e,i);a=f.$kP+f.$87}a<g&&Array.add(i,new NLRT.$LM(a,g-a,h,b.$KH,b.$Y1));return c};NLRT.$9I.prototype={$5Sk:function(c){if(c==null)throw Error.argumentNull("prefix");var a={},g=a[""]=new NLRT.$Od(null,0,0,0);this.$2FK(g,a);for(var b=0;b<c.length;++b){var h=c.charCodeAt(b),f={},d=a;for(var e in d){var i={key:e,value:d[e]};this.$4G5(h,i.value,f)}a=f}return this.$65c(a)},$2FK:function(b,d){if(b.$KH>=this.$1n7)return;var a=new NLRT.$Od(NLRT.$DM.$2lj(b.$Mi),b.$kQ,b.$KH+1,b.$Y1);if(a.$Mi.$Dz&1)++a.$kQ;if(this.$ez.$1Gc(a.$Mi)){++a.$Y1;var c=true;while(c){NLRT.$9I.$2Oh(a,d);this.$2FK(a,d);a.$kQ+=this.$ez.$1Rh(a.$Mi,true)+(a.$Mi.$Dz&1?1:0);c=this.$ez.$1qk(a.$Mi)}}},$4G5:function(d,a,b){if(a.$KH+1<=this.$1n7){++a.$KH;NLRT.$9I.$2Oh(a,b);--a.$KH}if(a.$Mi.$Dz&1)++a.$kQ;if(this.$ez.$1Gc(a.$Mi)){++a.$Y1;var c=true;while(c){if(a.$Mi.$15h===d){NLRT.$9I.$2Oh(a,b);this.$2FK(a,b)}else if(a.$KH+1<=this.$1n7){++a.$KH;NLRT.$9I.$2Oh(a,b);this.$2FK(a,b);--a.$KH}a.$kQ+=this.$ez.$1Rh(a.$Mi,true)+(a.$Mi.$Dz&1?1:0);c=this.$ez.$1qk(a.$Mi)}}},$65c:function(j){var a=[],d=j;for(var e in d){var h={key:e,value:d[e]},b=h.value;if(!b.$Mi.$Ea)continue;var g=!!(b.$Mi.$Dz&1),i=this.$ez.$1Rh(b.$Mi,false)+(g?1:0);Array.add(a,new NLRT.$LM(b.$kQ,i,g,b.$KH,b.$Y1))}var k=this;a.sort(function(b,c){var a=b.$kP-c.$kP;if(a)return a;a=-(b.$87-c.$87);if(a)return a;a=b.$Y1-c.$Y1;return a});if(a.length<2)return a;for(var f=[],c=0;c<a.length;)c+=NLRT.$9I.$40a(c,a,f);return f},$ez:null,$1n7:0};NLRT.$ZO=function(){};NLRT.$ZO.prototype={$eN:function(c,b){var d=c.get_$5(0),a=new(NLRT.$95.$$(Number));a.$11p(c,1,c.get_$14()-1);switch(d){case 1:return new NLRT.$NE(new NLRT.$NF(a,b),0);case 2:return new NLRT.$NE(new NLRT.$NF(a,b),1);case 3:return new NLRT.$NE(new NLRT.$NF(a,b),2);case 101:return new NLRT.$fJ(new NLRT.$fK(a,b));case 103:return new NLRT.$EJ(new NLRT.$EK(a,b),0);case 104:return new NLRT.$EJ(new NLRT.$EK(a,b),1);case 105:return new NLRT.$EJ(new NLRT.$EK(a,b),2);case 106:return new NLRT.$EJ(new NLRT.$EK(a,b),3);case 107:return new NLRT.$EJ(new NLRT.$EK(a,b),4);case 108:return new NLRT.$EJ(new NLRT.$EK(a,b),5);case 109:return new NLRT.$EJ(new NLRT.$EK(a,b),6);case 201:return new NLRT.$hY(new NLRT.$hZ(a));case 202:return new NLRT.$f5(new NLRT.$EV(a,b));case 301:return new NLRT.$H6(new NLRT.$H7(a,b),0);case 302:return new NLRT.$H6(new NLRT.$H7(a,b),1);case 303:return new NLRT.$H6(new NLRT.$H7(a,b),2);case 304:return new NLRT.$H6(new NLRT.$H7(a,b),3);case 305:return new NLRT.$H6(new NLRT.$H7(a,b),4);case 401:return new NLRT.$OM(new NLRT.$ON(a),0);case 402:return new NLRT.$OM(new NLRT.$ON(a),1);case 403:return new NLRT.$OM(new NLRT.$ON(a),2);case 404:return new NLRT.$JY(new NLRT.$JZ(a,b),0);case 405:return new NLRT.$JY(new NLRT.$JZ(a,b),1);case 406:return new NLRT.$JY(new NLRT.$JZ(a,b),2);case 407:return new NLRT.$JY(new NLRT.$JZ(a,b),3);case 501:return new NLRT.$ZL(new NLRT.$ZM(a,b));case 502:return new NLRT.$f6(new NLRT.$EV(a,b));case 601:return new NLRT.$Ss(new NLRT.$OC(a,b),0);case 602:return new NLRT.$Ss(new NLRT.$OC(a,b),1);case 603:return new NLRT.$cm(new NLRT.$OC(a,b));case 604:return new NLRT.$Ja(new NLRT.$EV(a,b),0);case 605:return new NLRT.$Ja(new NLRT.$EV(a,b),1);case 606:return new NLRT.$Ja(new NLRT.$EV(a,b),2);case 607:return new NLRT.$Ja(new NLRT.$EV(a,b),3);case 701:return new NLRT.$Qt(false);case 702:return new NLRT.$Qt(true);case 703:return new NLRT.$PH(new NLRT.$K7(a,b),false);case 704:return new NLRT.$PH(new NLRT.$K7(a,b),true);case 705:return new NLRT.$PG(new NLRT.$K7(a,b),false);case 706:return new NLRT.$PG(new NLRT.$K7(a,b),true);case 707:return new NLRT.$ef(new NLRT.$eg(a,b));case 901:return new NLRT.$i8(new NLRT.$i9(a,b));case 1002:return new NLRT.$f9(new NLRT.$EV(a,b));case 1001:return new NLRT.$hd(new NLRT.$he(a,b));default:throw Error.argument("initData");}}};NLRT.$HJ=function(i,c){var b=0;try{this.$9N=c.get_$Dc();var d=c.$12X(i.get_$5(b));++b;var a=new NLRT.$Kg(d);if(a.$Sk()!==-914743053)throw Error.argument("Input does not represent a flat lexicon");this.$2zh=a.$Sk()===1;this.$2zj=a.$Sk()===1;var e=a.$Sk();a.$Er+=e;var f=a.$Sk();this.$2Hc=NLRT.$HJ.$5ei(a,f,this.$9N);var g=a.$Sk();this.$2zf=NLRT.$HJ.$5eo(a,g);var h=a.$Sk();this.$ez=new NLRT.$DM(a.$HP,a.$Er);a.$Er+=h}catch(j){throw Error.argument("initData");}};NLRT.$HJ.$5ei=function(b,c,j){if(c%4)throw Error.argument("reader");var h=c/4,f=NLRT.$Nh.$4c3(b.$HP,b.$Er,h);b.$Er+=c;var g=[],a=0;while(a<f.get_$14()){var d,e,i=(e=j.$tM(9,f,d={val:a},null,null,null),a=d.val,e);Array.add(g,i)}return g};NLRT.$HJ.$5eo=function(a,h){var f=a.$Er+h,c=[];while(a.$Er<f){for(var d=a.$Sk(),e=new Array(d),b=0;b<d;++b){var g=a.$Sk();e[b]=g}Array.add(c,e)}return c};NLRT.$HJ.prototype={get_$39H:function(){return this.$ez},$53v:function(a){return a==="i"&&this.$2zj?"\u0130":a.toUpperCase()},$5LH:function(){return this.$2zh},$52x:function(a,b){b.val=new NLRT.$4s(this.$9N,9);if(a!==1)if(!a){var g=new NLRT.$6P(this.$9N);Array.add(b.val.get_$1x(),g)}else if(!(a&1073741824)){var h=this.$2Hc[a-2];Array.add(b.val.get_$1x(),h)}else for(var i=a&~1073741824,e=this.$2zf[i],c=0;c<e.length;++c){var f=e[c],d;if(!f)d=new NLRT.$6P(this.$9N);else d=this.$2Hc[f-2];Array.add(b.val.get_$1x(),d)}return true},$2zh:false,$2zj:false,$2zf:null,$2Hc:null,$ez:null,$9N:null};NLRT.$dc=function(a,b,c){this.$Co=a;this.$2zi=b;this.$2zx=c;this.$2Hp=new Array(!a.b?0:a.b.length);this.$1TY=new NLRT.$OP(new NLRT.$OQ(this.$12X(this.$Co.s)));this.$Ot=new Array(a.t.length);this.$2t=new NLRT.$1G(this.$12U(0),this)};NLRT.$dc.prototype={$2t:null,get_$Dc:function(){return this.$2t},get_$4oT:function(){return this.$Co.d},$593:function(a){if(!(a in this.$Co.m))throw Error.argument("name","Unrecognized module");return this.$2uF(this.$Co.m[a])},$12X:function(a){if(a<0||!this.$Co.b||a>=this.$Co.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.$2Hp[a]||(this.$2Hp[a]=new NLRT.$AS(this.$Co.b[a]))},$CH:function(a){if(a<1||a>=this.$Co.t.length)throw Error.argumentOutOfRange("blobID");if(this.$Co.t[a]!==1)throw Error.argument("blobID","Requested blob is not a string");if(this.$Ot[a]==null){var b=this.$12U(a),c=b.get_$5(0);this.$Ot[a]=this.$1TY.$CH(c)}return this.$Ot[a]},$2E7:function(a){if(a<1||a>=this.$Co.t.length)throw Error.argumentOutOfRange("blobID");if(this.$Co.t[a]!==2)throw Error.argument("blobID","Requested blob is not a Regex");if(!this.$Ot[a]){var b=this.$12U(a),c=this.$CH(b.get_$5(0)),d=b.get_$5(1)===1;this.$Ot[a]=new RegExp(c,d?"i":"")}return this.$Ot[a]},$5CR:function(a){if(a<1||a>=this.$Co.t.length)throw Error.argumentOutOfRange("blobID");if(this.$Co.t[a]!==3)throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();},$2uF:function(a){if(a<1||a>=this.$Co.t.length)throw Error.argumentOutOfRange("blobID");if(this.$Co.t[a]!==4)throw Error.argument("blobID","Requested blob is not an NL module");return this.$Ot[a]||(this.$Ot[a]=this.$2zx.$59Y(this.$12U(a),this))},$Hw:function(a){if(a<1||a>=this.$Co.t.length)throw Error.argumentOutOfRange("blobID");if(this.$Co.t[a]!==5)throw Error.argument("blobID","Requested blob is not an annotation query");return this.$Ot[a]||(this.$Ot[a]=new NLRT.$G9(new NLRT.$KQ(this.$12U(a),this)))},$1D9:function(a){if(a<1||a>=this.$Co.t.length)throw Error.argumentOutOfRange("blobID");if(this.$Co.t[a]!==6)throw Error.argument("blobID","Requested blob is not an annotation script");return this.$Ot[a]||(this.$Ot[a]=new NLRT.$Vn(new NLRT.$KR(this.$12U(a),this)))},$eN:function(a){if(a<1||a>=this.$Co.t.length)throw Error.argumentOutOfRange("blobID");if(this.$Co.t[a]!==7)throw Error.argument("blobID","Requested blob is not a filter");return this.$Ot[a]||(this.$Ot[a]=this.$2zi.$eN(this.$12U(a),this))},$5Ay:function(a){if(a<1||a>=this.$Co.t.length)throw Error.argumentOutOfRange("blobID");if(this.$Co.t[a]!==10)throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.$Ot[a]||(this.$Ot[a]=new NLRT.$HJ(this.$12U(a),this))},$12U:function(c){var a=this.$Co.n[c],e=c<this.$Co.t.length-1?this.$Co.n[c+1]:this.$Co.n.length,b=e-a;if(a<0||b<0||a+b>this.$Co.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+a+","+b+")");var d=new(NLRT.$95.$$(Number));d.$2qK(this.$Co.n,a,b);return d},$Co:null,$1TY:null,$2zi:null,$2zx:null,$Ot:null,$2Hp:null};NLRT.$r4=function(a,b,c){this.$2TB=a;this.$fr=b;this.$xM=c};NLRT.$r4.prototype={$fr:0,$xM:0,$3BE:null,$2TB:null};NLRT.$r5=function(a,b,c,d,e){this.$KK=a;this.$fr=d.$fr+b;this.$xM=c;this.$Gi=e};NLRT.$r5.prototype={$KK:null,$fr:0,$xM:0,$Gi:null};NLRT.$r6=function(){};NLRT.$r6.prototype={$59M:function(){throw Error.notImplemented();}};NLRT.$r6.$6Aq=function(){};NLRT.$r6.$6Aq.prototype={$3BX:null,$x3:0,$1ro:0};NLRT.$OP=function(a){this.$S=a};NLRT.$OP.prototype={get_$5WX:function(){return this.$S.$q9},get_$63P:function(){return this.$S.$YH!==4},get_$63R:function(){return true},get_$39H:function(){return this.$S.$1IL},$57S:function(a,b){if(!this.get_$63P())throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.$S.$YH){case 0:return this.$57U(a,b);default:throw Error.notImplemented();}},$CH:function(a){if(!this.get_$63R())throw Error.invalidOperation("String lookup not supported on this string table");if(a<0||a>=this.get_$5WX())throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.$S.$YH){case 0:return this.$5CW(a);case 4:return this.$5CV(a);default:throw Error.notImplemented();}},$57U:function(b,c){var a=this.$S.$1IL.$3i1(b,0,b.length,c);if(!a.$V7)return-1;if(a.$15S<0||a.$15S>=this.$S.$q9)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return!this.$S.$1IM?a.$15S:this.$S.$16H.$BZ(this.$S.$1IM+a.$15S*4,4)},$5CW:function(b){if(!this.$S.$1IM)return this.$S.$1IL.$3b6(b);else{for(var a=0;a<this.$S.$q9;++a)if(this.$S.$16H.$BZ(this.$S.$1IM+a*4,4)===b)break;if(a>=this.$S.$q9)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.$S.$1IL.$3b6(a)}},$5CV:function(g){var a=this.$S.$16H.$BZ(this.$S.$2TK+g*4,4),b=this.$S.$16H.$BZ(this.$S.$2TL+g*4,4);if(b<0||a<0)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");for(var f=new Array(a),c=0;c<a;++c){var d,e;f[c]=(e=this.$5k1(d={val:b}),b=d.val,e)}return String.fromCharCode.apply(null,f)},$5k1:function(d){for(var b=0,a=0;a<3;++a){var c=this.$S.$16H.get_$5(this.$S.$2Q5+d.val)^182;++d.val;b|=(c&127)<<7*a;if(!(c&128))break}return b},$S:null};NLRT.$OQ=function(b){if(!b)return;this.$16H=b;var a=0;if(b.$BZ(a,4)!==1025118440)throw Error.argument("bytes","Input does not represent a string table");a+=4;this.$q9=b.$BZ(a,4);a+=4;this.$YH=b.$BZ(a,4);a+=4;switch(this.$YH){case 0:var c=b.$BZ(a,4)===1;a+=4;if(!c){this.$1IM=a;a+=this.$q9*4}var d=b.$BZ(a,4);a+=4;this.$1IL=this.$5ez(b,a);a+=d;break;case 4:this.$2TL=a;a+=this.$q9*4;this.$2TK=a;a+=this.$q9*4;this.$2SG=b.$BZ(a,4);a+=4;this.$2Q5=a;a+=this.$2SG;break;default:throw Error.argument("bytes");}};NLRT.$OQ.prototype={$q9:0,$YH:0,$16H:null,$1IL:null,$1IM:0,$2TL:0,$2TK:0,$2SG:0,$2Q5:0,$5ez:function(a,b){return new NLRT.$DM(a,b)}};NLRT.$Ue=function(a){this.$2Ih=a;this.$V7=false;this.$15S=!a?0:a.$15S;this.$2yY=false;this.$38Z=0;this.$N=0};NLRT.$Ue.prototype={$2Ih:null,$V7:false,$15S:0,$2yY:false,$38Z:0,$N:0};NLRT.$DM=function(c,f){this.$F7=c;var b=f;if(c.$BZ(b,4)!==1654263084)throw Error.argument("Input does not represent a trie");b+=4;this.$2Hn=c.$BZ(b,4)===1;b+=4;this.$2zg=c.$BZ(b,4)===1;b+=4;this.$2zd=c.$BZ(b,4);b+=4;var e=c.$BZ(b,4);b+=4;if(!e)this.$Ou=null;else{var d=b;this.$Ou=this.$5k2(d);var a=d+48;this.$2zl=a;a+=2*(this.$Ou.$27u+(this.$Ou.$27u%2?1:0));this.$2zt=a;a+=2*(this.$Ou.$29F+(this.$Ou.$29F%2?1:0));this.$2zp=a;a+=2*(this.$Ou.$28I+(this.$Ou.$28I%2?1:0));this.$2zr=a;a+=2*(this.$Ou.$29E+(this.$Ou.$29E%2?1:0));this.$2zk=a;a+=4*this.$Ou.$2nZ;this.$2zs=a;a+=4*this.$Ou.$2nc;this.$2zo=a;a+=4*this.$Ou.$2na;this.$2zq=a;a+=4*this.$Ou.$2nb;if(a!==d+this.$Ou.$2lG)throw Error.argument("Corrupted trie binary");this.$1n5=a}};NLRT.$DM.$2lj=function(b){var a=new NLRT.$DM.$2OF;a.$15h=b.$15h;a.$Dz=b.$Dz;a.$1ht=b.$1ht;a.$Ea=b.$Ea;a.$uc=b.$uc;a.$oZ=b.$oZ;a.$1qW=b.$1qW;return a};NLRT.$DM.prototype={$3i1:function(b,c,d,e){var a=new NLRT.$DM.$5Sn(b,c,d);this.$43F(a,e);return a.$vP},$3b6:function(b){if(this.$2Hn)if(!b)return"";else--b;if(!this.$Ou)throw Error.argument("Invalid trieID");var a=new NLRT.$DM.$2OF;a.$Dz=0;this.$1Gc(a);var c=[];while(true){if(a.$Dz&1)if(!b){Array.add(c,a.$15h);return String.fromCharCode.apply(null,c)}else--b;var e=!!(a.$Dz&2),d=this.$1Rh(a,true);if(e||b<d){Array.add(c,a.$15h);if(!this.$1Gc(a))throw Error.argument("Invalid trieID");}else{b-=d;if(!this.$1qk(a))throw Error.argument("Invalid trieID");}}},$43F:function(d,i){var c=0;if(this.$2Hn){d.$3qW(this.$2zg,this.$2zd,0);++c}if(!this.$Ou)return;var a=new NLRT.$DM.$2OF;a.$Dz=0;if(!this.$1Gc(a))return;while(true){var b,e,f;if(!(f=d.$59J(e={val:b}),b=e.val,f))return;if(i)b=i(b);var j=b.toString().charCodeAt(0),g=false;while(!g){var h=!!(a.$Dz&1);if(a.$15h===j){g=true;h&&d.$3qW(!!(a.$Dz&8),a.$1qW,c);if(!this.$1Gc(a))return}else{c+=this.$1Rh(a,true);if(!this.$1qk(a))return}if(h)++c}}},$1Gc:function(a){if(!a.$Dz){this.$39I(a);return true}if(!(a.$Dz&16))return false;a.$oZ=0;a.$Ea=a.$uc;this.$39I(a);return true},$1qk:function(a){if(a.$Dz&2)return false;this.$39I(a);return true},$1Rh:function(a,b){return a.$Dz&4?a.$1ht:!(a.$Dz&16)?0:b||!(a.$Dz&2)?1:this.$54r(a)},$54r:function(a){a=NLRT.$DM.$2lj(a);if(!this.$1Gc(a))return 0;var b=0;do{if(a.$Dz&1)++b;b+=this.$1Rh(a,false)}while(this.$1qk(a));return b},$39I:function(a){if(!a.$Dz){a.$oZ=0;a.$Ea=this.$1n5}var b=this.$29T(this.$2zl,a.$Ea),g=b.$15H;a.$Ea+=b.$1F0;var c=this.$F7.$BZ(this.$2zk+4*g,4);a.$15h=c&65535;a.$Dz=c>>16;if(a.$Dz&4)a.$1ht=this.$4l8(a);if(a.$Dz&8){var d=this.$29T(this.$2zt,a.$Ea),h=d.$15H;a.$Ea+=d.$1F0;a.$1qW=this.$F7.$BZ(this.$2zs+4*h,4)}if(a.$Dz&256){a.$uc=this.$1n5+((this.$F7.get_$5(a.$Ea)<<8|this.$F7.get_$5(a.$Ea+1))<<8|this.$F7.get_$5(a.$Ea+2));a.$Ea+=3}else if(a.$Dz&64){a.$uc=a.$Ea;a.$oZ=a.$uc}else if(a.$Dz&128){var e=this.$29T(this.$2zp,a.$Ea),i=e.$15H;a.$Ea+=e.$1F0;a.$uc=this.$1n5+this.$F7.$BZ(this.$2zo+4*i,4)}else if(a.$Dz&16){var f=this.$29T(this.$2zr,a.$Ea),j=f.$15H;a.$Ea+=f.$1F0;if(!a.$oZ)a.$oZ=a.$Ea;a.$oZ+=this.$F7.$BZ(this.$2zq+4*j,4);a.$uc=a.$oZ}},$29T:function(d,e){var b=new NLRT.$DM.$65h,a=0;while(true){a+=this.$F7.get_$5(e);++e;++b.$1F0;var c=this.$F7.$BZ(d,2);if(a<c)break;b.$15H+=c;a-=c;d+=2;a<<=8}b.$15H+=a;return b},$4l8:function(b){var a=this.$F7.get_$5(b.$Ea);if(a>=192){a=(a&63)<<15;a|=(this.$F7.get_$5(b.$Ea+1)&127)<<8;a|=this.$F7.get_$5(b.$Ea+2);b.$Ea+=3}else if(a>=128){a=(a&127)<<8;a|=this.$F7.get_$5(b.$Ea+1);b.$Ea+=2}else b.$Ea+=1;return a},$5k2:function(b){var a=new NLRT.$DM.$65g;a.$27u=this.$F7.$BZ(b+12,2);a.$29F=this.$F7.$BZ(b+14,2);a.$28I=this.$F7.$BZ(b+16,2);a.$29E=this.$F7.$BZ(b+18,2);a.$2nb=this.$F7.$BZ(b+24,4);a.$2nZ=this.$F7.$BZ(b+28,4);a.$2nc=this.$F7.$BZ(b+32,4);a.$2na=this.$F7.$BZ(b+36,4);a.$2lG=this.$F7.$BZ(b+40,4);return a},$F7:null,$2Hn:false,$2zg:false,$2zd:0,$Ou:null,$2zl:0,$2zt:0,$2zp:0,$2zr:0,$2zk:0,$2zs:0,$2zo:0,$2zq:0,$1n5:0};NLRT.$DM.$5Sn=function(b,a,c){this.$vP=new NLRT.$Ue(null);this.$2zu=b;this.$1El=a;this.$2Hk=a+c-1};NLRT.$DM.$5Sn.prototype={$59J:function(a){if(this.$1El<=this.$2Hk){a.val=this.$2zu.charAt(this.$1El);++this.$1El;return true}else{a.val="\0";return false}},$3qW:function(a,b,c){if(a){this.$vP.$2yY=true;this.$vP.$38Z=b}this.$vP.$N=this.$1El;this.$vP.$V7=true;this.$vP.$15S=c;if(this.$1El!==this.$2Hk+1)this.$vP=new NLRT.$Ue(this.$vP)},$2zu:null,$1El:0,$2Hk:0};NLRT.$DM.$65h=function(){this.$1F0=0;this.$15H=0};NLRT.$DM.$65h.prototype={$1F0:0,$15H:0};NLRT.$DM.$2OF=function(){};NLRT.$DM.$2OF.prototype={$15h:0,$Dz:0,$1ht:0,$Ea:0,$uc:0,$oZ:0,$1qW:0};NLRT.$DM.$65g=function(){};NLRT.$DM.$65g.prototype={$27u:0,$29F:0,$28I:0,$29E:0,$2nb:0,$2nZ:0,$2nc:0,$2na:0,$2lG:0};NLRT.$8v=function(){};NLRT.$8v.$3ZJ=function(c,d){for(var a=new Array(d),b=0;b<a.length;b++)a[b]=NLRT.$8v.$4RB(c.$Sk());return a};NLRT.$8v.$4RB=function(d){var a=(d>>31&1)===1?-1:1,b=d&8388607,c=d>>23&255;return c+1===256?b?Number.NaN:a===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:!c?NLRT.$8v.$63G(a,b):NLRT.$8v.$5Vd(a,b,c)};NLRT.$8v.$63G=function(a,b){return a*NLRT.$8v.$3Kp(b,0)*Math.pow(2,-126)};NLRT.$8v.$5Vd=function(b,c,d){var a=d-127;return b*NLRT.$8v.$3Kp(c,1)*Math.pow(2,a)};NLRT.$8v.$3Kp=function(c,d){for(var b=0,a=0;a<23;a++)b+=(c>>22-a&1)/Math.pow(2,a+1);return d+b};NLRT.$Kg=function(a){this.$HP=a;this.$Er=0};NLRT.$Kg.prototype={$HP:null,$Er:0,$Sk:function(){var a=this.$HP.$BZ(this.$Er,4);this.$Er+=4;return a}};NLRT.$AS=function(b){if(b==null)throw Error.argumentNull("base64String");var e=b.length;if(e%4)throw Error.argument("base64String's length must be a multiple of 4");this.$Ud=e*.75;this.$1TQ=new Array(Math.ceil(this.$Ud/4));if(b.endsWith("=="))this.$Ud-=2;else if(b.endsWith("="))this.$Ud-=1;for(var a=0,c=0;c<e;c+=4){var f=NLRT.$AS.$1pD[b.charCodeAt(c)-43]<<18|NLRT.$AS.$1pD[b.charCodeAt(c+1)-43]<<12|NLRT.$AS.$1pD[b.charCodeAt(c+2)-43]<<6|NLRT.$AS.$1pD[b.charCodeAt(c+3)-43],d=f>>16&255;this.$1TQ[Math.floor(a/4)]|=d<<8*(a%4);++a;d=f>>8&255;this.$1TQ[Math.floor(a/4)]|=d<<8*(a%4);++a;d=f&255;this.$1TQ[Math.floor(a/4)]|=d<<8*(a%4);++a}};NLRT.$AS.prototype={get_$5:function(a){if(a<0||a>=this.$Ud)throw Error.argumentOutOfRange("i");return this.$3Wm(a)},$BZ:function(b,c){if(b<0||c<0||b+c>this.$Ud)throw Error.argument("Bad range");for(var d=0,a=0;a<c;++a)d|=this.$3Wm(b+a)<<a*8;return d},$5k3:function(g,c){var d=0,a=0,e=Math.floor(g/8),b=g%8;while(a<c){var f=8-b>c-a?c-a:8-b,h=this.get_$5(e);d|=(h>>b&~(255<<f))<<a;a+=f;++e;b=0}return d},$3Wm:function(a){return this.$1TQ[Math.floor(a/4)]>>8*(a%4)&255},$1TQ:null,$Ud:0};NLRT.$Kq=function(a,b){if(!a)throw Error.argumentNull("byteArray");this.$1TX=b;if(a.$BZ(this.$1TX,4)!==604662927)throw Error.argument("byteArray","Input does not represent a compact int array");this.$87=a.$BZ(this.$1TX+4,4);this.$2Hg=a.$BZ(this.$1TX+8,4);this.$2za=a};NLRT.$Kq.prototype={get_$5:function(a){if(a<0||a>=this.$87)throw Error.argumentOutOfRange("index");return this.$2za.$5k3(this.$1TX*8+96+a*this.$2Hg,this.$2Hg)},$87:0,get_$14:function(){return this.$87},$2Hg:0,$2za:null,$1TX:0};NLRT.$95=function(){};NLRT.$95.$$=function(d){var b="$95$"+d.getName().replace(/\./g,"_");if(!NLRT[b]){var a=NLRT[b]=function(){for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];NLRT.$95.apply(this,b)};a.registerClass("NLRT."+b,null,NLRT.$c4.$$(d));var g={"NLRT.$95":{T:d}};a.prototype.$$gta=g;var e=NLRT.$95.prototype;for(var f in e){var c={key:f,value:e[f]};if("constructor"!==c.key)a.prototype[c.key]=c.value}a.$2nL=function(c){var b=new a;b.$2qK(c,0,c.length);return b}}return NLRT[b]};NLRT.$95.prototype={$2qK:function(a,b,c){if(!a)throw Error.argumentNull("referenceList");if(b<0||b>a.length)throw Error.argumentOutOfRange("startIndex");if(c<0||c>a.length)throw Error.argumentOutOfRange("length");if(b+c>a.length)throw Error.argument("Invalid start-length range");this.$2Hv=a;this.$2Hw=b;this.$Ud=c},$11p:function(a,b,c){this.$2qK(a.$2Hv,a.$2Hw+b,c)},get_$5:function(a){if(a<0||a>=this.$Ud)throw Error.argumentOutOfRange("index");return this.$2Hv[this.$2Hw+a]},get_$14:function(){return this.$Ud},$2Hv:null,$2Hw:0,$Ud:0};NLRT.$Nh=function(){};NLRT.$Nh.$4c3=function(b,c,d){var a=new NLRT.$Nh;a.$F7=b;a.$2zm=c;a.$Ud=d;return a};NLRT.$Nh.prototype={get_$5:function(a){if(a<0||a>=this.$Ud)throw Error.argumentOutOfRange("index");var b=a*4;return this.$F7.$BZ(this.$2zm+b,4)},get_$14:function(){return this.$Ud},$F7:null,$Ud:0,$2zm:0};NLRT.$QZ=function(a,b){if(!a)return;this.$VO=b.$CH(a.get_$5(0))};NLRT.$QZ.prototype={$VO:null};NLRT.$WJ=function(a,b){if(!a)return;this.$2t=b;this.$Qu=a.get_$5(0)};NLRT.$WJ.prototype={$2t:null,$Qu:0};NLRT.$ZK=function(a,b){if(!a)return;this.$2t=b;this.$Y5=a.get_$5(0)};NLRT.$ZK.prototype={$2t:null,$Y5:0};NLRT.$bH=function(a,b){if(!a)return;this.$16W=b.$Hw(a.get_$5(0));this.$1tn=b.$Hw(a.get_$5(1));this.$1HJ=!a.get_$5(2)?null:b.$Hw(a.get_$5(2))};NLRT.$bH.prototype={$16W:null,$1tn:null,$1HJ:null};NLRT.$Ay=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$5N=b.$Hw(a.get_$5(0))};NLRT.$Ay.prototype={$2t:null,$5N:null};NLRT.$gy=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$5N=!a.get_$5(0)?null:b.$Hw(a.get_$5(0))};NLRT.$gy.prototype={$2t:null,$5N:null};NLRT.$Jp=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$Y6=b.$eN(a.get_$5(0))};NLRT.$Jp.prototype={$2t:null,$Y6:null};NLRT.$Vz=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$bs=b.$1D9(a.get_$5(0))};NLRT.$Vz.prototype={$2t:null,$bs:null};NLRT.$Vy=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$bs=b.$1D9(a.get_$5(0));this.$1rV=a.get_$5(1)};NLRT.$Vy.prototype={$2t:null,$bs:null,$1rV:0};NLRT.$iw=function(a,f){if(!a)return;var e=a.get_$5(0),d=1,b,c;this.$Bg=(c=f.$tM(e,a,b={val:d},null,null,null),d=b.val,c);NLRT.$1G.$1Eg(this.$Bg)};NLRT.$iw.prototype={$Bg:null};NLRT.$X2=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$2S4=b.$2uF(a.get_$5(0))};NLRT.$X2.prototype={$2t:null,$2S4:null};NLRT.$OJ=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$1YI=b.$Hw(a.get_$5(0));this.$15n=!a.get_$5(1)?null:b.$Hw(a.get_$5(1))};NLRT.$OJ.prototype={$2t:null,$1YI:null,$15n:null};NLRT.$Uo=function(a,b){if(!a)return;this.$16b=b.$CH(a.get_$5(0));this.$5N=b.$Hw(a.get_$5(1))};NLRT.$Uo.prototype={$16b:null,$5N:null};NLRT.$GA=function(a){if(!a)return;this.$2t=a};NLRT.$GA.prototype={$2t:null};NLRT.$bi=function(a,b){if(!a)return;this.$2RF=b.$Hw(a.get_$5(0));this.$1se=b.$Hw(a.get_$5(1))};NLRT.$bi.prototype={$2RF:null,$1se:null};NLRT.$r0=function(){};NLRT.$r0.prototype={$E1:0,$16K:0,$Gi:null,get_$Dt:function(){return this.$Gi},set_$Dt:function(a){this.$Gi=a;return a},$Be:function(){throw Error.invalidOperation("Store not supported");},$uW:function(a){if(this.$Gi)return this.$Gi;if(a.val){var b=a.val.get_$3Kc();a.val=a.val.get_$3og();return b}return null}};NLRT.$a7=function(a){NLRT.$a7.initializeBase(this);this.$S=a};NLRT.$a7.prototype={$Sa:function(c,b){var a=!b?null:b.$2DR(this.$S.$VO);if(!a)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.$S.$VO+'"');return a},$Be:function(i,h,c,d){var a=!c?null:c.$2DR(this.$S.$VO);if(!a)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.$S.$VO+'"');var b=h,e,f,g=(f=this.$uW(e={val:d}),d=e.val,f);if(g)b=g.$Be(a,h,c,d);a!==b&&a.$tF(b);return a},$S:null};NLRT.$c8=function(a){NLRT.$c8.initializeBase(this);this.$S=a};NLRT.$c8.prototype={$Sa:function(c,a){var b=!a?null:a.$2DR(this.$S.$VO);return!!b},$S:null};NLRT.$WI=function(a){NLRT.$WI.initializeBase(this);this.$S=a};NLRT.$WI.prototype={$Sa:function(d){if(this.$E1===9)return this.$2HT(d);else{for(var c=new NLRT.$4s(this.$S.$2t,this.$S.$2t.$1DA(this.$S.$Qu)),b=d.get_$1x(),e=b.length,a=0;a<e;++a){var f=b[a];Array.add(c.get_$1x(),this.$2HT(f))}return c}},$Be:function(s,e,t,b){if(this.$E1===9){var g=s,m=e,i,j,n=(j=this.$uW(i={val:b}),b=i.val,j);if(n)m=n.$Be(NLRT.$1G.$Q4(this.$2HT(g)),e,t,b);g.$Bc(this.$S.$Qu,m);return g}else{var a=s,o=e,k,l,p=(l=this.$uW(k={val:b}),b=k.val,l);if(p){for(var r=new NLRT.$4s(this.$S.$2t,this.$S.$2t.$1DA(this.$S.$Qu)),h=a.get_$1x(),u=h.length,f=0;f<u;++f){var v=h[f];Array.add(r.get_$1x(),this.$2HT(v))}o=p.$Be(r,e,t,b)}var q=o;if(q.get_$1x().length!==a.get_$1x().length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(var c=0,w=a.get_$1x().length;c<w;++c){var d=a.get_$1x()[c];if(d.get_$1EL()){d=d.$3l();a.get_$1x()[c]=d}d.$Bc(this.$S.$Qu,q.get_$1x()[c])}return a}},$2HT:function(d){var a,b,c;if(!(c=d.$8L(Object,this.$S.$Qu,b={val:a}),a=b.val,c))a=this.$S.$2t.$538(this.$S.$Qu);return a},$S:null};NLRT.$ZJ=function(a){NLRT.$ZJ.initializeBase(this);this.$S=a};NLRT.$ZJ.prototype={$Sa:function(d){if(!NLRT.$1G.$Gb(this.$E1))return d.$12d(this.$S.$Y5);else{for(var c=new NLRT.$4s(this.$S.$2t,this.$S.$2t.$1Da(NLRT.$1G.$uU(this.$E1),this.$S.$Y5)),b=d.get_$1x(),e=b.length,a=0;a<e;++a){var f=b[a];Array.add(c.get_$1x(),f.$12d(this.$S.$Y5))}return c}},$Be:function(s,e,t,b){if(!NLRT.$1G.$Gb(this.$E1)){var g=s,m=e,i,j,n=(j=this.$uW(i={val:b}),b=i.val,j);if(n)m=n.$Be(NLRT.$1G.$Q4(g.$12d(this.$S.$Y5)),e,t,b);g.$36A(this.$S.$Y5,m);return g}else{var a=s,o=e,k,l,p=(l=this.$uW(k={val:b}),b=k.val,l);if(p){for(var r=new NLRT.$4s(this.$S.$2t,this.$S.$2t.$1Da(NLRT.$1G.$uU(this.$E1),this.$S.$Y5)),h=a.get_$1x(),u=h.length,f=0;f<u;++f){var v=h[f];Array.add(r.get_$1x(),v.$12d(this.$S.$Y5))}o=p.$Be(r,e,t,b)}var q=o;if(q.get_$1x().length!==a.get_$1x().length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(var c=0,w=a.get_$1x().length;c<w;++c){var d=a.get_$1x()[c];if(d.get_$1EL()){d=d.$3l();a.get_$1x()[c]=d}d.$36A(this.$S.$Y5,q.get_$1x()[c])}return a}},$S:null};NLRT.$b9=function(a){NLRT.$b9.initializeBase(this);this.$S=a};NLRT.$b9.prototype={$Sa:function(a,b){return this.$S.$16W.$99(a,b)?this.$S.$1tn.$99(a,b):this.$S.$1HJ?this.$S.$1HJ.$99(a,b):a},$Be:function(b,c,d,a){var g=this.$S.$16W.$99(b,d);if(this.$Gi)a=new NLRT.$Vm(this.$Gi,a);if(g)return this.$S.$1tn.$1qA(b,c,d,a);else if(this.$S.$1HJ)return this.$S.$1HJ.$1qA(b,c,d,a);else{var f=c,e=null;if(a){e=a.get_$3Kc();a=a.get_$3og()}if(e)f=e.$Be(NLRT.$1G.$Q4(b),c,d,a);return f}},$S:null};NLRT.$cy=function(a){NLRT.$cy.initializeBase(this);this.$S=a};NLRT.$cy.prototype={$Sa:function(d,e){if(!NLRT.$1G.$Gb(this.$E1))return this.$S.$Y6.$NX(d,e,null);else{for(var c=new NLRT.$4s(this.$S.$2t,2),b=d.get_$1x(),f=b.length,a=0;a<f;++a){var g=b[a];Array.add(c.get_$1x(),this.$S.$Y6.$NX(g,e,null))}return c}},$S:null};NLRT.$cz=function(a){NLRT.$cz.initializeBase(this);this.$S=a};NLRT.$cz.prototype={$Sa:function(a,b){return this.$S.$Y6.$NX(a,b,null)},$S:null};NLRT.$Vv=function(a){NLRT.$Vv.initializeBase(this);this.$S=a};NLRT.$Vv.prototype={$Sa:function(d,e){if(this.$E1===9)return this.$2AN(d,e);else{for(var c=new NLRT.$4s(this.$S.$2t,9),b=d.get_$1x(),f=b.length,a=0;a<f;++a){var g=b[a];Array.add(c.get_$1x(),this.$2AN(g,e))}return c}},$2AN:function(c,d){var a=new NLRT.$6P(this.$S.$2t);a.$tF(c);var b=new NLRT.$6P(this.$S.$2t);this.$S.$bs.$1CE(null,new NLRT.$98("Input",a,new NLRT.$98("Output",b,d)));return b},$S:null};NLRT.$Vx=function(a){NLRT.$Vx.initializeBase(this);this.$S=a};NLRT.$Vx.prototype={$Sa:function(m,n){if(this.$E1===9){var k=this.$2AN(m,n),c,g,h;if(!(h=k.$8L(NLRT.$77,this.$S.$1rV,g={val:c}),c=g.val,h))c=new NLRT.$4s(this.$S.$2t,9);return k}else{for(var l=new NLRT.$4s(this.$S.$2t,9),e=m.get_$1x(),o=e.length,a=0;a<o;++a){var q=e[a],r=this.$2AN(q,n),d,i,j;if(j=r.$8L(NLRT.$77,this.$S.$1rV,i={val:d}),d=i.val,j)for(var f=d.get_$1x(),p=f.length,b=0;b<p;++b){var s=f[b];Array.add(l.get_$1x(),s)}}return l}},$2AN:function(c,d){var a=new NLRT.$6P(this.$S.$2t);a.$tF(c);var b=new NLRT.$6P(this.$S.$2t);this.$S.$bs.$1CE(null,new NLRT.$98("Input",a,new NLRT.$98("Output",b,d)));return b},$S:null};NLRT.$iv=function(a){NLRT.$iv.initializeBase(this);this.$S=a};NLRT.$iv.prototype={$Sa:function(){return this.$S.$Bg},$S:null};NLRT.$X1=function(a){NLRT.$X1.initializeBase(this);this.$S=a};NLRT.$X1.prototype={$Sa:function(b){var a=new NLRT.$6P(this.$S.$2t);a.$tF(b);return this.$S.$2S4.$46(a)},$S:null};NLRT.$fB=function(a){NLRT.$fB.initializeBase(this);this.$S=a};NLRT.$fB.prototype={$Sa:function(c,d){for(var e=this.$S.$1YI.$99(c,d),f=this.$S.$15n.$99(c,d),b=new NLRT.$4s(this.$S.$2t,3),a=0;a<f;++a)Array.add(b.get_$1x(),e+a);return b},$S:null};NLRT.$Xo=function(a){NLRT.$Xo.initializeBase(this);this.$S=a};NLRT.$Xo.prototype={$Sa:function(a){return NLRT.$G9.$3Jg(this.$S.$2t,a,this.$E1,this.$16K)},$S:null};NLRT.$cK=function(a){NLRT.$cK.initializeBase(this);this.$S=a};NLRT.$cK.prototype={$Sa:function(c,d){var a=c,b=this.$2Dc(a,d);return a.get_$1x()[b]},$Be:function(j,h,i,b){var a=j,e=this.$2Dc(a,i),f=h,c,d,g=(d=this.$uW(c={val:b}),b=c.val,d);if(g)f=g.$Be(NLRT.$1G.$Q4(a.get_$1x()[e]),h,i,b);a.get_$1x()[e]=f;return a},$2Dc:function(b,c){var a=this.$S.$5N.$99(b,c);if(a<0||a>=b.get_$1x().length)throw Error.invalidOperation("Index out of range in Item store step");return a},$S:null};NLRT.$cj=function(a){NLRT.$cj.initializeBase(this);this.$S=a};NLRT.$cj.prototype={$Sa:function(c,d){var a=c,b=this.$2Dc(a,d);return a.get_$1x()[a.get_$1x().length-b-1]},$Be:function(j,h,i,b){var a=j,e=this.$2Dc(a,i),f=h,c,d,g=(d=this.$uW(c={val:b}),b=c.val,d);if(g)f=g.$Be(NLRT.$1G.$Q4(a.get_$1x()[a.get_$1x().length-e-1]),h,i,b);a.get_$1x()[a.get_$1x().length-e-1]=f;return a},$2Dc:function(b,c){var a=!this.$S.$5N?0:this.$S.$5N.$99(b,c);if(a<0||a>=b.get_$1x().length)throw Error.invalidOperation("Index out of range in LastItem load step");return a},$S:null};NLRT.$Xs=function(){NLRT.$Xs.initializeBase(this)};NLRT.$Xs.prototype={$Sa:function(a){return a.get_$1x().length}};NLRT.$ZS=function(a){NLRT.$ZS.initializeBase(this);this.$S=a};NLRT.$ZS.prototype={$Sa:function(e,f){for(var b=e.get_$1x(),d=b.length,a=0;a<d;++a){var c=b[a];if(this.$S.$Y6.$NX(c,f,null))return c}throw Error.invalidOperation("No matching item found in FirstItemMatching load step");},$Be:function(m,i,j,d){for(var a=m,g=i,b=-1,c=0,k=a.get_$1x().length;c<k;c++){var l=a.get_$1x()[c];if(this.$S.$Y6.$NX(l,j,null)){b=c;break}}if(b<0)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");var e,f,h=(f=this.$uW(e={val:d}),d=e.val,f);if(h)g=h.$Be(NLRT.$1G.$Q4(a.get_$1x()[b]),i,j,d);a.get_$1x()[b]=g;return a},$S:null};NLRT.$Zr=function(a){NLRT.$Zr.initializeBase(this);this.$S=a};NLRT.$Zr.prototype={$Sa:function(f,g){for(var c=new NLRT.$98(this.$S.$16b,null,g),b=f.get_$1x(),e=b.length,a=0;a<e;++a){var d=b[a];c.$2lL(d);if(!this.$S.$5N.$99(d,c))return false}return true},$S:null};NLRT.$ZA=function(a){NLRT.$ZA.initializeBase(this);this.$S=a};NLRT.$ZA.prototype={$Sa:function(f,g){for(var c=new NLRT.$98(this.$S.$16b,null,g),b=f.get_$1x(),e=b.length,a=0;a<e;++a){var d=b[a];c.$2lL(d);if(this.$S.$5N.$99(d,c))return true}return false},$S:null};NLRT.$Vs=function(a){NLRT.$Vs.initializeBase(this);this.$S=a};NLRT.$Vs.prototype={$Sa:function(c,d){var b=this.$S.$5N.$99(c,d),a=c.$3l();if(NLRT.$1G.$Gb(this.$S.$5N.get_$jo()))Array.addRange(a.get_$1x(),b.get_$1x());else Array.add(a.get_$1x(),b);return a},$S:null};NLRT.$hc=function(a){NLRT.$hc.initializeBase(this);this.$S=a};NLRT.$hc.prototype={$Sa:function(h,i){var a=h,b,c,e,f;this.$2uy(a,i,e={val:b},f={val:c}),b=e.val,c=f.val;for(var g=new NLRT.$4s(this.$S.$2t,a.get_$f1()),d=0;d<c;++d)Array.add(g.get_$1x(),a.get_$1x()[b+d]);return g},$Be:function(s,p,q,f){var a=s,b,c,g,h;this.$2uy(a,q,g={val:b},h={val:c}),b=g.val,c=h.val;var k=p,i,j,l=(j=this.$uW(i={val:f}),f=i.val,j);if(l){for(var n=new NLRT.$4s(this.$S.$2t,a.get_$f1()),e=0;e<c;++e)Array.add(n.get_$1x(),a.get_$1x()[b+e]);k=l.$Be(n,p,q,f)}for(var m=k,o=0;o<c;++o)Array.removeAt(a.get_$1x(),b);for(var d=0,r=m.get_$1x().length;d<r;++d)Array.insert(a.get_$1x(),b+d,m.get_$1x()[d]);return a},$2uy:function(a,d,b,c){b.val=this.$S.$1YI.$99(a,d);if(b.val<0)throw Error.invalidOperation("Invalid start index in Sublist() query step");c.val=!this.$S.$15n?a.get_$1x().length-b.val:this.$S.$15n.$99(a,d);if(c.val<0||b.val+c.val>a.get_$1x().length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");},$S:null};NLRT.$cL=function(a){NLRT.$cL.initializeBase(this);this.$S=a};NLRT.$cL.prototype={$Sa:function(f,g){for(var c=new NLRT.$4s(this.$S.$2t,NLRT.$1G.$uU(this.$E1)),b=f.get_$1x(),e=b.length,a=0;a<e;++a){var d=b[a];this.$S.$Y6.$NX(d,g,null)&&Array.add(c.get_$1x(),d)}return c},$S:null};NLRT.$iP=function(a){NLRT.$iP.initializeBase(this);this.$S=a};NLRT.$iP.prototype={$Sa:function(b){var a=new NLRT.$4s(this.$S.$2t,this.$E1);Array.add(a.get_$1x(),b);return a},$S:null};NLRT.$bj=function(a){NLRT.$bj.initializeBase(this);this.$S=a};NLRT.$bj.prototype={$Sa:function(d,g){var a=this.$S.$2RF.$99(d,g),e=this.$S.$1se.$99(d,g),b=d.$3l();if(a<0||a>b.get_$1x().length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(NLRT.$1G.$Gb(this.$S.$1se.get_$jo()))for(var f=e,c=0;c<f.get_$1x().length;++c)Array.insert(b.get_$1x(),a+c,f.get_$1x()[c]);else Array.insert(b.get_$1x(),a,e);return b},$S:null};NLRT.$hf=function(a){NLRT.$hf.initializeBase(this);this.$S=a};NLRT.$hf.prototype={$Sa:function(d,e){if(NLRT.$1G.$Gb(this.$E1)){for(var b=d,c=new NLRT.$4s(this.$S.$2t,1),a=0,f=b.get_$1x().length;a<f;++a)Array.add(c.get_$1x(),this.$3bB(b.get_$1x()[a],e));return c}else return this.$3bB(d,e)},$Be:function(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");},$3bB:function(e,f){var a,b,c,d;this.$2uy(e,f,c={val:a},d={val:b}),a=c.val,b=d.val;return e.substr(a,b)},$2uy:function(a,d,b,c){b.val=this.$S.$1YI.$99(a,d);if(b.val<0)throw Error.invalidOperation("Invalid start index in Substring() query step");c.val=!this.$S.$15n?a.length-b.val:this.$S.$15n.$99(a,d);if(c.val<0||b.val+c.val>a.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");},$S:null};NLRT.$XV=function(a){NLRT.$XV.initializeBase(this);this.$S=a};NLRT.$XV.prototype={$Sa:function(a,n){if(NLRT.$1G.$Gb(this.$E1)){for(var r=a,e=this.$S.$5N.$99(a,n),f=new NLRT.$4s(this.$S.$2t,1),s=String.isInstanceOfType(e),t=e,h=r.get_$1x(),o=h.length,b=0;b<o;++b){var k=h[b];if(s)Array.add(f.get_$1x(),k+e);else for(var i=t.get_$1x(),p=i.length,c=0;c<p;++c){var u=i[c];Array.add(f.get_$1x(),k+u)}}return f}else{var l=a,g=this.$S.$5N.$99(a,n),v=String.isInstanceOfType(g);if(v)return l+g;else{for(var m=new NLRT.$4s(this.$S.$2t,1),j=g.get_$1x(),q=j.length,d=0;d<q;++d){var w=j[d];Array.add(m.get_$1x(),l+w)}return m}}},$S:null};NLRT.$cl=function(a){NLRT.$cl.initializeBase(this);this.$S=a};NLRT.$cl.prototype={$Sa:function(d){if(NLRT.$1G.$Gb(this.$E1)){for(var f=d,c=new NLRT.$4s(this.$S.$2t,3),b=f.get_$1x(),e=b.length,a=0;a<e;++a){var g=b[a];Array.add(c.get_$1x(),g.length)}return c}else return d.length},$S:null};NLRT.$iJ=function(a){NLRT.$iJ.initializeBase(this);this.$S=a};NLRT.$iJ.prototype={$Sa:function(d){for(var b=new NLRT.$4s(this.$S.$2t,1),c=d,a=0;a<c.length;++a)Array.add(b.get_$1x(),c.charAt(a).toString());return b},$S:null};NLRT.$s3=function(a){NLRT.$s3.initializeBase(this);this.$S=a};NLRT.$s3.prototype={$Sa:function(d,s){var a=this.$S.$5N.$99(d,s);if(NLRT.$1G.$Gb(this.$E1)){var b=d,g=NLRT.$1G.$uU(this.$E1),h=new NLRT.$4s(this.$S.$2t,g);if(!NLRT.$1G.$Gb(this.$S.$5N.get_$jo()))for(var i=b.get_$1x(),m=i.length,e=0;e<m;++e){var o=i[e];Array.add(h.get_$1x(),this.$27l(o,a,g===5))}else{var k=a;if(b.get_$1x().length!==k.get_$1x().length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(var c=0,p=b.get_$1x().length;c<p;++c)Array.add(h.get_$1x(),this.$27l(b.get_$1x()[c],k.get_$1x()[c],g===5))}return h}else if(!NLRT.$1G.$Gb(this.$S.$5N.get_$jo()))return this.$27l(d,a,this.$E1===5);else{for(var q=a,l=new NLRT.$4s(this.$S.$2t,this.$E1),j=q.get_$1x(),n=j.length,f=0;f<n;++f){var r=j[f];Array.add(l.get_$1x(),this.$27l(d,r,this.$E1===5))}return l}},$27l:function(b,c,d){var a=this.$4M2(b,c);return d?a:Math.floor(a)},$S:null};NLRT.$VI=function(a){NLRT.$VI.initializeBase(this,[a])};NLRT.$VI.prototype={$4M2:function(a,b){return a+b}};NLRT.$hg=function(a){NLRT.$hg.initializeBase(this,[a])};NLRT.$hg.prototype={$4M2:function(a,b){return a-b}};NLRT.$dK=function(a){NLRT.$dK.initializeBase(this,[a])};NLRT.$dK.prototype={$4M2:function(a,b){return a*b}};NLRT.$Ya=function(a){NLRT.$Ya.initializeBase(this,[a])};NLRT.$Ya.prototype={$4M2:function(a,b){return a/b}};NLRT.$dD=function(a){NLRT.$dD.initializeBase(this,[a])};NLRT.$dD.prototype={$4M2:function(a,b){return a%b}};NLRT.$ZB=function(a){NLRT.$ZB.initializeBase(this,[a])};NLRT.$ZB.prototype={$4M2:function(a,b){return Math.pow(a,b)}};NLRT.$s5=function(a){NLRT.$s5.initializeBase(this);this.$S=a};NLRT.$s5.prototype={$Sa:function(a,p){if(this.$E1===2&&this.$S.$5N.get_$jo()===2){var f,j,k;if(k=this.$4N2(a,j={val:f}),f=j.val,k)return f}if(NLRT.$1G.$Gb(this.$E1)){var b=a,g=new NLRT.$4s(this.$S.$2t,2),l=this.$S.$5N.$99(a,p);if(!NLRT.$1G.$Gb(this.$S.$5N.get_$jo()))for(var h=b.get_$1x(),q=h.length,d=0;d<q;++d){var s=h[d];Array.add(g.get_$1x(),this.$28W(l,s))}else{var m=l;if(b.get_$1x().length!==m.get_$1x().length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(var c=0,t=b.get_$1x().length;c<t;++c)Array.add(g.get_$1x(),this.$28W(m.get_$1x()[c],b.get_$1x()[c]))}return g}else{var n=this.$S.$5N.$99(a,p);if(!NLRT.$1G.$Gb(this.$S.$5N.get_$jo()))return this.$28W(n,a);else{for(var u=n,o=new NLRT.$4s(this.$S.$2t,2),i=u.get_$1x(),r=i.length,e=0;e<r;++e){var v=i[e];Array.add(o.get_$1x(),this.$28W(v,a))}return o}}},$S:null};NLRT.$Vk=function(a){NLRT.$Vk.initializeBase(this,[a])};NLRT.$Vk.prototype={$4N2:function(a,b){b.val=false;return!a},$28W:function(a,b){return a&&b}};NLRT.$du=function(a){NLRT.$du.initializeBase(this,[a])};NLRT.$du.prototype={$4N2:function(a,b){b.val=true;return a},$28W:function(a,b){return a||b}};NLRT.$dV=function(a){NLRT.$dV.initializeBase(this);this.$S=a};NLRT.$dV.prototype={$Sa:function(d){if(NLRT.$1G.$Gb(this.$E1)){for(var c=new NLRT.$4s(this.$S.$2t,2),b=d.get_$1x(),e=b.length,a=0;a<e;++a){var f=b[a];Array.add(c.get_$1x(),!f)}return c}else return!d},$S:null};NLRT.$N8=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$1Hf=b.$Hw(a.get_$5(0));this.$1YC=b.$Hw(a.get_$5(1))};NLRT.$N8.prototype={$2t:null,$1Hf:null,$1YC:null};NLRT.$fO=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$5N=b.$Hw(a.get_$5(0));this.$Qu=a.get_$5(1)};NLRT.$fO.prototype={$2t:null,$5N:null,$Qu:0};NLRT.$dO=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$VO=b.$CH(a.get_$5(0));this.$5N=!a.get_$5(1)?null:b.$Hw(a.get_$5(1))};NLRT.$dO.prototype={$2t:null,$VO:null,$5N:null};NLRT.$Yy=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$VO=b.$CH(a.get_$5(0));this.$1Xs=b.$Hw(a.get_$5(1));this.$2Pw=b.$1D9(a.get_$5(2));this.$16I=a.get_$5(3)};NLRT.$Yy.prototype={$2t:null,$VO:null,$1Xs:null,$2Pw:null,$16I:0};NLRT.$bK=function(a,b){if(!a)return;this.$16W=b.$Hw(a.get_$5(0));this.$2Tc=b.$1D9(a.get_$5(1));this.$1s9=!a.get_$5(2)?null:b.$1D9(a.get_$5(2))};NLRT.$bK.prototype={$16W:null,$2Tc:null,$1s9:null};NLRT.$W0=function(a,b){if(!a)return;this.$2RI=b.$Hw(a.get_$5(0));this.$2SQ=b.$Hw(a.get_$5(1));this.$bs=b.$1D9(a.get_$5(2))};NLRT.$W0.prototype={$2RI:null,$2SQ:null,$bs:null};NLRT.$WC=function(a){this.$S=a};NLRT.$WC.prototype={$46:function(a,b){var c=this.$S.$1YC.$99(a,b.val);this.$S.$1Hf.$1qA(a,c,b.val,null)},$S:null};NLRT.$dC=function(a){this.$S=a};NLRT.$dC.prototype={$46:function(b,a){var c=this.$S.$1YC.$99(this.$S.$1Hf.$99(b,a.val),a.val);this.$S.$1Hf.$1qA(b,c,a.val,null)},$S:null};NLRT.$fN=function(a){this.$S=a};NLRT.$fN.prototype={$46:function(f,g){var c=this.$S.$5N.$99(f,g.val);if(this.$S.$5N.get_$jo()===9)c.$2Kp(this.$S.$Qu);else for(var b=c.get_$1x(),d=b.length,a=0;a<d;++a){var e=b[a];e.$2Kp(this.$S.$Qu)}},$S:null};NLRT.$dM=function(a){this.$S=a};NLRT.$dM.prototype={$46:function(c,a){var b=new NLRT.$6P(this.$S.$2t);this.$S.$5N&&b.$tF(this.$S.$5N.$99(c,a.val));a.val=new NLRT.$98(this.$S.$VO,b,a.val)},$S:null};NLRT.$Yx=function(a){a.$16I>=0;this.$S=a};NLRT.$Yx.prototype={$46:function(c,d){var a=this.$S.$1Xs.$99(c,d.val);if(this.$S.$1Xs.get_$3zI()){a=NLRT.$1G.$Q4(a);for(var j=new NLRT.$98(this.$S.$VO,null,d.val),b=0,k=a.get_$1x().length;b<k;++b){var i=this.$3Pd(c,a.get_$1x()[b],j);if(this.$S.$16I<0)a.get_$1x()[b]=i;else{var e,g,h;if(h=i.$8L(Object,this.$S.$16I,g={val:e}),e=g.val,h)a.get_$1x()[b]=e;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}}this.$S.$1Xs.$1qA(c,a,d.val,null)}else for(var l=new NLRT.$98(this.$S.$VO,null,d.val),f=0,m=a.get_$1x().length;f<m;++f)this.$3Pd(c,a.get_$1x()[f],l)},$3Pd:function(d,b,c){var a;if(this.$S.$16I<0)a=NLRT.$1G.$Q4(b);else{a=new NLRT.$6P(this.$S.$2t);a.$Bc(this.$S.$16I,b)}c.$2lL(a);this.$S.$2Pw.$1CE(d,c);return a},$S:null};NLRT.$bA=function(a){this.$S=a};NLRT.$bA.prototype={$46:function(a,b){if(this.$S.$16W.$99(a,b.val))this.$S.$2Tc.$1CE(a,b.val);else this.$S.$1s9&&this.$S.$1s9.$1CE(a,b.val)},$S:null};NLRT.$Vw=function(a){this.$S=a};NLRT.$Vw.prototype={$46:function(a,b){var c=this.$S.$2RI.$99(a,b.val),d=this.$S.$2SQ.$99(a,b.val);this.$S.$bs.$1CE(a,new NLRT.$98("Input",c,new NLRT.$98("Output",d,b.val)))},$S:null};NLRT.$Xp=function(a){this.$S=a};NLRT.$Xp.prototype={$46:function(c,d){var a=this.$S.$1Hf.$99(c,d.val),b=this.$S.$1YC.$99(c,d.val);a!==b&&a.$tF(b)},$S:null};NLRT.$fC=function(a){if(!a)throw Error.argumentNull("resource");this.$Sb=new NLRT.$dc(a,new NLRT.$ZO,new NLRT.$dR);this.$1TW=this.$Sb.$593("");this.$2Hf=this.$Sb.$2t.$1k8("Text.Text");this.$2Hd=this.$Sb.$2t.$1k8("Classification.Predictions");this.$2He=this.$Sb.$2t.$1k8("Classification.PredictionString");this.$2zY=this.$Sb.$2t.$1k8("Classification.Probability");this.$2zZ=this.$Sb.$2t.$1k8("NLMod.Tokens");if(this.$2Hf<0||this.$2Hd<0||this.$2He<0||this.$2zY<0)throw Error.argument("resourceObj","Resource does not represent a ranker");};NLRT.$fC.prototype={$53J:function(b){var a=[];this.$3Pa(b,this.$3Wa(a),null);return a},$53K:function(f,b){var c=[],d=[],a=this,e=function(c,h){var e=a.$Sb.$2t.$3WV(c),f=[],g=[];if(!b||!b.length||Array.indexOf(b,e)!==-1){var i=a.$Sb.$2t.$1DA(c);a.$3oQ(i,h,f,g);var j=new NLRT.$iL(e,f,g);Array.add(d,j)}};this.$3Pa(f,this.$3Wa(c),e);return new NLRT.$eh(c,d)},$3Pa:function(r,s,m){var k=new NLRT.$6P(this.$Sb.$2t);k.$Bc(this.$2Hf,r);var l=this.$1TW.$46(k),c,g,h;if(h=l.$8L(NLRT.$77,this.$2Hd,g={val:c}),c=g.val,h)for(var e=c.get_$1x(),n=e.length,a=0;a<n;++a){var q=e[a];s(q)}if(m){var d,i,j;if(j=l.$8L(NLRT.$77,this.$2zZ,i={val:d}),d=i.val,j)for(var f=d.get_$1x(),o=f.length,b=0;b<o;++b){var p=f[b];p.$2Au(m)}}},$3oQ:function(a,d,e,f){if(NLRT.$1G.$Gb(a))for(var h=d,g=h.get_$1x(),i=g.length,c=0;c<i;++c){var j=g[c];this.$3oQ(h.get_$f1(),j,e,f)}else if(NLRT.$1G.$41D(a))for(var k=d,l=this.$Sb.$2t.$3Zn(a),b=0;b<l;b++){Array.add(e,this.$Sb.$2t.$3b8(a,b));Array.add(f,this.$Sb.$2t.$bL(this.$Sb.$2t.$1Da(a,b),k.$12d(b)))}else{Array.add(e,"VALUE");Array.add(f,this.$Sb.$2t.$bL(a,d))}},$3Wa:function(c){var a=this,b=function(f){var b,d,e;(e=f.$8L(String,a.$2He,d={val:b}),b=d.val,e)&&Array.add(c,b)};return b},$Sb:null,$1TW:null,$2Hf:0,$2Hd:0,$2He:0,$2zY:0,$2zZ:0};NLRT.$eh=function(a,b){if(!a)throw Error.argumentNull("predictions");if(!b)throw Error.argumentNull("attributes");this.$2eg=a;this.$2Up=b};NLRT.$eh.prototype={$2eg:null,$2Up:null,$3aP:function(){return this.$2eg},$52r:function(){return this.$2Up}};NLRT.$iL=function(c,a,b){if(!a)throw Error.argumentNull("fieldNames");if(!b)throw Error.argumentNull("values");a.length!==b.length&&Error.argument("values","fieldNames and values do not have same length");this.$3BC=c;this.$1n4=a;this.$2I0=b};NLRT.$iL.prototype={$1n4:null,$2I0:null,$3BC:null,get_$4rq:function(){return this.$1n4.length},$3Y1:function(a){return a>=0&&a<this.$1n4.length?this.$1n4[a]:null},$s:function(a){return a>=0&&a<this.$2I0.length?this.$2I0[a]:null}};NLRT.$NF=function(b,d){if(!b)return;var c=b.get_$5(0);this.$1rf=new Array(c);for(var a=0;a<c;++a)this.$1rf[a]=d.$eN(b.get_$5(1+a))};NLRT.$NF.prototype={$1rf:null};NLRT.$fK=function(a,b){if(!a)return;this.$1Hu=b.$2E7(a.get_$5(0))};NLRT.$fK.prototype={$1Hu:null};NLRT.$EK=function(a,b){if(!a)return;this.$5N=b.$Hw(a.get_$5(0));this.$2RR=a.get_$5(1)===1};NLRT.$EK.prototype={$5N:null,$2RR:false};NLRT.$hZ=function(a){if(!a)return;this.$Bg=a.get_$5(0)===1};NLRT.$hZ.prototype={$Bg:false};NLRT.$EV=function(a,b){if(!a)return;this.$5N=b.$Hw(a.get_$5(0))};NLRT.$EV.prototype={$5N:null};NLRT.$H7=function(a,b){if(!a)return;this.$2SF=a.get_$5(0);this.$5N=!a.get_$5(1)?null:b.$Hw(a.get_$5(1))};NLRT.$H7.prototype={$2SF:0,$5N:null};NLRT.$ON=function(a){if(!a)return;this.$161=a.get_$5(0)===1;this.$Bg=a.get_$5(1)};NLRT.$ON.prototype={$161:false,$Bg:0};NLRT.$JZ=function(a,b){if(!a)return;this.$161=a.get_$5(0)===1;this.$5N=b.$Hw(a.get_$5(1))};NLRT.$JZ.prototype={$161:false,$5N:null};NLRT.$ZM=function(a,b){if(!a)return;this.$Y5=a.get_$5(0);this.$1IS=b.$eN(a.get_$5(1))};NLRT.$ZM.prototype={$Y5:0,$1IS:null};NLRT.$OC=function(a,b){if(!a)return;this.$Y6=b.$eN(a.get_$5(0))};NLRT.$OC.prototype={$Y6:null};NLRT.$K7=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$Qu=a.get_$5(0);this.$1IS=!a.get_$5(1)?null:b.$eN(a.get_$5(1))};NLRT.$K7.prototype={$2t:null,$Qu:0,$1IS:null};NLRT.$eg=function(a,b){if(!a)return;this.$16b=b.$CH(a.get_$5(0));this.$5N=b.$Hw(a.get_$5(1))};NLRT.$eg.prototype={$16b:null,$5N:null};NLRT.$i9=function(a,b){if(!a)return;this.$2t=b.get_$Dc();this.$1tU=a.get_$5(0);this.$1tT=a.get_$5(1);this.$2T9=a.get_$5(2);this.$1YR=!a.get_$5(3)?null:b.$eN(a.get_$5(3));this.$1rW=!a.get_$5(4)?null:b.$eN(a.get_$5(4));this.$1tX=!a.get_$5(5)?null:b.$eN(a.get_$5(5));this.$1sl=!a.get_$5(6)?null:b.$eN(a.get_$5(6))};NLRT.$i9.prototype={$2t:null,$1tU:0,$1tT:0,$2T9:0,$1YR:null,$1rW:null,$1tX:null,$1sl:null};NLRT.$he=function(a,c){if(!a)return;var b=c.$CH(a.get_$5(0));this.$1XJ=b.charCodeAt(0);this.$2Ti=b.substr(1);this.$2TA=c.$5CR(a.get_$5(1))};NLRT.$he.prototype={$1XJ:0,$2Ti:null,$2TA:null};NLRT.$NE=function(a,b){this.$S=a;this.$I1=b};NLRT.$NE.prototype={$NX:function(f,g,h){for(var a=!this.$I1,c=this.$S.$1rf,d=c.length,b=0;b<d;++b){var e=c[b];a=e.$NX(f,g,h);if(a?this.$I1===1:!this.$I1)return a}if(this.$I1===2)a=!a;return a},$S:null,$I1:0};NLRT.$fJ=function(a){this.$S=a};NLRT.$fJ.prototype={$NX:function(a){if(!String.isInstanceOfType(a))throw Error.argument("objToTest","Expected string");var b=a;return this.$S.$1Hu.test(a)},$S:null};NLRT.$EJ=function(a,b){this.$S=a;this.$I1=b};NLRT.$EJ.prototype={$NX:function(d,e){if(!String.isInstanceOfType(d))throw Error.argument("objToTest","Expected string");var a=d,c=this.$S.$5N.$99(null,e);if(!String.isInstanceOfType(c))throw Error.invalidOperation("Query did not return string");var b=c;if(this.$S.$2RR){a=a.toUpperCase();b=b.toUpperCase()}switch(this.$I1){case 0:return a===b;case 1:return a.indexOf(b)>=0;case 2:return a.startsWith(b);case 3:return a.endsWith(b);case 4:return b.indexOf(a)>=0;case 5:return b.startsWith(a);case 6:return b.endsWith(a);default:throw Error.notImplemented();}},$S:null,$I1:0};NLRT.$hY=function(a){this.$S=a};NLRT.$hY.prototype={$NX:function(a){if(!Boolean.isInstanceOfType(a))throw Error.argument("objToTest","Expected bool value");return a===this.$S.$Bg},$S:null};NLRT.$f5=function(a){this.$S=a};NLRT.$f5.prototype={$NX:function(b,c){if(!Boolean.isInstanceOfType(b))throw Error.argument("objToTest","Expected bool value");var a=this.$S.$5N.$99(null,c);if(!Boolean.isInstanceOfType(a))throw Error.invalidOperation("Query did not return bool");return b===a},$S:null};NLRT.$H6=function(a,b){this.$S=a;this.$I1=b};NLRT.$H6.prototype={$NX:function(d,e){if(!Number.isInstanceOfType(d))throw Error.argument("objToTest","Expected number value");var b=d,a=this.$S.$2SF;if(this.$S.$5N){var c=this.$S.$5N.$99(null,e);if(!Number.isInstanceOfType(c))throw Error.invalidOperation("Query did not return number");a+=c}switch(this.$I1){case 0:return b===a;case 1:return b<a;case 2:return b<=a;case 3:return b>a;case 4:return b>=a;default:throw Error.notImplemented();}},$S:null,$I1:0};NLRT.$OM=function(a,b){this.$S=a;this.$I1=b};NLRT.$OM.prototype={$NX:function(b){if(!Number.isInstanceOfType(b))throw Error.argument("objToTest","Expected integer");var a=b;switch(this.$I1){case 0:return this.$S.$161?!this.$S.$Bg?!a:!!(a&this.$S.$Bg):a===this.$S.$Bg;case 1:return this.$S.$161?(a&this.$S.$Bg)===this.$S.$Bg:a<32&&(1<<a&this.$S.$Bg)===this.$S.$Bg;case 2:return this.$S.$161?!!(a&this.$S.$Bg):a<32&&!!(1<<a&this.$S.$Bg);default:throw Error.notImplemented();}},$S:null,$I1:0};NLRT.$JY=function(a,b){this.$S=a;this.$I1=b};NLRT.$JY.prototype={$NX:function(d,e){if(!Number.isInstanceOfType(d))throw Error.argument("objToTest","Expected integer");var a=d,c=this.$S.$5N.$99(null,e);if(!Number.isInstanceOfType(c))throw Error.invalidOperation("Query did not return an enum value");var b=c;switch(this.$I1){case 0:return a===b;case 1:return 0!==(a&b);case 2:return a===(a&b);case 3:return b===(a&b);default:throw Error.notImplemented();}},$S:null,$I1:0};NLRT.$ZL=function(a){this.$S=a};NLRT.$ZL.prototype={$NX:function(a,c){if(!NLRT.$J7.isInstanceOfType(a))throw Error.argument("objToTest","Expected struct value");var b=a;return this.$S.$1IS.$NX(b.$12d(this.$S.$Y5),c,null)},$S:null};NLRT.$f6=function(a){this.$S=a};NLRT.$f6.prototype={$NX:function(a,e){if(!NLRT.$J7.isInstanceOfType(a))throw Error.argument("objToTest","Expected struct value");var b=a,c=this.$S.$5N.$99(null,e);if(!NLRT.$J7.isInstanceOfType(c))throw Error.invalidOperation("Query did not return struct value");var d=a;return b.$ST(d)},$S:null};NLRT.$Ss=function(a,b){this.$S=a;this.$I1=b};NLRT.$Ss.prototype={$NX:function(f,g){if(!NLRT.$77.isInstanceOfType(f))throw Error.argument("objToTest","Expected list value");var e=f;switch(this.$I1){case 0:for(var c=e.get_$1x(),h=c.length,a=0;a<h;++a){var j=c[a];if(this.$S.$Y6.$NX(j,g,null))return true}return false;case 1:for(var d=e.get_$1x(),i=d.length,b=0;b<i;++b){var k=d[b];if(!this.$S.$Y6.$NX(k,g,null))return false}return true;default:throw Error.notImplemented();}},$S:null,$I1:0};NLRT.$cm=function(a){this.$S=a};NLRT.$cm.prototype={$NX:function(a,c){if(!NLRT.$77.isInstanceOfType(a))throw Error.argument("objToTest","Expected list value");var b=a;return this.$S.$Y6.$NX(b.get_$1x().length,c,null)},$S:null};NLRT.$Ja=function(a,b){this.$S=a;this.$I1=b};NLRT.$Ja.prototype={$NX:function(p,C){if(!NLRT.$77.isInstanceOfType(p))throw Error.argument("objToTest","Expected list value");var a=p,o=this.$S.$5N.$99(null,C);if(!NLRT.$77.isInstanceOfType(o))throw Error.invalidOperation("Query did not return list value");var b=o;if(a.get_$f1()!==b.get_$f1())return false;switch(this.$I1){case 0:return NLRT.$1G.$15f(NLRT.$1G.$58f(a.get_$f1()),a,b);case 1:for(var i=a.get_$1x(),q=i.length,c=0;c<q;++c)for(var w=i[c],j=b.get_$1x(),r=j.length,d=0;d<r;++d){var x=j[d];if(NLRT.$1G.$15f(a.get_$f1(),w,x))return true}return false;case 2:for(var k=a.get_$1x(),s=k.length,e=0;e<s;++e)for(var y=k[e],l=b.get_$1x(),t=l.length,f=0;f<t;++f){var z=l[f];if(!NLRT.$1G.$15f(a.get_$f1(),y,z))return false}return true;case 3:for(var m=b.get_$1x(),u=m.length,g=0;g<u;++g)for(var A=m[g],n=a.get_$1x(),v=n.length,h=0;h<v;++h){var B=n[h];if(!NLRT.$1G.$15f(a.get_$f1(),A,B))return false}return true;default:throw Error.notImplemented();}},$S:null,$I1:0};NLRT.$Qt=function(a){this.$1TT=a};NLRT.$Qt.prototype={$NX:function(a){if(!NLRT.$Dn.isInstanceOfType(a))throw Error.argument("objToTest","Expected feature bundle");var b=a;return!!(this.$1TT^b.get_$2vs())},$1TT:false};NLRT.$PH=function(a,b){this.$S=a;this.$1TT=b};NLRT.$PH.prototype={$NX:function(d){if(!NLRT.$Dn.isInstanceOfType(d))throw Error.argument("objToTest","Expected feature bundle");var e=d,c,a,b;return!!(this.$1TT^(b=e.$8L(Object,this.$S.$Qu,a={val:c}),c=a.val,b))},$S:null,$1TT:false};NLRT.$PG=function(a,b){this.$S=a;this.$2ze=b};NLRT.$PG.prototype={$NX:function(d,f){if(!NLRT.$Dn.isInstanceOfType(d))throw Error.argument("objToTest","Expected feature bundle");var e=d,a,b,c;return!(c=e.$8L(Object,this.$S.$Qu,b={val:a}),a=b.val,c)?this.$2ze:this.$S.$1IS.$NX(a,f,null)},$S:null,$2ze:false};NLRT.$ef=function(a){this.$S=a};NLRT.$ef.prototype={$NX:function(b,d){if(!NLRT.$Dn.isInstanceOfType(b))throw Error.argument("objToTest","Expected feature bundle");var c=b,a=this.$S.$5N.$99(null,new NLRT.$98(this.$S.$16b,c,d));if(!Boolean.isInstanceOfType(a))throw Error.invalidOperation("Query did not return bool");return a},$S:null};NLRT.$i8=function(a){this.$S=a};NLRT.$i8.prototype={$NX:function(s,d,h){if(!NLRT.$Dn.isInstanceOfType(s))throw Error.argument("objToTest","Expected feature bundle");var a=s;if(h==null)throw Error.argumentNull("parentTextForSpan");if(this.$S.$1rW&&!this.$S.$1rW.$NX(a,d,null))return false;if(this.$S.$1YR){var e,i,j;if(j=a.$8L(String,this.$S.$2T9,i={val:e}),e=i.val,j){if(!this.$S.$1YR.$NX(e,d,null))return false}else{var b,c,k,l,m,n;if(!(l=a.$8L(Number,this.$S.$1tU,k={val:b}),b=k.val,l)||!(n=a.$8L(Number,this.$S.$1tT,m={val:c}),c=m.val,n)||b<0||c<0||b+c>h.length)return false;if(!this.$S.$1YR.$NX(h.substr(b,c),d,null))return false}}if(this.$S.$1tX){var f,o,p;if(!(p=a.$8L(Number,this.$S.$1tU,o={val:f}),f=o.val,p)||!this.$S.$1tX.$NX(f,d,null))return false}if(this.$S.$1sl){var g,q,r;if(!(r=a.$8L(Number,this.$S.$1tT,q={val:g}),g=q.val,r)||!this.$S.$1sl.$NX(g,d,null))return false}return true},$S:null};NLRT.$f9=function(a){this.$S=a};NLRT.$f9.prototype={$NX:function(c,b){var a=this.$S.$5N.$99(null,b);if(!Boolean.isInstanceOfType(a))throw Error.invalidOperation("Query did not return bool");return a},$S:null};NLRT.$hd=function(a){this.$S=a};NLRT.$hd.prototype={$NX:function(g,h){if(!NLRT.$r6.$6Aq.isInstanceOfType(g))throw Error.argument("objToTest","Expected WHERE constraint data");var a=g,b=-1,d=-1,e=a.$3BX;switch(this.$S.$1XJ){case 4:b=e.$fr;d=e.$xM;break;case 5:b=a.$x3;d=e.$fr-a.$x3;break;case 6:b=e.$fr+e.$xM;d=a.$x3+a.$1ro-b;break;case 1:case 2:case 3:for(var f=false,c=e.$3BE;c;c=c.$Gi)if(this.$S.$2Ti===c.$KK){f=true;if(this.$S.$1XJ===1){b=c.$fr;d=c.$xM}else if(this.$S.$1XJ===2){b=a.$x3;d=c.$fr-a.$x3}else{b=c.$fr+c.$xM;d=a.$x3+a.$1ro-b}break}if(!f)return false;break;case 7:b=a.$x3;d=a.$1ro;break;default:throw Error.notImplemented();}return null!==this.$S.$2TA.$59M(e.$2TB,b,d,b,true,2,h)},$S:null};NLRT.$ke=function(){};NLRT.$ke.registerInterface("NLRT.$ke");NLRT.$kf=function(){};NLRT.$kf.registerInterface("NLRT.$kf");NLRT.$l9=function(){};NLRT.$l9.registerInterface("NLRT.$l9");NLRT.$ZV=function(b,c){this.$2t=c.get_$Dc();var a=0;try{this.$fo=b.get_$5(a);++a;this.$kH=b.get_$5(a);++a;this.$Nj=b.get_$5(a);++a;this.$PE=b.get_$5(a);++a;this.$pv=b.get_$5(a);++a;this.$1YG=b.get_$5(a);++a;this.$1Hk=b.get_$5(a);++a;this.$1XG=b.get_$5(a);++a;this.$1HW=b.get_$5(a)===1;++a;this.$2Re=b.get_$5(a)===1;++a;this.$2Rf=b.get_$5(a)===1;++a;this.$1HL=c.$5Ay(b.get_$5(a));++a}catch(d){throw Error.argument("initData");}};NLRT.$ZV.prototype={$2t:null,$fo:0,$kH:0,$Nj:0,$PE:0,$pv:0,$1YG:0,$1Hk:0,$1XG:0,$1HW:false,$2Re:false,$2Rf:false,$1HL:null};NLRT.$ZU=function(a){a.$1YG>=0;a.$1Hk>=0;a.$1XG>=0;this.$S=a};NLRT.$ZU.prototype={$46:function(c){var b,d,e;if(!(e=c.$8L(NLRT.$77,this.$S.$fo,d={val:b}),b=d.val,e))throw Error.argument("Expected input parameter NLMod.Tokens not found");var a,f,g;if(!(g=c.$8L(String,this.$S.$kH,f={val:a}),a=f.val,g))a=null;var i=this.$52d(b,a),h=NLRT.$1G.$Q4(c);h.$Bc(this.$S.$fo,i);return h},$52d:function(d,t){var b=null,u=this.$S.$1HL.get_$39H(),f=new NLRT.$ZU.$65f(this,d,t),q=null;if(this.$S.$1HL.$5LH()){var e=this.$S.$1HL;q=e.$$d_$53v||(e.$$d_$53v=Function.createDelegate(e,e.$53v))}var a=0,c,g,h;while(a<d.get_$1x().length){var r=d.get_$1x()[a];f.$5pk(a);u.$43F(f,q);var l,m,n;f.$58k(l={val:c},m={val:g},n={val:h}),c=l.val,g=m.val,h=n.val;if(c>0){var i,o,p;p=this.$S.$1HL.$52x(g,o={val:i}),i=o.val,p;var k=this.$4eq(d,a,c,i).$$ge();while(k.$$mn()){var s=k.$$cu();c>1&&this.$S.$1HW&&this.$4fm(d,t,a,r,c,h,s);if(!b){b=new NLRT.$4s(this.$S.$2t,9);for(var j=0;j<a;++j)Array.add(b.get_$1x(),d.get_$1x()[j])}Array.add(b.get_$1x(),s)}a+=c}else{b&&Array.add(b.get_$1x(),r);++a}}return b||d},$4fm:function(p,h,q,J,r,K,c){var a;if(K)a=true;else if(this.$S.$2Re){a=false;for(var b=-1,e=0;e<r;e++){var H=p.get_$1x()[q+e],f,k,t,u,v,w;if(!(u=H.$8L(Number,this.$S.$Nj,t={val:f}),f=t.val,u)||!(w=H.$8L(Number,this.$S.$PE,v={val:k}),k=v.val,w))throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(e>0){if(f>b+1){a=true;break}if(b<0||null===h||b>=h.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(h.charAt(b)!==" "){a=true;break}}b=f+k}}else a=false;if(a){for(var l=new Sys.StringBuilder,g=0;g<r;++g){var m,n,o,I,x,y,z,A;this.$3bc(p.get_$1x()[q+g],h,x={val:m},y={val:n},z={val:o},A={val:I}),m=x.val,n=y.val,o=z.val,I=A.val;g>0&&l.append(" ");l.append(m.substr(n,o))}c.$Bc(this.$S.$pv,l.toString())}var G=p.get_$1x()[q+r-1],d,i,j,B,C,D,E,F,s;if((C=J.$8L(Number,this.$S.$Nj,B={val:d}),d=B.val,C)&&(E=G.$8L(Number,this.$S.$Nj,D={val:i}),i=D.val,E)&&(s=G.$8L(Number,this.$S.$PE,F={val:j}),j=F.val,s)){c.$Bc(this.$S.$Nj,d);c.$Bc(this.$S.$PE,i+j-d)}else{c.$2Kp(this.$S.$Nj);c.$2Kp(this.$S.$PE)}},$4eq:function(a,b,c,d){return new NLRT.$ZU.$3Bn(this,a,b,c,d)},$3bc:function(d,e,a,b,c,f){if(d.$8L(String,this.$S.$pv,a)){f.val=true;b.val=0;c.val=a.val.length}else{f.val=false;if(null===e)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");a.val=e;if(!d.$8L(Number,this.$S.$Nj,b))throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!d.$8L(Number,this.$S.$PE,c))throw Error.argument("Token missing required Span.Length annotation","token");if(b.val<0||c.val<0||b.val+c.val>a.val.length)throw Error.argument("Token start/length values out of range","token");}},$S:null};NLRT.$ZU.$65f=function(a,b,c){this.$1TW=a;this.$1nC=b;this.$2zz=c};NLRT.$ZU.$65f.prototype={$59J:function(b){if(null===this.$13p){var a,c,d,e,f;this.$1TW.$3bc(this.$1nC.get_$1x()[this.$1TU],this.$2zz,c={val:this.$13p},d={val:this.$1n2},e={val:this.$1TP},f={val:a}),this.$13p=c.val,this.$1n2=d.val,this.$1TP=e.val,a=f.val;this.$1n3=!!(this.$1n3|a)}if(this.$1Ei<this.$1TP){b.val=this.$13p.charAt(this.$1n2+this.$1Ei);++this.$1Ei;return true}else if(this.$1TU===this.$1nC.get_$1x().length-1){b.val="\0";return false}else{++this.$1TU;this.$1Ei=0;this.$13p=null;b.val=" ";return true}},$3qW:function(b,a){if(this.$1Ei===this.$1TP&&this.$13p){this.$2Hz=a;this.$2Hj=this.$1TU-this.$2zn+1}},$5pk:function(a){if(a<0||a>=this.$1nC.get_$1x().length)throw Error.argumentOutOfRange("iToken");this.$2zn=a;this.$1TU=a;this.$13p=null;this.$1n2=0;this.$1TP=0;this.$1Ei=0;this.$2Hj=0;this.$2Hz=-1;this.$1n3=false},$58k:function(a,b,c){a.val=this.$2Hj;b.val=this.$2Hz;c.val=this.$1n3},$1TW:null,$1nC:null,$2zz:null,$2zn:0,$1TU:0,$13p:null,$1n2:0,$1TP:0,$1Ei:0,$2Hj:0,$2Hz:0,$1n3:false};NLRT.$ZU.$3Bn=function(e,a,b,c,d){this.dispose=this.$d;this.$$ge=this.$3f;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.$9Q=e;this.$2PM=a;this.$2PG=a;this.$2PI=b;this.$2PE=b;this.$2PH=c;this.$1H1=c;this.$2PJ=d;this.$1H2=d};NLRT.$ZU.$3Bn.prototype={$1H1:0,$2PE:0,$1H2:null,$2PG:null,$2PH:0,$2PI:0,$2PJ:null,$2PM:null,$9Q:null,$1Yg:0,$2Tw:null,$xT:0,$2Tx:null,$1Yi:0,$1IZ:null,$YK:null,$xU:null,$1tz:null,$2U0:0,$7H:null,$EE:null,$1Q:-1,$16c:function(){this.$1Yi=0;return this.$bx},$bx:function(){if(!(this.$1Yi<this.$1H1))return this.$16d;this.$1IZ=this.$2PG.get_$1x()[this.$1Yi+this.$2PE];this.$YK=new NLRT.$6P(this.$9Q.$S.$2t);(this.$1H1===1||!this.$9Q.$S.$1HW)&&this.$YK.$tF(this.$1IZ);if(this.$9Q.$S.$1Hk>=0){var a,b;if(b=this.$YK.$8L(NLRT.$4s,this.$9Q.$S.$1Hk,a={val:this.$xU}),this.$xU=a.val,b)this.$xU=this.$xU.$Q4();else this.$xU=new NLRT.$4s(this.$9Q.$S.$2t,9);this.$1tz=this.$1H2.get_$1x();this.$2U0=this.$1tz.length;this.$1Yg=0;for(;this.$1Yg<this.$2U0;++this.$1Yg){this.$2Tw=this.$1tz[this.$1Yg];Array.add(this.$xU.$fv,this.$2Tw)}this.$YK.$Bc(this.$9Q.$S.$1Hk,this.$xU)}else if(this.$9Q.$S.$1YG>=0)this.$YK.$Bc(this.$9Q.$S.$1YG,this.$1H2.get_$1x()[0]);else if(this.$9Q.$S.$1XG>=0)this.$YK.$Bc(this.$9Q.$S.$1XG,true);else if(this.$9Q.$S.$2Rf){var i=this;this.$1H2.get_$1x()[0].$2Au(function(a,b){return i.$YK.$Bc(a,b)})}else{this.$YK.$tF(this.$1H2.get_$1x()[0]);if(this.$1H1===1||!this.$9Q.$S.$1HW){var c,d;(d=this.$1IZ.$8L(Number,this.$9Q.$S.$Nj,c={val:this.$xT}),this.$xT=c.val,d)&&this.$YK.$Bc(this.$9Q.$S.$Nj,this.$xT);var e,f;(f=this.$1IZ.$8L(Number,this.$9Q.$S.$PE,e={val:this.$xT}),this.$xT=e.val,f)&&this.$YK.$Bc(this.$9Q.$S.$PE,this.$xT);var g,h;(h=this.$1IZ.$8L(String,this.$9Q.$S.$pv,g={val:this.$2Tx}),this.$2Tx=g.val,h)&&this.$YK.$Bc(this.$9Q.$S.$pv,this.$xT)}}this.$7H=this.$YK;this.$1Q=2;return this.$2Tq},$16d:function(){this.$1Q=3},$1IW:function(){this.$1Yi++;return this.$bx},$2Tq:function(){return this.$1H1>1&&this.$9Q.$S.$1HW?this.$16d:this.$1IW},$d:function(){},$3f:function(){if(this.$1Q===-1){this.$1Q=0;return this}return new NLRT.$ZU.$3Bn(this.$9Q,this.$2PM,this.$2PI,this.$2PH,this.$2PJ).$3f()},moveNext:function(){if(this.$1Q===3)return false;if(!this.$1Q){this.$1Q=1;this.$EE=this.$16c()}else this.$1Q=1;while(this.$1Q===1)this.$EE=this.$EE();return this.$1Q!==3},reset:function(){throw Error.invalidOperation("Reset() is not supported");},get_current:function(){return this.$7H}};NLRT.$dQ=function(b,e){if(!b)return;this.$2t=e.get_$Dc();var a=0;try{this.$1HY=b.get_$5(a)===1;++a;this.$2Ri=b.get_$5(a)===1;++a;this.$kW=b.get_$5(a)===1;++a;this.$wm=b.get_$5(a);++a;this.$wn=b.get_$5(a);++a;this.$wo=b.get_$5(a);++a;this.$kH=b.get_$5(a);++a;this.$fo=b.get_$5(a);++a;this.$Nj=b.get_$5(a);++a;this.$PE=b.get_$5(a);++a;this.$pv=b.get_$5(a);++a;this.$1YW=this.$5ex(e.$12X(b.get_$5(a)));++a;this.$1t7=b.get_$5(a);++a;this.$1t6=b.get_$5(a);++a;var f=b.get_$5(a);++a;this.$1tm=new Array(f);for(var c=0;c<f;++c){var h=b.get_$5(a);++a;var l=this.$1YW.get_$39H(),i=new(NLRT.$95.$$(Number));i.$11p(b,a,h);this.$1tm[c]=this.$5ey(i,e,l);a+=h}var g=b.get_$5(a);++a;this.$1XW=new Array(g);for(var d=0;d<g;++d){var j=b.get_$5(a);++a;var k=new(NLRT.$95.$$(Number));k.$11p(b,a,j);this.$1XW[d]=this.$5ep(k);a+=j}}catch(m){throw Error.argument("initData");}};NLRT.$dQ.prototype={$2t:null,$1HY:false,$2Ri:false,$kW:false,$wm:0,$wn:0,$wo:0,$kH:0,$fo:0,$Nj:0,$PE:0,$pv:0,$1YW:null,$1t7:0,$1t6:0,$1tm:null,$1XW:null,$5ex:function(a){return new NLRT.$OP(new NLRT.$OQ(a))},$5ey:function(a,b,c){return NLRT.$Bs.$x(a,b,c)},$5ep:function(a){return new NLRT.$GU(a)}};NLRT.$dP=function(e){this.$S=e;this.$1n9=0;this.$1n8=0;this.$1TV=0;for(var c=this.$S.$1XW,d=c.length,a=0;a<d;++a){var b=c[a];this.$1n9=Math.max(this.$1n9,b.get_$3oY());this.$1n8=Math.max(this.$1n8,b.get_$3oS());this.$1TV=Math.max(this.$1TV,b.get_$2N7().length)}};NLRT.$dP.prototype={get_$4sH:function(){return this.$S.$1YW.get_$39H()},$46:function(m){if(!m)throw Error.argumentNull("input");var a,f,r,s;this.$5DU(m,r={val:a},s={val:f}),a=r.val,f=s.val;var d=null,b=null,g={};if(this.$S.$1HY){a=NLRT.$1G.$Q4(a);for(var i=0;i<a.get_$1x().length;++i)a.get_$1x()[i]=NLRT.$1G.$Q4(a.get_$1x()[i])}else{var t,u;d=(u=this.$3Zx(m,g,t={val:b}),b=t.val,u)}for(var z=new Array(this.$1TV),o=new Array(this.$1TV),p=0;p<o.length;++p)o[p]=new NLRT.$dP.$4rj;for(var c=-this.$1n9;c<a.get_$1x().length+this.$1n8;++c){var j=null;if(this.$S.$1HY){j=a.get_$1x()[c];g={};var v,w;d=(w=this.$3Zx(j,g,v={val:b}),b=v.val,w)}for(var q=this.$S.$1XW,B=q.length,n=0;n<B;++n){var e=q[n];if(c<0&&-c>e.get_$3oY()||c>=a.get_$1x().length&&c-a.get_$1x().length+1>e.get_$3oS())continue;for(var A=true,k=0;k<e.get_$2N7().length;++k){var l=c+e.get_$2N7()[k];z[k]=l;if(l<0?this.$S.$1t7<0:l>=a.get_$1x().length?this.$S.$1t6<0:!f.$xR[l]){A=false;break}}if(!A)continue;var x,y;this.$5K3(e,f,x={val:d},y={val:b},g,o,z),d=x.val,b=y.val}if(this.$S.$1HY){j.$Bc(this.$S.$kW?this.$S.$wn:this.$S.$wm,d);this.$S.$kW&&j.$Bc(this.$S.$wo,b)}}var h=NLRT.$1G.$Q4(m);if(this.$S.$1HY)h.$Bc(this.$S.$fo,a);else{h.$Bc(this.$S.$kW?this.$S.$wn:this.$S.$wm,d);this.$S.$kW&&h.$Bc(this.$S.$wo,b)}return h},$5DU:function(e,f,b){if(!e||!e.$8L(NLRT.$77,this.$S.$fo,f))throw Error.argument("Expected input parameter NLMod.Tokens not found");var d,j,k;if(!(k=e.$8L(String,this.$S.$kH,j={val:d}),d=j.val,k))d="";b.val=new NLRT.$iO(f.val.get_$1x().length);for(var r=this,q=NLRT.$2l.$6Ap(NLRT.$cN,this.$S.$1tm,function(a){return!a.get_$3e5()||a.get_$3e5().$NX(e,null,null)}),a=0;a<f.val.get_$1x().length;++a){var n=f.val.get_$1x()[a],o=null;b.val.$1YV[a]=b.val.$1YK.length;b.val.$xR[a]=0;for(var h=0,i=q,p=i.length,g=0;g<p;++g){var c=i[g];if(c.get_$3iH()>0&&b.val.$xR[a]+h>=c.get_$3iH())continue;if(c.get_$40E()&&!c.get_$40E().$NX(n,null,null))continue;var l,m;c.$3GB(this,n,a,b.val,d,l={val:o},m={val:h}),o=l.val,h=m.val}}},$5K3:function(l,e,j,f,s,b,u){var a=0;b[0].$1SK=-1;b[0].$2Ab=l.get_$5qs();while(true){var d=u[a],t=d<0||d>=e.$xR.length?1:e.$xR[d],q=false;while(b[a].$1SK<t-1){++b[a].$1SK;var g,h;if(d<0){g=this.$S.$1t7;h=1}else if(d>=e.$1YV.length){g=this.$S.$1t6;h=1}else{var r=e.$1YV[d]+b[a].$1SK;g=e.$1YK[r];h=e.$1tb[r]}b[a].$1VS=h*(!a?l.get_$5s1():b[a-1].$1VS);var i,m,n;if(n=NLRT.$2c.$9F(Object,b[a].$2Ab,g.toString(),m={val:i}),i=m.val,n){if(a===l.get_$2N7().length-1){var k=i;if(b[a].$1VS){var c,o,p;if(!(p=NLRT.$2c.$9F(Number,s,k.toString(),o={val:c}),c=o.val,p))c=-1;if(c<0){j.val=NLRT.$1G.$Q4(j.val);Array.add(j.val.get_$1x(),k)}if(this.$S.$kW){f.val=NLRT.$1G.$Q4(f.val);if(c<0)Array.add(f.val.get_$1x(),b[a].$1VS);else f.val.get_$1x()[c]=f.val.get_$1x()[c]+b[a].$1VS}if(c<0&&(this.$S.$2Ri||this.$S.$kW))s[k.toString()]=j.val.get_$1x().length-1}}else{++a;b[a].$1SK=-1;b[a].$2Ab=i}q=true;break}}if(!q){--a;if(a<0)break}}},$3Zx:function(d,g,c){var a,e,f;if(f=d.$8L(NLRT.$77,this.$S.$kW?this.$S.$wn:this.$S.$wm,e={val:a}),a=e.val,f)for(var b=0;b<a.get_$1x().length;++b)g[a.get_$1x()[b].toString()]=b;else a=new NLRT.$4s(this.$S.$2t,3);if(this.$S.$kW){if(!d.$8L(NLRT.$77,this.$S.$wo,c))c.val=new NLRT.$4s(this.$S.$2t,5);if(c.val.get_$1x().length!==a.get_$1x().length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.$S.$2t.$bL(9,d));}else c.val=null;return a},get_$65A:function(){return this.$S.$1YW},$3bb:function(l,e){var c,d,f,g;if(g=e.$8L(String,this.$S.$pv,f={val:d}),d=f.val,g)c=d;else{var a,h,i;if(!(i=e.$8L(Number,this.$S.$Nj,h={val:a}),a=h.val,i))throw Error.argument("Token is missing Span.StartIndex");var b,j,k;if(!(k=e.$8L(Number,this.$S.$PE,j={val:b}),b=j.val,k))throw Error.argument("Token is missing Span.Length");if(a<0||b<0||a+b>l.length)throw Error.argument("Token indices are out of range");c=l.substr(a,b)}return c},$S:null,$1n9:0,$1n8:0,$1TV:0};NLRT.$dP.$4rj=function(){};NLRT.$dP.$4rj.prototype={$1SK:0,$2Ab:null,$1VS:0};NLRT.$dR=function(){};NLRT.$dR.prototype={$59Y:function(c,b){var d=c.get_$5(0),a=new(NLRT.$95.$$(Number));a.$11p(c,1,c.get_$14()-1);switch(d){case 0:return new NLRT.$g3(new NLRT.$g4(a,b));case 2:return new NLRT.$iM(new NLRT.$iN(a,b));case 3:return new NLRT.$dP(new NLRT.$dQ(a,b));case 5:return new NLRT.$ZU(new NLRT.$ZV(a,b));case 9:return new NLRT.$Ec(new NLRT.$iT(a,b));case 10:return new NLRT.$iA(new NLRT.$iB(a,b));default:throw Error.notImplemented();}}};NLRT.$iB=function(b,c){this.$2t=c.get_$Dc();var a=0;this.$2Pl=b.get_$5(a);++a;this.$wm=b.get_$5(a);++a;this.$2Pm=b.get_$5(a);++a;this.$2Pn=b.get_$5(a);++a;this.$wn=b.get_$5(a);++a;this.$wo=b.get_$5(a);++a;this.$2Ph=b.get_$5(a);++a;this.$2Pi=b.get_$5(a);++a;this.$2Pj=b.get_$5(a);++a;this.$2Pk=b.get_$5(a);++a;var e=b.get_$5(a);++a;for(var f=new Array(e),d=0;d<e;++d){f[d]=c.$CH(b.get_$5(a));++a}this.$2Q7=NLRT.$95.$$(String).$2nL(f);this.$2Rw=b.get_$5(a);++a;this.$2Si=b.get_$5(a);++a;var h=b.get_$5(a);++a;this.$1s4={};for(var g=0;g<h;++g){var k=c.$CH(b.get_$5(a));++a;var l=b.get_$5(a);++a;this.$1s4[k]=l}this.$1Xz=b.get_$5(a);++a;this.$2S2=b.get_$5(a);++a;var i=b.get_$5(a);++a;if(i>0){var m=c.$12X(b.get_$5(a));++a;this.$1sy=this.$2Jx(new NLRT.$Kg(m))}++a;var j=c.$12X(b.get_$5(a));++a;this.$5er(j)};NLRT.$iB.prototype={$2t:null,$2Pl:0,$wm:0,$2Pm:0,$2Pn:0,$wn:0,$wo:0,$2Ph:0,$2Pi:0,$2Pj:0,$2Pk:0,$2Q7:null,$2Rw:0,$2Si:0,$1s4:null,$1Xz:0,$2S2:0,$1sy:null,$2SI:0,$1Xh:null,$2RL:null,$2RM:null,$2SH:0,$2Q8:null,$2Q9:null,$2Jx:function(a){return new NLRT.$Kq(a.$HP,a.$Er)},$5er:function(e){try{var a=new NLRT.$Kg(e);this.$2SI=a.$Sk();if(a.$Sk()===1)this.$1Xh=NLRT.$95.$$(Number).$2nL(NLRT.$8v.$3ZJ(a,this.$2SI));else this.$1Xh=null;var b=a.$Sk();this.$2RL=this.$2Jx(a);a.$Er+=b;var c=a.$Sk();this.$2RM=this.$2Jx(a);a.$Er+=c;this.$2SH=a.$Sk();var d=a.$Sk();this.$2Q8=this.$2Jx(a);a.$Er+=d;this.$2Q9=NLRT.$95.$$(Number).$2nL(NLRT.$8v.$3ZJ(a,this.$2SH))}catch(f){throw Error.argument("byteReader");}}};NLRT.$iA=function(a){this.$S=a};NLRT.$iA.prototype={$46:function(i){if(!i)throw Error.argumentNull("input");var a=[],f=[];this.$4PI(i,a,f);this.$4Fu(a,f);for(var g={},b=0;b<a.length;++b)for(var p=a[b],q=this.$S.$2RL.get_$5(p),u=this.$S.$2RM.get_$5(p),c=0;c<u;++c){var r=this.$S.$2Q7.get_$5(this.$S.$2Q8.get_$5(q+c)),v=this.$S.$2Q9.get_$5(q+c),d,k,l;if(!(l=NLRT.$2c.$9F(Number,g,r,k={val:d}),d=k.val,l))d=0;g[r]=d+f[b]*v}var m=NLRT.$2c.$587(g),w=this;m.sort(function(d,e){var b=d,c=e,a=-NLRT.$1N.$4Ph(b.$Q,c.$Q);if(!a)a=b.$Ao.localeCompare(c.$Ao);return a});for(var n=new NLRT.$4s(this.$S.$2t,9),j=NLRT.$2l.$640(NLRT.$JA.$$(String,Number),m,this.$S.$2Rw),t=j.length,e=0;e<t;++e){var s=j[e],h=new NLRT.$6P(this.$S.$2t);h.$Bc(this.$S.$2Pj,s.$Ao);h.$Bc(this.$S.$2Pk,s.$Q);Array.add(n.get_$1x(),h)}var o=i;o.$Bc(this.$S.$2Pi,n);return o},$4PI:function(u,e,f){var b,g,h;if(h=u.$8L(NLRT.$Dn,this.$S.$2Ph,g={val:b}),b=g.val,h){var a,i,j;if(j=b.$8L(NLRT.$77,this.$S.$wn,i={val:a}),a=i.val,j){var c,k,l;if(!(l=b.$8L(NLRT.$77,this.$S.$wo,k={val:c}),c=k.val,l)||a.get_$1x().length!==c.get_$1x().length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.$28L(a,c,e,f)}var m,n;if(n=b.$8L(NLRT.$77,this.$S.$2Pm,m={val:a}),a=m.val,n){var d,o,p;if(!(p=b.$8L(NLRT.$77,this.$S.$2Pn,o={val:d}),d=o.val,p)||a.get_$1x().length!==d.get_$1x().length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.$28L(a,d,e,f)}var q,r;(r=b.$8L(NLRT.$77,this.$S.$wm,q={val:a}),a=q.val,r)&&this.$28L(a,null,e,f);var s,t;(t=b.$8L(NLRT.$77,this.$S.$2Pl,s={val:a}),a=s.val,t)&&this.$28L(a,null,e,f)}},$28L:function(e,h,j,k){for(var b=0;b<e.get_$1x().length;++b){var a;if(e.get_$f1()===1){var i=e.get_$1x()[b],f,g;if(!(g=NLRT.$2c.$9F(Number,this.$S.$1s4,i,f={val:a}),a=f.val,g))a=-1}else{var c=e.get_$1x()[b];if(c>=this.$S.$1Xz&&c<=this.$S.$2S2)if(!this.$S.$1sy)a=c-this.$S.$1Xz;else a=this.$S.$1sy.get_$5(c-this.$S.$1Xz)-1;else a=-1}if(a>=0){var d;if(!h)d=1;else d=h.get_$1x()[b];if(d>0){Array.add(j,a);Array.add(k,d)}}}},$4Fu:function(g,a){if(!g.length)return;switch(this.$S.$2Si){case 0:break;case 1:for(var b=0;b<a.length;++b)a[b]=1+Math.log(a[b]);break;case 2:for(var h=NLRT.$1N.$f0(a),c=0;c<a.length;++c)a[c]=.5+.5*(a[c]/h);break;case 3:for(var e=0;e<a.length;++e)a[e]=1;break;default:throw Error.notImplemented();}if(this.$S.$1Xh)for(var d=0;d<a.length;++d)a[d]*=this.$S.$1Xh.get_$5(g[d]);for(var i=NLRT.$1N.$5Vc(a),f=0;f<a.length;++f)a[f]/=i},$S:null};NLRT.$g4=function(a,b){if(!a)return;this.$bs=b.$1D9(a.get_$5(0))};NLRT.$g4.prototype={$bs:null};NLRT.$g3=function(a){this.$S=a};NLRT.$g3.prototype={$46:function(b){if(!b)throw Error.argumentNull("input");var a=b.$3l();this.$S.$bs.$46(a,null);return a},$S:null};NLRT.$iN=function(b,c){if(!b)return;this.$2t=c.get_$Dc();var a=0;try{this.$kH=b.get_$5(a);++a;this.$fo=b.get_$5(a);++a;this.$1ra=b.get_$5(a);++a;this.$Nj=b.get_$5(a);++a;this.$PE=b.get_$5(a);++a;this.$2Rh=b.get_$5(a)===1;++a;var f=b.get_$5(a);++a;if(f>0)this.$1sG=c.$2uF(f).get_$4sH();this.$2R6=!b.get_$5(a)?"":c.$CH(b.get_$5(a));++a;var e=b.get_$5(a);++a;this.$1YB=new Array(e);this.$1tL=new Array(e);for(var d=0;d<e;++d){this.$1YB[d]=new RegExp(c.$CH(b.get_$5(a)));++a;this.$1tL[d]=c.$CH(b.get_$5(a));++a}}catch(g){throw Error.argument("initData");}};NLRT.$iN.prototype={$2t:null,$kH:0,$fo:0,$1ra:0,$Nj:0,$PE:0,$2Rh:false,$1sG:null,$2R6:null,$1YB:null,$1tL:null};NLRT.$iM=function(a){this.$S=a};NLRT.$iM.prototype={$46:function(d){if(!d)throw Error.argumentNull("input");var b,e,f;if(!(f=d.$8L(String,this.$S.$kH,e={val:b}),b=e.val,f))throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");var a,g,h;if(!(h=d.$8L(Number,this.$S.$Nj,g={val:a}),a=g.val,h))a=0;var c,i,j;if(!(j=d.$8L(Number,this.$S.$PE,i={val:c}),c=i.val,j))c=b.length-a;if(a<0||a>b.length)throw Error.argument("input","Start index out of range");if(c<0||c>b.length)throw Error.argument("input","Length out of range");if(a+c>b.length)throw Error.argument("input","Bad start-length range");var k=new NLRT.$iM.$659(b,a,a+c,new NLRT.$4s(this.$S.$2t,9));this.$658(k);var l=d.get_$1EL()?d.$3l():d;l.$Bc(this.$S.$fo,k.$1qi);return l},$658:function(a){while(a.$do<a.$2Ak){if(this.$S.$1sG){var b=this.$S.$1sG.$3i1(a.$1oO,a.$do,a.$2Ak-a.$do,null);if(!b.$V7&&b.$2Ih)b=b.$2Ih;if(b.$V7){this.$3lj(a,b.$N,this.$S.$2R6);a.$do+=b.$N;continue}}for(var h=a.$1oO.substr(a.$do),d=-1,g=-1,f=-1,e=0;e<this.$S.$1YB.length;++e){var c=this.$S.$1YB[e].exec(h);if(c&&c[1].length>0)if(d<0||c[0].length>g){d=e;g=c[0].length;f=c[1].length}}if(d>=0){this.$3lj(a,f,this.$S.$1tL[d]);a.$do+=f}else a.$do+=1}},$3lj:function(a,e,d){if(!this.$S.$2Rh){var c=new NLRT.$6P(this.$S.$2t);c.$Bc(this.$S.$Nj,a.$do);c.$Bc(this.$S.$PE,e);c.$Bc(this.$S.$1ra,d);Array.add(a.$1qi.get_$1x(),c)}else{if(d==="GAP")return;if(a.$14o<0)a.$14o=a.$do;a.$1VX=a.$do+e-a.$14o;if(d==="EOS_CHUNK"){if(a.$14o>=0&&a.$1VX>0){var b=new NLRT.$6P(this.$S.$2t);b.$Bc(this.$S.$Nj,a.$14o);b.$Bc(this.$S.$PE,a.$1VX);b.$Bc(this.$S.$1ra,"SENTENCE");b.$Bc(this.$S.$kH,a.$1oO);Array.add(a.$1qi.get_$1x(),b)}a.$14o=-1;a.$1VX=0}}},$S:null};NLRT.$iM.$659=function(a,b,c,d){this.$1oO=a;this.$2Ak=c;this.$1qi=d;this.$do=b;this.$14o=-1;this.$1VX=0};NLRT.$iM.$659.prototype={$1oO:null,$2Ak:0,$1qi:null,$do:0,$14o:0,$1VX:0};NLRT.$iT=function(b,g){if(!b)return;this.$2t=g.get_$Dc();var a=0;try{this.$2Po=b.get_$5(a);++a;this.$2Pp=b.get_$5(a);++a;var d=b.get_$5(a);++a;this.$1tW=new Array(d);for(var c=0;c<d;++c){var h=b.get_$5(a);++a;var e=b.get_$5(a);++a;var f=new(NLRT.$95.$$(Number));f.$11p(b,a,e);a+=e;this.$1tW[c]=this.$5ew(h,f,g)}}catch(i){throw Error.argument("initData");}};NLRT.$iT.prototype={$2t:null,$2Po:0,$2Pp:0,$1tW:null,$5ew:function(c,a,b){switch(c){case 0:return new NLRT.$Kh(a);case 1:return new NLRT.$fI(a,b);case 2:return new NLRT.$gx(a,b);case 4:return new NLRT.$N3;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}};NLRT.$Kh=function(a){if(!a)return;this.$YH=a.get_$5(0)};NLRT.$Kh.$4NE=function(a,b){switch(b){case 0:return a.toLowerCase();case 1:return a==="I"?"\u0131":a.toLowerCase();case 2:return a.toUpperCase();case 3:return a==="i"?"\u0130":a.toUpperCase();default:throw Error.invalidOperation();}};NLRT.$Kh.prototype={$YH:0,$3GB:function(b){var a=this;return NLRT.$Ec.$2k6(b,function(b){return NLRT.$Kh.$4NE(b,a.$YH)})}};NLRT.$fI=function(a,b){if(!a)return;this.$1Hu=b.$2E7(a.get_$5(0));this.$2Sl=b.$CH(a.get_$5(1))};NLRT.$fI.prototype={$1Hu:null,$2Sl:null,$3GB:function(a){return a.replace(this.$1Hu,this.$2Sl)}};NLRT.$gx=function(a,c){if(!a)return;var f=a.get_$5(0),d=c.$CH(a.get_$5(1)),g=new NLRT.$Kq(c.$12X(a.get_$5(2)),0),e=a.get_$5(3)<0?null:new NLRT.$Kq(c.$12X(a.get_$5(3)),0);this.$1YL={};for(var b=0;b<f;++b)this.$1YL[d.charAt(b).toString()]=d.substr(g.get_$5(b),!e?1:e.get_$5(b))};NLRT.$gx.prototype={$1YL:null,$3GB:function(b){var a=this;return NLRT.$Ec.$2k6(b,function(b){return b in a.$1YL?a.$1YL[b]:b})}};NLRT.$N3=function(){};NLRT.$N3.$65b=function(b){var a=b.charCodeAt(0);return a>=65281&&a<=65374?String.fromCharCode(a-65248):b};NLRT.$N3.prototype={$3GB:function(a){return NLRT.$Ec.$2k6(a,NLRT.$N3.$65b)}};NLRT.$Ec=function(a){this.$S=a};NLRT.$Ec.$2k6=function(c,d){for(var b=new Sys.StringBuilder,a=0;a<c.length;++a)b.append(d(c.substr(a,1)));return b.toString()};NLRT.$Ec.prototype={$46:function(c){if(!c)throw Error.argumentNull("input");var a,e,f;if(!(f=c.$8L(String,this.$S.$2Po,e={val:a}),a=e.val,f))throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(var d=this.$S.$1tW,h=d.length,b=0;b<h;++b){var i=d[b];a=i.$3GB(a)}var g=NLRT.$1G.$Q4(c);g.$Bc(this.$S.$2Pp,a);return g},$S:null};NLRT.$lE=function(){};NLRT.$lE.registerInterface("NLRT.$lE");NLRT.$lF=function(){};NLRT.$lF.registerInterface("NLRT.$lF");NLRT.$cN=function(){};NLRT.$cN.registerInterface("NLRT.$cN");NLRT.$GU=function(b){if(!b)return;var a=0;try{if(b.get_$5(a)!==240803228)throw Error.argument("initData","Input does not represent a feature template");++a;var f=b.get_$5(a);++a;this.$1tS=new Array(f);for(var c=0;c<f;++c){this.$1tS[c]=b.get_$5(a);++a}this.$2Sc=b.get_$5(a);++a;this.$2Sa=b.get_$5(a);++a;this.$xJ=b.get_$5(a);++a;var d,e;this.$2Sw=(e=NLRT.$GU.$3pn(b,d={val:a}),a=d.val,e)}catch(g){throw Error.argument("initData");}};NLRT.$GU.$3pn=function(b,a){var f=b.get_$5(a.val);++a.val;for(var c={},d=0;d<f;++d){var e=b.get_$5(a.val);++a.val;if(!b.get_$5(a.val)){++a.val;c[e.toString()]=b.get_$5(a.val);++a.val}else c[e.toString()]=NLRT.$GU.$3pn(b,a)}return c};NLRT.$GU.prototype={$1tS:null,get_$2N7:function(){return this.$1tS},$2Sc:0,get_$3oY:function(){return this.$2Sc},$2Sa:0,get_$3oS:function(){return this.$2Sa},$xJ:0,get_$5s1:function(){return this.$xJ},$2Sw:null,get_$5qs:function(){return this.$2Sw}};NLRT.$rV=function(){};NLRT.$rV.prototype={$2RG:null,$2TW:null,$2Rx:0,$xJ:0,$1sq:0,$329:function(b,a,c){this.$xJ=b.get_$5(a.val);++a.val;this.$2RG=!b.get_$5(a.val)?null:c.$eN(b.get_$5(a.val));++a.val;this.$2TW=!b.get_$5(a.val)?null:c.$eN(b.get_$5(a.val));++a.val;this.$2Rx=b.get_$5(a.val);++a.val;this.$1sq=b.get_$5(a.val);++a.val}};NLRT.$Bs=function(a){this.$1mz=a};NLRT.$Bs.$x=function(c,d,f){var a=0;try{if(c.get_$5(a)!==1099767983)throw Error.argument("initData","Input does not represent a token string generator");++a;var e=c.get_$5(a);++a;var b=new(NLRT.$95.$$(Number));b.$11p(c,a,c.get_$14()-a);switch(e){case 0:return new NLRT.$hh(new NLRT.$hi(b,d));case 1:return new NLRT.$f7(new NLRT.$f8(b,d));case 2:return new NLRT.$Zz(new NLRT.$a0(b,d,f));default:throw Error.argument("initData");}}catch(g){throw Error.argument("initData");}};NLRT.$Bs.$3FP=function(b,c,d,e,f,g){var a=b.get_$65A().$57S(c,null);if(a<0){++g.val;return}NLRT.$Bs.$3FQ(a,d,e,f)};NLRT.$Bs.$3FQ=function(b,c,d,a){Array.add(a.$1YK,b);Array.add(a.$1tb,c);++a.$xR[d]};NLRT.$Bs.prototype={get_$3e5:function(){return this.$1mz.$2RG},get_$40E:function(){return this.$1mz.$2TW},get_$3iH:function(){return this.$1mz.$2Rx},$1mz:null};NLRT.$hi=function(c,d){NLRT.$hi.initializeBase(this);if(!c)return;var b=0;try{var a;this.$329(c,a={val:b},d),b=a.val}catch(e){throw Error.argument("initData");}};NLRT.$hh=function(a){NLRT.$hh.initializeBase(this,[a]);this.$S=a};NLRT.$hh.prototype={$3GB:function(b,c,d,e,f,a,g){if(a.val==null)a.val=b.$3bb(f,c);NLRT.$Bs.$3FP(b,a.val,this.$S.$xJ,d,e,g)},$S:null};NLRT.$f8=function(b,c){NLRT.$f8.initializeBase(this);if(!b)return;this.$2t=c.get_$Dc();var a=0;try{var d;this.$329(b,d={val:a},c),a=d.val;this.$KK=c.$CH(b.get_$5(a));++a;this.$5N=c.$Hw(b.get_$5(a));++a}catch(e){throw Error.argument("initData");}};NLRT.$f8.prototype={$2t:null,$KK:null,$5N:null};NLRT.$f7=function(a){NLRT.$f7.initializeBase(this,[a]);this.$S=a};NLRT.$f7.prototype={$3GB:function(f,g,h,i,k,l,j){var d=this.$S.$5N.$Sa(g,null),e=0,b=0,a=null;if(this.$S.$5N.get_$jo()===2){if(d)a=this.$S.$KK}else{a=this.$S.$KK;if(a)a+="_";a+=this.$S.$2t.$bL(this.$S.$5N.get_$jo(),d)}if(!(a==null)){var c;NLRT.$Bs.$3FP(f,a,this.$S.$xJ,h,i,c={val:b}),b=c.val;++e}j.val+=b},$S:null};NLRT.$a0=function(b,e,f){NLRT.$a0.initializeBase(this);if(!b)return;var a=0;try{var c;this.$329(b,c={val:a},e),a=c.val;this.$2SK=b.get_$5(a)===1;++a;this.$2RE=b.get_$5(a)===1;++a;var d=b.get_$5(a);++a;this.$2Qi=this.$5en(f,d)}catch(g){throw Error.argument("initData");}};NLRT.$a0.prototype={$2SK:false,$2RE:false,$2Qi:null,$5en:function(a,b){return new NLRT.$9I(a,b)}};NLRT.$Zz=function(a){NLRT.$Zz.initializeBase(this,[a]);this.$S=a};NLRT.$Zz.prototype={$3GB:function(v,w,p,q,x,f){if(f.val==null)f.val=v.$3bb(x,w);var e=this.$S.$2Qi.$5Sk(f.val);if(this.$S.$2SK)for(var g=e,r=g.length,b=0;b<r;++b){var n=g[b];if(!n.$KH&&n.$1HK)return}for(var a=0,h=e,s=h.length,c=0;c<s;++c){var o=h[c];if(!o.$KH)continue;var j,k;if(!(k=this.$3GC(o,true,p,q,j={val:a}),a=j.val,k))return}if(this.$S.$2RE)for(var i=e,t=i.length,d=0;d<t;++d){var u=i[d],l,m;if(!(m=this.$3GC(u,false,p,q,l={val:a}),a=l.val,m))return}},$3GC:function(b,f,g,h,e){var a,c;if(f){a=0;c=b.$1HK?1:0}else{a=b.$1HK?1:0;c=b.$87-a}for(var d=0;d<c;++d){NLRT.$Bs.$3FQ(b.$kP+a+d,this.$S.$xJ,g,h);++e.val;if(this.$S.$1sq>0&&e.val>=this.$S.$1sq)return false}return true},$S:null};NLRT.$iO=function(a){this.$1YV=new Array(a);this.$xR=new Array(a);this.$1YK=new Array(0);this.$1tb=new Array(0)};NLRT.$iO.prototype={$1YV:null,$xR:null,$1YK:null,$1tb:null};NLRT.$JA=function(){this.$Ao=this.$$gta["NLRT.$JA"].TK===Number||Type.isEnum(this.$$gta["NLRT.$JA"].TK)?0:this.$$gta["NLRT.$JA"].TK===Boolean?false:null;this.$Q=this.$$gta["NLRT.$JA"].TV===Number||Type.isEnum(this.$$gta["NLRT.$JA"].TV)?0:this.$$gta["NLRT.$JA"].TV===Boolean?false:null};NLRT.$JA.$$=function(f,g){var a="$JA$"+f.getName().replace(/\./g,"_")+"$"+g.getName().replace(/\./g,"_");if(!NLRT[a]){var c=NLRT[a]=function(){for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];NLRT.$JA.apply(this,b)};c.registerClass("NLRT."+a);var h={"NLRT.$JA":{TK:f,TV:g}};c.prototype.$$gta=h;var d=NLRT.$JA.prototype;for(var e in d){var b={key:e,value:d[e]};if("constructor"!==b.key)c.prototype[b.key]=b.value}}return NLRT[a]};NLRT.$2c=function(){};NLRT.$2c.$9F=function(d,a,b,c){c.val=a[b];return b in a};NLRT.$2c.$587=function(f){var d=[],b=f;for(var c in b){var e={key:c,value:b[c]},a=new(NLRT.$JA.$$(String,Number));a.$Ao=e.key;a.$Q=e.value;Array.add(d,a)}return d};NLRT.$2l=function(){};NLRT.$2l.$3qA=function(f,g,c,d,e){for(var a=e,b=0;b<c.length;b++)a=d(a,c[b]);return a};NLRT.$2l.$5TB=function(e,f,b,d){for(var c=new Array(b.length),a=0;a<b.length;a++)c[a]=d(b[a]);return c};NLRT.$2l.$640=function(e,c,d){for(var b=new Array(Math.min(d,c.length)),a=0;a<b.length;a++)b[a]=c[a];return b};NLRT.$2l.$6Ap=function(h,f,g){for(var c=[],b=f,e=b.length,a=0;a<e;++a){var d=b[a];g(d)&&Array.add(c,d)}return c};NLRT.$1N=function(){};NLRT.$1N.$5Vc=function(b){var a=NLRT.$2l.$5TB(Number,Number,b,function(a){return a*a});return Math.sqrt(NLRT.$2l.$3qA(Number,Number,a,function(a,b){return a+b},0))};NLRT.$1N.$f0=function(a){return NLRT.$2l.$3qA(Number,Number,a,function(a,b){return a>b?a:b},a[0])};NLRT.$1N.$4Ph=function(a,b){return a>b?1:a<b?-1:0};NLRT.$G9.registerClass("NLRT.$G9",null,NLRT.$pV);NLRT.$KQ.registerClass("NLRT.$KQ");NLRT.$Vm.registerClass("NLRT.$Vm",null,NLRT.$pX);NLRT.$1G.registerClass("NLRT.$1G",null,NLRT.$pb);NLRT.$6P.registerClass("NLRT.$6P",null,NLRT.$Dn,NLRT.$RP);NLRT.$6P.$4I7.registerClass("NLRT.$6P.$4I7");NLRT.$UK.registerClass("NLRT.$UK",null,NLRT.$J7,NLRT.$RP);NLRT.$4s.registerClass("NLRT.$4s",null,NLRT.$77,NLRT.$RP);NLRT.$98.registerClass("NLRT.$98",null,NLRT.$pC);NLRT.$Vn.registerClass("NLRT.$Vn",null,NLRT.$pE);NLRT.$KR.registerClass("NLRT.$KR");NLRT.$LM.registerClass("NLRT.$LM");NLRT.$Od.registerClass("NLRT.$Od");NLRT.$9I.registerClass("NLRT.$9I",null,NLRT.$pH);NLRT.$ZO.registerClass("NLRT.$ZO",null,NLRT.$pK);NLRT.$HJ.registerClass("NLRT.$HJ",null,NLRT.$pL);NLRT.$dc.registerClass("NLRT.$dc",null,NLRT.$pf);NLRT.$r4.registerClass("NLRT.$r4");NLRT.$r5.registerClass("NLRT.$r5");NLRT.$r6.registerClass("NLRT.$r6",null,NLRT.$pr);NLRT.$r6.$6Aq.registerClass("NLRT.$r6.$6Aq");NLRT.$OP.registerClass("NLRT.$OP",null,NLRT.$pt);NLRT.$OQ.registerClass("NLRT.$OQ");NLRT.$Ue.registerClass("NLRT.$Ue");NLRT.$DM.registerClass("NLRT.$DM",null,NLRT.$pv);NLRT.$DM.$5Sn.registerClass("NLRT.$DM.$5Sn",null,NLRT.$pz);NLRT.$DM.$65h.registerClass("NLRT.$DM.$65h");NLRT.$DM.$2OF.registerClass("NLRT.$DM.$2OF");NLRT.$DM.$65g.registerClass("NLRT.$DM.$65g");NLRT.$8v.registerClass("NLRT.$8v");NLRT.$Kg.registerClass("NLRT.$Kg");NLRT.$AS.registerClass("NLRT.$AS");NLRT.$Kq.registerClass("NLRT.$Kq",null,NLRT.$c4.$$(Number));NLRT.$Nh.registerClass("NLRT.$Nh",null,NLRT.$c4.$$(Number));NLRT.$QZ.registerClass("NLRT.$QZ");NLRT.$WJ.registerClass("NLRT.$WJ");NLRT.$ZK.registerClass("NLRT.$ZK");NLRT.$bH.registerClass("NLRT.$bH");NLRT.$Ay.registerClass("NLRT.$Ay");NLRT.$gy.registerClass("NLRT.$gy");NLRT.$Jp.registerClass("NLRT.$Jp");NLRT.$Vz.registerClass("NLRT.$Vz");NLRT.$Vy.registerClass("NLRT.$Vy");NLRT.$iw.registerClass("NLRT.$iw");NLRT.$X2.registerClass("NLRT.$X2");NLRT.$OJ.registerClass("NLRT.$OJ");NLRT.$Uo.registerClass("NLRT.$Uo");NLRT.$GA.registerClass("NLRT.$GA");NLRT.$bi.registerClass("NLRT.$bi");NLRT.$r0.registerClass("NLRT.$r0",null,NLRT.$q5);NLRT.$a7.registerClass("NLRT.$a7",NLRT.$r0);NLRT.$c8.registerClass("NLRT.$c8",NLRT.$r0);NLRT.$WI.registerClass("NLRT.$WI",NLRT.$r0);NLRT.$ZJ.registerClass("NLRT.$ZJ",NLRT.$r0);NLRT.$b9.registerClass("NLRT.$b9",NLRT.$r0);NLRT.$cy.registerClass("NLRT.$cy",NLRT.$r0);NLRT.$cz.registerClass("NLRT.$cz",NLRT.$r0);NLRT.$Vv.registerClass("NLRT.$Vv",NLRT.$r0);NLRT.$Vx.registerClass("NLRT.$Vx",NLRT.$r0);NLRT.$iv.registerClass("NLRT.$iv",NLRT.$r0);NLRT.$X1.registerClass("NLRT.$X1",NLRT.$r0);NLRT.$fB.registerClass("NLRT.$fB",NLRT.$r0);NLRT.$Xo.registerClass("NLRT.$Xo",NLRT.$r0);NLRT.$cK.registerClass("NLRT.$cK",NLRT.$r0);NLRT.$cj.registerClass("NLRT.$cj",NLRT.$r0);NLRT.$Xs.registerClass("NLRT.$Xs",NLRT.$r0);NLRT.$ZS.registerClass("NLRT.$ZS",NLRT.$r0);NLRT.$Zr.registerClass("NLRT.$Zr",NLRT.$r0);NLRT.$ZA.registerClass("NLRT.$ZA",NLRT.$r0);NLRT.$Vs.registerClass("NLRT.$Vs",NLRT.$r0);NLRT.$hc.registerClass("NLRT.$hc",NLRT.$r0);NLRT.$cL.registerClass("NLRT.$cL",NLRT.$r0);NLRT.$iP.registerClass("NLRT.$iP",NLRT.$r0);NLRT.$bj.registerClass("NLRT.$bj",NLRT.$r0);NLRT.$hf.registerClass("NLRT.$hf",NLRT.$r0);NLRT.$XV.registerClass("NLRT.$XV",NLRT.$r0);NLRT.$cl.registerClass("NLRT.$cl",NLRT.$r0);NLRT.$iJ.registerClass("NLRT.$iJ",NLRT.$r0);NLRT.$s3.registerClass("NLRT.$s3",NLRT.$r0);NLRT.$VI.registerClass("NLRT.$VI",NLRT.$s3);NLRT.$hg.registerClass("NLRT.$hg",NLRT.$s3);NLRT.$dK.registerClass("NLRT.$dK",NLRT.$s3);NLRT.$Ya.registerClass("NLRT.$Ya",NLRT.$s3);NLRT.$dD.registerClass("NLRT.$dD",NLRT.$s3);NLRT.$ZB.registerClass("NLRT.$ZB",NLRT.$s3);NLRT.$s5.registerClass("NLRT.$s5",NLRT.$r0);NLRT.$Vk.registerClass("NLRT.$Vk",NLRT.$s5);NLRT.$du.registerClass("NLRT.$du",NLRT.$s5);NLRT.$dV.registerClass("NLRT.$dV",NLRT.$r0);NLRT.$N8.registerClass("NLRT.$N8");NLRT.$fO.registerClass("NLRT.$fO");NLRT.$dO.registerClass("NLRT.$dO");NLRT.$Yy.registerClass("NLRT.$Yy");NLRT.$bK.registerClass("NLRT.$bK");NLRT.$W0.registerClass("NLRT.$W0");NLRT.$WC.registerClass("NLRT.$WC",null,NLRT.$pG);NLRT.$dC.registerClass("NLRT.$dC",null,NLRT.$pG);NLRT.$fN.registerClass("NLRT.$fN",null,NLRT.$pG);NLRT.$dM.registerClass("NLRT.$dM",null,NLRT.$pG);NLRT.$Yx.registerClass("NLRT.$Yx",null,NLRT.$pG);NLRT.$bA.registerClass("NLRT.$bA",null,NLRT.$pG);NLRT.$Vw.registerClass("NLRT.$Vw",null,NLRT.$pG);NLRT.$Xp.registerClass("NLRT.$Xp",null,NLRT.$pG);NLRT.$fC.registerClass("NLRT.$fC");NLRT.$eh.registerClass("NLRT.$eh");NLRT.$iL.registerClass("NLRT.$iL");NLRT.$NF.registerClass("NLRT.$NF");NLRT.$fK.registerClass("NLRT.$fK");NLRT.$EK.registerClass("NLRT.$EK");NLRT.$hZ.registerClass("NLRT.$hZ");NLRT.$EV.registerClass("NLRT.$EV");NLRT.$H7.registerClass("NLRT.$H7");NLRT.$ON.registerClass("NLRT.$ON");NLRT.$JZ.registerClass("NLRT.$JZ");NLRT.$ZM.registerClass("NLRT.$ZM");NLRT.$OC.registerClass("NLRT.$OC");NLRT.$K7.registerClass("NLRT.$K7");NLRT.$eg.registerClass("NLRT.$eg");NLRT.$i9.registerClass("NLRT.$i9");NLRT.$he.registerClass("NLRT.$he");NLRT.$NE.registerClass("NLRT.$NE",null,NLRT.$pJ);NLRT.$fJ.registerClass("NLRT.$fJ",null,NLRT.$pJ);NLRT.$EJ.registerClass("NLRT.$EJ",null,NLRT.$pJ);NLRT.$hY.registerClass("NLRT.$hY",null,NLRT.$pJ);NLRT.$f5.registerClass("NLRT.$f5",null,NLRT.$pJ);NLRT.$H6.registerClass("NLRT.$H6",null,NLRT.$pJ);NLRT.$OM.registerClass("NLRT.$OM",null,NLRT.$pJ);NLRT.$JY.registerClass("NLRT.$JY",null,NLRT.$pJ);NLRT.$ZL.registerClass("NLRT.$ZL",null,NLRT.$pJ);NLRT.$f6.registerClass("NLRT.$f6",null,NLRT.$pJ);NLRT.$Ss.registerClass("NLRT.$Ss",null,NLRT.$pJ);NLRT.$cm.registerClass("NLRT.$cm",null,NLRT.$pJ);NLRT.$Ja.registerClass("NLRT.$Ja",null,NLRT.$pJ);NLRT.$Qt.registerClass("NLRT.$Qt",null,NLRT.$pJ);NLRT.$PH.registerClass("NLRT.$PH",null,NLRT.$pJ);NLRT.$PG.registerClass("NLRT.$PG",null,NLRT.$pJ);NLRT.$ef.registerClass("NLRT.$ef",null,NLRT.$pJ);NLRT.$i8.registerClass("NLRT.$i8",null,NLRT.$pJ);NLRT.$f9.registerClass("NLRT.$f9",null,NLRT.$pJ);NLRT.$hd.registerClass("NLRT.$hd",null,NLRT.$pJ);NLRT.$ZV.registerClass("NLRT.$ZV");NLRT.$ZU.registerClass("NLRT.$ZU",null,NLRT.$ke);NLRT.$ZU.$65f.registerClass("NLRT.$ZU.$65f",null,NLRT.$pz);NLRT.$ZU.$3Bn.registerClass("NLRT.$ZU.$3Bn",null,Sys.IDisposable,Sys.IEnumerable$1,Sys.IEnumerator$1);NLRT.$dQ.registerClass("NLRT.$dQ");NLRT.$dP.registerClass("NLRT.$dP",null,NLRT.$ke,NLRT.$lF);NLRT.$dP.$4rj.registerClass("NLRT.$dP.$4rj");NLRT.$dR.registerClass("NLRT.$dR",null,NLRT.$kf);NLRT.$iB.registerClass("NLRT.$iB");NLRT.$iA.registerClass("NLRT.$iA",null,NLRT.$ke);NLRT.$g4.registerClass("NLRT.$g4");NLRT.$g3.registerClass("NLRT.$g3",null,NLRT.$ke);NLRT.$iN.registerClass("NLRT.$iN");NLRT.$iM.registerClass("NLRT.$iM",null,NLRT.$ke);NLRT.$iM.$659.registerClass("NLRT.$iM.$659");NLRT.$iT.registerClass("NLRT.$iT");NLRT.$Kh.registerClass("NLRT.$Kh",null,NLRT.$l9);NLRT.$fI.registerClass("NLRT.$fI",null,NLRT.$l9);NLRT.$gx.registerClass("NLRT.$gx",null,NLRT.$l9);NLRT.$N3.registerClass("NLRT.$N3",null,NLRT.$l9);NLRT.$Ec.registerClass("NLRT.$Ec",null,NLRT.$ke);NLRT.$GU.registerClass("NLRT.$GU",null,NLRT.$lE);NLRT.$rV.registerClass("NLRT.$rV");NLRT.$Bs.registerClass("NLRT.$Bs",null,NLRT.$cN);NLRT.$hi.registerClass("NLRT.$hi",NLRT.$rV);NLRT.$hh.registerClass("NLRT.$hh",NLRT.$Bs);NLRT.$f8.registerClass("NLRT.$f8",NLRT.$rV);NLRT.$f7.registerClass("NLRT.$f7",NLRT.$Bs);NLRT.$a0.registerClass("NLRT.$a0",NLRT.$rV);NLRT.$Zz.registerClass("NLRT.$Zz",NLRT.$Bs);NLRT.$iO.registerClass("NLRT.$iO");NLRT.$2c.registerClass("NLRT.$2c");NLRT.$2l.registerClass("NLRT.$2l");NLRT.$1N.registerClass("NLRT.$1N");NLRT.$AS.$1pD=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Type.registerNamespace("Common.App.CollabControls");Common.App.CollabControls.$n3=function(){};Common.App.CollabControls.$n3.registerInterface("Common.App.CollabControls.$n3");Common.App.CollabControls.$n4=function(){};Common.App.CollabControls.$n4.registerInterface("Common.App.CollabControls.$n4");Common.App.CollabControls.$3J=function(){};Common.App.CollabControls.$3J.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13};Common.App.CollabControls.$3J.registerEnum("Common.App.CollabControls.$3J",false);Common.App.CollabControls.$PY=function(a){this.$$d_$62x=Function.createDelegate(this,this.$62x);this.dispose=this.$d;Common.App.CollabControls.$PY.initializeBase(this);this.$2B=a};Common.App.CollabControls.$PY.$4hJ=function(a,b){return a+(b?"Rtl":"")};Common.App.CollabControls.$PY.prototype={$2B:null,get_$1N:function(){return this.$2B},get_$7R:function(){return this.$2B.style.visibility==="visible"},set_$7R:function(a){this.$2B.style.visibility=a?"visible":"hidden";return a},set_$1pC:function(a){this.$2B.dir=a?"rtl":"ltr";return a},set_$1X9:function(a){this.$2B.style.zIndex=a;return a},$d:function(){this.$2B&&this.$2B.parentNode&&this.$2B.parentNode.removeChild(this.$2B);this.$2B=null},$1j:function(a){return this.$2B.ownerDocument.createElement(a)},$62x:function(){return true}};Common.App.CollabControls.$Ix=function(a,b){Common.App.CollabControls.$Ix.initializeBase(this);this.$3G=a;this.$2Qj=b};Common.App.CollabControls.$Ix.prototype={$3G:0,$2Qj:null};Common.App.CollabControls.$Ar=function(d,c,a){this.$$d_$5a3=Function.createDelegate(this,this.$5a3);this.$FX=[];this.$Ly=[];this.dispose=this.$d;Common.App.CollabControls.$Ar.initializeBase(this,[d]);this.$1Km={};this.$7o=a;this.$3z=a.$BQ(Boolean,8);this.$OA=a.$BQ(Boolean,11);var b=a.$BQ(Number,12);this.$x4=a.$BQ(Number,6);this.$24M=c;this.$2B.id=Common.App.CollabControls.$Ar.$3S4();this.$2B.className=Common.App.CollabControls.$PY.$4hJ("prControl",this.$3z);b&&this.set_$1X9(b);this.set_$1pC(this.$3z);this.$5vq(c);this.$Yq=this.$1j("div");this.$Yq.className=this.$OA?"prContainerV":"prContainerHr";this.$2B.appendChild(this.$Yq);this.$Ld=new Common.App.CollabControls.$HG(this.$1j("div"),this.$7o);this.$Ld.add_$2xA(this.$$d_$5a3);this.$2B.appendChild(this.$Ld.$2B)};Common.App.CollabControls.$Ar.$3S4=function(){return String.format("{0}-{1}","presencetooltip",Common.App.CollabControls.$Ar.$2a1++)};Common.App.CollabControls.$Ar.$5BB=function(c){var a=c.$1c.rawEvent,b=a.relatedTarget;return b||a.toElement};Common.App.CollabControls.$Ar.prototype={$Yq:null,$1Lw:0,$3z:false,$1KG:false,$OA:false,$24M:0,$7o:null,$1Km:null,get_$5h1:function(){return Common.$2l.$3l(this.$FX)},$Ld:null,$1rR:null,$x4:0,get_$2N8:function(){return this.$x4+2},get_$At:function(){return!this.$OA?this.$24M:this.get_$2N8()},get_$EY:function(){return!this.$OA?this.get_$2N8():this.$24M},$d:function(){this.$Ld&&this.$Ld.remove_$2xA(this.$$d_$5a3);System.$39.$F9(this.$Ld);System.$39.$34h(this.$Ly);this.$Ld=null;this.$Ly=null;Common.App.CollabControls.$PY.prototype.$d.call(this)},$618:function(){this.$3xq();this.$Ld.$9M();this.set_$7R(true);this.$1KG=false},$617:function(){if(!this.$Ly||this.$Ly.length<1)return;this.set_$7R(true);this.$3xq();this.$32O(this.$Ly[this.$Ly.length-1]);this.$1KG=true},$9M:function(){this.set_$7R(false);this.$Ld.$9M();for(var a=0;a<this.$Ly.length;a++)this.$Ly[a].$9M();this.$1KG=false},$1P1:function(b){if(this.$1Lw<=0)return;if(!b.$6f)b.$6f=(Common.App.CollabControls.$Ar.$2a1++).toString();if(b.$6f in this.$1Km){var c=this.$3Qx(b.$6f);if(c>=0){var d=this.$FX[c];if(d.$HJ===b.$HJ&&d.$HM===b.$HM)return;else this.$3rW(b.$6f)}}var a;if(this.$FX.length<this.$1Lw){a=new Common.App.CollabControls.$en(this.$1j("div"),this.$7o,b);a.add_$2xA(this.$$d_$5a3);if(this.$3z&&!this.$OA&&this.$FX.length>0)this.$Yq.insertBefore(a.$2B,this.$Yq.firstChild);else this.$Yq.appendChild(a.$2B);Array.add(this.$Ly,a)}else{if(this.$3z&&!this.$OA)a=this.$Ly[0];else a=this.$Ly[this.$Ly.length-1];a.$1P1(b)}a.$Bz();this.$1Km[b.$6f]=a;Array.add(this.$FX,b);this.$15Z(a)},$3rW:function(a){this.$3rX(a);this.$FX.length>=this.$1Lw&&this.$Ly.length<this.$1Lw&&this.$5kA();this.$FX.length<=0&&this.$9M()},$3rX:function(d){var b=this.$3Qx(d);if(b<0)return;var c=this.$FX[b];Array.removeAt(this.$FX,b);var a=this.$1Km[c.$6f];delete this.$1Km[c.$6f];a.$3rW(c.$6f);this.$15Z(a);if(a.get_$vW()<=0){this.$Yq.removeChild(a.$2B);Array.remove(this.$Ly,a);a.$d()}},$5kA:function(){var a=this.$59w();if(!a||a.$FX.length<=1)return;var b=Array.clone(this.$FX),c=this;Array.forEach(b,function(a){c.$3rX(a.$6f)});var d=this;Array.forEach(b,function(a){d.$1P1(a)})},$3Qx:function(b){for(var a=0;a<this.$FX.length;a++)if(this.$FX[a].$6f===b)return a;return-1},$59w:function(){return this.$3z&&!this.$OA?this.$Ly[0]:this.$Ly[this.$Ly.length-1]},$3xq:function(){for(var a=0;a<this.$Ly.length;a++)this.$Ly[a].$Bz()},$32O:function(a){if(!a)return;this.$1rR=a;if(this.$OA){var c=this.$x4;if(a.$FX.length>1)this.$Ld.$Bz(a.$FX,c,this.get_$EY()-this.$x4);else for(var d=this.$Yq.children.length,b=0;b<this.$Yq.children.length;b++)a.$2B===this.$Yq.children[b]&&this.$Ld.$Bz(a.$FX,c,this.get_$EY()-(d-b)*this.get_$2N8()+2)}else this.$Ld.$Bz(a.$FX,this.get_$At(),0)},$5a3:function(b,a){if(a.$3G===2||a.$3G===1&&!this.$Ld.get_$7R())this.$32O(b);else if(a.$3G===1){this.$Ld.$9M();this.$1KG=false}else if(a.$3G===3)if(!this.$4r1(a.$2Qj))!this.$1KG&&this.$Ld.$9M();else return;this.$27("InteractivityChanged",a)},$4r1:function(b){var a=Common.App.CollabControls.$Ar.$5BB(b);return this.$Yq!==a&&Common.$J.$2G4(this.$Yq,a)||Common.$J.$2G4(this.$Ld.$2B,a)},$15Z:function(a){var b=this.$5Kf(a);if(b&&a.get_$vW()<=0)this.$Ld.$9M();else if(b)this.$32O(a);else this.$Ld.$9M()},$5Kf:function(a){return!!this.$1rR&&a===this.$1rR&&this.$Ld.get_$7R()},$5vq:function(a){this.$1Lw=a===this.$x4?1:Math.floor(a/this.get_$2N8());if(this.$OA){this.$2B.style.height=a+"px";this.$2B.style.width=this.$x4+"px"}else{this.$2B.style.width=a+"px";this.$2B.style.height=this.$x4+"px"}}};Common.App.CollabControls.$em=function(a){this.$7o=a;this.$7o.$26e(Common.$MF,10,Common.$1I.get_$4());this.$7o.$26e(Common.$Mp,9,Common.$v.get_$4());this.$7o.$26e(Number,6,16);this.$7o.$26e(Common.$3C,13,Common.$3C.get_$4())};Common.App.CollabControls.$em.prototype={$7o:null,$4XV:function(a){return new Common.App.CollabControls.$Ar(a,16,this.$7o)}};Common.App.CollabControls.$HG=function(b,a){this.$$d_$2JI=Function.createDelegate(this,this.$2JI);this.$$d_$QW=Function.createDelegate(this,this.$QW);Common.App.CollabControls.$HG.initializeBase(this,[b]);this.$2fz=a.$BQ(Boolean,8);this.$1wl=a.$BQ(Number,6);this.$2B=b;this.$2B.className=Common.App.CollabControls.$HG.$3RI;this.$1fP=this.$1j("ul");this.$2B.appendChild(this.$1fP);this.$3J=a.$BQ(Common.$MF,10);this.$3J.$z("click",this.$2B,this.$$d_$QW);this.$Pl=a.$BQ(Common.$Mp,9);this.$Pl.$z("msospPointerOut",this.$2B,this.$$d_$2JI);this.$Pl.$z("msospPointerDown",this.$2B,this.$$d_$62x);this.$cF=a.$BQ(Common.$3C,13);this.$cF.$z(this.$2B,this.$$d_$62x)};Common.App.CollabControls.$HG.prototype={$3J:null,$Pl:null,$cF:null,$1fP:null,$1wl:0,$2fz:false,add_$2xA:function(a){this.$1O("InteractivityChanged",a)},remove_$2xA:function(a){this.$2X("InteractivityChanged",a)},$3Bj:null,$d:function(){if(this.$2B){this.$3J.$1u("click",this.$2B,this.$$d_$QW);this.$Pl.$1u("msospPointerDown",this.$2B,this.$$d_$62x);this.$Pl.$1u("msospPointerOut",this.$2B,this.$$d_$2JI);this.$cF.$1u(this.$2B,this.$$d_$62x)}Common.App.CollabControls.$PY.prototype.$d.call(this)},$9M:function(){this.set_$7R(false)},$Bz:function(a,b,c){this.$9M();if(!a||a.length<=0)return;if(!this.$2fz)this.$2B.style.left=b+"px";else this.$2B.style.right=b+"px";this.$2B.style.top=c+"px";this.$4Fq(a);this.set_$7R(true)},$4Fq:function(b){this.$3Bj=b;Common.$J.$Jf(this.$1fP);for(var a=b.length-1;a>=0;a--)this.$1P1(b[a])},$1P1:function(b){var a=document.createElement("li");a.style.backgroundColor=b.$HJ;a.style.height=this.$1wl+"px";a.id="fly_"+b.$6f;a.style.lineHeight=this.$1wl+"px";Common.$J.$GR(a,b.$HM);this.$1fP.appendChild(a)},$QW:function(){this.$9M();return false},$2JI:function(a){this.$27("InteractivityChanged",new Common.App.CollabControls.$Ix(3,a));return false}};Common.App.CollabControls.$en=function(a,b,c){this.$$d_$QW=Function.createDelegate(this,this.$QW);this.$$d_$2JI=Function.createDelegate(this,this.$2JI);this.$$d_$1o4=Function.createDelegate(this,this.$1o4);this.$FX=[];Common.App.CollabControls.$en.initializeBase(this,[a]);this.$2B.className="prGlyph";this.$7o=b;this.$zl=this.$7o.$BQ(Common.$Mp,9);this.$Cx=this.$7o.$BQ(Common.$MF,10);this.$cF=this.$7o.$BQ(Common.$3C,13);this.$5GX();this.$1P1(c);this.$1c7=false};Common.App.CollabControls.$en.prototype={$1Kr:null,$7o:null,$1c7:true,$Cx:null,$zl:null,$cF:null,get_$vW:function(){return this.$FX.length},add_$2xA:function(a){this.$1O("InteractivityChanged",a)},$d:function(){this.$67B();Common.App.CollabControls.$PY.prototype.$d.call(this)},$1P1:function(a){Array.add(this.$FX,a);if(this.get_$vW()===2)this.$fk(true);else if(this.get_$vW()===1)this.$fk(false);else this.$fk(this.$1c7)},$3rW:function(b){var a=this.$4sM(b);if(!a)return;this.get_$vW()>1&&this.$fk(true);if(this.get_$vW()===1)this.$fk(false);else this.get_$vW()<1&&this.$9M()},$Bz:function(){this.$fk(this.get_$vW()>=2);this.set_$7R(true)},$9M:function(){this.set_$7R(false)},$57f:function(a){return a?this.$3X9(0,5):this.$3X9(1,4)},$4sM:function(c){for(var a=0;a<this.get_$vW();a++)if(this.$FX[a].$6f===c){var b=this.$FX[a];Array.removeAt(this.$FX,a);return b}return null},$fk:function(a){if(this.$1c7!==a){this.$1Kr&&this.$2B.removeChild(this.$1Kr);this.$1Kr=this.$57f(a);this.$2B.appendChild(this.$1Kr);this.$1c7=a}this.$1Kr.childNodes[0].style.backgroundColor=this.$FX[this.$FX.length-1].$HJ},$3X9:function(b,c){var a=this.$7o.$BQ(Number,6);return Common.$n.$2n3(a,a,this.$7o.$BQ(String,b),this.$7o.$BQ(String,c),"cui-img-cont-float cui-img-16by16","",false,"",this.$2B.ownerDocument)},$1o4:function(a){a.$3y!==3&&this.$27("InteractivityChanged",new Common.App.CollabControls.$Ix(2,a));return false},$QW:function(a){this.$27("InteractivityChanged",new Common.App.CollabControls.$Ix(1,a));return true},$2JI:function(a){a.$3y!==3&&this.$27("InteractivityChanged",new Common.App.CollabControls.$Ix(3,a));return false},$67B:function(){if(!this.$2B)return;this.$zl.$1u("msospPointerDown",this.$2B,this.$$d_$62x);this.$zl.$1u("msospPointerOver",this.$2B,this.$$d_$1o4);this.$zl.$1u("msospPointerOut",this.$2B,this.$$d_$2JI);this.$Cx.$1u("dblclick",this.$2B,this.$$d_$62x);this.$Cx.$1u("click",this.$2B,this.$$d_$QW);this.$cF.$1u(this.$2B,this.$$d_$62x)},$5GX:function(){if(!this.$2B)return;this.$zl.$z("msospPointerDown",this.$2B,this.$$d_$62x);this.$zl.$z("msospPointerOver",this.$2B,this.$$d_$1o4);this.$zl.$z("msospPointerOut",this.$2B,this.$$d_$2JI);this.$Cx.$z("dblclick",this.$2B,this.$$d_$62x);this.$Cx.$z("click",this.$2B,this.$$d_$QW);this.$cF.$z(this.$2B,this.$$d_$62x)}};Common.App.CollabControls.$eo=function(){this.$Lk={}};Common.App.CollabControls.$eo.prototype={$BQ:function(c,d){var a=Common.App.CollabControls.$3J.toString(d);if(c===Number){var b=this.$Lk[a];return!b?0:Number.parseInvariant(b.toString())}return this.$Lk[a]},$F:function(c,a,b){this.$Lk[Common.App.CollabControls.$3J.toString(a)]=b},$26e:function(c,a,b){if(!(Common.App.CollabControls.$3J.toString(a)in this.$Lk))this.$Lk[Common.App.CollabControls.$3J.toString(a)]=b}};Common.App.CollabControls.$PY.registerClass("Common.App.CollabControls.$PY",Common.$2y,Sys.IDisposable);Common.App.CollabControls.$Ix.registerClass("Common.App.CollabControls.$Ix",Sys.EventArgs);Common.App.CollabControls.$Ar.registerClass("Common.App.CollabControls.$Ar",Common.App.CollabControls.$PY,Common.App.CollabControls.$n3,Sys.IDisposable);Common.App.CollabControls.$em.registerClass("Common.App.CollabControls.$em",null,Common.App.CollabControls.$n4);Common.App.CollabControls.$HG.registerClass("Common.App.CollabControls.$HG",Common.App.CollabControls.$PY);Common.App.CollabControls.$en.registerClass("Common.App.CollabControls.$en",Common.App.CollabControls.$PY);Common.App.CollabControls.$eo.registerClass("Common.App.CollabControls.$eo");Common.App.CollabControls.$Ar.$2a1=0;Common.App.CollabControls.$HG.$3RI="prFlyout UISmallFont";Type.registerNamespace("CACPU");CACPU.$RU=function(){};CACPU.$RU.registerInterface("CACPU.$RU");CACPU.$et=function(){this.CT=0;this.MT=0;this.TT=0;this.AT=0};CACPU.$L0=function(a){this.$AP=new($$sc.$5l.$$(Common.$b3));this.$C5=a};CACPU.$L0.prototype={$C5:null,$1JQ:null,$AP:null,$66E:function(){return this.$1JQ},$3XX:function(){return this.$AP.get_$8z()},$8F:function(a,b,c,d){if(!this.$1JQ){this.$1JQ=new CACPU.$Xu(this.$C5,a,b,c,d);this.$AP.$9D(this.$1JQ)}return this.$1JQ}};CACPU.$Xu=function(a,b,c,d,e){this.$$d_$6V=Function.createDelegate(this,this.$6V);this.$21b=new Common.$2y;this.$C5=a;this.$1Xt=b;this.$1XZ=c;this.$2QO=d;this.$2Qx=e};CACPU.$Xu.prototype={$C5:null,$17N:0,$22V:0,$2hG:0,$23m:0,$2g2:false,$1Xt:null,$2QO:null,$1XZ:null,$2Qx:null,$1bs:0,add_$145:function(a){this.$21b.$1O("OnCpuMeterFrameAvailable",a)},remove_$145:function(a){this.$21b.$2X("OnCpuMeterFrameAvailable",a)},$2KR:function(a,b){this.$2k();a();this.$4x(b)},$1Uw:function(e,b){var c=this.$C5();e();var d=this.$C5(),a=d-c;this.$1XZ.$26l(a,b);this.$2Qx.$bG(a,b)},$3i8:function(a){this.$1bs=this.$1bs|a},$2k:function(){if(!this.$17N)this.$22V=this.$C5();this.$17N++},$4x:function(b){var a=0;this.$17N--;if(this.$17N<=0){var c=this.$C5();a=c-this.$22V;this.$23m+=a;this.$1Xt.$26l(a,b);this.$17N=0}b.indexOf(Common.$6n.$41E)>=0&&this.$3i8(2);b.indexOf(Common.$6n.$3s3)>=0&&this.$3i8(4)},$61w:function(){var d=this.$C5(),e=d-this.$2hG,f=this.$23m/e,g=Common.$1N.$1p9(f*100,2),a=new Common.$Ky;a.CP=g;a.II=this.$1bs;var b=this.$1Xt.$12c();if(Common.$2c.$14(b))a.LRT=b;var c=this.$1XZ.$12c();if(Common.$2c.$14(c))a.FP=c;this.$2QO.$bG(a,null);this.$21b.$27("OnCpuMeterFrameAvailable",new Common.$Xv(a));this.$3yj();return a},$3yj:function(){this.$1Xt.$7h();this.$1XZ.$7h();this.$17N=0;this.$23m=0;this.$2hG=this.$C5();this.$22V=0;this.$1bs=0},$6V:function(){if(this.$2g2)this.$61w();else{this.$3yj();this.$2g2=true}window.setTimeout(this.$$d_$6V,1e3)}};CACPU.$Kz=function(){};CACPU.$Kz.$5Hl=function(a,n){var c=5,d=1,e=5,f=new Common.Utils.Aggregators.$d0(c),g=new Common.$Nf(a.$5L("CpuMeterFrameSamplingPercent",0)/100),h=new(Common.Utils.Aggregators.$Je.$$(Common.$Ky))(g.$$d_$36s),i=Common.Utils.Aggregators.$8o.$$(Common.$Ky).$EV(9,d,h,true),j=Common.Utils.Aggregators.$8o.$$(Number).$EV(10,e,new CACPU.$Ql,true),b=n.$8F(f,new CACPU.$Ql,i,j);b.$6V();if(a.$1A("CpuMeterMonitorIsEnabled")){var k=Common.Utils.$8.get_$4().$J(CACPU.$RU),l=a.$55j("CpuMeterAverageCpuPercentThreshold",80),m=a.$5L("CpuMeterRollingAverageFramesCount",15);k.$7Y(b,l,m)}Diag.$p.$1k(16827671,306,50,"Initializing CpuMeter")};CACPU.$Kz.$5Sr=function(){Common.App.$f.get_$4().$3M(new CACPU.$Kz)};CACPU.$Kz.prototype={get_$5j:function(){return"Common.App.CpuMeter"},$t9:function(a){var b=this;a.$e(CACPU.$L0).$1p(Common.$Gj).$p().$n(function(){return new CACPU.$L0(Common.$J.$1ks)});var c=this;a.$e(CACPU.$Q9).$1p(CACPU.$RU).$p().$n(function(){return new CACPU.$Q9})},$7Y:function(){var a=Common.$0.$o,b=a.$1A("CpuMeterIsEnabled");if(b){var c=Common.Utils.$8.get_$4().$J(CACPU.$L0),d=Common.$2K.get_$4().get_$3GA(),e=this;d.CW(function(){CACPU.$Kz.$5Hl(a,c)})}},$d:function(){}};CACPU.$Xw=function(a,b){CACPU.$Xw.initializeBase(this);this.$16Y=a;this.$15k=b};CACPU.$Xw.prototype={$16Y:0,$15k:0};CACPU.$Q9=function(){this.$$d_$4Ro=Function.createDelegate(this,this.$4Ro);this.$$d_$145=Function.createDelegate(this,this.$145);this.$17O=[];this.$17=new Common.$2y};CACPU.$Q9.prototype={$1w8:0,$2WF:0,$Ny:null,$7Y:function(a,b,c){this.$Ny=a;this.$1w8=b;this.$2WF=c;this.$Ny.add_$145(this.$$d_$145);this.add_$5Yh(this.$$d_$4Ro)},$145:function(b,a){if(a.$16D){Array.enqueue(this.$17O,a.$16D.CP);if(this.$17O.length>this.$2WF){Array.dequeue(this.$17O);this.$4NU()}}},$4NU:function(){for(var a=this.$17O.length,b=0,d=0;d<a;d++){var e=Array.dequeue(this.$17O);b+=e;Array.enqueue(this.$17O,e)}var c=b/a;c>this.$1w8&&this.$17.$27("CPTTE",new CACPU.$Xw(this.$1w8,c))},$4Ro:function(b,a){Diag.$p.$1k(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.$2n9(a.$16Y,a.$15k))},add_$5Yh:function(a){this.$17.$1O("CPTTE",a)},$2n9:function(b,c){var a={};a.ThresholdValue=b;a.ActualValue=c;return a}};CACPU.$Ql=function(){this.$18A={}};CACPU.$Ql.prototype={$26l:function(b,c){var a;if(c in this.$18A)a=this.$18A[c];else{a=new CACPU.$et;this.$18A[c]=a}a.CT++;a.MT=b>a.MT?b:a.MT;a.TT+=b},$12c:function(){var b=this.$18A;for(var c in b){var d={key:c,value:b[c]},a=d.value;a.AT=Common.$1N.$1p9(a.TT/a.CT,2);a.MT=Common.$1N.$1p9(a.MT,2);a.TT=Common.$1N.$1p9(a.TT,2)}return this.$18A},$7h:function(){this.$18A={}}};CACPU.$et.registerClass("CACPU.$et");CACPU.$L0.registerClass("CACPU.$L0",null,Common.$Gj);CACPU.$Xu.registerClass("CACPU.$Xu",null,Common.$b3);CACPU.$Kz.registerClass("CACPU.$Kz",null,Common.App.$jx,Common.Utils.$l6);CACPU.$Xw.registerClass("CACPU.$Xw",Sys.EventArgs);CACPU.$Q9.registerClass("CACPU.$Q9",null,CACPU.$RU);CACPU.$Ql.registerClass("CACPU.$Ql",null,Common.Utils.Aggregators.$b4.$$(Number));CACPU.$Kz.$5Sr();Type.registerNamespace("Common.App.O365Shell");Common.App.O365Shell.$47=function(){this.$$d_$1F5=Function.createDelegate(this,this.$1F5)};Common.App.O365Shell.$47.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.O365Shell.$47)};Common.App.O365Shell.$47.prototype={$U:null,get_$5j:function(){return"Common.App.O365Shell"},$t9:function(a){this.$U=a;var b=this;this.$U.$e(Common.App.O365Shell.$NG).$1p(Common.App.O365Shell.$S9).$p().$n(function(){return new Common.App.O365Shell.$NG(new($$sc.$x.$$(Common.$Ij))(function(){return Common.$0.$7Q}))})},$7Y:function(){Common.$0.$o.$UQ(this.$$d_$1F5)},$1F5:function(){if(!Common.$0.$3AX)return;this.$U.$J(Common.App.O365Shell.$NG).$5pM()},$d:function(){}};Common.App.O365Shell.$NG=function(a){this.$$d_$5cW=Function.createDelegate(this,this.$5cW);this.$$d_$5WY=Function.createDelegate(this,this.$5WY);this.$$d_$5WZ=Function.createDelegate(this,this.$5WZ);this.$$d_$5ZL=Function.createDelegate(this,this.$5ZL);this.$$d_$5cQ=Function.createDelegate(this,this.$5cQ);this.$1AE=new($$sc.$5l.$$(Object));this.$60=a};Common.App.O365Shell.$NG.prototype={$2dX:false,$2dW:false,$1ee:null,$1NP:null,$60:null,$dL:null,get_$36r:function(){return this.$1AE.get_$8z()},get_$4Oi:function(){return this.$60.get_$Q()},$5pM:function(){this.$dL=$get("sw_bar");var a={};a["Content-Type"]="application/json; charset=utf-8";Diag.$2.$9(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");var b=Common.$q.$DB("O365ShellServiceProxy.ashx","qs",Common.$9.$8W(Common.$0.$Tq));this.get_$4Oi().$DC(b,1,"",a,true,2,this.$$d_$5cQ,this.$$d_$5ZL,null,null,false,null,null,null)},$5cQ:function(e){var a=e.$1v.$7c;if(!a||!a.length){this.$fY();Diag.$2.$9(6362369,215,10,"Response from O365ShellServiceProxy is null.");return}try{var b=Common.$1s.$QA(a);if(this.$66Z(b))this.$1ee=b.NavBarDataJson;if(!this.$1ee){Diag.$2.$9(9000737,215,15,"ShellData is null");this.$1AE.$wE();return}var c,d;if(!(d=Common.$1s.$2OG(b.NavBarDataJson,c={val:this.$1NP}),this.$1NP=c.val,d)){Diag.$2.$9(7660113,215,10,"Failed to deserialize : {0}",{ShellData:Common.Utils.$FR.$39K(this.$1ee)});this.$1AE.$wE();return}this.$1AE.$9D(this.$1NP)}catch(f){this.$fY();Diag.$2.$9(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy.");this.$1AE.$wE()}},$5ZL:function(){this.$dL&&this.$fY();this.$1AE.$wE();Diag.$2.$9(7608091,215,10,"Call to O365ShellServiceProxy failed.")},$66Z:function(a){if(!a.JsUrl||!a.JsUrl.length){this.$fY();Diag.$2.$9(6387854,215,10,"Empty or null JS URL.");return false}var b=Common.$5j.$x(a.JsUrl);b.add_$XF(this.$$d_$5WZ);Common.$31.$tV(b);if(!a.CssUrl||!a.CssUrl.length){this.$fY();Diag.$2.$9(6387855,215,10,"Empty or null CSS URL.");return false}var c=new Common.$QA(a.CssUrl);c.add_$XF(this.$$d_$5WY);Common.$31.$tV(c);return true},$5WY:function(b,a){if(a.$g5){this.$2dW=true;this.$3rl()}else{Diag.$2.$9(7608092,215,10,"CSS failed to load");this.$fY()}},$5WZ:function(b,a){if(a.$g5){this.$2dX=true;this.$3rl()}else{Diag.$2.$9(7608093,215,10,"JS failed to load");this.$fY()}},$3rl:function(){if(this.$2dW&&this.$2dX){if(!this.$dL){Diag.$2.$m(7608280,215,false,null);return}Sys.UI.DomElement.removeCssClass(this.$dL,"SwitcherLoading");var a=document.createElement("div");a.id="ShellContainer";this.$dL.appendChild(a);this.$5oM()}},$5oM:function(){var a=window.self.O365Shell;if(!a){this.$fY();Diag.$2.$m(6613128,215,false,null);return}if(!a.SetData){this.$fY();Diag.$2.$m(6613129,215,false,null);return}if(!this.$1ee){this.$fY();Diag.$2.$m(6613130,215,false,null);return}if(!this.$1NP){this.$fY();return}a.SetData(this.$1NP);var b,c=(b=new Common.App.O365Shell.$NG.$5za,b.launcher="ShellContainer",b);if(!a.RenderAsync){this.$fY();Diag.$2.$m(6613131,215,false,null);return}a.RenderAsync(c,this.$$d_$5cW)},$5cW:function(){if(this.$dL){var a=this.$dL.getElementsByTagName("a");a&&a.length>0&&a[0]&&this.$dL.style.display!=="none"&&a[0].focus();Common.$0.get_$r().$2u(1448619089,2);Diag.$2.$9(6612807,215,50,"O365 switcher tiles added to the DOM.")}},$fY:function(){if(!Sys.UI.DomElement.containsCssClass(this.$dL,"SwitcherError")){Sys.UI.DomElement.removeCssClass(this.$dL,"SwitcherLoading");Sys.UI.DomElement.addCssClass(this.$dL,"SwitcherError");Diag.$2.$9(7129104,215,10,"Failed to display O365 Shell Switcher.")}}};Common.App.O365Shell.$NG.$6BW=function(){};Common.App.O365Shell.$NG.$5za=function(){};Common.App.O365Shell.$47.registerClass("Common.App.O365Shell.$47",null,Common.App.$jx,Common.Utils.$l6);Common.App.O365Shell.$NG.registerClass("Common.App.O365Shell.$NG",null,Common.App.O365Shell.$S9);Common.App.O365Shell.$NG.$6BW.registerClass("Common.App.O365Shell.$NG.$6BW");Common.App.O365Shell.$NG.$5za.registerClass("Common.App.O365Shell.$NG.$5za");Common.App.O365Shell.$47.$5Sr();Type.registerNamespace("Common.App.Rename.RenameExecutor");Common.App.Rename.RenameExecutor.$PR=function(){};Common.App.Rename.RenameExecutor.$PR.$29f=function(a){try{return Common.$1s.$QA(a)}catch(b){}return null};Common.App.Rename.RenameExecutor.$Z8=function(){};Common.App.Rename.RenameExecutor.$Z8.prototype={$33p:null,$1F8:null,$vY:null};Common.App.Rename.RenameExecutor.$9s=function(a,b,c,d){this.$$d_$5bZ=Function.createDelegate(this,this.$5bZ);this.$$d_$5ba=Function.createDelegate(this,this.$5ba);this.$$d_$3mC=Function.createDelegate(this,this.$3mC);this.$$d_$1QO=Function.createDelegate(this,this.$1QO);this.$K=a;this.$60=b;this.$4L=c;this.$2bu=d};Common.App.Rename.RenameExecutor.$9s.get_$4=function(){return Common.App.Rename.RenameExecutor.$9s.$T||(Common.App.Rename.RenameExecutor.$9s.$T=Common.App.Rename.RenameExecutor.$9s.$2so())};Common.App.Rename.RenameExecutor.$9s.$2so=function(){return new Common.App.Rename.RenameExecutor.$9s(new($$sc.$x.$$(Common.$M5))(function(){return Common.$0.get_$r()}),new($$sc.$x.$$(Common.$Ij))(function(){return Common.$0.$7Q}),new($$sc.$x.$$(Common.$RN))(function(){return Common.$0.$Ic}),new($$sc.$x.$$(Common.$9N))(function(){return Common.Utils.$8.get_$4().$J(Common.$9N)}))};Common.App.Rename.RenameExecutor.$9s.prototype={$K:null,$60:null,$4L:null,$cP:false,$2bu:null,$3F:function(){this.get_$mt().$P(1851939779,2147483648,this.$$d_$1QO)},$1QO:function(c,d,e,f,b){var a=b;this.$3Pk(a,true);return 32},$3Pk:function(b,d){var c=this.$4Kt(b),a={};a["Content-Type"]="application/json; charset=utf-8";a.n=Common.$9.$8W(b.$33p);if(d)this.get_$33r().$DC(c,2,"",a,false,2,this.$$d_$3mC,this.$$d_$5ba,b,null,false,null,null,null);else this.get_$33r().$DC(c,2,"",a,false,2,this.$$d_$3mC,this.$$d_$5bZ,b,null,false,null,null,null)},$4Kt:function(){var a="renamehandler.ashx";a=Common.$q.$DB(a,"qs",Common.$9.$8W(Common.$0.$Tq));if(this.get_$Ic().get_$5MA())a=Common.$q.$DB(a,"sl","1");return a},$3mC:function(a){this.$cP=false;var b=a.$1v.$7c,c=Common.App.Rename.RenameExecutor.$PR.$29f(b);a.$1v.$8y.$1F8(c,this.$2bu.get_$Q())},$5ba:function(a){if(a.$1v.$3I===5&&!this.$cP){this.$cP=true;this.$3Pk(a.$1v.$8y,false)}else a.$1v.$8y.$vY(-1)},$5bZ:function(a){a.$1v.$8y.$vY(-1)},get_$mt:function(){return this.$K.get_$Q()},get_$33r:function(){return this.$60.get_$Q()},get_$Ic:function(){return this.$4L.get_$Q()}};Common.App.Rename.RenameExecutor.$47=function(){this.$$d_$1F5=Function.createDelegate(this,this.$1F5)};Common.App.Rename.RenameExecutor.$47.$1QO=function(b,c,d){var a=new Common.App.Rename.RenameExecutor.$Z8;a.$33p=b;a.$1F8=c;a.$vY=d;Common.$0.get_$r().$4J(1851939779,2,a)};Common.App.Rename.RenameExecutor.$47.prototype={get_$5j:function(){return"Common.App.RenameFile.RenameExecutor"},$t9:function(){},$7Y:function(){Common.$0.$o.$UQ(this.$$d_$1F5)},$1F5:function(){if(!Common.$0.$1mS())return;Common.App.Rename.RenameExecutor.$9s.get_$4().$3F();Common.$0.$1QO=Common.App.Rename.RenameExecutor.$47.$1QO},$d:function(){}};Common.App.Rename.RenameExecutor.$qL=function(){};Common.App.Rename.RenameExecutor.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.Rename.RenameExecutor.$47)};Common.App.Rename.RenameExecutor.$PR.registerClass("Common.App.Rename.RenameExecutor.$PR");Common.App.Rename.RenameExecutor.$Z8.registerClass("Common.App.Rename.RenameExecutor.$Z8");Common.App.Rename.RenameExecutor.$9s.registerClass("Common.App.Rename.RenameExecutor.$9s");Common.App.Rename.RenameExecutor.$47.registerClass("Common.App.Rename.RenameExecutor.$47",null,Common.App.$jx,Common.Utils.$l6);Common.App.Rename.RenameExecutor.$qL.registerClass("Common.App.Rename.RenameExecutor.$qL");Common.App.Rename.RenameExecutor.$9s.$T=null;Common.App.Rename.RenameExecutor.$qL.$5Sr();Type.registerNamespace("Common.App.SaveAsToHost");Common.App.SaveAsToHost.$lR=function(){};Common.App.SaveAsToHost.$lR.registerInterface("Common.App.SaveAsToHost.$lR");Common.App.SaveAsToHost.$Rg=function(){};Common.App.SaveAsToHost.$Rg.registerInterface("Common.App.SaveAsToHost.$Rg");Common.App.SaveAsToHost.$kt=function(){};Common.App.SaveAsToHost.$kt.registerInterface("Common.App.SaveAsToHost.$kt");Common.App.SaveAsToHost.$cP=function(){};Common.App.SaveAsToHost.$cP.registerInterface("Common.App.SaveAsToHost.$cP");Common.App.SaveAsToHost.$8u=function(){};Common.App.SaveAsToHost.$8u.get_$Gx=function(){return CommonUI.$4l.$Oc(Common.App.SaveAsToHost.$8u.$Ak,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)};Common.App.SaveAsToHost.$QV=function(a){this.$$d_$3sg=Function.createDelegate(this,this.$3sg);Common.App.SaveAsToHost.$QV.initializeBase(this);this.$K=a;this.$16Q=false};Common.App.SaveAsToHost.$QV.prototype={$K:null,$19F:false,$Vr:null,$B3:function(a,b,c){this.$Vr=b;this.$19F=c;Diag.$2.$9(8194008,216,50,"Display error with code:{0}, fileName:{1}, overwriteTarget:{2}.",a,b,c);a=this.$2lV(a);if(!a){this.set_$4T(6);this.$5l(0,CommonUIStrings.l_DialogClose)}else{this.set_$4T(0);this.$5l(1,CommonUIStrings.l_DialogClose)}!a&&Diag.$2.$9(8194009,216,50,"Show standard error dialog.");this.$Ne(26,this.$55R(a),this.$55Q(a,b),this.$$d_$3sg,!!a)},$3sg:function(a){if(a===1){Diag.$2.$9(8194010,216,50,"User click to retry button in error dialog.");if(this.$Vr)this.$K.$4J(2316717900,2,[this.$Vr,this.$19F]);else this.$K.$2u(2316717900,2)}else Diag.$2.$9(8194011,216,50,"User cancel the error dialog.")},$2lV:function(a){if(a<0||a>5){Diag.$2.$9(8194012,216,15,"Unexpected error code {0}.",a);return 0}return a},$55Q:function(a,b){a=this.$2lV(a);return([CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,b),CommonUIStrings.l_LockTargetText])[a]},$55R:function(a){a=this.$2lV(a);return([CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle])[a]}};Common.App.SaveAsToHost.$F5=function(a,b,c,d,e,f){this.$K=b;this.$3H=a;this.$PO=d;this.$10Y=f;this.$RO=e;this.$7k=c};Common.App.SaveAsToHost.$F5.prototype={$K:null,$PO:null,$10Y:null,$RO:null,$3H:null,$7k:null,$x:function(){return new Common.App.SaveAsToHost.$Qb(this.$3H,this.$K,this.$7k,this.$PO,this.$RO,this.$10Y)}};Common.App.SaveAsToHost.$Qb=function(a,b,c,d,e,f){this.$$d_$5ZN=Function.createDelegate(this,this.$5ZN);this.$$d_$3QB=Function.createDelegate(this,this.$3QB);Common.App.SaveAsToHost.$Qb.initializeBase(this);this.$K=b;this.$PO=d;this.$10Y=f;this.$5l(1,CommonUIStrings.l_SaveButtonLabel);this.$FN=Common.App.SaveAsToHost.$8u.get_$Gx();this.$3H=a;this.$RO=e;this.$7k=c};Common.App.SaveAsToHost.$Qb.prototype={$K:null,$PO:null,$10Y:null,$RO:null,$3H:null,$cR:null,$7k:null,$1i3:function(a,d){var b=Common.$9.$it(Common.$0.$Kq.get_$Q3()),c={txtFileName:a||b,lblFolderName:CommonUIStrings.l_ToCurrentFolder,chkOverwrite:d};this.$LB(CommonUIStrings.L_SaveAs,this.$$d_$3QB,c);this.$wD(1,!!a&&a!==b);this.$cR=$get("txtFileName");Common.$W.$1O(this.$cR,"change",this.$$d_$5ZN);Common.$W.$1O(this.$cR,"input",this.$$d_$5ZN);this.$cR.focus()},$3QB:function(e,d){if(e!==1)Diag.$2.$9(8194013,216,50,"User click cancel to cancel upload file in file name dialog.");else{var a=d.txtFileName,b=d.chkOverwrite;Diag.$2.$9(8194014,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",a,b);var c=Common.$9.$2tg(Common.$0.$Kq.get_$Q3());a=!a?null:a.trim();if((!a||a===""||c==="")&&this.$7k.get_$8y()!==1){this.$RO().$B3(2,a,b);return}if(this.$4rx(a)){this.$RO().$B3(1,a,b);return}this.$10Y.$2NJ(a+c,b)}},$4rx:function(a){return new RegExp("["+this.$4qt('\\/:*?"<>|#{}%~&')+"]").test(a)},$4qt:function(a){return a.replace(new RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")},$5ZN:function(){if(this.$cR){var b=Common.$9.$it(Common.$0.$Kq.get_$Q3()),a=this;window.setTimeout(function(){a.$wD(1,!!a.$cR&&a.$cR.value!==b)},0)}},dispose:function(){if(this.$cR){Common.$W.$2X(this.$cR,"change",this.$$d_$5ZN);Common.$W.$2X(this.$cR,"input",this.$$d_$5ZN);this.$cR=null}CommonUI.$4l.prototype.dispose.call(this)}};Common.App.SaveAsToHost.$Nz=function(a,b,c){this.$$d_$5rI=Function.createDelegate(this,this.$5rI);this.$10Y=c;this.$2Xm=b;this.$3H=a};Common.App.SaveAsToHost.$Nz.prototype={$3H:null,$2Xm:null,$10Y:null,$3F:function(){Common.$0.get_$r().$P(2316717900,2147483648,this.$$d_$5rI)},$5rI:function(e,f,d,g,b){if(f.get_$3t()!==2147483648||e!==2316717900)return 2;if(!this.$3H.$1A("SaveAsToHostBrsIsEnabled"))return 8;if(d===1)return 32;if(d===2){var a=b;Diag.$2.$9(8194015,216,50,"User clicked on SaveAsToHost button from the backstage.");var c=this.$2Xm.$x();if(b&&Object.getType(b)===Array&&a.length===2)c.$1i3(a[0],!!a[1]);else c.$1i3(null,false);return 32}return 8}};Common.App.SaveAsToHost.$fw=function(){};Common.App.SaveAsToHost.$fw.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.SaveAsToHost.$fw)};Common.App.SaveAsToHost.$fw.prototype={$U:null,get_$5j:function(){return"Common.App.SaveAsToHost"},$7Y:function(){Common.$0.$o.$1A("SaveAsToHostBrsIsEnabled")&&this.$U.$J(Common.App.SaveAsToHost.$Nz).$3F()},$t9:function(a){this.$U=a;var b=this;this.$U.$e(Common.App.SaveAsToHost.$K6).$1p(Common.App.SaveAsToHost.$cP).$n(function(){return new Common.App.SaveAsToHost.$K6(Common.$0.$o,Common.$0.$7Q,function(){return Common.$0.$6B},function(){return new CommonUI.$Ff},function(){return new Common.App.SaveAsToHost.$QV(Common.$0.get_$r())},Common.$0.get_$1Y(),Common.$0.get_$1Y().get_$CN())}).$p();var c=this;this.$U.$e(Common.App.SaveAsToHost.$F5).$1p(Common.App.SaveAsToHost.$Rg).$n(function(){return new Common.App.SaveAsToHost.$F5(Common.$0.$o,Common.$0.get_$r(),Common.$0.get_$1Y(),Common.$0.get_$1Y().get_$Hf(),function(){return new Common.App.SaveAsToHost.$QV(Common.$0.get_$r())},a.$J(Common.App.SaveAsToHost.$K6))}).$p();var d=this;this.$U.$e(Common.App.SaveAsToHost.$Nz).$n(function(){return new Common.App.SaveAsToHost.$Nz(Common.$0.$o,a.$J(Common.App.SaveAsToHost.$F5),a.$J(Common.App.SaveAsToHost.$K6))}).$p()},$d:function(){}};Common.App.SaveAsToHost.$K6=function(a,b,c,d,e,f,g){this.$$d_$5d3=Function.createDelegate(this,this.$5d3);this.$$d_$5d4=Function.createDelegate(this,this.$5d4);this.$3H=a;this.$1Oe=this.$3H.$5G.WebServiceBase;this.$1zB=c;this.$1Mg=d;this.$60=b;this.$RO=e;this.$4A=g;this.$7k=f};Common.App.SaveAsToHost.$K6.prototype={$7k:null,$OG:null,$1Mg:null,$RO:null,$60:null,$1zB:null,$3H:null,$1Oe:null,$cP:false,$19F:false,$Vr:null,$4A:null,$mo:null,$37F:function(){if(this.$7k.get_$8y()!==1){this.$OG=this.$1Mg();this.$OG.set_$Iw(CommonUIStrings.l_CommentProgressTooltip);this.$OG.set_$4T(5);this.$OG.set_$2Ev(false);this.$OG.$1WF(CommonUIStrings.l_DefaultDialogTitle,null,null)}},$fX:function(a){this.$7k.get_$8y()!==1&&this.$RO().$B3(a,Common.$9.$it(this.$Vr),this.$19F)},$32y:function(){var a=this.$3H.$5G.BreadcrumbFolderUrl;Diag.$2.$9(8194016,216,50,"Redirecting to OneDrive for business Folder.");window.open(a,Common.$J.$15j(3))},$32x:function(a){Diag.$2.$9(8194017,216,50,"Redirecting to edit url {0}.",a);window.open(a,Common.$J.$15j(3))},$2NJ:function(a,b){Diag.$2.$9(8194018,216,50,"Starting to upload file");if(this.$1zB&&!this.$1zB()&&this.$60){if(this.$4A)this.$mo=this.$4A.$8G("DialogShown","SaveAsToHostUploadTime");this.$37F();this.$19F=b;this.$Vr=a;this.$1QP()}},$1QP:function(){var b={};b["Content-Type"]="application/json; charset=utf-8";var a=this.$1Oe+"hostuploadhandler.ashx";a=Common.$q.$DB(a,"qs",Common.$9.$8W(Common.$0.$Tq));a=Common.$q.$DB(a,"n",Common.$9.$8W((+new Date).toString()));a=Common.$q.$DB(a,"ov",Common.$9.$8W(this.$19F.toString()));a=Common.$q.$DB(a,"fn",Common.$9.$8W(this.$Vr));this.$60.$DC(a,1,"",b,false,2,this.$$d_$5d4,this.$$d_$5d3,null,null,false,null,null,null)},$5d4:function(b){this.$1i2();this.$cP=false;if(!b||!b.$1v||!b.$1v.$7c){Diag.$2.$9(8194019,216,10,"UploadToHostManager failure. Response data is null");this.$fX(0);return}var c,d,e;if(!(e=Common.$1s.$2OG(b.$1v.$7c,d={val:c}),c=d.val,e)){Diag.$2.$9(8194048,216,10,"Failed to deserialize : {0}",{ResponseData:Common.Utils.$FR.$39K(b.$1v.$7c)});this.$fX(0);return}var a=c;if(a.StatusCode!==200&&a.StatusCode!==201){Diag.$2.$9(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");this.$fX(parseInt(a.ExtraInfo));return}Diag.$2.$9(8194050,216,50,"UploadToHost execute success.");if(a.NewDocumentUrl&&a.NewDocumentUrl!=="")this.$32x(a.NewDocumentUrl);else this.$32y();this.$2KA()},$5d3:function(a){if((a.$1v.$3I===5||a.$1v.$3I===12)&&!this.$cP){Diag.$2.$9(8194051,216,10,"UploadToHostManager failure. Retry automatically.");this.$cP=true;this.$1QP()}else{Diag.$2.$9(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",a.$1v.$3I);this.$1i2();this.$fX(0);this.$2KA()}},$1i2:function(){if(this.$OG){this.$OG.$1BT();this.$OG=null}},$2KA:function(){if(this.$mo){this.$mo.$4x();this.$mo=null}}};Common.App.SaveAsToHost.$8u.registerClass("Common.App.SaveAsToHost.$8u");Common.App.SaveAsToHost.$QV.registerClass("Common.App.SaveAsToHost.$QV",CommonUI.$4j,Common.App.SaveAsToHost.$lR);Common.App.SaveAsToHost.$F5.registerClass("Common.App.SaveAsToHost.$F5",null,Common.App.SaveAsToHost.$Rg);Common.App.SaveAsToHost.$Qb.registerClass("Common.App.SaveAsToHost.$Qb",CommonUI.$4l,Common.App.SaveAsToHost.$kt);Common.App.SaveAsToHost.$Nz.registerClass("Common.App.SaveAsToHost.$Nz");Common.App.SaveAsToHost.$fw.registerClass("Common.App.SaveAsToHost.$fw",null,Common.App.$jx,Common.Utils.$l6);Common.App.SaveAsToHost.$K6.registerClass("Common.App.SaveAsToHost.$K6",null,Common.App.SaveAsToHost.$cP);Common.App.SaveAsToHost.$8u.$Ak="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput'/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\\\"WACDialogInlineLabel\\\"' for='chkOverwrite'>{1}</label> </div>";Common.App.SaveAsToHost.$fw.$5Sr();Type.registerNamespace("Common.App.SaveToCloudStorage");Common.App.SaveToCloudStorage.$lS=function(){};Common.App.SaveToCloudStorage.$lS.registerInterface("Common.App.SaveToCloudStorage.$lS");Common.App.SaveToCloudStorage.$Sa=function(){};Common.App.SaveToCloudStorage.$Sa.registerInterface("Common.App.SaveToCloudStorage.$Sa");Common.App.SaveToCloudStorage.$cD=function(){};Common.App.SaveToCloudStorage.$cD.registerInterface("Common.App.SaveToCloudStorage.$cD");Common.App.SaveToCloudStorage.$lX=function(){};Common.App.SaveToCloudStorage.$lX.registerInterface("Common.App.SaveToCloudStorage.$lX");Common.App.SaveToCloudStorage.$lY=function(){};Common.App.SaveToCloudStorage.$lY.registerInterface("Common.App.SaveToCloudStorage.$lY");Common.App.SaveToCloudStorage.$cE=function(){};Common.App.SaveToCloudStorage.$cE.registerInterface("Common.App.SaveToCloudStorage.$cE");Common.App.SaveToCloudStorage.$Su=function(){};Common.App.SaveToCloudStorage.$Su.registerInterface("Common.App.SaveToCloudStorage.$Su");Common.App.SaveToCloudStorage.$QU=function(){Common.App.SaveToCloudStorage.$QU.initializeBase(this);this.set_$4T(0);this.$5l(1,CommonUIStrings.l_DialogClose)};Common.App.SaveToCloudStorage.$QU.prototype={$B3:function(a){this.$Ne(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}};Common.App.SaveToCloudStorage.$47=function(){};Common.App.SaveToCloudStorage.$47.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.SaveToCloudStorage.$47)};Common.App.SaveToCloudStorage.$47.prototype={$U:null,get_$5j:function(){return"Common.App.SaveToCloudStorage"},$7Y:function(){Common.$0.$o.$1A("SaveToCloudStorageUIIsEnabled")&&this.$U.$J(Common.App.SaveToCloudStorage.$7n).$3F()},$d:function(){},$t9:function(a){this.$U=a;var b=this;this.$U.$e(Common.App.SaveToCloudStorage.$Jn).$1p(Common.App.SaveToCloudStorage.$cD).$n(function(){return new Common.App.SaveToCloudStorage.$Jn(Common.$0.get_$r(),Common.$4w.get_$4(),Common.$0.get_$1Y().get_$Hf())}).$p();var c=this;this.$U.$e(Common.App.SaveToCloudStorage.$Jq).$1p(Common.App.SaveToCloudStorage.$cE).$n(function(){return new Common.App.SaveToCloudStorage.$Jq(Common.$0.$o,Common.$0.$Tq)}).$p();var d=this;this.$U.$e(Common.App.SaveToCloudStorage.$7n).$n(function(){return new Common.App.SaveToCloudStorage.$7n(a.$J(Common.App.SaveToCloudStorage.$O1),Common.$0.$o,Common.$0.get_$1Y().get_$CN())}).$p();var e=this;this.$U.$e(Common.App.SaveToCloudStorage.$K5).$1p(Common.App.SaveToCloudStorage.$Su).$n(function(){return new Common.App.SaveToCloudStorage.$K5(a.$J(Common.App.SaveToCloudStorage.$Jq),function(){return new CommonUI.$Ff},function(){return new Common.App.SaveToCloudStorage.$QU},Common.$0.get_$1Y(),Common.$0.get_$1Y().get_$CN())}).$p();var f=this;this.$U.$e(Common.App.SaveToCloudStorage.$O1).$1p(Common.App.SaveToCloudStorage.$Sa).$n(function(){return new Common.App.SaveToCloudStorage.$O1(a.$J(Common.App.SaveToCloudStorage.$Jn),Common.$4w.get_$4(),a.$J(Common.App.SaveToCloudStorage.$K5),Common.$0.$o,Common.$0.$1HI,function(){return new Common.App.SaveToCloudStorage.$QU})}).$p()}};Common.App.SaveToCloudStorage.$7n=function(a,b,c){this.$$d_$5rd=Function.createDelegate(this,this.$5rd);this.$2g5=a;this.$3H=b;this.$1rJ=new($$sc.$5l.$$(Boolean));this.$4A=c};Common.App.SaveToCloudStorage.$7n.$3Zt=function(b){if(!Common.App.SaveToCloudStorage.$7n.$1dJ&&b){var a=b.$5G.OneDriveApiUrl;Common.App.SaveToCloudStorage.$7n.$1dJ=a?Common.$5j.$x(a,null,null,null,false):null}return Common.App.SaveToCloudStorage.$7n.$1dJ};Common.App.SaveToCloudStorage.$7n.prototype={$2g5:null,$3H:null,$4A:null,$1eJ:null,$1rJ:null,$5PL:function(){return this.$3H.$1A("SaveToCloudStorageUIIsEnabled")},$52R:function(){return 617689800},$4MB:function(){Common.$31.$2Kf(this.$$d_$5rd);Common.$31.$2A8([new Common.$5L(617689800,2147483648,0)],Common.App.SaveToCloudStorage.$7n.$3Zt(this.$3H))},$3F:function(){var a=Common.App.SaveToCloudStorage.$7n.$3Zt(this.$3H);if(a){var b=this;a.add_$XF(function(){b.$1rJ.$9D(true)});this.$4MB()}else Diag.$2.$9(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")},$5kP:function(){Diag.$2.$9(6590597,216,50,"User clicked on SaveToOneDrive button")},$5rd:function(c,d,b){if(d.get_$3t()!==2147483648||c!==this.$52R())return 2;if(!this.$5PL())return 8;if(b===1)return 32;if(b===2){this.$5kP();if(this.$4A)this.$1eJ=this.$4A.$8G("DialogShown","SaveToOneDriveReponseTime");var a=this;this.$1rJ.get_$8z().CW(function(){if(a.$1eJ){a.$1eJ.$4x();a.$1eJ=null}a.$2g5.$2k()});return 32}return 8}};Common.App.SaveToCloudStorage.$O1=function(a,b,c,d,e,f){this.$$d_$vY=Function.createDelegate(this,this.$vY);this.$$d_$1F8=Function.createDelegate(this,this.$1F8);this.$2h3=a;this.$WE=b;this.$sc=c;this.$3H=d;this.$1uS=e;this.$RO=f};Common.App.SaveToCloudStorage.$O1.prototype={$2h3:null,$RO:null,$WE:null,$sc:null,$3H:null,$1uS:0,$2k:function(){if(this.$WE.get_$2Ft()){Diag.$2.$9(6590559,216,50,"User is signed in. We will show file picker.");this.$4MC()}else{Diag.$2.$9(6590560,216,50,"User is not signed in. We will show sign in dialog.");this.$61a()}},$61a:function(){var a=this.$2h3.$x();a.$1i3()},$K8:function(){this.$RO().$B3(18)},$4MC:function(){try{Diag.$2.$9(6590561,216,50,"Initializing OneDrive API");var a={client_id:this.$3H.$5G.UploadToSkyDriveClientId,env:"INT"};if(this.$1uS===1||this.$1uS===2)a={client_id:this.$3H.$5G.UploadToSkyDriveClientId};var b={mode:"save",lightbox:"grey"};WL.init(a);Diag.$2.$9(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(b).then(this.$$d_$1F8,this.$$d_$vY)}catch(c){Diag.$2.$9(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",c,c.stack);this.$K8()}},$1F8:function(a){Diag.$2.$9(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");a&&a.data&&a.data.folders&&this.$sc.$2NJ(a.data.folders[0].id,a.data.folders[0].urls.viewInBrowser,null)},$vY:function(a){if(a&&a.error){if(a.error.code==="user_canceled"){Diag.$2.$9(6590593,216,50,"User cancelled upload to their OneDrive.");return}Diag.$2.$9(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,a.error.message)}else Diag.$2.$9(6590595,216,50,"File Dialog returned with no response");this.$K8()}};Common.App.SaveToCloudStorage.$Jn=function(a,b,c){this.$K=a;this.$WE=b;this.$PO=c};Common.App.SaveToCloudStorage.$Jn.prototype={$K:null,$WE:null,$PO:null,$x:function(){return new Common.App.SaveToCloudStorage.$gt(this.$K,this.$WE,this.$PO)}};Common.App.SaveToCloudStorage.$gt=function(a,b,c){this.$$d_$5JD=Function.createDelegate(this,this.$5JD);this.$$d_$5cD=Function.createDelegate(this,this.$5cD);Common.App.SaveToCloudStorage.$gt.initializeBase(this);this.$K=a;this.$WE=b;this.$PO=c;this.$rA=false;this.set_$4T(1);this.$151(1);this.$5l(1,CommonUIStrings.l_SignIn);this.$5l(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)};Common.App.SaveToCloudStorage.$gt.prototype={$K:null,$WE:null,$PO:null,$1i3:function(){this.$WE.add_$2kN(this.$$d_$5cD);this.$Sc(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.$$d_$5JD)},$5JD:function(a){if(!a){Diag.$2.$9(6590598,216,50,"User dismissed SignIn Dialog.");this.$9M();return}this.$32H()},$4NS:function(){var a="2";if(this.$PO)switch(this.$PO.get_$oz()){case 3:a="0";break;case 2:a="3";break;case 1:a="1"}return a},$9M:function(){this.$WE.remove_$2kN(this.$$d_$5cD);CommonUI.$1k.prototype.$9M.call(this)},$32H:function(){var a=new Common.$9W("Signin.aspx");a.$Ah("prompt","1");a.$Ah("cbcxt",this.$4NS());Common.$0.$10j(a);window.open(a.toString(),"LoginWindow")},$5cD:function(){this.$79&&this.$9M();Diag.$2.$9(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.$K.$2u(617689800,2)}};Common.App.SaveToCloudStorage.$h0=function(a,b,c,d,e){this.$1Oe=a;this.$Vr=b;this.$1xR=c;this.$1KE=d;this.$2fA=e};Common.App.SaveToCloudStorage.$h0.prototype={$1Oe:null,$Vr:null,$1xR:null,$1KE:null,$2fA:null,$46:function(c,d){if(Common.$0.$6B||!Common.$0.$7Q)return;var b={};b["Content-Type"]="application/json; charset=utf-8";var a=this.$1Oe+"skydriveuploadhandler.ashx";a=Common.$q.$DB(a,"fo",Common.$9.$8W(this.$1KE));a=Common.$q.$DB(a,"fn",Common.$9.$8W(this.$Vr));a=Common.$q.$DB(a,"qs",Common.$9.$8W(this.$2fA));a=Common.$q.$DB(a,"n",Common.$9.$8W((+new Date).toString()));if(this.$1xR)a=Common.$q.$DB(a,"fnn",Common.$9.$8W(this.$1xR));Common.$0.$7Q.$DC(a,1,"",b,false,2,c,d,null,null,false,null,null,null)}};Common.App.SaveToCloudStorage.$Jq=function(a,b){this.$3H=a;this.$1Of=a.$5G.WebServiceBase;this.$Vr=a.$5G.FileName;this.$19l=b};Common.App.SaveToCloudStorage.$Jq.prototype={$1Of:null,$Vr:null,$19l:null,$3H:null,$x:function(a,b){return new Common.App.SaveToCloudStorage.$h0(this.$1Of,this.$Vr,b,a,this.$19l)}};Common.App.SaveToCloudStorage.$K5=function(a,b,c,d,e){this.$$d_$5bv=Function.createDelegate(this,this.$5bv);this.$$d_$5bw=Function.createDelegate(this,this.$5bw);this.$2ib=a;this.$1Mg=b;this.$RO=c;this.$7k=d;this.$4A=e};Common.App.SaveToCloudStorage.$K5.prototype={$2ib:null,$2VC:null,$OG:null,$7k:null,$1KF:null,$1Mg:null,$RO:null,$cP:false,$4A:null,$mo:null,$37F:function(){if(this.$7k&&this.$7k.get_$8y()===1)return;this.$OG=this.$1Mg();this.$OG.set_$Iw(CommonUIStrings.l_CommentProgressTooltip);this.$OG.set_$4T(5);this.$OG.set_$2Ev(false);this.$OG.$1WF(CommonUIStrings.l_DefaultDialogTitle,null,null)},$1i2:function(){if(this.$OG){this.$OG.$1BT();this.$OG=null}},$fX:function(){if(Common.$0.get_$1Y().get_$8y()===1)return;this.$RO().$B3(17)},$32y:function(){Diag.$2.$9(6590599,216,50,"Redirecting to OneDrive Folder.");window.open(this.$1KF,Common.$J.$15j(3))},$32x:function(a){Diag.$2.$9(6654163,216,50,"Redirecting to edit url {0}.",a);window.open(a,Common.$J.$15j(3))},$2NJ:function(a,b,c){Diag.$2.$9(7143886,216,50,"Starting to upload file");if(this.$4A)this.$mo=this.$4A.$8G("DialogShown","SaveToOneDriveUploadTime");this.$37F();this.$1KF=b;this.$2VC=this.$2ib.$x(a,c);this.$1QP()},$1QP:function(){Diag.$2.$9(6590600,216,50,"Calling SkydriveUploadHandler.");this.$2VC.$46(this.$$d_$5bw,this.$$d_$5bv)},$5bw:function(b){this.$1i2();this.$cP=false;if(!b||!b.$1v||!b.$1v.$7c){Diag.$2.$9(6590601,216,10,"UploadToCloudManager upload failure. Response data is null");this.$fX();return}var c,d,e;if(!(e=Common.$1s.$2OG(b.$1v.$7c,d={val:c}),c=d.val,e)){Diag.$2.$9(7660114,216,10,"Failed to deserialize : {0}",{ResponseData:Common.Utils.$FR.$39K(b.$1v.$7c)});this.$fX();return}var a=c;if(a.StatusCode!==200&&a.StatusCode!==201){Diag.$2.$9(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON.");this.$fX();return}Diag.$2.$9(6590603,216,50,"UploadToCloudManager upload success.");if(a.NewDocumentUrl&&a.NewDocumentUrl!=="")this.$32x(a.NewDocumentUrl);else this.$32y();this.$2KA()},$5bv:function(a){if((a.$1v.$3I===5||a.$1v.$3I===12)&&!this.$cP){Diag.$2.$9(6590604,216,10,"UploadToCloudManager failure. Retrying.");this.$cP=true;this.$1QP()}else{Diag.$2.$9(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",a.$1v.$3I);this.$1i2();this.$fX();this.$2KA()}},$2KA:function(){if(this.$mo){this.$mo.$4x();this.$mo=null}}};Common.App.SaveToCloudStorage.$QU.registerClass("Common.App.SaveToCloudStorage.$QU",CommonUI.$4j,Common.App.SaveToCloudStorage.$lS);Common.App.SaveToCloudStorage.$47.registerClass("Common.App.SaveToCloudStorage.$47",null,Common.App.$jx,Common.Utils.$l6);Common.App.SaveToCloudStorage.$7n.registerClass("Common.App.SaveToCloudStorage.$7n");Common.App.SaveToCloudStorage.$O1.registerClass("Common.App.SaveToCloudStorage.$O1",null,Common.App.SaveToCloudStorage.$Sa);Common.App.SaveToCloudStorage.$Jn.registerClass("Common.App.SaveToCloudStorage.$Jn",null,Common.App.SaveToCloudStorage.$cD);Common.App.SaveToCloudStorage.$gt.registerClass("Common.App.SaveToCloudStorage.$gt",CommonUI.$4j,Common.App.SaveToCloudStorage.$lX);Common.App.SaveToCloudStorage.$h0.registerClass("Common.App.SaveToCloudStorage.$h0",null,Common.App.SaveToCloudStorage.$lY);Common.App.SaveToCloudStorage.$Jq.registerClass("Common.App.SaveToCloudStorage.$Jq",null,Common.App.SaveToCloudStorage.$cE);Common.App.SaveToCloudStorage.$K5.registerClass("Common.App.SaveToCloudStorage.$K5",null,Common.App.SaveToCloudStorage.$Su);Common.App.SaveToCloudStorage.$7n.$1dJ=null;Common.App.SaveToCloudStorage.$47.$5Sr();Type.registerNamespace("CATypingSpeedMeter");CATypingSpeedMeter.$Of=function(a){this.$AP=new($$sc.$5l.$$(Common.$St));this.$C5=a};CATypingSpeedMeter.$Of.prototype={$C5:null,$1OI:null,$AP:null,$40v:function(){return this.$1OI},$5Dg:function(){return this.$AP.get_$8z()},$8F:function(a,b,c,d){if(!this.$1OI){this.$1OI=new CATypingSpeedMeter.$iW(this.$C5,a,b,c,d);this.$AP.$9D(this.$1OI)}return this.$1OI}};CATypingSpeedMeter.$iW=function(a,b,c,d,e){this.$$d_$145=Function.createDelegate(this,this.$145);this.$25f=new Common.$2y;this.$C5=a;this.$Ny=b;this.$Ny.add_$145(this.$$d_$145);this.$2iQ=c;this.$2ce=e;this.$2i8=d};CATypingSpeedMeter.$iW.prototype={$2IJ:null,$1Ez:0,$2i8:0,$2ce:0,$25O:0,$1fJ:0,$2WK:0,$C5:null,$Ny:null,$2iQ:null,add_$31l:function(a){this.$25f.$1O("TypingSpeedWindowAvailable",a)},remove_$31l:function(a){this.$25f.$2X("TypingSpeedWindowAvailable",a)},$145:function(b,a){this.$2IJ=a.$16D},$2yt:function(){var b=this.$C5();b-this.$1fJ>this.$2i8&&this.$3sN();if(!this.$1Ez)this.$25O=b;this.$1fJ=b;this.$1Ez++;if(this.$1Ez>=this.$2ce){this.$25f.$27("TypingSpeedWindowAvailable",new Common.$iX(this.$3IH()));var a=new Common.$Og;a.TS=this.$3IH();if(this.$2IJ)a.CP=this.$2IJ.CP;a.EC=this.$2WK;this.$2iQ.$bG(a,null);this.$3sN()}},$3sN:function(){this.$1Ez=0;this.$25O=0;this.$1fJ=0},$3IH:function(){return this.$1Ez<2?0:Math.round((this.$1Ez-1)*1e3*60/(this.$1fJ-this.$25O))},$68o:function(a){this.$2WK=a},$d:function(){this.$Ny.remove_$145(this.$$d_$145)}};CATypingSpeedMeter.$iY=function(){};CATypingSpeedMeter.$iY.$5Sr=function(){Common.App.$f.get_$4().$3M(new CATypingSpeedMeter.$iY)};CATypingSpeedMeter.$iY.prototype={$dQ:null,get_$5j:function(){return"Common.App.TypingSpeedMeter"},$7Y:function(){if(Common.$0.$o.$1A("TypingSpeedMeterIsEnabled")){var c=1,d=Common.Utils.$8.get_$4().$J(CATypingSpeedMeter.$Of),a=Common.Utils.$5U.$V9(Common.$Gj,Common.Utils.$8.get_$4().$3j(Common.$Gj)),b=this;a.CW(function(){var e=a.get_$5k().$3XX(),i=new Common.$Nf(Common.$0.$o.$5L("TypingSpeedMeterWindowSamplingPercent",0)/100),j=new(Common.Utils.Aggregators.$Je.$$(Common.$Og))(i.$$d_$36s),f=Common.Utils.Aggregators.$8o.$$(Common.$Og).$EV(12,c,j,true),g=Common.$0.$o.$5L("TypingSpeedMeterWindowTimeoutMs",5e3),h=Common.$0.$o.$5L("TypingSpeedMeterMaxKeystrokesPerWindow",5);e.CWR(Common.$St,function(){return b.$dQ=d.$8F(e.get_$5k(),f,g,h)})})}},$d:function(){this.$dQ&&this.$dQ.$d()},$t9:function(a){var b=this;a.$e(CATypingSpeedMeter.$Of).$1p(Common.$J8).$p().$n(function(){return new CATypingSpeedMeter.$Of(Common.$J.$1ks)})}};CATypingSpeedMeter.$Of.registerClass("CATypingSpeedMeter.$Of",null,Common.$J8);CATypingSpeedMeter.$iW.registerClass("CATypingSpeedMeter.$iW",null,Common.$St);CATypingSpeedMeter.$iY.registerClass("CATypingSpeedMeter.$iY",null,Common.App.$jx,Common.Utils.$l6);CATypingSpeedMeter.$iY.$5Sr();Type.registerNamespace("AppRealtimeChannel");AppRealtimeChannel.$mz=function(){};AppRealtimeChannel.$mz.registerInterface("AppRealtimeChannel.$mz");AppRealtimeChannel.$ms=function(){};AppRealtimeChannel.$ms.registerInterface("AppRealtimeChannel.$ms");AppRealtimeChannel.$lQ=function(){};AppRealtimeChannel.$lQ.registerInterface("AppRealtimeChannel.$lQ");AppRealtimeChannel.$ma=function(){};AppRealtimeChannel.$ma.registerInterface("AppRealtimeChannel.$ma");AppRealtimeChannel.$kH=function(){};AppRealtimeChannel.$kH.registerInterface("AppRealtimeChannel.$kH");AppRealtimeChannel.$kJ=function(){};AppRealtimeChannel.$kJ.registerInterface("AppRealtimeChannel.$kJ");AppRealtimeChannel.$kF=function(){};AppRealtimeChannel.$kF.registerInterface("AppRealtimeChannel.$kF");AppRealtimeChannel.$cM=function(){};AppRealtimeChannel.$cM.registerInterface("AppRealtimeChannel.$cM");AppRealtimeChannel.$bZ=function(){};AppRealtimeChannel.$bZ.registerInterface("AppRealtimeChannel.$bZ");AppRealtimeChannel.$kC=function(){};AppRealtimeChannel.$kC.registerInterface("AppRealtimeChannel.$kC");AppRealtimeChannel.$kU=function(){};AppRealtimeChannel.$kU.registerInterface("AppRealtimeChannel.$kU");AppRealtimeChannel.$Bg=function(){};AppRealtimeChannel.$Bg.prototype={unspecified:0,word:1,excel:2,powerPoint:3,test:4,wacFrontEnd:5,last:6};AppRealtimeChannel.$Bg.registerEnum("AppRealtimeChannel.$Bg",false);AppRealtimeChannel.$9A=function(){};AppRealtimeChannel.$9A.prototype={contentUpdate:0,editorsTableUpdate:1,fileNameUpdate:2,wetContentUpdate:3,persistedContentUpdate:4,clientRtcReconnectRequest:5,replicationTelemetry:6,lockUpdate:7,last:8};AppRealtimeChannel.$9A.registerEnum("AppRealtimeChannel.$9A",false);AppRealtimeChannel.$GK=function(a){this.$$d_$5SW=Function.createDelegate(this,this.$5SW);this.$kh=AppRealtimeChannel.$GK.$2nr;this.$wr=AppRealtimeChannel.$GK.$3Mr;this.$2Rs=this.$$d_$5SW;this.$2ZY=a};AppRealtimeChannel.$GK.$2nr=function(a,b){return window.setTimeout(a,b)};AppRealtimeChannel.$GK.$3Mr=function(a){window.clearTimeout(a)};AppRealtimeChannel.$GK.prototype={$Ri:false,$sS:0,$1vr:false,$2ZY:null,$kh:null,$wr:null,$2Rs:null,$5YT:function(){if(this.$Ri)return;var a=this;this.$sS=this.$kh(function(){a.$Ri=false;a.$3hz()},8e3);this.$Ri=true;this.$1vr=false},$5Ys:function(){this.$117()},$5cR:function(){this.$3hz()},$3hz:function(){this.$117();if(this.$1vr)return;this.$1vr=true;this.$2Rs()},$5SW:function(){Diag.$2.$9(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.$2ZY)},$117:function(){this.$Ri&&this.$wr(this.$sS);this.$sS=0;this.$Ri=false}};AppRealtimeChannel.$iq=function(a,b){this.$3I=a;this.$3h8=b};AppRealtimeChannel.$iq.prototype={$3I:0,$3h8:null};AppRealtimeChannel.$ik=function(a,b){AppRealtimeChannel.$ik.initializeBase(this);this.$6a=a;this.$1fU=b};AppRealtimeChannel.$ik.prototype={$6a:0,$1fU:null};AppRealtimeChannel.$5c=function(f,g,c,h,i,j,k,l,m,n,a,d,e){this.$$d_$5l6=Function.createDelegate(this,this.$5l6);this.$$d_$5cC=Function.createDelegate(this,this.$5cC);this.$$d_$5cB=Function.createDelegate(this,this.$5cB);this.$$d_$5cH=Function.createDelegate(this,this.$5cH);this.$$d_$2JQ=Function.createDelegate(this,this.$2JQ);this.$$d_$va=Function.createDelegate(this,this.$va);this.$$d_$5ct=Function.createDelegate(this,this.$5ct);this.$3sF=["enabled","errorMessage","url","connectionString","queryString","throttling_globalMaxNumberOfOutstandingMessages","throttling_maxNumberOfOutstandingMessages","throttling_timeToWaitForResponse","throttling_messageDelay"];this.$3sE=["enabled","errorMessage"];this.$W9={};this.$209=+new Date(0);this.$2bV=+new Date(0);AppRealtimeChannel.$5c.initializeBase(this);this.$2Vq=f;this.$2f7=g;this.$PT=h;this.$N9=j;this.$1OD=k;this.$60=c;this.$KU=0;this.$4A=l;this.$21M=0;this.$21O=0;this.$2Xz=m;this.$2cW=e;this.$1Zn=new AppRealtimeChannel.$GK(AppRealtimeChannel.$Bg.toString(a));if(!this.$N9)this.$N9=Common.$1O.$x().toString();this.$1Ad=new AppRealtimeChannel.$iD(d);this.$1Ad.add_$39C(this.$$d_$5ct);this.$Pb=String.format("{0}={1}","qs",Common.$9.$8W(i));this.$Pb=String.format("{0}&{1}={2}",this.$Pb,"ClientId",Common.$9.$8W(this.$PT));this.$Pb=String.format("{0}&{1}={2}",this.$Pb,"usid",Common.$9.$8W(this.$N9));this.$Pb=String.format("{0}&{1}={2}",this.$Pb,"UserApp",Common.$9.$8W(a.toString()));this.$Pb=String.format("{0}&{1}={2}",this.$Pb,"UserType",Common.$9.$8W((1).toString()));this.$Pb=String.format("{0}&{1}={2}",this.$Pb,"UserVersion",Common.$9.$8W(n));this.$Pb=String.format("{0}&{1}={2}",this.$Pb,"clientProtocol",Common.$9.$8W("1.0"));var b=this.$539(a,c);if(b)this.$Pb=String.format("{0}&{1}",this.$Pb,b);this.$3Lr();AppRealtimeChannel.$5c.$5z5();this.$4nA()};AppRealtimeChannel.$5c.$7s=function(a,b,c,d,e,f,g,h,i){return AppRealtimeChannel.$Tm.$7s(a,b,c,d,e,f,g,h,i)};AppRealtimeChannel.$5c.$4d1=function(g,h,i,b,j,k,l,m,n){var c=b?b.split(","):null,a="/rtc2",d=a+"/signalr",e=a+"/findsession",f=new AppRealtimeChannel.$5c(function(){return $.hubConnection(d)},function(a){return new AppRealtimeChannel.$fE(a.createHubProxy("realtimeChannelHub"))},j,g,h,i,c,m,e,k,l,new AppRealtimeChannel.$iC,n);return f};AppRealtimeChannel.$5c.$280=function(d){var a;try{a=Common.$1s.$5B(d)}catch(e){var b=String.format("Failed to JSON-serialize payload : {0}",e);Diag.$2.$9(3457859,500,10,b);throw Error.argument("payload",b);}if(a.length>8e3){var c=String.format("Payload exceeds maximum length: {0} > {1} : {2}",a.length,8e3,a);Diag.$2.$9(3457861,500,10,c);throw Error.argument("payload",c);}return a};AppRealtimeChannel.$5c.$QA=function(a,e,f,g){if(!a)return null;if(Object.getType(a)!==String){var b;if(g)try{b=AppRealtimeChannel.$5c.$280(a)}catch(k){b=String.format("Failed to JSON serialize the object with exception [{0}]",k)}else b="not allowed to log the object";var h=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}]. Object: [{3}].",e,Object.getType(a).getName(),f,b);Diag.$2.$9(8721928,500,10,h);return null}var c=null,d=a;try{c=Common.$1s.$QA(d)}catch(l){var i=g?d:"not allowed to log the object",j=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}]. Object: [{3}]",e,l,f,i);Diag.$2.$9(3457863,500,10,j)}return c};AppRealtimeChannel.$5c.$1no=function(a){if(!a)return"";if(String.isInstanceOfType(a))return a.toString();try{return Common.$1s.$5B(a)}catch(b){return a.toString()}};AppRealtimeChannel.$5c.$5z5=function(){};AppRealtimeChannel.$5c.prototype={$5ct:function(){Diag.$2.$9(4318727,500,15,"Too many undelivered messages. Restarting RTC connection.");this.$11Y()},$539:function(b,a){return b===4?String.format("{0}={1}","NoAuth","1"):a?a.$5Dx():null},$4nA:function(){try{var a=$.signalR;if(!a)throw Error.invalidOperation("Failed to retrieve signalr object");var c=a.version;if(!c)throw Error.invalidOperation("Signalr object is missing version information");if(c!=="2.1.1")return;var d=a.transports;if(!d)throw Error.invalidOperation("Failed to retrieve transports object");var b=d.longPolling;if(!b)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!b.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");b.supportsKeepAlive=this.$4ha()}catch(e){Diag.$2.$9(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",e.message)}},$4ha:function(){var a=this;return function(){return false}},$3Lr:function(){var b=++this.$17J;this.$209=+new Date(0);this.$RF=this.$2Vq();this.$DY=this.$2f7(this.$RF);this.$1Ad.$7h();this.$DY.$5m5(this.$$d_$va);this.$DY.$5mF(this.$$d_$2JQ);var a=this;this.$RF.stateChanged(function(c){a.$5YS(c,b)});this.$RF.connectionSlow(this.$$d_$5cH);this.$RF.error(this.$$d_$5cB);this.$RF.log=this.$$d_$5cC},$1X3:function(a,b){if(a!==this.$17J){Diag.$2.$9(4309017,500,50,"ConnectionToken verification failed for {0}",b);return false}return true},$3KE:function(){if(this.$KU===2||this.$KU===1)return;Diag.$2.$9(4539721,500,50,"Starting connection to Rtc");this.$1Zn.$5YT();this.$144(1,this.$KU);this.$3yg()},$3yg:function(){var c=this.$17J,a=this,b=this;this.$5sx(function(){if(!a.$1X3(c,"GetMachineIdSuccess"))return;Diag.$2.$9(4060128,500,50,"Successfully retrieved Rtc MachineId");a.$4QO()},function(){if(!b.$1X3(c,"GetMachineIdFailure"))return;Diag.$2.$9(4060129,500,15,"Failed to retrieve Rtc MachineId");b.$11Y()})},$11Y:function(){Diag.$2.$9(4309018,500,50,"Disposing and creating a new RTC connection");var a=this.$KU===2||this.$KU===1;a&&this.$144(1,this.$KU);++this.$17J;this.$1Wq();this.$62y();this.$3Lr();this.$3JH();this.$5HK();a&&this.$3yg()},$5sx:function(b,e){Diag.$2.$9(4060130,500,50,"Retrieving Rtc MachineId from server");if(this.$Xy){b();return}var c=this.$4M0(),d=this.$17J,a=this;window.setTimeout(function(){if(!a.$1X3(d,"RequestMachineId"))return;a.$2bV=+new Date;a.$3Y7(function(c){a.$5E3(c);b()},function(){a.$3JH();e()})},c)},$5pW:function(){this.$1JU=1e3},$5HK:function(){this.$1JU+=3e3;this.$1JU=Math.min(this.$1JU,3e5)},$4M0:function(){var b=+new Date,a=this.$2bV+this.$1JU-b;if(a<0)a=0;return a},$5E3:function(a){try{this.$2Sp=a;this.$1so=a.get_$4Pr();this.$Xy=a.$Xy;this.$36P();this.$5IV(new AppRealtimeChannel.$UZ(a.$2S1,a.$2S0,a.$2Rz,a.$2R3))}catch(b){Diag.$2.$9(7672351,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",b.toString())}},$5IV:function(a){this.$1Ad.$7Y(a)},$3JH:function(){this.$Xy=null;this.$3JI()},$36P:function(){this.$3JI();this.$1cl=true;this.$2cX=window.setTimeout(this.$$d_$5l6,24e4)},$3JI:function(){if(this.$1cl){window.clearTimeout(this.$2cX);this.$1cl=false}},$5l6:function(){this.$1cl=false;var a=this,b=this;this.$3Y7(function(b){if(!a.$KU)return;if(a.$Xy!==b.$Xy){Diag.$2.$9(4309019,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",a.$Xy||"null",b.$Xy);a.$11Y();return}a.$36P()},function(){b.$36P()})},$65d:function(e){if(Object.getType(e)!==Object)return null;var c=e,a=c;for(var b in a)var f={key:b,value:a[b]};var d=this.$65e(c);d;return d},$65e:function(a){if(!("enabled"in a))return null;for(var e=a.enabled,g=e?this.$3sF:this.$3sE,d=g,f=d.length,c=0;c<f;++c){var h=d[c];if(!(h in a))return null}var b=new AppRealtimeChannel.$ZR;b.$1sb=a.enabled;b.$2Qh=a.errorMessage;if(e){b.$1sb=a.enabled;b.$2Qh=a.errorMessage;b.$2QI=a.url;b.$1Y6=a.queryString;b.$Xy=a.connectionString;b.$2R3=a.throttling_globalMaxNumberOfOutstandingMessages;b.$2Rz=a.throttling_maxNumberOfOutstandingMessages;b.$2S0=a.throttling_timeToWaitForResponse;b.$2S1=a.throttling_messageDelay}return b},$3Y7:function(f,c){var b=this.$2Xz+"?"+this.$Pb,a=null;if(this.$4A)a=this.$4A.$8G("WebServiceCall","GetMachineIdFromTheServer");Diag.$2.$9(4317445,500,50,"Getting MachineId from server {0}",b);var e={},d=this,g=this;this.$60.$DC(b,1,null,e,false,3,function(h){a&&a.$4x();var g=AppRealtimeChannel.$5c.$QA(h.$1v.$7c,"FindSession",null,true);if(g){var e=d.$65d(g);if(e)if(e.$1sb&&e.$1Y6&&e.$Xy){Diag.$2.$9(4317446,500,50,"Successfully retrieved MachineId from server {0}",b);f(e);return}else Diag.$2.$9(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString]");else Diag.$2.$9(8745097,500,15,"Could not translate server response to findSession response")}else Diag.$2.$9(7372827,500,10,"Could not deserialize response data");c()},function(b){a&&a.$4x();Diag.$2.$9(4290721,500,15,"Request for MachineId failed with '{0}'",b.$1v?Common.$4v.toString(b.$1v.$3I):"unknown");c()},null,null,false,null,this.$3Cg,null)},$4QO:function(){this.$209=+new Date;this.$RF.qs=this.$2Sp.$1Y6;var b=null;if(this.$4A)b=this.$4A.$8G("WebServiceCall","ConnectToServer");Diag.$2.$9(3290048,500,50,"Connecting to server");var c={};if(this.$1OD)if(this.$1OD.length===1)c.transport=this.$1OD[0];else c.transport=this.$1OD;var d=this,a=this,e=this;this.$RF.start(c,null).done(function(){Diag.$2.$9(3457857,500,50,"Successfully connected to server")}).fail(function(b){var c=a.$RF?a.$RF.baseUrl+a.$RF.url:"";Diag.$2.$9(3457858,500,15,"Failed to connect to server : {0}, connection string: {1}, machine connection string: {2}, callback parameter:{3}",c,a.$Xy,a.$1so,AppRealtimeChannel.$5c.$1no(b));a.$11Y()}).always(function(){b&&b.$4x()})},$29k:function(){if(!this.$KU)return;this.$1K3=true;this.$1Zn.$5Ys();this.$144(0,this.$KU);this.$11Y();this.$1K3=false},$62y:function(){var a=this.$4M6(),c=this.$RF,d=this,b=function(){c.stop(true,true)};if(a>0){Diag.$2.$9(4309020,500,50,"Waiting to stop connection: [{0}] ms.",a);window.setTimeout(b,a)}else b()},$4M6:function(){var a=0;if(!this.$RF.state){a=this.$209+15e3-+new Date;if(a<0)a=0}return a},get_$tA:function(){return this.$KU},add_$1hB:function(a){this.$1O("CSC",a)},remove_$1hB:function(a){this.$2X("CSC",a)},$3tl:function(d){var f=AppRealtimeChannel.$5c.$280(d);this.$W9[this.$PT]=d;if(this.$KU!==2)return $$sc.$30.$iV(Object,null);var a=this.$16C.toString();++this.$16C;var e=this,g=new AppRealtimeChannel.$TJ(function(){return e.$5t3(f,a)},a),h=this.$1Ad.$3bX(this.$3bY(0,0)),b=h.$F(g),c=new($$sc.$5l.$$(Object)),i=this;b.$2JH(function(){c.$9D(null)});var j=this;b.$2JG(function(){});return c.get_$8z()},$5t3:function(e,c){var b=null,a=new AppRealtimeChannel.$JI;Diag.$2.$9(3249501,500,50,"Sending presence update");if(this.$KU!==2){Diag.$2.$9(7934171,500,15,"Connection is lost - unable to send the message");a.$2I9();return a}if(this.$4A&&this.$21M<20){b=this.$4A.$8G("WebServiceCall","Send Presence Message");this.$21M++}a.$1nG(1);var f=this,d=this,g=this;this.$DY.$68v(e).done(function(){Diag.$2.$9(3249502,500,50,"Successfully delivered presence update message [{0}]",c);a.$1En(1)}).fail(function(b){!d.$1K3&&Diag.$2.$9(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}]",c,AppRealtimeChannel.$5c.$1no(b));a.$1En(2)}).always(function(){b&&b.$4x()});return a},add_$vh:function(a){this.$1O("PU",a)},remove_$vh:function(a){this.$2X("PU",a)},$5Dq:function(a){return a in this.$W9?this.$W9[a]:null},$1k6:function(){return this.$W9},$1Fs:function(d,i){var f=AppRealtimeChannel.$5c.$280(i);if(this.$KU!==2)return $$sc.$30.$iV(Object,null);var a=this.$16C.toString();++this.$16C;var e=this,g=new AppRealtimeChannel.$TJ(function(){return e.$5tG(d,f,a)},a),h=this.$1Ad.$3bX(this.$3bY(1,d)),b=h.$F(g),c=new($$sc.$5l.$$(Object)),j=this;b.$2JH(function(){c.$9D(null)});var k=this;b.$2JG(function(){});return c.get_$8z()},$5tG:function(c,f,d){var b=null,a=new AppRealtimeChannel.$JI;Diag.$2.$9(3249505,500,50,"Sending update notification");if(this.$KU!==2){Diag.$2.$9(7934172,500,15,"Connection is lost - unable to send the message");a.$2I9();return a}if(this.$4A&&c===3&&this.$21O<20){b=this.$4A.$8G("WebServiceCall","Send WetContent Update");this.$21O++}a.$1nG(1);var g=this,e=this,h=this;this.$DY.$1Fs(c,f).done(function(){Diag.$2.$9(3249506,500,50,"Successfully delivered update notification message [{0}]",d);a.$1En(1)}).fail(function(b){!e.$1K3&&Diag.$2.$9(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}]",d,AppRealtimeChannel.$5c.$1no(b));a.$1En(2)}).always(function(){b&&b.$4x()});return a},add_$1Gp:function(a){this.$1O("UNR",a)},remove_$1Gp:function(a){this.$2X("UNR",a)},$5Du:function(){return new AppRealtimeChannel.$iq(1,new Date)},get_$Hi:function(){return this.$PT},$d:function(){if(this.$7I)return;this.$1Wq();Common.$2y.prototype.$d.call(this);this.$7I=true},$1Wq:function(){this.$DY.$67c(this.$$d_$va);this.$DY.$67e(this.$$d_$2JQ)},$5YS:function(a,b){if(!this.$1X3(b,"StateChangedSignalR"))return;this.$144(this.$3Kl(a.newState),this.$3Kl(a.oldState))},$144:function(b,c){if(!(this.$KU===1&&!c&&b===1))if(this.$KU!==c){var g=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.$KU,c,b]));Diag.$2.$9(3290053,500,10,g)}if(this.$KU===b)return;switch(b){case 2:this.$3C9=this.$RF.id;Diag.$2.$9(3249539,500,50,"Established connection");this.$5Sf(this.$RF);Diag.$2.$9(4298369,500,50,"Retrieving complete session state");var d=null;if(this.$4A)d=this.$4A.$8G("WebServiceCall","Receive First Presence");var f=this.$17J,a=this,e=this,h=this;this.$DY.$54T().done(function(b){if(!a.$1X3(f,"GetCompletePresenceSuccess"))return;a.$1Zn.$5cR();Diag.$2.$9(3249540,500,50,"Successfully retrieved complete session state");a.$5pW();a.$4OR();a.$va(b,new Array(0));a.$PT in a.$W9&&a.$3tl(a.$W9[a.$PT])}).fail(function(a){if(!e.$1X3(f,"GetCompletePresenceFail"))return;Diag.$2.$9(3249541,500,15,"Failed to retrieve complete session state : {0}",AppRealtimeChannel.$5c.$1no(a));e.$11Y()}).always(function(){d&&d.$4x()});break;case 1:c===2&&Diag.$2.$9(4298644,500,50,"Lost connection to the server...trying to re-establish it");break;case 0:if(c===1&&!this.$1K3){Diag.$2.$9(7672737,500,50,"Signalr gave up trying to connect to server...kicking off global reconnect logic");this.$11Y();return}else Diag.$2.$9(3249543,500,50,"Connection to the server has been closed")}this.$KU=b;this.$27("CSC",new Common.$X5(b,c))},$5Sf:function(d){if(!d||!d.transport||!d.transport.name){Diag.$2.$9(4290722,500,10,"Transport protocol name is missing");return}var a=d.transport.name,b=a.toLowerCase(),c="Transport name - {0}";if(b==="websockets")Diag.$2.$9(4290723,500,50,c,a);else if(b==="serversentevents")Diag.$2.$9(4290752,500,50,c,a);else if(b==="foreverframe")Diag.$2.$9(4290753,500,50,c,a);else if(b==="longpolling")Diag.$2.$9(4290754,500,50,c,a);else b!=="mocktransport"&&Diag.$2.$9(4290755,500,15,"Unknown transport protocol encountered - '{0}'",a)},$5cH:function(){Diag.$2.$9(3249544,500,50,"Detected that the connection is slow")},$5cB:function(a){Diag.$2.$9(3249545,600,10,"SignalR ERROR: {0}",AppRealtimeChannel.$5c.$1no(a)||"<empty>")},$5cC:function(){},$va:function(a,b){if(Diag.$2.$1WD(500,100)){var d=a;for(var g in d)var n={key:g,value:d[g]};for(var j=0;j<b.length;++j);}delete a[this.$PT];if(Common.$2c.$7N(a)&&!b.length)return;var e=a;for(var h in e){var k={key:h,value:e[h]},l=k.key;a[l]=AppRealtimeChannel.$5c.$QA(k.value,"Presence",l,true)}var f=a;for(var i in f){var m={key:i,value:f[i]};this.$W9[m.key]=m.value}for(var c=0;c<b.length;++c)delete this.$W9[b[c]];if(!this.$2cU){Diag.$2.$9(4539734,500,50,"Raising first presence update notification");this.$2cU=true}this.$27("PU",new Common.$Nb(a,b))},$2JQ:function(a,c){if(a===5){Diag.$2.$9(8755426,500,50,"Received client reconnection request from the server - rebooting the client connection");this.$11Y();return}var b=AppRealtimeChannel.$5c.$QA(c,String.format("UpdateNotification-{0}",AppRealtimeChannel.$9A.toString(a)),null,this.$2cW);this.$27("UNR",new AppRealtimeChannel.$ik(a,b))},$4OR:function(){var a=this.$W9[this.$PT];delete this.$W9[this.$PT];var b=Common.$2c.$eP(this.$W9);this.$W9={};if(a)this.$W9[this.$PT]=a;this.$va({},b)},$3Kl:function(a){switch(a){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",a,"Unknown SignalR state");}},$3bY:function(a,b){return a+","+b},$1Ad:null,$PT:null,$Pb:null,$2Xz:null,$3C9:null,$KU:0,$1K3:false,$1so:null,get_$3i2:function(){return this.$1so},$Xy:null,$2Sp:null,$16C:0,$2Vq:null,$2f7:null,$17J:1,$RF:null,$DY:null,$60:null,$7I:false,$N9:null,$1OD:null,$2cW:false,$4A:null,$21M:0,$21O:0,$3Cg:6e4,$1JU:1e3,$2cU:false,$1Zn:null,$2cX:0,$1cl:false};AppRealtimeChannel.$ZR=function(){};AppRealtimeChannel.$ZR.prototype={$2S1:0,$2S0:0,$2Rz:0,$2R3:0,$1sb:false,$2Qh:null,$2QI:null,$1Y6:null,$Xy:null,get_$4Pr:function(){return this.$2QI+"?"+this.$1Y6}};AppRealtimeChannel.$Tm=function(){};AppRealtimeChannel.$Tm.$7s=function(b,c,d,e,f,g,h,i,j){var a=AppRealtimeChannel.$5c.$4d1;return a(b,c,d,e,f,g,h,i,j)};AppRealtimeChannel.$fE=function(a){this.$DY=a};AppRealtimeChannel.$fE.prototype={$DY:null,$5m5:function(a){this.$DY.on("presenceUpdated",a)},$5mF:function(a){this.$DY.on("updateNotification",a)},$67c:function(a){this.$DY.off("presenceUpdated",a)},$67e:function(a){this.$DY.off("updateNotification",a)},$54T:function(){return this.$DY.invoke("GetCompletePresenceState")},$68v:function(a){return this.$DY.invoke("UpdatePresence",a)},$1Fs:function(a,b){return this.$DY.invoke("SendUpdateNotification",a,b)}};AppRealtimeChannel.$JI=function(){this.$20q=new(AppRealtimeChannel.$IG.$$(Common.$dA));this.$20o=new(AppRealtimeChannel.$IG.$$(Common.$d8))};AppRealtimeChannel.$JI.prototype={$2JH:function(a){this.$20q.$31L(a)},$2JG:function(a){this.$20o.$31L(a)},$1nG:function(a){this.$20q.$3i6(a)},$1En:function(a){this.$20o.$3i6(a)},$2I9:function(){this.$1nG(2);this.$1En(2)},$20q:null,$20o:null};AppRealtimeChannel.$IG=function(){this.$2Vo=this.$$gta["AppRealtimeChannel.$IG"].T===Number||Type.isEnum(this.$$gta["AppRealtimeChannel.$IG"].T)?0:this.$$gta["AppRealtimeChannel.$IG"].T===Boolean?false:null};AppRealtimeChannel.$IG.$$=function(f){var a="$IG$"+f.getName().replace(/\./g,"_");if(!AppRealtimeChannel[a]){var c=AppRealtimeChannel[a]=function(){for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];AppRealtimeChannel.$IG.apply(this,b)};c.registerClass("AppRealtimeChannel."+a);var g={"AppRealtimeChannel.$IG":{T:f}};c.prototype.$$gta=g;var d=AppRealtimeChannel.$IG.prototype;for(var e in d){var b={key:e,value:d[e]};if("constructor"!==b.key)c.prototype[b.key]=b.value}}return AppRealtimeChannel[a]};AppRealtimeChannel.$IG.prototype={$31L:function(a){this.$pw=a;this.$40b()},$3i6:function(a){if(this.$1vn)return;this.$1vn=true;this.$2Vo=a;this.$40b()},$40b:function(){if(!this.$1vn||!this.$pw||this.$2VA)return;this.$2VA=true;this.$pw(this.$2Vo)},$1vn:false,$2VA:false,$pw:null};AppRealtimeChannel.$TJ=function(a,b){this.$2gR=a;this.$16C=b};AppRealtimeChannel.$TJ.prototype={$1Fr:function(){return this.$2gR()},$16C:null,$2gR:null};AppRealtimeChannel.$H1=function(a,b){this.$$d_$5t9=Function.createDelegate(this,this.$5t9);this.$1NK=a;this.$1tj=b;this.$18j=+new Date(0);var c=this;this.$1rs=function(){return+new Date};this.$kh=AppRealtimeChannel.$H1.$2nr};AppRealtimeChannel.$H1.$7s=function(a,b){return new AppRealtimeChannel.$H1(a,b)};AppRealtimeChannel.$H1.$2nr=function(a,b){return window.setTimeout(a,b)};AppRealtimeChannel.$H1.prototype={$1su:0,$1NK:null,$18j:0,$cb:false,$10L:null,$dP:null,$1tj:null,$yy:false,$1rs:null,$kh:null,$7Y:function(a){if(this.$yy)return;this.$1su=a;this.$yy=true},$F:function(c){!this.$yy&&this.$7Y(200);var a=this.$1rs(),b=new AppRealtimeChannel.$JI;if(this.$18j>a)this.$18j=a;if(this.$cb){this.$1PK(true);this.$2Mj(c,b)}else if(this.$18j+this.$1su<=a)this.$2Le(c,b);else{this.$2Mj(c,b);this.$kh(this.$$d_$5t9,this.$18j+this.$1su-a)}return b},$5t9:function(){if(this.$cb){var a=this.$10L,b=this.$dP;this.$1PK(false);this.$2Le(a,b)}},$2Le:function(c,b){this.$18j=this.$1rs();var a=this.$1NK(c),d=this;a.$2JH(function(a){b.$1nG(a)});var e=this;a.$2JG(function(a){b.$1En(a)})},$2Mj:function(a,b){this.$1PK(true);this.$cb=true;this.$10L=a;this.$dP=b},$1PK:function(a){this.$cb=false;this.$dP&&a&&this.$dP.$2I9();this.$10L=null;this.$dP=null}};AppRealtimeChannel.$E4=function(a,b){this.$$d_$5tB=Function.createDelegate(this,this.$5tB);this.$$d_$5aY=Function.createDelegate(this,this.$5aY);this.$17=new Common.$2y;this.$1NK=a;this.$1tj=b;this.$1Lv=0;this.$1O5=[];this.$kh=AppRealtimeChannel.$E4.$2nr;this.$wr=AppRealtimeChannel.$E4.$3Mr};AppRealtimeChannel.$E4.$7s=function(a,b){return new AppRealtimeChannel.$E4(a,b)};AppRealtimeChannel.$E4.$3Mr=function(a){window.clearTimeout(a)};AppRealtimeChannel.$E4.$2nr=function(a,b){return window.setTimeout(a,b)};AppRealtimeChannel.$E4.prototype={$396:0,$1sp:0,$kh:null,$wr:null,$1NK:null,$1Lv:0,$1O5:null,$cb:false,$10L:null,$dP:null,$18e:false,$yy:false,$25I:0,$1Zo:0,$1Zy:0,$1tj:null,$F:function(b){var a=new AppRealtimeChannel.$JI;!this.$yy&&this.$7Y(15e3,5);if(this.$cb)this.$2Mj(b,a);else if(this.$1Lv<this.$1sp)this.$2Le(b,a);else{this.$2Mj(b,a);this.$18e=false}return a},$2Le:function(f,e){var b=this.$1NK(f),c=this.$kh(this.$$d_$5aY,this.$396);++this.$1Lv;Array.add(this.$1O5,c);var d=this.$1Zo,g=this;b.$2JH(function(a){e.$1nG(a)});var a=this;b.$2JG(function(b){if(a.$1Zo!==d)return;a.$5aX(d,c);e.$1En(b)})},$5aX:function(b,a){if(this.$1Zo!==b)return;--this.$1Lv;this.$wr(a);Array.remove(this.$1O5,a);this.$cb&&this.$5tA()},$5tA:function(){if(!this.$cb)return;if(!this.$18e){this.$25I=this.$kh(this.$$d_$5tB,0);this.$18e=true}},$5tB:function(){this.$18e=false;if(this.$cb){var a=this.$10L,b=this.$dP;this.$1PK(false);this.$2Le(a,b)}},$5aY:function(){++this.$1Zy;var a=Math.floor(this.$1sp/2);if(this.$1Zy>a){this.$1Zy=-1e9;this.$17.$27("TMUDM")}},add_$39C:function(a){this.$17.$1O("TMUDM",a)},$7h:function(){this.$1Zy=0;++this.$1Zo;for(var b=this.$1O5,c=b.length,a=0;a<c;++a){var d=b[a];this.$wr(d)}this.$1Lv=0;this.$1O5=[];this.$1PK(true);if(this.$18e){this.$wr(this.$25I);this.$25I=0;this.$18e=false}},$2Mj:function(a,b){this.$1PK(true);this.$cb=true;this.$10L=a;this.$dP=b},$1PK:function(a){this.$cb=false;this.$dP&&a&&this.$dP.$2I9();this.$10L=null;this.$dP=null},$7Y:function(a,b){if(this.$yy)return;this.$396=a;this.$1sp=b;this.$yy=true}};AppRealtimeChannel.$iC=function(){};AppRealtimeChannel.$iC.prototype={$3Lj:function(a,b){return AppRealtimeChannel.$E4.$7s(a,b)},$4eY:function(a,b){return AppRealtimeChannel.$H1.$7s(a,b)}};AppRealtimeChannel.$iD=function(b){this.$17=new Common.$2y;this.$20h=new($$sc.$3j.$$(AppRealtimeChannel.$cM));this.$1cq=new($$sc.$3j.$$(AppRealtimeChannel.$bZ));this.$1fG=b;var c=this;this.$1KR=this.$1fG.$3Lj(function(a){return a.$1Fr()},"GlobalMaxOustandingThrottler");var a=this;this.$1KR.add_$39C(function(){a.$17.$27("TMUDM")})};AppRealtimeChannel.$iD.prototype={$1fG:null,$20h:null,$1cq:null,$1KR:null,$7o:null,$li:false,$7Y:function(a){if(this.$li)return;this.$7o=a;this.$1KR.$7Y(this.$7o.$1tk,this.$7o.$2R2);this.$li=true},$3bX:function(c){!this.$li&&this.$7Y(new AppRealtimeChannel.$UZ(200,15e3,5,1e3));var b,f,g;if(!(g=this.$20h.$9F(c,f={val:b}),b=f.val,g)){var a,h,i;if(!(i=this.$1cq.$9F(c,h={val:a}),a=h.val,i)){var l="MaxOutstandingThrottler-"+c,d=this.$1KR;a=this.$1fG.$3Lj(d.$$d_$F||(d.$$d_$F=Function.createDelegate(d,d.$F)),l);a.$7Y(this.$7o.$1tk,this.$7o.$2Ry);var j=this;a.add_$39C(function(){j.$17.$27("TMUDM")});this.$1cq.$F(c,a)}var k="MaxRateThrottler-"+c,e=a;b=this.$1fG.$4eY(e.$$d_$F||(e.$$d_$F=Function.createDelegate(e,e.$F)),k);b.$7Y(this.$7o.$2S3);this.$20h.$F(c,b)}return b},$7h:function(){var a=this.$1cq.$3f();while(a.$$mn()){var b=a.$$cu();b.get_$Q().$7h()}this.$1KR.$7h()},add_$39C:function(a){this.$17.$1O("TMUDM",a)}};AppRealtimeChannel.$UZ=function(a,b,c,d){this.$2S3=a;this.$1tk=b;this.$2Ry=c;this.$2R2=d};AppRealtimeChannel.$UZ.prototype={$2S3:0,$1tk:0,$2Ry:0,$2R2:0};AppRealtimeChannel.$GK.registerClass("AppRealtimeChannel.$GK",null,AppRealtimeChannel.$mz);AppRealtimeChannel.$iq.registerClass("AppRealtimeChannel.$iq");AppRealtimeChannel.$ik.registerClass("AppRealtimeChannel.$ik",Sys.EventArgs);AppRealtimeChannel.$5c.registerClass("AppRealtimeChannel.$5c",Common.$2y,AppRealtimeChannel.$ms,Common.$oi);AppRealtimeChannel.$ZR.registerClass("AppRealtimeChannel.$ZR");AppRealtimeChannel.$Tm.registerClass("AppRealtimeChannel.$Tm");AppRealtimeChannel.$fE.registerClass("AppRealtimeChannel.$fE",null,AppRealtimeChannel.$lQ,AppRealtimeChannel.$ma);AppRealtimeChannel.$JI.registerClass("AppRealtimeChannel.$JI",null,AppRealtimeChannel.$kH);AppRealtimeChannel.$TJ.registerClass("AppRealtimeChannel.$TJ",null,AppRealtimeChannel.$kJ);AppRealtimeChannel.$H1.registerClass("AppRealtimeChannel.$H1",null,AppRealtimeChannel.$cM,AppRealtimeChannel.$kF);AppRealtimeChannel.$E4.registerClass("AppRealtimeChannel.$E4",null,AppRealtimeChannel.$bZ,AppRealtimeChannel.$kF);AppRealtimeChannel.$iC.registerClass("AppRealtimeChannel.$iC",null,AppRealtimeChannel.$kC);AppRealtimeChannel.$iD.registerClass("AppRealtimeChannel.$iD",null,AppRealtimeChannel.$kU);AppRealtimeChannel.$UZ.registerClass("AppRealtimeChannel.$UZ");var AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("Common.App.Assistance");Common.App.Assistance.$qK=function(){};Common.App.Assistance.$qK.registerInterface("Common.App.Assistance.$qK");Common.App.Assistance.$q4=function(){};Common.App.Assistance.$q4.registerInterface("Common.App.Assistance.$q4");Common.App.Assistance.$pO=function(){};Common.App.Assistance.$pO.registerInterface("Common.App.Assistance.$pO");Common.App.Assistance.$pU=function(){};Common.App.Assistance.$pU.registerInterface("Common.App.Assistance.$pU");Common.App.Assistance.$6l=function(){this.$$d_$61T=Function.createDelegate(this,this.$61T);this.dispose=this.$d};Common.App.Assistance.$6l.get_$4=function(){if(!Common.App.Assistance.$6l.$T)Common.App.Assistance.$6l.$T=new Common.App.Assistance.$6l;return Common.App.Assistance.$6l.$T};Common.App.Assistance.$6l.$5Dm=function(a){var d="|",b=new Common.App.Assistance.$WF,c=a.indexOf(d);b.$16M=a.substring(0,c);var e=a.indexOf(d,c+1);b.$2QN=a.substring(c+1,e);b.$2Sj=a.substr(e+1);return b};Common.App.Assistance.$6l.prototype={$2RY:false,$1Iu:null,$2gG:null,$8F:function(b,c){var a=!!b&&!!c;if(a){this.$1Iu=b;this.$2gG=c}this.$2RY=a},$3F:function(a){if(!a)a=Common.$0.get_$r();a.$P(2918242107,2147483648,this.$$d_$61T)},$61T:function(e,f,c,g,d){if(c===1)return 32;Diag.$2.$9(4761738,1302,50,"");Common.PerfMetrics.$1m(4771);if(this.$2RY){var a=d.CommandValueId,b=Common.App.Assistance.$6l.$5Dm(a);this.$1Iu.$60o(this.$2gG.$5Dk(b));Common.PerfMetrics.$1m(4772);return 32}else{Common.PerfMetrics.$1m(4772);return 8}},$d:function(){if(this.$1Iu){this.$1Iu.dispose();this.$1Iu=null}}};Common.App.Assistance.$KZ=function(a,b){this.dispose=this.$d;if(b&&CommandUI.$I.$b(a)){Diag.$2.$m(4511688,1302,false,null);this.$229=false}else{this.$2Um=a;this.$229=b}};Common.App.Assistance.$KZ.$7s=function(a){return new Common.App.Assistance.$KZ(a,Common.$0.$2kF)};Common.App.Assistance.$KZ.prototype={$16u:null,$2Um:null,$229:false,$60o:function(a){if(this.$229){if(!this.$16u)this.$16u=this.$2Um();this.$16u.$37A(a)}else{var b=null;try{b=window.open(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}catch(c){Diag.$2.$9(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+c.message);throw c;}if(!b)Diag.$2.$9(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no");else Diag.$2.$9(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a)}},$d:function(){if(this.$16u){this.$16u.dispose();this.$16u=null}}};Common.App.Assistance.$qR=function(){};Common.App.Assistance.$qR.prototype={$t9:function(){},$7Y:function(){if(!Common.$0.$1P6)return;Common.App.Assistance.$6l.get_$4().$3F(Common.$0.get_$r())},$d:function(){Common.App.Assistance.$6l.get_$4().$d()},$5He:function(a,b){Common.App.Assistance.$6l.get_$4().$8F(Common.App.Assistance.$KZ.$7s(a),Common.App.Assistance.$Kb.$7s(Common.App.Assistance.$GD.$7s(b)))}};Common.App.Assistance.$WE=function(a){this.$$d_$3l8=Function.createDelegate(this,this.$3l8);this.$$d_$3l9=Function.createDelegate(this,this.$3l9);this.$$d_$5XQ=Function.createDelegate(this,this.$5XQ);this.dispose=this.$d;Common.PerfMetrics.$1m(4773);this.$1Nr=a;this.$1gb();this.$pH();Common.PerfMetrics.$1m(4774)};Common.App.Assistance.$WE.prototype={$2P:null,$C8:null,$21h:null,$21g:null,$1Nr:null,$1gb:function(){this.$2P=this.$1Nr.$3MM();var a=this.$2P.$dJ,b=a.$Vn;this.$3du(b);this.$2P.$14b(this.$$d_$5XQ);this.$2P.$8T()},$pH:function(){Common.$W.$1O(this.$C8,"load",this.$21h=this.$$d_$3l9);Common.$W.$1O(this.$C8,"error",this.$21g=this.$$d_$3l8)},$1Gk:function(){Common.$W.$2X(this.$C8,"load",this.$21h);this.$21h=null;Common.$W.$2X(this.$C8,"error",this.$21g);this.$21g=null},$d:function(){this.$1Gk();this.$C8.parentNode.removeChild(this.$C8);this.$C8=null;if(this.$2P){this.$1Nr.$11Z("AssistanceTaskPane",this.$2P);this.$2P=null}},$3Mn:function(){this.$C8.src="about:blank";this.$2P.$Ab()},$37A:function(a){Common.PerfMetrics.$1m(4775);this.$C8.src=a;if(this.$2P.$VQ)this.$2P.$8T();else this.$1Nr.$Xf(this.$2P)},$1lH:function(){this.$1Nr.$133(this.$2P);this.$3Mn()},$3du:function(b){var a=CommandUI.$B.$1j("iframe");a.src="about:blank";a.style.height="100%";this.$C8=a;b.appendChild(this.$C8);a.id="AssistanceContentFrame"},$5XQ:function(a){a===this.$2P&&this.$1lH()},$3l9:function(a){Diag.$2.$9(4474517,1302,50,"The resource at {0} is loaded successfully in assistance task pane",a.target.src);Common.PerfMetrics.$1m(4776)},$3l8:function(a){Diag.$2.$9(4474518,1302,15,"Loading the resource at {0} failed in assistance task pane",a.target.src);Common.PerfMetrics.$1m(4776)}};Common.App.Assistance.$GD=function(a,b,c,d,e){this.$164=a;this.$2SA=b;this.$2Rt=c;this.$2Pd=d;this.$2Rq=e};Common.App.Assistance.$GD.$5Dd=function(b){var a=b.indexOf(".");if(a>=0&&a<b.length){var c=parseInt(b.substring(0,a));if(!isNaN(c))return c}return 16};Common.App.Assistance.$GD.$7s=function(a){return new Common.App.Assistance.$GD(Common.$0.$6J,a,Common.App.Assistance.$GD.$5Dd(Common.$0.$Wb),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",Common.$H.$5Y(Common.$0.$6J).$JM)};Common.App.Assistance.$GD.prototype={$164:0,$2SA:null,$2Rt:0,$2Pd:null,$2Rq:null};Common.App.Assistance.$WF=function(){};Common.App.Assistance.$WF.prototype={$2Sj:null,$16M:null,$2QN:null};Common.App.Assistance.$Kb=function(c,b){var a=new Common.$9W(c);a.$Ah("clid",b.$164.toString());a.$Ah("p1",b.$2SA);a.$Ah("ver",b.$2Rt.toString());a.$Ah("apps",b.$2Pd);a.$Ah("lc",b.$2Rq);a.$Ah("src","TellMe");this.$A3=a.toString()};Common.App.Assistance.$Kb.$7s=function(a){return new Common.App.Assistance.$Kb(Common.$0.$2kG,a)};Common.App.Assistance.$Kb.prototype={$A3:null,$5Dk:function(b){var a=new Common.$9W(this.$A3);a.$Ah("query",b.$2Sj);a.$Ah("sessionid",b.$16M);a.$Ah("correlationid",b.$2QN);return a.toString()}};Common.App.Assistance.$6l.registerClass("Common.App.Assistance.$6l",null,Sys.IDisposable);Common.App.Assistance.$KZ.registerClass("Common.App.Assistance.$KZ",null,Common.App.Assistance.$qK,Sys.IDisposable);Common.App.Assistance.$qR.registerClass("Common.App.Assistance.$qR",null,Common.App.$jx,Common.Utils.$l6);Common.App.Assistance.$WE.registerClass("Common.App.Assistance.$WE",null,Common.App.Assistance.$q4,Sys.IDisposable);Common.App.Assistance.$GD.registerClass("Common.App.Assistance.$GD");Common.App.Assistance.$WF.registerClass("Common.App.Assistance.$WF");Common.App.Assistance.$Kb.registerClass("Common.App.Assistance.$Kb",null,Common.App.Assistance.$pO);Common.App.Assistance.$6l.$T=null;Type.registerNamespace("Common.App.Rename");Common.App.Rename.$lm=function(){};Common.App.Rename.$lm.registerInterface("Common.App.Rename.$lm");Common.App.Rename.$SR=function(){};Common.App.Rename.$SR.registerInterface("Common.App.Rename.$SR");Common.App.Rename.$SS=function(){};Common.App.Rename.$SS.registerInterface("Common.App.Rename.$SS");Common.App.Rename.$47=function(){this.$$d_$1F5=Function.createDelegate(this,this.$1F5)};Common.App.Rename.$47.prototype={$U:null,get_$5j:function(){return"Common.App.RenameFile"},$t9:function(b){this.$U=b;var a=this;this.$U.$e(Common.App.Rename.$To).$1p(Common.App.Rename.$SR).$n(function(){return new Common.App.Rename.$To(Common.$0.get_$r(),a.$U.$7a(Common.App.Rename.$SS))}).$p();var c=this;this.$U.$e(Common.App.Rename.$Ni).$1p(Common.App.Rename.$SS).$n(function(){return new Common.App.Rename.$Ni(Common.$0.get_$r())}).$p()},$7Y:function(){Common.$0.$o.$UQ(this.$$d_$1F5)},$1F5:function(){if(!Common.$0.$1mS())return;if(!Common.App.Rename.$6w.get_$4().$8F(Common.$0.$1Q8,Common.$0.$1iP,Common.$0.$33X||CommonUIStrings.l_RenameFileTooltip))return;Common.App.Rename.$96.get_$4().$3F();if(Common.$0.$o.$1A("RenameDialogIsEnabled")){this.$U.$J(Common.App.Rename.$Ni).$8F(Common.$0.$Kq,Common.$0.$1iP);this.$U.$J(Common.App.Rename.$SR).$3F()}},$d:function(){}};Common.App.Rename.$qL=function(){};Common.App.Rename.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.Rename.$47)};Common.App.Rename.$96=function(a,b,c,d,e,f,g){this.$$d_$5bY=Function.createDelegate(this,this.$5bY);this.$$d_$3mC=Function.createDelegate(this,this.$3mC);this.$$d_$5o7=Function.createDelegate(this,this.$5o7);this.$$d_$61Q=Function.createDelegate(this,this.$61Q);this.$$d_$5I7=Function.createDelegate(this,this.$5I7);this.$2av=a;this.$K=b;this.$4L=c;this.$lH=d;this.$20R=e;this.$1fa=f;this.$25r=g};Common.App.Rename.$96.get_$4=function(){return Common.App.Rename.$96.$T||(Common.App.Rename.$96.$T=Common.App.Rename.$96.$2so())};Common.App.Rename.$96.$2so=function(){return new Common.App.Rename.$96(Common.$0.$1mS,new($$sc.$x.$$(Common.$M5))(function(){return Common.$0.get_$r()}),new($$sc.$x.$$(Common.$RN))(function(){return Common.$0.$Ic}),Common.$0.$Kq,Common.$0.$1Ea,Common.$0.$3Ab,Common.App.Rename.$6w.get_$4().$$d_$3AK)};Common.App.Rename.$96.$4Gg=function(b,c){var a=Common.$9.$2tg(b);return c+a};Common.App.Rename.$96.prototype={$K:null,$4L:null,$lH:null,$20R:false,$1fa:false,$2av:null,$25r:null,$3F:function(){this.get_$mt().$P(3740310824,2147483648,this.$$d_$5I7);this.get_$mt().$P(2638199087,2147483648,this.$$d_$61Q);this.get_$mt().$P(1897077126,2147483648,this.$$d_$5o7)},$2y9:function(){return!this.$2av()?8:this.get_$Ic()&&!this.get_$Ic().get_$3WL()||!this.$1fa?8:32},$5I7:function(){var a=Common.App.Rename.$6w.get_$4().$8F(Common.$0.$1Q8,Common.$0.$1iP,Common.$0.$33X||CommonUIStrings.l_RenameFileTooltip);return a?32:8},$61Q:function(){var a=this.get_$Ic().get_$3WL();Diag.$2.$9(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userIsAlone = {2}",this.$20R,this.$1fa,a);new Common.App.Rename.$HK(this.$20R,!this.$1fa,!a);return 32},$5o7:function(c,d,a,e,b){if(a===1)return this.$2y9();if(!Common.$0.$1QO)return 8;if(this.$2y9()===8){this.get_$mt().$2u(2638199087,2);return 8}Common.$0.$1QO(b,this.$$d_$3mC,this.$$d_$5bY);return 32},$3mC:function(a,b){if(a.OperationResult){this.$5F5(a.OperationResult);return}this.$5t2(b,a.NewName);this.$67n(a,Common.$0.get_$1Y().get_$Hf().$$d_$68m);Common.$0.$o.$1A("DocumentNameInJewelInfoMenuIsEnabled")&&Common.$0.get_$1Y().$86(false)},$5t2:function(b,c){var a={};a.NewName=c;b.$P5("File_Rename",a)},$67n:function(b,d){this.$67p(b.NewName);Common.$0.$1i0=b.DirectInvokeDavUrl;var c=d(b.EditDocInClientUrl),a=new Common.$fR;a.$2If=this.$lH.get_$Q3();a.$29I=c;a.$2Ie=b.EditDocInClientUrl;this.get_$mt().$4J(2391221446,2,a)},$5F5:function(b){switch(b){case 1:var a=new CommonUI.$4j;a.set_$4T(0);a.$wL(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);this.$3sX()}},$67p:function(a){this.$lH.set_$Q3(Common.App.Rename.$96.$4Gg(this.$lH.get_$Q3(),a));this.$25r(a)},$5bY:function(b){var a=new CommonUI.$4j;a.set_$4T(0);if(b===1)a.$wL(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);else{Common.$0.$Sn(25);a.$wL(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}this.$3sX()},$3sX:function(){this.$25r(Common.$9.$it(this.$lH.get_$Q3()))},get_$mt:function(){return this.$K.get_$Q()},get_$Ic:function(){return this.$4L.get_$Q()}};Common.App.Rename.$fP=function(a,b,c){this.$$d_$5o6=Function.createDelegate(this,this.$5o6);Common.App.Rename.$fP.initializeBase(this);this.$K=a;this.$lH=b;this.$184=c;this.$FN=Common.App.Rename.$EL.get_$Gx()};Common.App.Rename.$fP.prototype={$K:null,$lH:null,$184:0,$3xc:function(){var b={txtDocumentName:Common.$9.$it(this.$lH.get_$Q3())};this.$LB(CommonUIStrings.l_RenameDialogTitle,this.$$d_$5o6,b);var a=$get("txtDocumentName");if(this.$184>0)a.maxLength=this.$184;a.focus()},$5o6:function(c,d){if(c===1){var b=Common.$9.$it(this.$lH.get_$Q3()),a=(d.txtDocumentName||"").trim();if(a!==b&&a!==""){this.$K.$4J(1897077126,2,a);return}}Common.$X.get_$4().$1B("DoNothingResult",{Reason:"FileNameUnchanged"})}};Common.App.Rename.$To=function(a,b){this.$$d_$61P=Function.createDelegate(this,this.$61P);this.$K=a;this.$1Ji=b};Common.App.Rename.$To.prototype={$K:null,$1Ji:null,$3F:function(){this.$K.$P(2382951455,2147483648,this.$$d_$61P)},$61P:function(e,f,d){var a=32;if(d===2){var b=this.$K.$2u(1897077126,1);if(b!==32){this.$K.$2u(2638199087,2);Common.$X.get_$4().$1B("FailedProcessingStep",{Reason:"RenameDisabled"});a=8}else{var c=this.$1Ji.get_$Q().$x();c.$3xc()}}return a}};Common.App.Rename.$Ni=function(a){this.$K=a;this.$A2=false};Common.App.Rename.$Ni.prototype={$K:null,$yJ:null,$184:0,$A2:false,$8F:function(a,b){this.$yJ=a;this.$184=b;this.$A2=true},$x:function(){return this.$A2?new Common.App.Rename.$fP(this.$K,this.$yJ,this.$184):null}};Common.App.Rename.$HK=function(a,b,c){Common.App.Rename.$HK.initializeBase(this);this.$18S=new Common.App.Rename.$fQ(a,b,c);this.set_$4T(0);this.$5l(1,CommonUIStrings.l_DialogClose);this.$FN=Common.App.Rename.$EM.get_$Gx();this.$fW(CommonUIStrings.l_RenameFileRenameDisabledTitle,null)};Common.App.Rename.$HK.$3y7=function(a,b,c){a.style.display="none";b.innerText=c};Common.App.Rename.$HK.prototype={$18S:null,$3lD:function(){if(this.$18S.$2N1)Common.App.Rename.$HK.$3y7($get("ulRenameFileDisabled"),$get("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledCoauthFull);else if(this.$18S.$2N2)Common.App.Rename.$HK.$3y7($get("ulRenameFileDisabled"),$get("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull);else this.$5GU()},$5GU:function(){if(this.$18S.$379)$get("liRenameFileRenameDisabledSignIn").style.display="none";if(this.$18S.$378)$get("liRenameFileRenameDisabledPermission").style.display="none";if(this.$18S.$377)$get("liRenameFileRenameDisabledCoauth").style.display="none"}};Common.App.Rename.$fQ=function(a,b,c){this.$2N1=!a&&!b;this.$2N2=!a&&!c;if(!this.$2N1&&!this.$2N2){this.$379=!a;this.$378=!b;this.$377=!c}};Common.App.Rename.$fQ.prototype={$2N1:false,$2N2:false,$379:false,$378:false,$377:false};Common.App.Rename.$6w=function(c,d,e,f,g,h,i,j,k,l,a,b){this.$$d_$3m5=Function.createDelegate(this,this.$3m5);this.$$d_$148=Function.createDelegate(this,this.$148);this.$$d_$XR=Function.createDelegate(this,this.$XR);this.$$d_$3m0=Function.createDelegate(this,this.$3m0);this.$$d_$143=Function.createDelegate(this,this.$143);this.$$d_$3AK=Function.createDelegate(this,this.$3AK);this.$K=c;this.$1ZE=d;this.$7m=e;this.$Pl=f;this.$yJ=g;this.$23p=h;this.$1NJ=i;this.$1Zc=j;this.$II=k;this.$1zX=l;this.$5W=a;this.$1c4=b};Common.App.Rename.$6w.$w2=function(){Common.$19.$w2(Common.$0.$3z)};Common.App.Rename.$6w.get_$4=function(){return Common.App.Rename.$6w.$T||(Common.App.Rename.$6w.$T=Common.App.Rename.$6w.$AX())};Common.App.Rename.$6w.$AX=function(){return new Common.App.Rename.$6w(Common.$0.get_$r(),Common.$2D.get_$4(),Common.$G.get_$4(),Common.$v.get_$4(),Common.$0.$Kq,Common.App.Rename.$6w.$w2,Common.$J.$5sa,Common.$J.$4OT,Common.Utils.$8.get_$4().$3j(Common.$FB),Common.$7.get_$Ec(),Common.$7.get_$7D(),Common.$7.get_$7Z())};Common.App.Rename.$6w.prototype={$A2:false,$K:null,$1ZE:null,$7m:null,$Pl:null,$II:null,$yJ:null,$23p:null,$1NJ:null,$1Zc:null,$2h:null,$20i:0,$1zX:false,$5W:false,$1c4:false,$1yf:false,$241:false,get_$GA:function(){return this.$2h.getAttribute("contentEditable")==="true"},$8F:function(a,b,c){if(!this.$K||!this.$yJ||!this.$23p||!this.$1NJ||!this.$1Zc||!a||b<=0)return false;this.$2h=a;this.$2h.style.direction=Common.$0.$3z?"rtl":"ltr";this.$2h.title=c;this.$2h.setAttribute("role","button");this.$2h.setAttribute("Unselectable","on");this.$20i=b;this.$1oo();this.$A2=true;return true},$1oo:function(){if(this.$1ZE){this.$1ZE.$z("blur",this.$2h,this.$$d_$143);this.$1ZE.$z("paste",this.$2h,this.$$d_$3m0)}this.$7m.$z("keydown",this.$2h,this.$$d_$XR);this.$Pl.$z("msospPointerDown",this.$2h,this.$$d_$148);this.$Pl.$z("msospPointerUp",this.$2h,this.$$d_$3m5)},$143:function(){if(this.get_$GA()&&!this.$1yf){!this.$1zX&&this.$1Zc(this.$2h);this.$3Jr();this.$2nk(false)}this.$1yf=false;return false},$3m0:function(){Diag.$2.$9(4281482,203,50,"Attempting to paste into the document title");return true},$XR:function(a){return this.get_$GA()?this.$5a6(a):this.$5a7(a)},$5a6:function(c){var b=c.$1c.keyCode,a=false;switch(b){case 13:this.$3Jr();this.$2nk(this.$5W||this.$1c4);a=true;break;case 9:this.$1zX&&this.$1Zc(this.$2h);break;case 27:this.$34D();this.$2nk(this.$5W||this.$1c4);a=true}return a},$5a7:function(c){var b=c.$1c.keyCode,a=false;switch(b){case 13:case 32:this.$40f(this.$1c4);this.get_$GA()&&this.$1NJ(this.$2h);a=true}return a},$148:function(){if(!this.get_$GA()){this.$40f(false);if(this.get_$GA()){this.$2h.focus();this.$1NJ(this.$2h);this.$241=true}}return false},$3m5:function(){if(this.$241){this.$1NJ(this.$2h);this.$241=false;return true}return false},$2y9:function(){var a=this.$K.$2u(1897077126,1);return a===32},$3Jr:function(){var b=Common.$9.$it(this.$yJ.get_$Q3()),a=this.$2h.innerText.trim();if(a.length>this.$20i)a=a.substr(0,this.$20i);if(a!==b&&a!==""){var c=this.$K.$4J(1897077126,2,a);if(c!==32)this.$34D();else this.$3AK(a)}else this.$34D()},$34D:function(){this.$3AK(Common.$9.$it(this.$yJ.get_$Q3()))},$3AK:function(a){if(!this.$A2)return;this.$2h.innerText=a;this.$23p()},$40f:function(a){if(!this.$2y9())this.$K.$2u(2638199087,2);else if(!this.get_$GA()){if(a){this.$1yf=true;this.$2h.blur()}this.$2h.setAttribute("contentEditable","true");this.$2h.removeAttribute("Unselectable");this.$2h.setAttribute("role","textbox");this.$2h.style.width="auto";Sys.UI.DomElement.addCssClass(this.$2h,"EditableBreadcrumbItem");if(this.$II){var b=this;this.$II.$46(function(a){a.$3pm(true)})}a&&this.$2h.focus();Diag.$2.$9(9234188,203,50,"Rename document from header.")}},$2nk:function(a){this.$2h.removeAttribute("contentEditable");this.$2h.setAttribute("Unselectable","on");this.$2h.setAttribute("role","button");Sys.UI.DomElement.removeCssClass(this.$2h,"EditableBreadcrumbItem");if(this.$II){var b=this;this.$II.$46(function(a){a.$3pm(false)})}if(a){this.$2h.blur();this.$2h.focus()}}};Common.App.Rename.$EL=function(){};Common.App.Rename.$EL.get_$Gx=function(){return CommonUI.$4l.$Oc(Common.App.Rename.$EL.$Ak,CommonUIStrings.l_RenameDialogLabel)};Common.App.Rename.$EM=function(){};Common.App.Rename.$EM.get_$Gx=function(){return CommonUI.$4l.$Oc(Common.App.Rename.$EM.$Ak,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)};Common.App.Rename.$47.registerClass("Common.App.Rename.$47",null,Common.App.$jx,Common.Utils.$l6);Common.App.Rename.$qL.registerClass("Common.App.Rename.$qL");Common.App.Rename.$96.registerClass("Common.App.Rename.$96");Common.App.Rename.$fP.registerClass("Common.App.Rename.$fP",CommonUI.$4l,Common.App.Rename.$lm);Common.App.Rename.$To.registerClass("Common.App.Rename.$To",null,Common.App.Rename.$SR);Common.App.Rename.$Ni.registerClass("Common.App.Rename.$Ni",null,Common.App.Rename.$SS);Common.App.Rename.$HK.registerClass("Common.App.Rename.$HK",CommonUI.$4l);Common.App.Rename.$fQ.registerClass("Common.App.Rename.$fQ");Common.App.Rename.$6w.registerClass("Common.App.Rename.$6w");Common.App.Rename.$EL.registerClass("Common.App.Rename.$EL");Common.App.Rename.$EM.registerClass("Common.App.Rename.$EM");Common.App.Rename.$96.$T=null;Common.App.Rename.$6w.$T=null;Common.App.Rename.$EL.$Ak="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput'/> </div>";Common.App.Rename.$EM.$Ak="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";Common.App.Rename.$qL.$5Sr();Type.registerNamespace("Common.App.SaveACopy");Common.App.SaveACopy.$Rg=function(){};Common.App.SaveACopy.$Rg.registerInterface("Common.App.SaveACopy.$Rg");Common.App.SaveACopy.$kt=function(){};Common.App.SaveACopy.$kt.registerInterface("Common.App.SaveACopy.$kt");Common.App.SaveACopy.$F5=function(a,b,c){this.$K=a;this.$PO=b;this.$sc=c};Common.App.SaveACopy.$F5.prototype={$K:null,$PO:null,$sc:null,$x:function(){return new Common.App.SaveACopy.$Qb(this.$K,this.$PO,this.$sc)}};Common.App.SaveACopy.$Qb=function(a,b,c){this.$$d_$3QB=Function.createDelegate(this,this.$3QB);Common.App.SaveACopy.$Qb.initializeBase(this);this.$K=a;this.$PO=b;this.$sc=c;this.$5l(1,CommonUIStrings.l_SaveButtonLabel);this.$FN=Common.App.SaveACopy.$8u.get_$Gx()};Common.App.SaveACopy.$Qb.prototype={$K:null,$PO:null,$sc:null,$1KF:null,$1KE:null,$1i3:function(c,d,e){this.$1KE=c;this.$1KF=e;var a={txtFileName:Common.$9.$it(Common.$0.$Kq.get_$Q3()),lblFolderName:String.format(CommonUIStrings.l_DestinationFolder,d)};this.$LB(CommonUIStrings.l_SaveToOneDrive,this.$$d_$3QB,a);Diag.$2.$9(7174148,216,50,"The file name dialog is initialized and shown.");var b=$get("txtFileName");b.focus()},$3QB:function(c,d){if(c!==1)Diag.$2.$9(7165650,216,50,"User click cancel to cancel upload file in file name dialog.");else{var a=d.txtFileName.trim();Diag.$2.$9(7165651,216,50,"User click save to upload file with new name {0}.",a);var b=Common.$9.$2tg(Common.$0.$Kq.get_$Q3());if(a&&a!==""&&b!=="")a=a+b;this.$sc.$2NJ(this.$1KE,this.$1KF,a)}}};Common.App.SaveACopy.$47=function(){};Common.App.SaveACopy.$47.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.SaveACopy.$47)};Common.App.SaveACopy.$47.prototype={$U:null,get_$5j:function(){return"Common.App.SaveACopy"},$7Y:function(){Common.$0.$o.$1A("SaveACopyBrsIsEnabled")&&this.$U.$J(Common.App.SaveACopy.$Nx).$3F()},$d:function(){},$t9:function(a){this.$U=a;var b=this;this.$U.$e(Common.App.SaveACopy.$Jf).$1p(Common.App.SaveToCloudStorage.$Su).$n(function(){return new Common.App.SaveACopy.$Jf(Common.$0.get_$r(),a.$J(Common.App.SaveToCloudStorage.$Jq),function(){return new CommonUI.$Ff},function(){return new Common.App.SaveACopy.$Ts(Common.$0.get_$r())},Common.$0.get_$1Y(),Common.$0.get_$1Y().get_$CN())}).$p();var c=this;this.$U.$e(Common.App.SaveACopy.$F5).$1p(Common.App.SaveACopy.$Rg).$n(function(){return new Common.App.SaveACopy.$F5(Common.$0.get_$r(),Common.$0.get_$1Y().get_$Hf(),a.$J(Common.App.SaveACopy.$Jf))}).$p();var d=this;this.$U.$e(Common.App.SaveACopy.$Nx).$n(function(){return new Common.App.SaveACopy.$Nx(a.$J(Common.App.SaveACopy.$Ny),Common.$0.$o,Common.$0.get_$1Y().get_$CN())}).$p();var e=this;this.$U.$e(Common.App.SaveACopy.$Ny).$1p(Common.App.SaveToCloudStorage.$Sa).$n(function(){return new Common.App.SaveACopy.$Ny(a.$J(Common.App.SaveACopy.$F5),a.$J(Common.App.SaveToCloudStorage.$Jn),Common.$4w.get_$4(),a.$J(Common.App.SaveACopy.$Jf),Common.$0.$o,Common.$0.$1HI,function(){return new Common.App.SaveACopy.$Ts(Common.$0.get_$r())})}).$p()}};Common.App.SaveACopy.$Ts=function(a){this.$$d_$3sg=Function.createDelegate(this,this.$3sg);Common.App.SaveACopy.$Ts.initializeBase(this);this.set_$4T(1);this.$5l(1,CommonUIStrings.l_RetryButtonLabel);this.$5l(0,CommonUIStrings.l_DialogClose);this.$K=a};Common.App.SaveACopy.$Ts.prototype={$K:null,$B3:function(a){Diag.$2.$9(7165652,216,50,"Show error dialog here {0}.",a);this.$Ne(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.$$d_$3sg)},$3sg:function(a){if(a===1){Diag.$2.$9(7165653,216,50,"User click to retry the action.");this.$K.$2u(4246497969,2)}else Diag.$2.$9(7165654,216,50,"User cancel the error dialog.")}};Common.App.SaveACopy.$Nx=function(a,b,c){Common.App.SaveACopy.$Nx.initializeBase(this,[a,b,c])};Common.App.SaveACopy.$Nx.prototype={$5PL:function(){return this.$3H.$1A("SaveACopyBrsIsEnabled")},$52R:function(){return 4246497969},$4MB:function(){Common.$31.$2Kf(this.$$d_$5rd);Common.$31.$2A8([new Common.$5L(4246497969,2147483648,0)],Common.App.SaveToCloudStorage.$7n.$1dJ)},$5kP:function(){Diag.$2.$9(7205456,216,50,"User clicked on SaveAs button from the backstage.")}};Common.App.SaveACopy.$Ny=function(a,b,c,d,e,f,g){Common.App.SaveACopy.$Ny.initializeBase(this,[b,c,d,e,f,g]);this.$2Xn=a};Common.App.SaveACopy.$Ny.prototype={$2Xn:null,$1F8:function(a){if(a&&a.data&&a.data.folders){Diag.$2.$9(7165655,216,50,"User select folder {0} to upload file.",a.data.folders[0].name);var b=this.$2Xn.$x();b.$1i3(a.data.folders[0].id,a.data.folders[0].name,a.data.folders[0].urls.viewInBrowser)}else{Diag.$2.$9(7165656,216,10,"Fail to select folder to upload file.");this.$K8()}},$vY:function(a){a&&a.error&&a.error.code==="user_canceled"&&Diag.$2.$9(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");Common.App.SaveToCloudStorage.$O1.prototype.$vY.call(this,a)},$K8:function(){Diag.$2.$9(7205458,216,50,"Error occur in Save A Copy Manager.");Common.App.SaveToCloudStorage.$O1.prototype.$K8.call(this)}};Common.App.SaveACopy.$Jf=function(a,b,c,d,e,f){Common.App.SaveACopy.$Jf.initializeBase(this,[b,c,d,e,f]);this.$K=a};Common.App.SaveACopy.$Jf.prototype={$K:null,$fX:function(){Diag.$2.$9(7205459,216,50,"Display Error for Save A Copy.");Common.App.SaveToCloudStorage.$K5.prototype.$fX.call(this)},$32y:function(){Diag.$2.$9(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");Common.App.SaveToCloudStorage.$K5.prototype.$32y.call(this)},$32x:function(a){Diag.$2.$9(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",a);Common.App.SaveToCloudStorage.$K5.prototype.$32x.call(this,a)},$1QP:function(){var c=this.$K.$2u(3070187925,1);if(c!==32){Diag.$2.$9(8741711,216,15,"The save file change is not supported, this operation may exist data losting.");Common.App.SaveToCloudStorage.$K5.prototype.$1QP.call(this)}else{var a=this,d=function(){Diag.$2.$9(8741712,216,50,"Call the force save file change successfully.");Common.App.SaveToCloudStorage.$K5.prototype.$1QP.call(a)},b=this,e=function(){Diag.$2.$9(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");b.$fX()};this.$K.$4J(3070187925,2,[d,e])}}};Common.App.SaveACopy.$8u=function(){};Common.App.SaveACopy.$8u.get_$Gx=function(){return CommonUI.$4l.$Oc(Common.App.SaveACopy.$8u.$Ak,CommonUIStrings.l_SaveACopyFileName)};Common.App.SaveACopy.$F5.registerClass("Common.App.SaveACopy.$F5",null,Common.App.SaveACopy.$Rg);Common.App.SaveACopy.$Qb.registerClass("Common.App.SaveACopy.$Qb",CommonUI.$4l,Common.App.SaveACopy.$kt);Common.App.SaveACopy.$47.registerClass("Common.App.SaveACopy.$47",null,Common.App.$jx,Common.Utils.$l6);Common.App.SaveACopy.$Ts.registerClass("Common.App.SaveACopy.$Ts",CommonUI.$4j,Common.App.SaveToCloudStorage.$lS);Common.App.SaveACopy.$Nx.registerClass("Common.App.SaveACopy.$Nx",Common.App.SaveToCloudStorage.$7n);Common.App.SaveACopy.$Ny.registerClass("Common.App.SaveACopy.$Ny",Common.App.SaveToCloudStorage.$O1);Common.App.SaveACopy.$Jf.registerClass("Common.App.SaveACopy.$Jf",Common.App.SaveToCloudStorage.$K5);Common.App.SaveACopy.$8u.registerClass("Common.App.SaveACopy.$8u");Common.App.SaveACopy.$8u.$Ak="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput'/> </div>";Common.App.SaveACopy.$47.$5Sr();Type.registerNamespace("Common");Common.$Ha=function(a,b,c,d){this.$60=a;this.$1ZC=b;this.$4A=c;this.$2Z4=d};Common.$Ha.$H3=function(b,a){a=a||"skypeproxy.ashx";return new Common.$Ha(new($$sc.$x.$$(Common.$Ij))(function(){return Common.$0.$7Q}),Common.$0.$Tq,b,a)};Common.$Ha.prototype={$60:null,$1ZC:null,$4A:null,$2Z4:null,get_$33r:function(){return this.$60.get_$Q()},$5Pz:function(b,c){var a=this.$4A.$8G("WebServiceCall","JoinSkypeChatThread"),d=this,e=this;this.$46(new Common.App.SkypeChat.$hA(this.$1ZC),function(c){a.$4x();b(c)},function(b){a.$4x();c(b)})},$4jK:function(b,c){var a=this.$4A.$8G("WebServiceCall","CreateSkypeChatThread"),d=this,e=this;this.$46(new Common.App.SkypeChat.$h9(this.$1ZC),function(c){a.$4x();b(c)},function(b){a.$4x();c(b)})},$4NN:function(b,c){var a=this.$4A.$8G("WebServiceCall","ChatThreadLookup"),d=this,e=this;this.$46(new Common.App.SkypeChat.$h8(this.$1ZC),function(c){a.$4x();b(c)},function(b){a.$4x();c(b)})},$46:function(b,c,d){var a={};a["Content-Type"]="application/json; charset=utf-8";this.get_$33r().$DC(this.$2Z4,2,b.$1VY(),a,false,2,c,d,null,null,false,null,null,null)}};Type.registerNamespace("Common.App.SkypeChat");Common.App.SkypeChat.$ju=function(){};Common.App.SkypeChat.$ju.registerInterface("Common.App.SkypeChat.$ju");Common.App.SkypeChat.$RZ=function(){};Common.App.SkypeChat.$RZ.registerInterface("Common.App.SkypeChat.$RZ");Common.App.SkypeChat.$b6=function(){};Common.App.SkypeChat.$b6.registerInterface("Common.App.SkypeChat.$b6");Common.App.SkypeChat.$rD=function(){};Common.App.SkypeChat.$rJ=function(){};Common.App.SkypeChat.$rK=function(){};Common.App.SkypeChat.$rI=function(){this.$17=new Common.$2y};Common.App.SkypeChat.$rI.prototype={$17:null,$2eo:false,add_$10r:function(a){this.$17.$1O("AVCEK",a)},$1oh:function(a){if(a!==this.$2eo){this.$17.$27("AVCEK",new Common.App.SkypeChat.$Pq(a));this.$2eo=a;Diag.$2.$9(6603939,333,50,"Chat availability changed to now be {0}",a)}}};Common.App.SkypeChat.$rH=function(){this.$17=new Common.$2y};Common.App.SkypeChat.$rH.prototype={$32j:function(a){this.$17.$27("NTID_EK",new Common.$h4(a))},add_$1Tz:function(a){this.$17.$1O("NTID_EK",a)},remove_$1Tz:function(a){this.$17.$2X("NTID_EK",a)}};Common.App.SkypeChat.$rG=function(a){this.$$d_$5Y4=Function.createDelegate(this,this.$5Y4);this.$$d_$5Y5=Function.createDelegate(this,this.$5Y5);this.$17i=a};Common.App.SkypeChat.$rG.prototype={$IF:null,$17i:null,$7Y:function(){this.$IF=this.$17i.$x(0);var a=this;return this.$IF.$3pq().CW(function(){a.$3kl()})},$3kl:function(){this.$IF.add_$2Jj(this.$$d_$5Y5);this.$IF.add_$3Ih(this.$$d_$5Y4)},$5Y5:function(b,a){this.$4p7(a.$2ST===1)},$5Y4:function(b,a){Diag.$2.$9(8451934,333,50,"chat pane leave focus");this.$3Ih(a.$2T4)},$5tI:function(){Diag.$2.$9(8246106,333,50,"SendWebImTakeFocusMessage called due to ctrl+f6.  PaneState = {0}",this.$IF.get_$2Ji());this.$IF.$641()}};Common.App.SkypeChat.$Pq=function(a){Common.App.SkypeChat.$Pq.initializeBase(this);this.$1sU=a};Common.App.SkypeChat.$Pq.prototype={$1sU:false,get_$2xH:function(){return this.$1sU}};Common.App.SkypeChat.$X6=function(a,b){this.$$d_$3k7=Function.createDelegate(this,this.$3k7);Common.App.SkypeChat.$X6.initializeBase(this);this.$1K6=a;this.$1K7=b};Common.App.SkypeChat.$X6.prototype={$1K6:null,$1K7:null,$7Y:function(a){this.$1K6.add_$10r(this.$$d_$3k7);this.$1K7.add_$10r(this.$$d_$3k7);var b=this.$1K6.$7Y(a),c=this.$1K7.$7Y(a);return $$sc.$30.When([b,c])},$2MW:function(a){this.$1K6.$2MW(a);this.$1K7.$2MW(a)},$3k7:function(b,a){this.$1oh(a.get_$2xH())},$1B5:function(){return this.$1K6.$1B5()||this.$1K7.$1B5()}};Common.App.SkypeChat.$Yb=function(a,b,c,d){this.$$d_$5XV=Function.createDelegate(this,this.$5XV);this.$2bm=b;this.$2bo=a;this.$2YT=c;this.$22c=d};Common.App.SkypeChat.$Yb.prototype={$22c:null,$2bo:null,$2bm:null,$2YT:null,$A2:false,$7Y:function(){if(this.$A2){Diag.$2.$9(9000738,333,15,"Init called multiple times");return}this.$A2=true;var a=Common.$0.$o.$1A("WebImChatIsEnabled")||Common.$0.$o.$1A("DocChatIsEnabled");if(!a)return;this.$2YT.$46(this.$$d_$5XV)},$5XV:function(b){var a=this;b.get_$Oo().CW(function(){if(b.get_$Oo().get_$5k())a.$3e0(1);else Common.$0.$o.$1A("WebImChatIsEnabled")&&a.$3e0(0)})},$3e0:function(a){Diag.$2.$9(9000739,333,50,"DocChatBootStrapper: Doc chat is enabled and resolving components for experience:{0}",a);this.$2bo.get_$Q().$5lC(a);!a&&this.$2bm.get_$Q().$7Y();this.$22c&&this.$22c(a)}};Common.App.SkypeChat.$IQ=function(a,b){this.$$d_$5YC=Function.createDelegate(this,this.$5YC);this.$17=new Common.$2y;this.$1vM=a;this.$4A=b};Common.App.SkypeChat.$IQ.prototype={$1JH:null,$1vM:null,$hI:null,$xi:null,$4A:null,$1cR:null,add_$10r:function(a){this.$17.$1O("ACE",a)},$3pq:function(){if(this.$hI)return this.$hI.get_$8z();this.$hI=new($$sc.$5l.$$(Boolean));var a=this;this.$1vM.CW(function(){a.$1JH=a.$1vM.get_$5k();a.$xi=a.$1JH.$x(a.$$d_$5YC);a.$xi.$7Y();a.$xi.add_$2Jj(function(c,b){a.$17.$27("PSC",b)})});return this.$hI.get_$8z()},$5YC:function(b,a){!this.$hI.get_$8z().get_$SQ()&&a.$1rg===2&&this.$hI.$66s(true);this.$17.$27("ACE",new Common.App.SkypeChat.$Pq(a.$1rg===2))},get_$2Ji:function(){return this.$xi.get_$n7()?1:0},get_$5UM:function(){return 0},get_$4Mh:function(){return true},$5Px:function(e,f,g){this.$1cR=this.$4A.$13t("ServerNotification","JoinSkypeChatThreadClient");var a=this,c=function(){a.$1cR.$4x();f()},b=this,d=function(){b.$1cR.$4x();g()};this.$1cR.$2k();this.$xi.$2yp(e,c,d)},add_$2Jj:function(a){this.$17.$1O("PSC",a)},add_$5UN:function(){},add_$3Ih:function(){},$5sz:function(a){var b=this,c=this;this.$xi.$2yp(a,function(){},function(){});this.$xi.$wK()},$641:function(){},$3qV:function(){}};Common.App.SkypeChat.$L8=function(a,b){this.$2Wt=a;this.$2iw=b};Common.App.SkypeChat.$L8.prototype={$2Wt:null,$2iw:null,$x:function(a){switch(a){case 1:return this.$2Wt.get_$Q();case 0:return this.$2iw.get_$Q();default:Diag.$2.$9(9000768,333,10,"unknown DocChatExperience");return null}}};Common.App.SkypeChat.$L9=function(a){this.$1vL=a};Common.App.SkypeChat.$L9.prototype={$1vL:null,$sd:null,$Mm:null,$Vp:0,$7Y:function(a){this.$Vp=a},get_$3Ad:function(){if(this.$Vp!==1)return $$sc.$30.$iV(String,"");if(this.$sd)return this.$sd.get_$8z();this.$sd=new($$sc.$5l.$$(String));var a=this;this.$1vL.CW(function(){a.$Mm=a.$1vL.get_$5k().$x(null);a.$Mm.$7Y().CW(function(){a.$Mm.get_$3dS().CW(function(){a.$sd.$9D(a.$Mm.get_$3dS().get_$5k())})})});return this.$sd.get_$8z()}};Common.App.SkypeChat.$rF=function(a){this.BaseDocQuerySignature=a};Common.App.SkypeChat.$rF.prototype={BaseDocQuerySignature:null,$1VY:function(){return Common.$1s.$5B([this.$12a(),this])}};Common.App.SkypeChat.$h9=function(a){Common.App.SkypeChat.$h9.initializeBase(this,[a])};Common.App.SkypeChat.$h9.prototype={$12a:function(){return 1}};Common.App.SkypeChat.$h8=function(a){Common.App.SkypeChat.$h8.initializeBase(this,[a])};Common.App.SkypeChat.$h8.prototype={$12a:function(){return 3}};Common.App.SkypeChat.$hA=function(a){Common.App.SkypeChat.$hA.initializeBase(this,[a])};Common.App.SkypeChat.$hA.prototype={ThreadId:null,$12a:function(){return 2}};Common.App.SkypeChat.$Fp=function(){};Common.App.SkypeChat.$Fp.$QA=function(a){if(!a){Diag.$2.$9(5328905,333,10,"Response from SkypeProxy was null");return null}try{return Common.$1s.$QA(a)}catch(b){Diag.$2.$9(5328906,333,10,"could not parse the response of request: {0}",a.substr(0,Math.min(a.length,250)))}return null};Common.App.SkypeChat.$Nr=function(a,b,c,d,e){this.$$d_$va=Function.createDelegate(this,this.$va);this.$$d_$144=Function.createDelegate(this,this.$144);this.$$d_$3k1=Function.createDelegate(this,this.$3k1);Common.App.SkypeChat.$Nr.initializeBase(this);this.$IS=a;this.$22e=b;this.$22i=c;this.$1fd=d;this.$zn=e};Common.App.SkypeChat.$Nr.prototype={$9U:null,$zm:null,$IS:null,$22e:null,$22i:null,$zn:null,$22h:null,$1fd:null,$1Me:null,$h4:null,$A2:false,$7Y:function(a){this.$1fd.$7Y(a);Diag.$2.$9(9000769,333,50,"Init - RtcChatAvailabilityFinder");return $$sc.$30.WAA(this.$1fd.get_$3Ad(),this.$IS,this.$22i,this.$zn,this.$22e).CW(this.$$d_$3k1)},$3k1:function(){Diag.$2.$9(6603968,333,50,"All prerequisite ready for RtcChatAvailabilityFinder");this.$9U=this.$IS.get_$5k();this.$22h=this.$22i.get_$5k();this.$zm=this.$22e.get_$5k();this.$h4=this.$1fd.get_$3Ad().get_$5k();this.$1Me=this.$zn.get_$5k();this.$9U.add_$1hB(this.$$d_$144);this.$9U.add_$vh(this.$$d_$va);if(!this.$h4&&!this.$zm.get_$1iF()){Diag.$2.$9(6603969,333,10,"Email in presence context is null or undefined. This will cause Skype to not work");return}this.$zm.set_$1iF(this.$zm.get_$1iF()||this.$h4);this.$2MW(true);this.$A2=true;this.$1B5()},$2MW:function(a){if(!this.$zm||!this.$22h)return;if(a)this.$zm.get_$1gj().$2MF(4);else this.$zm.get_$1gj().$67g(4);this.$22h.$2Ld()},$144:function(){this.$1B5()},$va:function(){this.$1B5()},$1B5:function(){if(!this.$A2){Diag.$2.$9(6603970,333,50,"Anyone to chat with was called before component was initialized");this.$1oh(false);return false}if(this.$9U.get_$tA()!==2){Diag.$2.$9(6649866,333,50,"Rtc Connection not yet established: state:{0}",this.$9U.get_$tA());this.$1oh(false);return false}var b=this.$9U.$1k6(),a=this.$3ge(b);this.$1oh(a);return a},$3ge:function(d){if(!d)return false;var b=d;for(var c in b){var e={key:c,value:b[c]},a=this.$1Me.$3aQ(e);if(a&&a.get_$1iF()&&a.get_$1gj()&&a.get_$1gj().$1Di(4)&&a.get_$1iF()!==this.$h4)return true}return false}};Common.App.SkypeChat.$UC=function(a,b,c,d,e){this.$$d_$5Yi=Function.createDelegate(this,this.$5Yi);this.$$d_$5Yj=Function.createDelegate(this,this.$5Yj);this.$$d_$3lK=Function.createDelegate(this,this.$3lK);this.$$d_$3lL=Function.createDelegate(this,this.$3lL);this.$$d_$5c4=Function.createDelegate(this,this.$5c4);this.$$d_$5c5=Function.createDelegate(this,this.$5c5);this.$$d_$10r=Function.createDelegate(this,this.$10r);this.$$d_$5at=Function.createDelegate(this,this.$5at);this.$$d_$5Y3=Function.createDelegate(this,this.$5Y3);this.$$d_$5ab=Function.createDelegate(this,this.$5ab);this.$$d_$3lt=Function.createDelegate(this,this.$3lt);this.$$d_$5Y6=Function.createDelegate(this,this.$5Y6);this.$$d_$5Y7=Function.createDelegate(this,this.$5Y7);this.$$d_$5l1=Function.createDelegate(this,this.$5l1);this.$$d_$5Pu=Function.createDelegate(this,this.$5Pu);this.$$d_$409=Function.createDelegate(this,this.$409);this.$$d_$5ib=Function.createDelegate(this,this.$5ib);this.$Cv=a;this.$194=c;this.$xr=false;this.$ci=0;this.$1eH=d;this.$1Z9=e;this.$17i=b};Common.App.SkypeChat.$UC.prototype={$1O2:null,$ci:0,$2VQ:false,$1a1:false,$2dM:false,$24j:false,$2aj:false,$2V4:false,$xr:false,$1uQ:false,$1KU:false,$2aC:false,$Vp:0,$194:null,$zN:null,$1eH:null,$1Z9:null,$2Yz:false,$zw:null,$Cv:null,$17i:null,$IF:null,$2Sf:null,$fp:null,get_$1GB:function(){return Common.$7t.$545(this.$Vp)},get_$3f3:function(){return this.$1uQ&&this.$2aC},$5lC:function(a){this.$Vp=a;if(this.$zw)return this.$zw.get_$8z();this.$zw=new($$sc.$5l.$$(Boolean));if(!this.$17i){Diag.$2.$9(8730523,333,15,"docChatClient is null");this.$zw.$9D(false);return this.$zw.get_$8z()}this.$5IC();return this.$zw.get_$8z()},$3F:function(){Diag.$2.$m(5269512,333,!!this.$Cv,null);this.$Cv.$1W(this.get_$1GB().$1og,2147483648,this.$$d_$5ib,96);this.$Cv.$P(this.get_$1GB().$1qh,2147483648,this.$$d_$409);this.$Cv.$P(this.get_$1GB().$2yo,2147483648,this.$$d_$5Pu);this.$Cv.$1W(this.get_$1GB().$330,2147483648,this.$$d_$5l1,96)},$5IC:function(){this.$IF=this.$17i.$x(this.$Vp);var b=this.$IF.$3pq(),a=this;b.CW(function(){var c=b.get_$5k();a.$3kl(c);a.$zw.$9D(c)})},$5ab:function(b,a){this.$ci=a.$87;this.$1FP()},$3lt:function(){this.$1FP();this.$2VQ=this.$2VQ||this.$IF.get_$2Ji()===1;this.$5Sa()},$5Sa:function(){if(this.$1KU&&this.$IF.get_$2Ji()===1&&!this.$2Yz){Diag.$2.$9(6129288,333,50,"Group chat started and pane toggled");this.$2Yz=true}},$10r:function(b,a){this.$1uQ=a.get_$2xH();this.$1FP()},$4r7:function(){this.$1eH.$4NN(this.$$d_$5Y7,this.$$d_$5Y6)},$5at:function(b,a){this.$3rI(this.$194.get_$5k());this.$Cv.$4J(2246375352,2,a.$g3)},$3kl:function(c){if(!c){Diag.$2.$9(9000770,333,10,"Doc chat client not ready");return}this.$3F();this.$xr=true;this.$ci=this.$IF.get_$5UM();this.$IF.add_$2Jj(this.$$d_$3lt);this.$IF.add_$5UN(this.$$d_$5ab);this.$IF.add_$10r(this.$$d_$5Y3);var a=this;this.$194.CW(function(){a.$5ax()});var b=this;this.$1Z9.$7Y(this.$Vp).CW(function(){b.$5XT()});!this.$Vp&&this.$4r7();this.$3vH(true)},$5Y3:function(b,a){this.$3vH(a.$1sU)},$3vH:function(a){this.$2aC=a;this.$1FP()},$5ax:function(){this.$zN=this.$194.get_$5k();this.$zN.add_$1Tz(this.$$d_$5at);this.$zN.$7Y();this.$24j=true},$5XT:function(){Diag.$2.$9(9000771,333,50,"AvailabilityFinder ready");this.$1Z9.add_$10r(this.$$d_$10r);this.$1uQ=this.$1Z9.$1B5();this.$1FP()},$5ib:function(d,e,f,g,c){var a=c,b=this.$5zg();a[CommandUI.Controls.$48.Visible]=b;this.$5zR(a);this.$5S5(b);return 32},$5zR:function(a){if(!this.$Vp){a.On=!!this.$IF&&this.$xr&&this.$IF.get_$2Ji()===1;a.DisplayMode=!this.get_$1GB().$2FF&&this.$ci>0?"Medium":"Small";a[CommandUI.Controls.$48.LabelText]=this.$ci.toString()}},$5S5:function(a){if(a&&!this.$2V4){Diag.$2.$9(6350045,333,50,"Setting visibility of the chat button to true");this.$2V4=true}},$5zg:function(){return this.$xr&&(this.get_$3f3()||!this.get_$1GB().$2FF&&this.$ci>0)},$5Pu:function(c,d,a,e,b){if(a!==2)return 32;if(this.$2aj){Diag.$2.$9(8451935,333,50,"Join operation was called more than once");return 32}if(this.$fp){Diag.$2.$9(8451936,333,50,"");return 32}if(this.$1O2){Diag.$2.$9(5616858,333,50,"Trying to join again when the previous join operation failed");return 8}if(!this.$xr){Diag.$2.$9(16808076,333,15,"Join operation before client is ready");return 8}this.$2aj=true;this.$1O2=b;this.$5Pv(this.$1O2);return 32},$5Pv:function(a){if(!this.$IF.get_$4Mh())this.$1eH.$5Pz(this.$$d_$5c5,this.$$d_$5c4);else{this.$1O2=a;this.$IF.$5Px(a,this.$$d_$3lL,this.$$d_$3lK)}},$5c4:function(){this.$3lK()},$3lK:function(){Diag.$2.$9(5616860,333,50,"Join operation failed")},$5c5:function(c){if(!c.$1v){Diag.$2.$9(6612680,333,10,"OnServerJoinSuccess e.Data is null");return}var a=c.$1v.$7c;if(!a){Diag.$2.$9(5616861,333,10,"ResponseData is null");return}var b=Common.App.SkypeChat.$Fp.$QA(a);if(!b)return;if(!b.Success){Diag.$2.$9(5616862,333,50,"Join chat thread operation did not add the user successfully");return}this.$3lL()},$3lL:function(){this.$fp=this.$1O2;this.$IF.$3qV(this.$fp);this.$3jV(this.$fp);Diag.$2.$9(5616863,333,50,"Join operation was successful")},$3jV:function(b){if(this.$2dM)return;var a=this;this.$194.CW(function(){var c=a.$194.get_$5k();c.$3jU(b);a.$3rI(a.$zN)});this.$2dM=true},$3rI:function(a){if(this.$24j){a.remove_$1Tz(this.$$d_$5at);a.$4x();this.$24j=false}},$409:function(b,c,a){if(a===2){if(!this.$xr)return 8;if(this.$1a1)return 1;this.$1KU=true;if(this.get_$3f3()&&!this.$fp){Diag.$2.$9(5616864,333,50,"Trying to create a new thread");this.$1a1=true;this.$1eH.$4jK(this.$$d_$5Yj,this.$$d_$5Yi)}else this.$399(this.$fp)}return this.$xr?32:8},$5Yj:function(d){Diag.$2.$9(5616865,333,50,"Thread created successfully");var b=false;if(d.$1v){var c=d.$1v.$7c;if(c){var a=Common.App.SkypeChat.$Fp.$QA(c);if(a&&a.Success){Diag.$2.$9(5328903,333,50,"SkypeChatThreadId is :{0}",a.ThreadId);this.$fp=a.ThreadId;this.$399(this.$fp);this.$3jV(this.$fp);b=true}else Diag.$2.$9(5616866,333,10,"Could not parse the response, parsed response is null or create thread operation failed.")}else Diag.$2.$9(5328902,333,10,"ResponseData is null")}else Diag.$2.$9(5328901,333,10,"e.Data is null");if(!b){this.$3xk();this.$399(this.$fp)}this.$1a1=false},$3xk:function(){},$5Yi:function(){this.$1a1=false;this.$3xk();Diag.$2.$9(5328904,333,15,"Try to create thread for this user failed")},$5Y7:function(c){Diag.$2.$9(6612681,333,50,"ChatThreadLookup request passed");if(c.$1v){var b=c.$1v.$7c;if(b){var a=Common.App.SkypeChat.$Fp.$QA(b);if(!a)Diag.$2.$9(7079710,333,10,"Parsed response of thread lookup request is null");else if(a.Success&&a.ThreadId){Diag.$2.$9(6612682,333,50,"ChatThreadLookup thread Id :{0}",a.ThreadId);this.$2Sf=a.ThreadId;this.$IF.$3qV(this.$2Sf);this.$1FP()}else Diag.$2.$9(6612683,333,50,"ChatThreadLookup operation failed.")}else Diag.$2.$9(6612684,333,10,"ChatThreadLookup ResponseData is null")}else Diag.$2.$9(6612685,333,10,"ChatThreadLookup e.Data is null")},$5Y6:function(){Diag.$2.$9(6612686,333,15,"ChatThreadLookup request failed")},$5l1:function(){this.$1FP();return 32},$399:function(a){this.$IF.$5sz(a)}};Common.App.SkypeChat.$Jt=function(a,b,c,d){this.$$d_$5pQ=Function.createDelegate(this,this.$5pQ);this.$$d_$va=Function.createDelegate(this,this.$va);this.$$d_$3k1=Function.createDelegate(this,this.$3k1);Common.App.SkypeChat.$Jt.initializeBase(this);Diag.$2.$9(5895065,333,50,"Initializing chat notifier");this.$IS=a;this.$1Lk=c;this.$1dt=b;this.$zn=d};Common.App.SkypeChat.$Jt.prototype={$IS:null,$9U:null,$1dt:null,$1Lk:null,$HX:null,$1Na:false,$24k:false,$2em:false,$zn:null,$1Me:null,$7Y:function(){return this.$1Na?$$sc.$30.$iV(Boolean,false):$$sc.$30.WAA.call(null,this.$zn,this.$IS,this.$1Lk).CW(this.$$d_$3k1)},$3k1:function(){Diag.$2.$9(6603971,333,50,"All prerequisite ready for SkypeChatNotifier");this.$1Me=this.$zn.get_$5k();this.$HX=this.$1Lk.get_$5k();if(this.$1Na)return;this.$9U=this.$IS.get_$5k();this.$3m8(this.$9U.$1k6());Diag.$2.$9(5898719,333,50,"Subscribing to presence updates");this.$9U.add_$vh(this.$$d_$va);this.$24k=true},$va:function(b,a){if(!this.$HX)return;if(this.$1Na)return;if(!this.$2em){this.$2em=true;Diag.$2.$9(6555618,333,50,"SkypeChat complemented recorded presence update")}this.$3m8(a.$1IO)},$3m8:function(f){var c=f;for(var d in c){var e={key:d,value:c[d]},a=this.$1Me.$3aQ(e);if(!a)continue;var b=a.get_$3yQ();if(b&&a.get_$Hi()!==this.$HX.get_$Hi()){Diag.$2.$9(5895069,333,50,String.format("A new chat thread id found : {0}",b));this.$32j(b);return}}},$3jU:function(a){return this.$1dt.CWO(this.$$d_$5pQ,a)},$4x:function(){if(this.$1Na)return;Diag.$2.$9(5898721,333,50,"Un-subscribing from presence updated");if(this.$24k){this.$9U.remove_$vh(this.$$d_$va);this.$24k=false}this.$1Na=true},$5pQ:function(c,b){var a=this;$$sc.$30.WAA(this.$1Lk,this.$1dt).CW(function(){a.$1Lk.get_$5k().set_$3yQ(b);Diag.$2.$9(5898752,333,50,"Re-sending the latest presence with the chat id:",b);a.$1dt.get_$5k().$2Ld()})}};Common.App.SkypeChat.$h3=function(a,b){this.$$d_$5as=Function.createDelegate(this,this.$5as);Common.App.SkypeChat.$h3.initializeBase(this);this.$19Y=a;this.$1Js=b};Common.App.SkypeChat.$h3.prototype={$19Y:null,$1Js:null,$22g:null,$1ae:null,$lk:false,$1du:false,$1af:false,$7Y:function(){if(this.$lk)return $$sc.$30.$iV(Boolean,false);var a=this,c=this.$19Y.CW(function(){a.$22g=a.$19Y.get_$5k();a.$22g.$7Y().CW(function(){if(!a.$1du){a.$19Y.get_$5k().add_$1Tz(a.$$d_$5as);a.$1du=true}})}),b=this,d=this.$1Js.CW(function(){b.$1ae=b.$1Js.get_$5k();b.$1ae.$7Y().CW(function(){if(!b.$1af){b.$1ae.add_$1Tz(b.$$d_$5as);b.$1af=true}})});return $$sc.$30.WAA(c,d)},$4x:function(){if(this.$lk)return;if(this.$1du){this.$22g.remove_$1Tz(this.$$d_$5as);this.$1du=false}if(this.$1af){this.$1ae.remove_$1Tz(this.$$d_$5as);this.$1af=false}var a=this;this.$3GD(function(a){a.$4x()});this.$lk=true},$3jU:function(a){var b=this;return this.$3GD(function(b){b.$3jU(a)})},$5as:function(b,a){if(this.$lk)return;this.$32j(a.$g3)},$3GD:function(a){var b=this,d=this.$19Y.CW(function(){a(b.$19Y.get_$5k())}),c=this,e=this.$1Js.CW(function(){a(c.$1Js.get_$5k())});return $$sc.$30.WAA(d,e)}};Common.App.SkypeChat.$h5=function(){};Common.App.SkypeChat.$h5.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.SkypeChat.$h5)};Common.App.SkypeChat.$h5.prototype={get_$5j:function(){return"Common.App.SkypeChat"},$t9:function(a){var b=this;a.$e(Common.App.SkypeChat.$IQ).$p().$n(function(){return new Common.App.SkypeChat.$IQ(Common.Utils.$5U.$V9(BasicChat.$FE,a.$3j(BasicChat.$FE)),Common.$0.get_$1Y().get_$CN())});var c=this;a.$e(Common.App.SkypeChat.$L8).$1p(Common.App.SkypeChat.$RZ).$p().$n(function(){return new Common.App.SkypeChat.$L8(new($$sc.$x.$$(Common.App.SkypeChat.$IQ))(function(){return a.$J(Common.App.SkypeChat.$IQ)}),new($$sc.$x.$$(Common.App.SkypeChat.$K9))(function(){return a.$J(Common.App.SkypeChat.$K9)}))});var d=this;a.$e(Common.App.SkypeChat.$L9).$p().$n(function(){return new Common.App.SkypeChat.$L9(Common.Utils.$5U.$V9(BasicChat.$FE,a.$3j(BasicChat.$FE)))})},$7Y:function(){},$d:function(){}};Common.App.SkypeChat.$K9=function(b,c,a){this.$$d_$6Al=Function.createDelegate(this,this.$6Al);this.$$d_$6An=Function.createDelegate(this,this.$6An);this.$$d_$43K=Function.createDelegate(this,this.$43K);this.$$d_$6Ak=Function.createDelegate(this,this.$6Ak);this.$$d_$6Am=Function.createDelegate(this,this.$6Am);this.$hI=new($$sc.$5l.$$(Boolean));this.$17=new Common.$2y;this.$Ys=b;this.$N9=c;if(!this.$N9)this.$N9="NSI_"+Common.$1O.$x().toString();if(a)this.$1fo=a.$8G("ServerNotification","SkypeChatInit")};Common.App.SkypeChat.$K9.prototype={$2ix:false,$1KU:false,$2Zr:false,$260:false,$2fF:false,$ci:0,$19M:0,$IJ:null,$1fo:null,$N9:null,$Ys:null,get_$2Ji:function(){return this.$19M},get_$5UM:function(){return this.$ci},get_$4Mh:function(){return false},$5Px:function(){Diag.$2.$9(8757446,333,10,"Should not be doing a join on the WebImClient")},add_$10r:function(){},add_$2Jj:function(a){this.$17.$1O("psc",a)},add_$5UN:function(a){this.$17.$1O("umcc",a)},add_$3Ih:function(a){this.$17.$1O("cplf",a)},$3pq:function(){if(this.$2fF)return this.$hI.get_$8z();this.$2fF=true;Diag.$2.$m(8251527,333,!!this.$Ys,null);var a=this;this.$Ys.CW(function(){a.$31U(a.$Ys.get_$5k())});return this.$hI.get_$8z()},$31U:function(a){Diag.$2.$m(8251528,333,!!a,null);this.$IJ=a;this.$5II()},$5II:function(){this.$IJ.$hn("WebImReady");this.$IJ.$ji("WebImReady",this.$$d_$6Am);this.$IJ.$hn("WebImFirstMessage");this.$IJ.$ji("WebImFirstMessage",this.$$d_$6Ak);this.$IJ.$hn("WebImPaneStateChanged");this.$IJ.$ji("WebImPaneStateChanged",this.$$d_$43K);this.$IJ.$hn("WebImUnreadCountChanged");this.$IJ.$ji("WebImUnreadCountChanged",this.$$d_$6An);this.$IJ.$hn("WebImGiveFocus");this.$IJ.$ji("WebImGiveFocus",this.$$d_$6Al);this.$5tH();this.$5SH()},$5tH:function(){var a={};a.contextId=this.$N9;this.$IJ.$P5("VerifyWebImReady",a)},$5SH:function(){var a=this;$$sc.$30.$3N4(15e3).CW(function(){Diag.$2.$9(5804703,333,50,"InitializeWebIm for sessionId - {0}",a.$N9)})},$43K:function(a){Diag.$2.$9(8451937,333,50,"WebImPaneStateChangedHandler");this.$32A(a)},$5xb:function(a){var b=false;if(a!==2){b=this.$19M!==a;this.$19M=a;this.$5Sh(a)}Diag.$2.$9(8451938,333,50,"stateChanged = {0}, newState ={1} ",b,a);return b},$5Sh:function(a){if(!this.$2ix&&a===1){Diag.$2.$9(8451939,333,50,"WebIM pane opened");this.$2ix=true}},$32A:function(d){var a=2;try{var b=d.Values.PaneState,c=b?b.toLowerCase():null;a=c==="open"?1:0;Diag.$2.$9(8451968,333,50,"PaneState : {0}",c)}catch(e){Diag.$2.$9(8451969,333,10,"Exception reading PaneState from {0} message.  Exception: {1}",d.MessageId,e)}if(this.$5xb(a)){if(!this.$2Zr){Diag.$2.$9(8451970,333,50,"Initial WebIm pane state : {0}",a);this.$2Zr=true}this.$17.$27("psc",new Common.App.BasicChat.$NR(this.$19M))}},$6An:function(a){this.$3ns(a);this.$32A(a)},$3ns:function(c){var a=0;try{var b=c.Values.UnreadCount;if(!isNullOrUndefined(b))a=parseInt(b.toString(),10)}catch(d){Diag.$2.$9(8451971,333,50,"Exception reading Count from {0} message.  Exception: {1}",c.MessageId,d)}if(!isNaN(a)&&isFinite(a)&&a>0&&this.$ci!==a){this.$ci=a;this.$17.$27("umcc",new Common.App.SkypeChat.$X7(this.$ci))}},$6Ak:function(b){var a=null;try{a=b.Values.isSend}catch(c){Diag.$2.$9(6635678,333,10,"Exception reading IsSend from {0} message. Exception: {1}",b.MessageId,c)}if(!a)Diag.$2.$9(8451973,333,50,"Could not read the IsSend property");else Diag.$2.$9(6635677,333,50,"WebImFirstMessage IsSend:{0}",a)},$6Am:function(a){Diag.$2.$9(8251529,333,50,"WebImReadyHandler");if(this.$1fo){this.$1fo.$4x();this.$1fo=null}this.$hI.$9D(true);this.$3ns(a);this.$32A(a)},$5sz:function(b){if(b&&!this.$1KU){Diag.$2.$9(8451974,333,50,"Starting group chat");var a={};a.groupId=b.toLocaleLowerCase();this.$IJ.$P5("StartGroupChat",a);this.$1KU=true}else{Diag.$2.$9(8451975,333,50,"Group chat already initiated just toggle message pane");this.$IJ.$P5("ToggleMessagingPane",null)}},$3qV:function(a){if(!a||this.$260){Diag.$2.$9(8451976,333,50,"TId:{0},NT:{1}",this.$260,!a);return}Diag.$2.$9(8451977,333,50,"Sent RegisterThreadId postmessage");var b={};b.groupId=a.toLocaleLowerCase();this.$IJ.$P5("RegisterThreadId",b);this.$260=true},$641:function(){if(!this.$IJ){Diag.$2.$9(8451978,333,15,"Can't give focus to the webim because host postmessenger is not available");return}if(this.$19M===1)this.$IJ.$P5("WebImTakeFocus",null);else Diag.$2.$9(8451979,333,50,"Could not take focus because pane state is {0}",this.$19M)},$6Al:function(b){Diag.$2.$9(8451980,333,50,"WebImGiveFocusHandler called due to ctrl+f6 in webim");this.$43K(b);var a=false;try{a=b.Values.Direction.toLowerCase()==="backward"}catch(c){Diag.$2.$9(8451981,333,10,"Exception reading Direction from WebImGiveFocusHandler message.  Exception: {0}",c)}this.$17.$27("cplf",new Common.App.SkypeChat.$X8(a))}};Common.$Ha.registerClass("Common.$Ha");Common.App.SkypeChat.$rD.registerClass("Common.App.SkypeChat.$rD");Common.App.SkypeChat.$rJ.registerClass("Common.App.SkypeChat.$rJ");Common.App.SkypeChat.$rK.registerClass("Common.App.SkypeChat.$rK");Common.App.SkypeChat.$rI.registerClass("Common.App.SkypeChat.$rI",null,Common.App.SkypeChat.$jp);Common.App.SkypeChat.$rH.registerClass("Common.App.SkypeChat.$rH",null,Common.$J5);Common.App.SkypeChat.$rG.registerClass("Common.App.SkypeChat.$rG",null,Common.App.SkypeChat.$ME);Common.App.SkypeChat.$Pq.registerClass("Common.App.SkypeChat.$Pq",Sys.EventArgs,Common.App.SkypeChat.$jo);Common.App.SkypeChat.$X6.registerClass("Common.App.SkypeChat.$X6",Common.App.SkypeChat.$rI);Common.App.SkypeChat.$Yb.registerClass("Common.App.SkypeChat.$Yb");Common.App.SkypeChat.$IQ.registerClass("Common.App.SkypeChat.$IQ",null,Common.App.SkypeChat.$ju);Common.App.SkypeChat.$L8.registerClass("Common.App.SkypeChat.$L8",null,Common.App.SkypeChat.$RZ);Common.App.SkypeChat.$L9.registerClass("Common.App.SkypeChat.$L9",null,Common.App.SkypeChat.$b6);Common.App.SkypeChat.$rF.registerClass("Common.App.SkypeChat.$rF");Common.App.SkypeChat.$h9.registerClass("Common.App.SkypeChat.$h9",Common.App.SkypeChat.$rF);Common.App.SkypeChat.$h8.registerClass("Common.App.SkypeChat.$h8",Common.App.SkypeChat.$rF);Common.App.SkypeChat.$hA.registerClass("Common.App.SkypeChat.$hA",Common.App.SkypeChat.$rF);Common.App.SkypeChat.$Fp.registerClass("Common.App.SkypeChat.$Fp");Common.App.SkypeChat.$Nr.registerClass("Common.App.SkypeChat.$Nr",Common.App.SkypeChat.$rI);Common.App.SkypeChat.$UC.registerClass("Common.App.SkypeChat.$UC",null,Common.App.SkypeChat.$RY);Common.App.SkypeChat.$Jt.registerClass("Common.App.SkypeChat.$Jt",Common.App.SkypeChat.$rH);Common.App.SkypeChat.$h3.registerClass("Common.App.SkypeChat.$h3",Common.App.SkypeChat.$rH);Common.App.SkypeChat.$h5.registerClass("Common.App.SkypeChat.$h5",null,Common.App.$jx,Common.Utils.$l6);Common.App.SkypeChat.$K9.registerClass("Common.App.SkypeChat.$K9",null,Common.App.SkypeChat.$ju);Common.App.SkypeChat.$h5.$5Sr();Type.registerNamespace("Common.App.TellMe");Common.App.TellMe.$kb=function(){};Common.App.TellMe.$kb.registerInterface("Common.App.TellMe.$kb");Common.App.TellMe.$kc=function(){};Common.App.TellMe.$kc.registerInterface("Common.App.TellMe.$kc");Common.App.TellMe.$kd=function(){};Common.App.TellMe.$kd.registerInterface("Common.App.TellMe.$kd");Common.App.TellMe.$lO=function(){};Common.App.TellMe.$lO.registerInterface("Common.App.TellMe.$lO");Common.App.TellMe.$kw=function(){};Common.App.TellMe.$kw.registerInterface("Common.App.TellMe.$kw");Common.App.TellMe.$lA=function(){};Common.App.TellMe.$lA.registerInterface("Common.App.TellMe.$lA");Common.App.TellMe.$lD=function(){};Common.App.TellMe.$lD.registerInterface("Common.App.TellMe.$lD");Common.App.TellMe.$lH=function(){};Common.App.TellMe.$lH.registerInterface("Common.App.TellMe.$lH");Common.App.TellMe.$qU=function(){this.PopulationXML=null;this.Value=null;this.CommandValueId=null};Common.App.TellMe.$lJ=function(){};Common.App.TellMe.$lJ.registerInterface("Common.App.TellMe.$lJ");Common.App.TellMe.$lL=function(){};Common.App.TellMe.$lL.registerInterface("Common.App.TellMe.$lL");Common.App.TellMe.$kK=function(){};Common.App.TellMe.$kK.registerInterface("Common.App.TellMe.$kK");Common.App.TellMe.$IJ=function(){};Common.App.TellMe.$IJ.$4Qz=function(a){var b=[];while(a){Array.add(b,Common.App.TellMe.$IJ.$5tJ(a));a=a.get_$Du()}b.reverse();return"{"+b.join(", ")+"}"};Common.App.TellMe.$IJ.$5tJ=function(a){return"{ContextId:"+a.get_$3t()+", IsGraphNodeContext:"+a.get_$DK()+"}"};Common.App.TellMe.$Mg=function(){};Common.App.TellMe.$Mg.prototype={neighborhood:null,mentionStart:0,mentionLength:0};Common.App.TellMe.$WD=function(a){this.$2gC=a};Common.App.TellMe.$WD.prototype={$2gC:null,get_$5qF:function(){return 0},$1hd:function(a,b){var c=b.get_$35Q()+"|"+b.get_$3eH()+"|"+a.$Q,d=String.format(CommonUIStrings.l_HelpButtonText,a.$Q);return this.$4ut(c,Common.$9.$3O(d))},$4ut:function(b,a){return Common.$m.$OQ("bSearchHelp",this.$2gC,a,"OfficeAssistant_16x16x32","A0",Common.$9.$3O(b),a,null,null)}};Common.App.TellMe.$Kl=function(a,b){this.$2W8=a||{};this.$hB=b};Common.App.TellMe.$Kl.$3Hd=function(f,g){var a='<ClonedControl Id="{0}" ';a=String.format(a,f);var c=g;for(var d in c){var b={key:d,value:c[d]},e=b.value?Common.$9.$3O(b.value.toString()):"";a+=String.format('{0}="{1}" ',b.key,e)}a+="/>";return a};Common.App.TellMe.$Kl.prototype={$2W8:null,$hB:null,get_$5qF:function(){return 1},$1hd:function(a,b){return this.$hB.$1hd(a,b)||this.$4Jh(a.$Q)},$4Jh:function(a){var b=this.$2W8[a]||null;return Common.App.TellMe.$Kl.$3Hd(a,b)}};Common.App.TellMe.$LX=function(){};Common.App.TellMe.$LX.$4Jy=function(){return Common.$m.$1PA("bTellMeFirstRun","798637440",Common.$9.$3O(CommonUIStrings.l_LookupFirstRunExperienceTitle),Common.$0.$9R,Common.$n.$6d("Info_32x32x32"),null,null,Common.$9.$3O(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,Common.$9.$3O(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,true)};Common.App.TellMe.$LX.prototype={get_$5qF:function(){return 2},$1hd:function(){return Common.App.TellMe.$LX.$4Jy()}};Common.App.TellMe.$bo=function(a){this.$2Zz=a||CommonUIStrings.l_InsightsButtonText};Common.App.TellMe.$bo.prototype={$2Zz:null,get_$5qF:function(){return 3},$1hd:function(d){var a=d.$Q,b=Common.App.TellMe.$5I.$2nR(a),c=String.format(this.$2Zz,a);return this.$4uj(b,c)},$4uj:function(b,a){return Common.$m.$OQ("bInsights","3317204163",Common.$9.$3O(a),Common.App.TellMe.$5I.get_$2x7(),null,Common.$9.$3O(b),Common.$9.$3O(a),null,null)}};Common.App.TellMe.$d3=function(a){this.$1xL=[];this.$8a=a};Common.App.TellMe.$d3.prototype={$1xL:null,$8a:null,$56A:function(e){for(var b=this.$1xL,d=b.length,a=0;a<d;++a){var c=b[a];if(c.get_$5qF()===e)return c}return null},$14Z:function(a){this.$1xL.push(a)},$5lP:function(a){this.$14Z(new Common.App.TellMe.$Kl(this.$8a.get_$4R6(),a));this.$14Z(new Common.App.TellMe.$dS(this.$8a.get_$5Vb(),null));this.$14Z(new Common.App.TellMe.$WD(this.$8a.get_$5sF()));this.$14Z(new Common.App.TellMe.$bo(null));this.$14Z(new Common.App.TellMe.$LX);this.$14Z(new Common.App.TellMe.$iU);this.$8a.$5lK(this)}};Common.App.TellMe.$dS=function(a,b){this.$21G=a;this.$2dG=b||CommonUIStrings.l_LookupNoResultsDescription};Common.App.TellMe.$dS.prototype={$21G:null,$2dG:null,get_$5qF:function(){return 4},$1hd:function(b){var a=String.format(this.$2dG,b.$Q);return this.$4Kh(a)},$4Kh:function(a){return Common.$m.$1PA("lookupNoResults","798637440",Common.$9.$3O(CommonUIStrings.l_LookupNoResultsTitle),this.$21G?Common.$0.$9R:null,this.$21G,null,null,Common.$9.$3O(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,Common.$9.$3O(a),null,true)}};Common.App.TellMe.$iU=function(){};Common.App.TellMe.$iU.prototype={get_$5qF:function(){return 9},$1hd:function(a){var b=$$as(Common.App.TellMe.$Uf,a);return this.$4uy(Common.$9.$3O(a.$Q),b.$E)},$4uy:function(a,b){return Common.$m.$OQ(b,"1404166600",a,null,null,a,a,null,null)}};Common.App.TellMe.$NB=function(a){this.$zH=[];this.$1ct=a};Common.App.TellMe.$NB.$7s=function(){return new Common.App.TellMe.$NB(5)};Common.App.TellMe.$NB.prototype={$1ct:0,$2DM:function(){return this.$zH},$hp:function(b){var a=b.ControlId;if(this.$5Kx(a))return;if(b.ParentControlId&&b.ParentControlId!=="sbTellMe")a=b.ParentControlId;if(a==="bSearchHelp"||a==="bTellMeFirstRun"||a==="bInsights"||a==="lookupNoResults"||a.startsWith("bTryQuery"))return;this.$5nh(a);this.$5dt();Array.insert(this.$zH,0,a)},$5nh:function(b){var a=Array.indexOf(this.$zH,b);a>=0&&Array.removeAt(this.$zH,a)},$5dt:function(){this.$zH.length===this.$1ct&&Array.removeAt(this.$zH,this.$zH.length-1)},$5Kx:function(d){var c="WA",a=d.split("|"),b="";if(a.length>=6)b=a[0];else if(a.length>=3)b=a[1];return b.startsWith(c)}};Common.App.TellMe.$qc=function(){};Common.App.TellMe.$qc.prototype={$2ct:null,$2S5:null,$1hd:function(a,b){this.$2ct=a;return this.$4ea(a,b)},$5W5:function(){this.$2S5=this.$2ct}};Common.App.TellMe.$eT=function(a){this.$1de=a};Common.App.TellMe.$eT.prototype={$1de:null,$1hd:function(b,c){var a=null;if(b.$1FG){a=this.$1de[b.$Q];if(a)return a.$1hd(b,c)}a=this.$3XF(b.$Q);return a?a.$1hd(a.$2S5,c):null},$5AG:function(g,h){var c=this.$1de[g];if(c)for(var b=h,e=b.length,a=0;a<e;++a){var f=b[a],d=Common.App.TellMe.$5I.$3aI(f);if(d.get_$Ao()===c.get_$5ef())return d.get_$Q()}return null},$5W6:function(b){var a=this.$3XF(b);a&&a.$5W5()},$3XF:function(b){var a=b.indexOf(Common.App.TellMe.$5I.get_$327());return a>0?this.$1de[b.substring(0,a)]:null}};Common.App.TellMe.$Vi=function(a,b){this.$1Il=a;this.$7d=b};Common.App.TellMe.$Vi.prototype={$1Il:null,$7d:0,$1p5:function(a){this.$1Il.$5y0(this.$7d,a)}};Common.App.TellMe.$fZ=function(a){this.$Lh=a;this.$23V=[]};Common.App.TellMe.$fZ.prototype={$2fk:false,$22N:false,$Lh:null,$23V:null,$5y0:function(a,b){this.$23V[a]=b;if(this.$22N)this.$2fk=true;else this.$1SZ()},$5fA:function(){this.$22N=true},$67H:function(){this.$22N=false;this.$2fk&&this.$1SZ()},$1SZ:function(){for(var b=new Common.App.TellMe.$XI,e=this.$23V,g=e.length,c=0;c<g;++c){var a=e[c];if(!a)continue;b.$5N=a.get_$3pb();if(a.get_$5J()&&a.get_$5J().length>0)b.$1H5=a.get_$5J();if(a&&a.get_$34F())for(var f=a.get_$34F(),h=f.length,d=0;d<h;++d){var i=f[d];b.$1B1(i)}}this.$Lh.$1p5(b)}};Common.App.TellMe.$KN=function(){this.$1e2=[]};Common.App.TellMe.$KN.$7s=function(e,b,f){var a=new Common.App.TellMe.$KN;a.$26c(new Common.App.TellMe.$Km(b,f));var c=Common.$0.$o.$1A("TellMeFirstRunExperienceIsEnabled"),d=Common.$0.$o.$1A("TellMeTryQueriesIsEnabled");a.$26c(new Common.App.TellMe.$LK(e,b.get_$66m(),c,d));b.get_$1P6()&&a.$26c(new Common.App.TellMe.$Ka);b.get_$oQ()&&a.$26c(new Common.App.TellMe.$Mh);return a};Common.App.TellMe.$KN.prototype={$1e2:null,$2yS:function(d,e){var b=new Common.App.TellMe.$fZ(e);b.$5fA();for(var a=0;a<this.$1e2.length;++a){var c=new Common.App.TellMe.$Vi(b,a);this.$1e2[a].$2yS(d,c)}b.$67H()},$26c:function(a){this.$1e2.push(a)}};Common.App.TellMe.$Ka=function(){};Common.App.TellMe.$Ka.$2H3=function(a){return!!a&&!!a.$Si&&a.$Si.trim()!==""};Common.App.TellMe.$Ka.prototype={$2yS:function(b,e){if(!Common.App.TellMe.$Ka.$2H3(b))return;var c=new Common.App.TellMe.$EU(1),d=new Common.App.TellMe.$Bf(b.$Si,0,null);c.$dX(d);var a=new Common.App.TellMe.$Jo;a.$1B1(c);a.$5N=b;e.$1p5(a)}};Common.App.TellMe.$Km=function(a,b){this.$3Bz=["TellMe.ParameterizedQueries"];this.$8a=a;this.$hB=b;if(this.$8a.get_$277())this.$xa=this.$8a.$537()};Common.App.TellMe.$Km.$2H3=function(a){return!!a&&!!a.$Si&&a.$Si.trim()!==""};Common.App.TellMe.$Km.prototype={$2bd:"",$22y:null,$2fC:false,$8a:null,$xa:null,$hB:null,get_$2KY:function(){if(!this.$22y&&!this.$2fC){var a=null;try{a=window.TellMeModel}catch(b){Diag.$2.$9(9212881,1300,10,"Exception thrown when loading the model. Exception: {0}",b)}if(a){try{this.$22y=new NLRT.$fC(a)}catch(c){Diag.$2.$9(6576133,1300,10,"Exception thrown when loading classifier. Exception: {0}",c)}this.$2fC=true}else Diag.$2.$9(6576134,1300,15,"Classifier model not found")}return this.$22y},$2yS:function(b,z){var e=new Common.App.TellMe.$Jo;if(!Common.App.TellMe.$Km.$2H3(b))return;this.$8a.get_$277()&&this.$xa&&this.$xa.$8F();var m=b?this.$2bd=b.$Si:this.$2bd,j,f;if(Common.$0.$o.$1A("TellMeParameterizedQueriesEnabled")){var n=this.$5AV(m);j=n.$3aP();f=n.$52r()}else{j=this.$3aP(m);f=[]}for(var a=new Common.App.TellMe.$EU(0),k=j,q=k.length,h=0;h<q;++h){var c=k[h],o=this.$5Kw(c);if(this.$8a.$5PT(c)&&!o){var s=this.$hB.$5AG(c,f),t=new Common.App.TellMe.$Bf(c,1,s);a.$dX(t)}else if(this.$8a.get_$277()&&o&&this.$xa){var u=c.substr(21);this.$xa.$69A(b,u,a)}if(a.$xF.length>=5)break}this.$8a.get_$277()&&this.$xa&&this.$xa.$4Pu(a);if(Common.$0.$o.$1A("TellMeCommandHookIsEnabled")){var d=b.$Si;if(d.length>2&&d.charAt(0)===";"&&d.charAt(d.length-1)===";"){a=new Common.App.TellMe.$EU(6);for(var v=d.split(";"),l=v,r=l.length,i=0;i<r;++i){var p=l[i],g=p.split(":");if(g.length===1){var w=new Common.App.TellMe.$Bf(p,1,null);a.$dX(w)}else if(g.length===2){var x=new Common.App.TellMe.$Bf(g[0],1,g[1]);a.$dX(x)}}}}if(!a.$xF.length&&!this.$8a.get_$oQ()){var y=new Common.App.TellMe.$Bf(b.$Si,4,null);a.$dX(y)}a.$xF.length>0&&e.$1B1(a);e.$5N=b;e.$1H5=f;z.$1p5(e)},$3aP:function(b){var a=[];if(this.get_$2KY())try{a=this.get_$2KY().$53J(b)}catch(c){Diag.$2.$9(6635971,1300,10,"Exception thrown by classifier. Exception: {0}",c)}return a},$5AV:function(a){if(this.get_$2KY())try{return this.get_$2KY().$53K(a,this.$3Bz)}catch(b){Diag.$2.$9(17162523,1300,10,"Exception thrown by classifier with token attributes. Exception: {0}",b)}return null},$5Kw:function(a){return a.startsWith("btnTellMeOfficeAddIn")}};Common.App.TellMe.$Hi=function(a,b,c){this.$2TE=a;this.$2PV=b;this.$2T5=c};Common.App.TellMe.$Hi.prototype={$2TE:null,$2PV:null,$2T5:false};Common.App.TellMe.$LK=function(a,b,c,d){this.$lx=a;this.$1OH=b;this.$25d=d;this.$2Y5=c};Common.App.TellMe.$LK.$2H3=function(a){return!!a&&!!a.$Si&&a.$Si.trim()!==""};Common.App.TellMe.$LK.prototype={$lx:null,$1OH:null,$25d:false,$2Y5:false,$2yS:function(h,o){if(Common.App.TellMe.$LK.$2H3(h))return;var a=new Common.App.TellMe.$Jo;if(!this.$lx.$2DM().length&&this.$2Y5&&!this.$25d){var g=new Common.App.TellMe.$EU(5),j=new Common.App.TellMe.$Bf(null,2,null);g.$dX(j);a.$1B1(g)}var c=new Common.App.TellMe.$EU(5);if(this.$lx.$2DM().length>0){c.$Y3=CommonUIStrings.l_TellMeRecentlyUsedTitle;for(var f=this.$lx.$2DM(),i=f.length,d=0;d<i;++d){var k=f[d],l=new Common.App.TellMe.$Bf(k,1,null);c.$dX(l)}a.$1B1(c)}if(this.$25d&&this.$1OH.length>0&&this.$lx.$2DM().length<5){var e=new Common.App.TellMe.$EU(4);e.$Y3=CommonUIStrings.l_TellMeTryQueryTitle;for(var m=5-c.$xF.length,b=0;b<this.$1OH.length&&b<m;++b){var n=new Common.App.TellMe.$Uf(this.$1OH[b].get_$Ao(),9,this.$1OH[b].get_$Q(),null);e.$dX(n)}a.$1B1(e)}a.$5N=h;o.$1p5(a)}};Common.App.TellMe.$Mh=function(){};Common.App.TellMe.$Mh.$2H3=function(a){return!!a&&!!a.$Si&&a.$Si.trim()!==""};Common.App.TellMe.$Mh.prototype={$2yS:function(b,e){if(!Common.App.TellMe.$Mh.$2H3(b))return;var c=new Common.App.TellMe.$EU(1),d=new Common.App.TellMe.$Bf(b.$Si,3,null);c.$dX(d);var a=new Common.App.TellMe.$Jo;a.$1B1(c);a.$5N=b;e.$1p5(a)}};Common.App.TellMe.$UX=function(){};Common.App.TellMe.$UX.prototype={$Si:""};Common.App.TellMe.$Bf=function(a,b,c){this.$Q=a;this.$19=b;this.$1FG=c};Common.App.TellMe.$Bf.prototype={$Q:null,$19:0,$1FG:null};Common.App.TellMe.$EU=function(a){this.$xF=[];this.$2vg=a};Common.App.TellMe.$EU.prototype={$Y3:null,get_$1i4:function(){return this.$Y3},$xF:null,get_$1FZ:function(){return this.$xF},$dX:function(a){Array.add(this.$xF,a)},$2tv:function(){return this.$2vg},$2vg:0};Common.App.TellMe.$Jo=function(){this.$bq=[]};Common.App.TellMe.$Jo.prototype={$5N:null,get_$3pb:function(){return this.$5N},$bq:null,get_$34F:function(){return this.$bq},$1H5:null,get_$5J:function(){return this.$1H5},$1B1:function(a){this.$bq.push(a)}};Common.App.TellMe.$XI=function(){this.$bq=[]};Common.App.TellMe.$XI.prototype={$5N:null,get_$3pb:function(){return this.$5N},$bq:null,get_$34F:function(){return this.$bq},$1H5:null,get_$5J:function(){return this.$1H5},$1B1:function(b){for(var c=false,a=0;a<this.$bq.length;a++)if(this.$bq[a].$2tv()!==6&&this.$bq[a].$2tv()===b.$2tv()){this.$4FA(this.$bq[a],b);c=true;break}!c&&this.$bq.push(b)},$4FA:function(c,b){for(var a=0;a<b.get_$1FZ().length;a++)c.$dX(b.get_$1FZ()[a])}};Common.App.TellMe.$Uf=function(a,b,c,d){Common.App.TellMe.$Uf.initializeBase(this,[a,b,d]);this.$E=c};Common.App.TellMe.$Uf.prototype={$E:null};Common.App.TellMe.$9Y=function(){this.$$d_$3Nl=Function.createDelegate(this,this.$3Nl);this.$$d_$3eE=Function.createDelegate(this,this.$3eE);this.$$d_$3KM=Function.createDelegate(this,this.$3KM);this.$$d_$3RJ=Function.createDelegate(this,this.$3RJ);this.$$d_$3ht=Function.createDelegate(this,this.$3ht);this.$$d_$3hq=Function.createDelegate(this,this.$3hq);this.$$d_$3eG=Function.createDelegate(this,this.$3eG);this.$$d_$3hr=Function.createDelegate(this,this.$3hr);this.$$d_$3hn=Function.createDelegate(this,this.$3hn);this.$$d_$3hs=Function.createDelegate(this,this.$3hs);this.$$d_$3IA=Function.createDelegate(this,this.$3IA);this.$$d_$3zm=Function.createDelegate(this,this.$3zm)};Common.App.TellMe.$9Y.get_$4=function(){return Common.App.TellMe.$9Y.$T||(Common.App.TellMe.$9Y.$T=new Common.App.TellMe.$9Y)};Common.App.TellMe.$9Y.prototype={$8a:null,$23W:null,$2j4:null,$cY:null,$3CW:null,$K:null,$25:null,$2I:null,$lx:null,$hB:null,$1d1:false,$lC:null,$1wJ:null,$178:null,$s2:0,$2cj:0,$10O:false,$8F:function(d,e,f,b,g,h){this.$8a=d;this.$cY=b;this.$hB=new Common.App.TellMe.$eT(this.$8a.$1Y3);this.$2j4=f||new Common.App.TellMe.$7F(this.$8a,this.$hB);this.$2I=Common.$b.$4();this.$lx=Common.App.TellMe.$NB.$7s();this.$23W=e||Common.App.TellMe.$KN.$7s(this.$lx,this.$8a,this.$hB);this.$K=g||Common.$0.get_$r();this.$25=h||Common.$0.get_$2e();if(!b){var a=new Common.App.TellMe.$Xr;a.$16M=Common.$0.$9g;var c=Common.$H.$5Y(Common.$0.$6J)||Common.$H.get_$1lh();this.$cY=new Common.App.TellMe.$bv(new Common.App.TellMe.$in(this.$8a.$2Pa,c.$JM,a))}this.$3CW=new Common.App.TellMe.$Z0(this.$cY.get_$32r());this.$lC=Common.App.TellMe.$7F.get_$2A1()},$5lD:function(a){Common.$31.$2Kf(this.$$d_$3Nl);Common.$31.$2A8([new Common.$5L(2652476189,2147483648,0),new Common.$5L(2751631965,2147483648,0),new Common.$5L(878547493,2147483648,0),new Common.$5L(4266170064,2147483648,0),new Common.$5L(2303219627,2147483648,0),new Common.$5L(586156566,2147483648,0),new Common.$5L(3243793933,2147483648,0),new Common.$5L(1024534176,2147483648,0),new Common.$5L(2480888384,2147483648,0),new Common.$5L(815990803,2147483648,0),new Common.$5L(4054875485,2147483648,0),new Common.$5L(1404166600,2147483648,0)],a)},$3Nl:function(a,b,c,d,e){if(b.get_$3t()===2147483648)switch(a){case 2652476189:return this.$3zm(a,b,c,d,e);case 2751631965:return this.$3IA(a,b,c,d,e);case 878547493:return this.$3hs(a,b,c,d,e);case 4266170064:return this.$3hn(a,b,c,d,e);case 2303219627:return this.$3hr(a,b,c,d,e);case 586156566:return this.$3eG(a,b,c,d,e);case 3243793933:return this.$5q8(a,b,c,d,e);case 1024534176:return this.$3hq(a,b,c,d,e);case 2480888384:return this.$3ht(a,b,c,d,e);case 815990803:return this.$3RJ(a,b,c,d,e);case 4054875485:return this.$3KM(a,b,c,d,e);case 1404166600:return this.$3eE(a,b,c,d,e)}return 2},$3RJ:function(b,c,a){if(a===1)return 32;this.$2I.$8x(this.$8a.get_$34Q());return Common.$b.$bH($get("sbTellMe"))?32:8},$3eE:function(f,g,d,h,e){if(d===1)return 32;this.$2I.$8x(this.$8a.get_$34Q());var c=e,a=c.CommandValueId;if(a){var b=$get("sbTellMe");if(b)b.value=a}this.$s2++;return Common.$b.$bH($get("sbTellMe"))?32:8},$3KM:function(e,f,c,g,d){if(c===1)return 32;var b=d,a=this.$lC?this.$lC.$2Sq:0;b.Value=a!==1?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,a):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;return 32},$3IA:function(d,e,a,f,b){if(a!==1){var c=this;this.$178=new Common.$1e(2,1,0,function(){b.action()});this.$lC&&this.$25.$2f(this.$178)}return 32},$3hs:function(d,e,f,g,b){if(b){var a=b;this.$10O=a.ControlId.startsWith("bTryQuery");var c=this.$4md(this.$10O,this.$1d1,a.ControlId.endsWith(Common.App.TellMe.$5I.get_$327()));this.$cY.$5YJ(a.ControlId,a.ParentControlId,a.CommandId,a.CloseAllMenus,c);this.$hB.$5W6(a.ControlId);a.CloseAllMenus&&this.$lx.$hp(a)}return 32},$3hn:function(){!this.$10O&&this.$cY.$5aU();return 32},$3hr:function(b,a){!this.$10O&&this.$cY.$1UI(Common.App.TellMe.$IJ.$4Qz(a));return 32},$3hq:function(){!this.$10O&&this.$cY.$1F6();return 32},$3ht:function(){this.$cY.$31X(this.$2cj);return 32},$3eG:function(e,f,b,g,c){if(b===1)return 32;if(Common.$7.get_$2xe())return 32;if(this.$10O){this.$10O=false;return 32}var d=c,a=new Common.App.TellMe.$9Y.$3sd(this,0);this.$1d1=true;this.$lC=Common.App.TellMe.$7F.get_$2A1();this.$23W.$2yS(new Common.App.TellMe.$UX,a);this.$178&&this.$25.$2f(this.$178);return 32},$5q8:function(){this.$2I.$vg(this.$8a.get_$34Q());return 32},$3zm:function(g,h,e,i,f){if(e===1)return 32;var b=f,a=b.Value;if(a&&a.trim()!==""){this.$1d1=false;this.$8a.$4qg();if(a!==this.$1wJ){this.$cY.$4Ih(a,this.$s2);var c=new Common.App.TellMe.$UX;c.$Si=a;var d=new Common.App.TellMe.$9Y.$3sd(this,this.$s2);this.$lC=Common.App.TellMe.$7F.get_$2A1();this.$23W.$2yS(c,d);this.$2cj=this.$s2;this.$1wJ=a;this.$s2++}b.PopulationXML=this.$lC.$1Ye}else if(this.$1d1)b.PopulationXML=this.$lC.$1Ye;else{b.PopulationXML=Common.App.TellMe.$7F.get_$2A1().$1Ye;this.$1wJ=""}return 32},$5SV:function(n,j,o){for(var f=[],d=n.get_$1FZ(),k=d.length,a=0;a<k;++a){var h=d[a];h.$19===1&&f.push(h.$Q)}var g=null;if(j){for(var c=[],e=j,l=e.length,b=0;b<l;++b){var m=e[b],i=Common.App.TellMe.$5I.$3aI(m);c.push(i.get_$Ao()+":"+i.get_$Q())}g=c.length>0?"{"+c.join(", ")+"}":null}this.$cY.$4pO("{"+f.join(", ")+"}",g,o)},$149:function(b,a,c,d){b!==""&&this.$5SV(a[0],c,d);this.$lC=this.$2j4.$4ux(a,this.$cY.get_$32r());this.$178&&this.$25.$2f(this.$178)},$4md:function(a,b,c){return a?"tryQuery":b?"mru":c?"parameterQuery":"query"}};Common.App.TellMe.$9Y.$3sd=function(a,b){this.$2hn=a;this.$s2=b};Common.App.TellMe.$9Y.$3sd.prototype={$2hn:null,$s2:0,$1p5:function(a){this.$2hn.$149(a.get_$3pb().$Si,a.get_$34F(),a.get_$5J(),this.$s2)}};Common.App.TellMe.$qT=function(d,a,b,c){this.$2Pg=a==null?Common.$0.$1P6:a;this.$3BY=c==null?5:c;this.$2RJ=b==null?Common.$0.$oQ:b;this.$5Hk(d||{});this.$2T1="2918242107";this.$1Y3={};this.$1to=[]};Common.App.TellMe.$qT.prototype={$1Yt:null,$2UK:false,$2Pa:null,$2Pg:false,get_$1P6:function(){return this.$2Pg},$2T1:null,get_$5sF:function(){return this.$2T1},$3BK:null,$2RJ:false,get_$oQ:function(){return this.$2RJ},$1XF:false,get_$277:function(){return this.$1XF},get_$5Vb:function(){return Common.$n.$6d("OfficeAssistant_32x32x32")},$5PT:function(a){return!!CommandUI.$6X.get_$4().$3YF(a)},$5lK:function(){},$537:function(){return null},$3BY:0,$1rm:null,get_$4R6:function(){return this.$1rm},$1Y3:null,$1to:null,get_$66m:function(){return this.$1to},$4qg:function(){if(this.$1Yt&&!this.$2UK){this.$2UK=true;this.$36k(this.$1Yt)}},$52Z:function(){throw Error.notImplemented();},$36k:function(){},$4mg:function(b){for(var c=[],a=0;a<b.length;++a)if(b[a].$2T5)c.push(new $$sc.$JA(b[a].$2PV,"bTryQueryAlternate"+a.toString()));else c.push(new $$sc.$JA(b[a].$2TE,"bTryQuery"+a.toString()));return c},$5pq:function(b,e){if(!b||!e)return;e.$5pp(b);this.$1Yt=this.$52Z();for(var g=b.children,c=g,f=c.length,a=0;a<f;++a){var d=c[a],h=d.attrs,i=h.Id;this.$1Yt.$3Ei(i,d)}},$5ps:function(d){var a=this.$1rm;for(var b in a){var c={key:b,value:a[b]};d.$5pv(c.value)}},$5Hk:function(m){var a={},c=m;for(var e in c){var f={key:e,value:c[e]},i=f.key,j=f.value,b=j;for(var d in b){var g={key:d,value:b[d]},h=g.key,k=g.value,l=a[h]||(a[h]={});l[i]=k}}this.$1rm=a}};Common.App.TellMe.$qT.$6BJ=function(){};Common.App.TellMe.$qT.$6BJ.registerInterface("Common.App.TellMe.$qT.$6BJ");Common.App.TellMe.$qT.$6BK=function(){};Common.App.TellMe.$qT.$6BK.registerInterface("Common.App.TellMe.$qT.$6BK");Common.App.TellMe.$qT.$4kf=function(a,b,c){Common.App.TellMe.$qT.$4kf.initializeBase(this,[a,b,null,null,c])};Common.App.TellMe.$qT.$4kf.prototype={$5pv:function(b){var h={},d=b;for(var f in d){var a={key:f,value:d[f]};if(!a.value)continue;var c=a.value.toString();this.$3rx(b,a.key,c);this.$3rw(b,a.key,c);this.$3rv(b,a.key,c,h)}var e=h;for(var g in e){var i={key:g,value:e[g]};b[i.key+"Class"]=i.value}},$5pp:function(a){this.$39z(a)}};Common.App.TellMe.$qS=function(){};Common.App.TellMe.$qS.prototype={$t9:function(){},$d:function(){}};Common.App.TellMe.$Xr=function(){};Common.App.TellMe.$Xr.prototype={$16M:null,get_$35Q:function(){return this.$16M},$15x:null,get_$3eH:function(){return this.$15x}};Common.App.TellMe.$bv=function(a){this.$h1=a;this.$1bo=false;this.$1cv=false};Common.App.TellMe.$bv.prototype={$h1:null,$1bo:false,$1cv:false,get_$32r:function(){return this.$h1.get_$32r()},$4Ih:function(a,b){this.$h1.$5SS(a,b)},$4pO:function(b,c,a){this.$h1.$5SU(b,a);this.$h1.$5SQ(c,a)},$1UI:function(a){this.$h1.$4Ie(a);this.$1bo=true},$1F6:function(){this.$1bo=false;!this.$1cv&&this.$h1.$3Ob()},$5YJ:function(a,b,c,d,e){this.$h1.$5Rx(a,b,c,d,e)},$5aU:function(){this.$1cv=false;!this.$1bo&&this.$h1.$3Ob()},$31X:function(a){this.$h1.$5SK(a);this.$1cv=true}};Common.App.TellMe.$in=function(a,b,c){this.$qT=a;this.$2WJ=b;this.$hJ=c};Common.App.TellMe.$in.prototype={$qT:null,$2WJ:null,$hJ:null,get_$32r:function(){return this.$hJ},$4Ie:function(a){if(!this.$hJ.$15x){this.$hJ.$15x=Common.$1O.$x().toString();this.$5Rv(a)}},$3Ob:function(){this.$hJ.$15x&&this.$5S2();this.$hJ.$15x=null},$5Rv:function(b){var a=this.$1Bi("InteractionBegin");a.Culture=this.$2WJ;a.AppName=this.$qT;a.Context=b;Diag.$2.$9(4334090,1300,50,"{0}",a)},$5S2:function(){var a=this.$1Bi("InteractionEnd");Diag.$2.$9(4334091,1300,50,"{0}",a)},$5SS:function(b,c){var a=this.$1Bi("Query");a.Input=b;a.QueryID=c;Diag.$2.$9(4334092,1300,50,"{0}",a)},$5SU:function(b,c){var a=this.$1Bi("QueryResponse");a.ResultsList=b;a.QueryID=c;Diag.$2.$9(4334093,1300,50,"{0}",a)},$5SQ:function(b,c){if(!b)return;var a=this.$1Bi("ParameterResponse");a.ResultsList=b;a.QueryID=c;Diag.$2.$9(17162522,1300,50,"{0}",a)},$5Rx:function(b,c,d,e,f){var a=this.$1Bi("Click");a.UiElement=b;a.ParentUiElement=c;a.CommandId=d;a.CloseAllMenus=e;a.Source=f;Diag.$2.$9(4334094,1300,50,"{0}",a)},$5SK:function(b){var a=this.$1Bi("MenuLaunched");a.QueryID=b;Diag.$2.$9(4334095,1300,50,"{0}",a)},$1Bi:function(a){return{SessionID:this.$hJ.$16M,CorrelationID:this.$hJ.$15x,Time:+new Date,Event:a}}};Common.App.TellMe.$Z0=function(a){this.$hJ=a};Common.App.TellMe.$Z0.prototype={$hJ:null};Common.App.TellMe.$5I=function(){};Common.App.TellMe.$5I.get_$2x7=function(){return"Insights_16x16x32"};Common.App.TellMe.$5I.get_$327=function(){return"-Parameterized"};Common.App.TellMe.$5I.$3LJ=function(a){return a+Common.App.TellMe.$5I.get_$327()};Common.App.TellMe.$5I.$3aI=function(b){var c="",d="";if(b)for(var a=0;a<b.get_$4rq();++a)if(b.$3Y1(a)==="Type")c=b.$s(a);else if(b.$3Y1(a)==="Value")d=b.$s(a);return new $$sc.$JA(c,d)};Common.App.TellMe.$5I.$2nR=function(b){var a,c=(a=new Common.App.TellMe.$Mg,a.neighborhood=b,a.mentionStart=0,a.mentionLength=b.length,a);return Common.$1s.$5B(c)};Common.App.TellMe.$Qm=function(a,b){this.$1Ye=a;this.$2Sq=b};Common.App.TellMe.$Qm.prototype={$1Ye:null,$2Sq:0};Common.App.TellMe.$7F=function(a,b){this.$8a=a;this.$20n=new Common.App.TellMe.$d3(this.$8a);this.$20n.$5lP(b)};Common.App.TellMe.$7F.get_$2A1=function(){return Common.App.TellMe.$7F.$2XF||(Common.App.TellMe.$7F.$2XF=new Common.App.TellMe.$Qm(Common.$m.$1BL(new Array(0),"LookupDropdownMenu"),0))};Common.App.TellMe.$7F.prototype={$8a:null,$20n:null,$4ux:function(q,r){for(var a=0,h=[],f=q,k=f.length,c=0;c<k;++c){for(var i=f[c],j="MenuTellMe",e=[],g=i.get_$1FZ(),l=g.length,d=0;d<l;++d){var b=g[d],p=this.$20n.$56A(b.$19).$1hd(b,r);e.push(p);if(b.$19===2||b.$19===4)j="Menu32"}a=!a?e.length:a;var n=Common.$m.$sv("TellMeDropdownControls",e),o=Common.$m.$sw("TellMeDropdownMenuSection",n,j,i.get_$1i4());h.push(o)}var m=Common.$m.$1BL(h,"LookupDropdownMenu");return new Common.App.TellMe.$Qm(m,a)}};Common.App.TellMe.$qU.registerClass("Common.App.TellMe.$qU");Common.App.TellMe.$IJ.registerClass("Common.App.TellMe.$IJ");Common.App.TellMe.$Mg.registerClass("Common.App.TellMe.$Mg");Common.App.TellMe.$WD.registerClass("Common.App.TellMe.$WD",null,Common.App.TellMe.$kb);Common.App.TellMe.$Kl.registerClass("Common.App.TellMe.$Kl",null,Common.App.TellMe.$kb);Common.App.TellMe.$LX.registerClass("Common.App.TellMe.$LX",null,Common.App.TellMe.$kb);Common.App.TellMe.$bo.registerClass("Common.App.TellMe.$bo",null,Common.App.TellMe.$kb);Common.App.TellMe.$d3.registerClass("Common.App.TellMe.$d3");Common.App.TellMe.$dS.registerClass("Common.App.TellMe.$dS",null,Common.App.TellMe.$kb);Common.App.TellMe.$iU.registerClass("Common.App.TellMe.$iU",null,Common.App.TellMe.$kb);Common.App.TellMe.$NB.registerClass("Common.App.TellMe.$NB",null,Common.App.TellMe.$kc);Common.App.TellMe.$qc.registerClass("Common.App.TellMe.$qc");Common.App.TellMe.$eT.registerClass("Common.App.TellMe.$eT",null,Common.App.TellMe.$kd);Common.App.TellMe.$Vi.registerClass("Common.App.TellMe.$Vi",null,Common.App.TellMe.$lA);Common.App.TellMe.$fZ.registerClass("Common.App.TellMe.$fZ");Common.App.TellMe.$KN.registerClass("Common.App.TellMe.$KN",null,Common.App.TellMe.$lD);Common.App.TellMe.$Ka.registerClass("Common.App.TellMe.$Ka",null,Common.App.TellMe.$lD);Common.App.TellMe.$Km.registerClass("Common.App.TellMe.$Km",null,Common.App.TellMe.$lD);Common.App.TellMe.$Hi.registerClass("Common.App.TellMe.$Hi");Common.App.TellMe.$LK.registerClass("Common.App.TellMe.$LK",null,Common.App.TellMe.$lD);Common.App.TellMe.$Mh.registerClass("Common.App.TellMe.$Mh",null,Common.App.TellMe.$lD);Common.App.TellMe.$UX.registerClass("Common.App.TellMe.$UX");Common.App.TellMe.$Bf.registerClass("Common.App.TellMe.$Bf");Common.App.TellMe.$EU.registerClass("Common.App.TellMe.$EU",null,Common.App.TellMe.$lO);Common.App.TellMe.$Jo.registerClass("Common.App.TellMe.$Jo",null,Common.App.TellMe.$kw);Common.App.TellMe.$XI.registerClass("Common.App.TellMe.$XI",null,Common.App.TellMe.$kw);Common.App.TellMe.$Uf.registerClass("Common.App.TellMe.$Uf",Common.App.TellMe.$Bf);Common.App.TellMe.$9Y.registerClass("Common.App.TellMe.$9Y");Common.App.TellMe.$9Y.$3sd.registerClass("Common.App.TellMe.$9Y.$3sd",null,Common.App.TellMe.$lA);Common.App.TellMe.$qT.registerClass("Common.App.TellMe.$qT",null,Common.App.TellMe.$lJ);Common.App.TellMe.$qT.$4kf.registerClass("Common.App.TellMe.$qT.$4kf",Common.$t,Common.App.TellMe.$qT.$6BJ,Common.App.TellMe.$qT.$6BK);Common.App.TellMe.$qS.registerClass("Common.App.TellMe.$qS",null,Common.App.$jx,Common.Utils.$l6);Common.App.TellMe.$Xr.registerClass("Common.App.TellMe.$Xr",null,Common.App.TellMe.$lL);Common.App.TellMe.$bv.registerClass("Common.App.TellMe.$bv");Common.App.TellMe.$in.registerClass("Common.App.TellMe.$in",null,Common.App.TellMe.$kK);Common.App.TellMe.$Z0.registerClass("Common.App.TellMe.$Z0");Common.App.TellMe.$5I.registerClass("Common.App.TellMe.$5I");Common.App.TellMe.$Qm.registerClass("Common.App.TellMe.$Qm");Common.App.TellMe.$7F.registerClass("Common.App.TellMe.$7F");Common.App.TellMe.$9Y.$T=null;Common.App.TellMe.$7F.$2XF=null;Type.registerNamespace("RealtimePresenceUI");RealtimePresenceUI.$l1=function(){};RealtimePresenceUI.$l1.registerInterface("RealtimePresenceUI.$l1");RealtimePresenceUI.$PI=function(a){this.$cx=[];this.$3Bo=[];this.dispose=this.$d;this.$Au=a;this.$1Ja=new Common.$A6(this.$Au.$6f,"Anonymous user","#808080",new Common.$Fy(7),null,null,null);this.$1cM=true;this.$1Xn=true;this.$2WM=this.$1Ja};RealtimePresenceUI.$PI.$5dZ=function(c,d){var a=c,b=d;return a.$HI.$1Di(1)&&b.$HI.$1Di(1)||!a.$HI.$1Di(1)&&!b.$HI.$1Di(1)?Common.$9.$2HU(c.$HM,d.$HM):a.$HI.$1Di(1)?-1:1};RealtimePresenceUI.$PI.prototype={$2WM:null,$1Ja:null,$1cM:false,$Au:null,$1Xn:false,$54m:function(f,g,h,i,j){var e,a,b,c,d;e=this.$54n();if(!this.$cx.length){a=false;b="";c="";d=""}else if(this.$cx.length===1){a=true;b=this.$Au.get_$37J().$1H8;c=this.$Au.get_$37J().$1HD;d=this.$cx[0].$HJ}else{a=true;b=this.$Au.get_$30q().$1H8;c=this.$Au.get_$30q().$1HD;d=""}f.val=e;g.val=a;h.val=b;i.val=c;j.val=d},$54n:function(){return this.$cx.length>=2?String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.$cx.length):this.$cx.length===1?String.format(CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,this.$cx[0].$HM):CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself},$5Dv:function(b){return this.$5Dw(b)},$4Mq:function(d,a,c){if(!a){c&&Diag.$2.$9(4482393,325,50,"User does not have any presence data");return false}if(Common.$1z.$2Mr("PeoplesWell",1)){var b;try{b=Common.$1s.$5B(a)}catch(e){b="Error - Failed to serialize presence"}}if(!this.$4Mp(d,a)){c&&Diag.$2.$9(4482394,325,50,"User has presence data but app can't use it");return false}return true},$5CU:function(){return CommonUIStrings.l_PeoplesWellUserStatusIsEditingOffline},$5Dw:function(a){if(!a.$HI.$1Di(1))return this.$5CU(a);var b=this.$Au.$2R1(a.$6f),c=this.$Au.$1sF(a.$6f);if(!b)return CommonUIStrings.l_PeoplesWellUserStatusIsEditingOnline;switch(b.$3I){case 1:return!c?CommonUIStrings.l_PeoplesWellUserStatusIsEditingOnline:this.$4RG(a.$6f,c)||CommonUIStrings.l_PeoplesWellUserStatusIsEditingOnline;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusIsEditingOnline}},$5Do:function(a){var c=String.format("buttonPeoplesWellUser-{0}",a.$6f),d=a.$HM,b=a.$6f,e=this.$5Dv(a),f=Common.$m.$1PA(c,this.$Au.get_$3E0().toString(),d,this.$Au.get_$37K().$1H8,this.$Au.get_$37K().$1HD,b,b,a.$HM,"Menu32",null,null,e,a.$HJ,true);return f},$5Dn:function(c){for(var b=[],a=0;a<c.length;a++){var d=c[a],e=this.$5Do(d);Array.add(b,e)}return b},$5Lb:function(){return this.$cx.length>0},$5jW:function(a){if(!this.$1cM)return true;if(!this.$1Xn)a[CommandUI.Controls.$5A.Visible]=true;var b,c,k,d,e,f,g,h,i,j;this.$54m(f={val:b},g={val:c},h={val:k},i={val:d},j={val:e}),b=f.val,c=g.val,k=h.val,d=i.val,e=j.val;a[CommandUI.Controls.$5A.LabelText]=b;a.ImageIsVisible=c;a[CommandUI.Controls.$5A.Image16by16Class]=d;a.ImageBackColor=e;this.$1cM=false;return true},$5fn:function(e){if(this.$cx.length<=0)return false;var d=this.$61z(this.$cx),c=this.$5Dn(d),a=new Sys.StringBuilder;a.append('<Menu Id="menuCoauthors">');a.append('<MenuSection Id="msCoauthors" DisplayMode="Menu32"><Controls>');for(var b=0;b<c.length;b++)a.append(c[b]);a.append("</Controls></MenuSection>");a.append("</Menu>");e.PopulationXML=a.toString();return true},$69p:function(c){Diag.$2.$9(4482395,325,50,"PeoplesWell: Received user button click");var a=c.MenuItemId;if(!a)return false;var b=this.$Au.$1sF(a);if(!this.$4Mq(a,b,true))return false;this.$5Q2(a,b);return true},$5l2:function(){var c=null,d=[],a=this.$52t();!a.length&&Array.add(a,this.$1Ja);for(var b=0;b<a.length;++b)if(a[b].$6f===this.$Au.$6f)c=a[b];else Array.add(d,a[b]);if(!c){c=this.$1Ja;Array.add(a,this.$1Ja)}if(this.$1Xn&&d.length>=1){Diag.$2.$9(6092429,325,50,"PeoplesWell: User is no longer forever alone.");this.$1Xn=false}this.$2WM=c;this.$cx=d;this.$3Bo=a;this.$1cM=true},$52t:function(){var a=null;if(!a)a=this.$52s()||[];if(Common.$1z.$2Mr("PeoplesWell",1))for(var c=0;c<a.length;++c);for(var b=0;b<a.length;++b)this.$5rD(a[b]);return a},$5rD:function(a){if(!a.$6f)a.$6f=Common.$1O.$x().toString();if(!a.$HM)a.$HM="Anonymous user";if(!a.$HI)a.$HI=new Common.$Fy(0);if(!a.$HJ)a.$HJ="#808080"},$61z:function(b){var a=[];Array.addRange(a,b);a.sort(RealtimePresenceUI.$PI.$5dZ);return a},$5m2:function(){this.$5m3();this.$3qD()},$3qD:function(){this.$5l2();this.$5l3()},$d:function(){}};RealtimePresenceUI.$JV=function(a,b,c,d){this.$7o=a;this.$6f=b;var e=this;this.$1sF=c||function(){return null};var f=this;this.$2R1=d||function(){return null}};RealtimePresenceUI.$JV.$7s=function(d,e,c){if(!c)return new RealtimePresenceUI.$JV(d,e,null,null);var a=c,b=c;return new RealtimePresenceUI.$JV(d,e,a.$$d_$5Dq||(a.$$d_$5Dq=Function.createDelegate(a,a.$5Dq)),b.$$d_$5Du||(b.$$d_$5Du=Function.createDelegate(b,b.$5Du)))};RealtimePresenceUI.$JV.prototype={$7o:null,get_$E:function(){return this.$7o.$3Q},get_$441:function(){return this.$7o.$1rL},get_$445:function(){return this.$7o.$1rP},get_$444:function(){return this.$7o.$1rO},get_$443:function(){return this.$7o.$1rN},get_$442:function(){return this.$7o.$1rM},get_$3E0:function(){return this.$7o.$2PP},get_$446:function(){return this.$7o.$2PO},get_$37J:function(){return this.$7o.$1YH},get_$37K:function(){return this.$7o.$2T6},get_$30q:function(){return this.$7o.$2S9},$6f:null,$1sF:null,$2R1:null};RealtimePresenceUI.$PI.registerClass("RealtimePresenceUI.$PI",null,RealtimePresenceUI.$l1,Sys.IDisposable);RealtimePresenceUI.$JV.registerClass("RealtimePresenceUI.$JV");Type.registerNamespace("Box4.ParagraphRenderMetrics");Box4.ParagraphRenderMetrics.$Nj=function(){};Box4.ParagraphRenderMetrics.$NV=function(a){this.$C5=a};Box4.ParagraphRenderMetrics.$NV.prototype={$2eP:null,$C5:null,$8F:function(a){this.$2eP=new Box4.ParagraphRenderMetrics.$eQ(a,this.$C5)},$66K:function(){return this.$2eP}};Box4.ParagraphRenderMetrics.$eQ=function(a,b){this.$2eO=a;this.$C5=b};Box4.ParagraphRenderMetrics.$eQ.prototype={$1eE:null,$2eO:null,$C5:null,$5oR:function(){this.$1eE=this.$C5()},$5oD:function(b){if(this.$1eE!=null){var a=new Box4.ParagraphRenderMetrics.$Nj;a.RT=Math.round(this.$C5()-this.$1eE);a.PS=b;this.$2eO.$bG(a,null)}this.$1eE=null}};Type.registerNamespace("Common.App.ParagraphRenderMetrics");Common.App.ParagraphRenderMetrics.$eR=function(){};Common.App.ParagraphRenderMetrics.$eR.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.ParagraphRenderMetrics.$eR)};Common.App.ParagraphRenderMetrics.$eR.prototype={get_$5j:function(){return"Common.App.ParagraphRenderMetrics"},$7Y:function(){if(Common.$0.$o.$1A("WordEditorParagraphRenderingMetricsAreEnabled")){var a=1,b=new(Common.Utils.Aggregators.$IB.$$(Box4.ParagraphRenderMetrics.$Nj)),c=Common.Utils.Aggregators.$8o.$$(Box4.ParagraphRenderMetrics.$Nj).$EV(13,a,b,true);Common.Utils.$8.get_$4().$J(Box4.ParagraphRenderMetrics.$NV).$8F(c)}},$d:function(){},$t9:function(a){var b=this;a.$e(Box4.ParagraphRenderMetrics.$NV).$1p(Box4.$SF).$p().$n(function(){return new Box4.ParagraphRenderMetrics.$NV(Common.$J.$1ks)})}};Box4.ParagraphRenderMetrics.$Nj.registerClass("Box4.ParagraphRenderMetrics.$Nj");Box4.ParagraphRenderMetrics.$NV.registerClass("Box4.ParagraphRenderMetrics.$NV",null,Box4.$SF);Box4.ParagraphRenderMetrics.$eQ.registerClass("Box4.ParagraphRenderMetrics.$eQ",null,Box4.$oz);Common.App.ParagraphRenderMetrics.$eR.registerClass("Common.App.ParagraphRenderMetrics.$eR",null,Common.App.$jx,Common.Utils.$l6);Common.App.ParagraphRenderMetrics.$eR.$5Sr();Type.registerNamespace("RealtimePresenceUI");RealtimePresenceUI.$Oy=function(a,b){this.$$d_$5fI=Function.createDelegate(this,this.$5fI);this.$$d_$69q=Function.createDelegate(this,this.$69q);this.$$d_$5fo=Function.createDelegate(this,this.$5fo);this.$$d_$4PT=Function.createDelegate(this,this.$4PT);this.$$d_$4PU=Function.createDelegate(this,this.$4PU);this.$$d_$5jX=Function.createDelegate(this,this.$5jX);this.$$d_$5Lc=Function.createDelegate(this,this.$5Lc);this.$$d_$69r=Function.createDelegate(this,this.$69r);this.$$d_$5fp=Function.createDelegate(this,this.$5fp);this.$$d_$5jY=Function.createDelegate(this,this.$5jY);RealtimePresenceUI.$Oy.initializeBase(this,[a]);var c=this;this.$gV=function(){return true};this.$K=b};RealtimePresenceUI.$Oy.$4J6=function(a){return a?32:8};RealtimePresenceUI.$Oy.prototype={$gV:null,$K:null,$5jY:function(a){return this.$5jW(a)},$5fp:function(a){return this.$5fn(a)},$69r:function(a){return this.$69p(a)},$1Dg:function(f,g,c,h,b,d,e){var a=false;switch(c){case 1:a=d(b);break;case 2:a=e(b)}return RealtimePresenceUI.$Oy.$4J6(a)},$5Lc:function(b,c,d,e,f){var a=this;return this.$1Dg(b,c,d,e,f,function(){return a.$5Lb()},this.$gV)},$5jX:function(a,b,c,d,e){return this.$1Dg(a,b,c,d,e,this.$$d_$5jY,this.$gV)},$5fo:function(a,b,c,d,e){return this.$1Dg(a,b,c,d,e,this.$gV,this.$$d_$5fp)},$4PU:function(a,b,c,d,e){return this.$1Dg(a,b,c,d,e,this.$gV,this.$gV)},$4PT:function(a,b,c,d,e){return this.$1Dg(a,b,c,d,e,this.$gV,this.$gV)},$69q:function(a,b,c,d,e){return this.$1Dg(a,b,c,d,e,this.$gV,this.$$d_$69r)},$5fI:function(b,c,d,e,f){var a=this;return this.$1Dg(b,c,d,e,f,this.$gV,function(){a.$3qD();return true})},$5m3:function(){this.$K.$P(this.$Au.get_$441(),1,this.$$d_$5Lc);this.$K.$1W(this.$Au.get_$445(),1,this.$$d_$5jX,96);this.$K.$1W(this.$Au.get_$443(),1,this.$$d_$4PU,96);this.$K.$1W(this.$Au.get_$442(),1,this.$$d_$4PT,96);this.$K.$P(this.$Au.get_$444(),1,this.$$d_$5fo);this.$K.$P(this.$Au.get_$3E0(),1,this.$$d_$69q);this.$K.$1W(this.$Au.get_$446(),1,this.$$d_$5fI,96)},$d:function(){RealtimePresenceUI.$PI.prototype.$d.call(this)}};RealtimePresenceUI.$Oy.registerClass("RealtimePresenceUI.$Oy",RealtimePresenceUI.$PI);Type.registerNamespace("BPr");BPr.$li=function(){};BPr.$li.registerInterface("BPr.$li");BPr.$lj=function(){};BPr.$lj.registerInterface("BPr.$lj");BPr.$lk=function(){};BPr.$lk.registerInterface("BPr.$lk");BPr.$ll=function(){};BPr.$ll.registerInterface("BPr.$ll");BPr.$c6=function(){};BPr.$c6.registerInterface("BPr.$c6");BPr.$D3=function(){};BPr.$D3.registerInterface("BPr.$D3");BPr.$SX=function(){};BPr.$SX.registerInterface("BPr.$SX");BPr.$It=function(){};BPr.$It.registerInterface("BPr.$It");BPr.SerializablePresenceData=function(a,b){this.ip=a;this.user=b};BPr.SerializablePresenceIpData=function(a,b,c){this.paragraphId=a;this.cp=b;this.length=c};BPr.SerializablePresenceUserData=function(a,b,c,d,e){this.clientId=a;this.skypeChatThreadId=c;this.localColbaltSessionId=b;this.capabilities=d;this.email=e};BPr.$qQ=function(b,c,d,e,f,g,h){this.$$d_$5qz=Function.createDelegate(this,this.$5qz);this.$9U=b;this.$3U=c;this.$4L=d;this.$2i3=f;this.$2X9=g;this.$1yq=h;this.$lj=e;var a=this;this.$3U.set_$2un(function(){return a.$9U.get_$3i2()});this.$9U.add_$1Gp(this.$$d_$5qz)};BPr.$qQ.prototype={$9U:null,$3U:null,$4L:null,$2i3:false,$2X9:0,$1yq:null,$lj:null,$5qz:function(d,c){if(c.$6a)return;this.$1yq.$38("CU");var a=this.$4L.get_$2oo()>=this.$2X9;if(this.$2i3&&a){var b=this.$3U.$4q3();b&&this.$1yq.$38("PI")}else this.$Ob()},$Ob:function(){!this.$lj()&&this.$3U.get_$vD()&&this.$3U.$Ob(null,null,null)}};BPr.$NC=function(){BPr.$NC.initializeBase(this)};BPr.$NC.prototype={$1sm:null,set_$5Rl:function(a){this.$1sm=a;return a},$3Za:function(){var a=!this.$1sm?null:this.$1sm.$KJ;return new BPr.$A6(this.$6f,this.$HM,this.$HJ,this.$HI,a,this.$g3,this.$15r,null)}};BPr.$ei=function(a,b,c,d){this.$$d_$1o6=Function.createDelegate(this,this.$1o6);this.$$d_$5bQ=Function.createDelegate(this,this.$5bQ);this.dispose=this.$d;this.$FU=d;this.$f=b;this.$1aD=a;this.$CO=c;this.$FU.$335(this)};BPr.$ei.prototype={$f:null,$1aD:null,$17W:null,$1zM:false,$CO:null,$FU:null,$Kf:false,$10Z:null,$2k:function(){if(this.$Kf)return;this.$Kf=true;this.$10Z={};this.$1aD.add_$1oY(this.$$d_$5bQ);this.$f.add_$Sg(this.$$d_$1o6);this.$41v(this.$f.get_$23())},$4x:function(){if(!this.$Kf)return;this.$Kf=false;this.$10Z=null;this.$1aD.remove_$1oY(this.$$d_$5bQ);this.$f.remove_$Sg(this.$$d_$1o6)},$1o6:function(f,e){if(Common.$0.$6B)return;var c=this.$41v(e.$Aa);if(!this.$17W||!c)return;for(var a=this.$1aD.$2D7(this.$17W.toString(),-1,-1,true),b=0;b<a.length;b++)this.$10Z[a[b].get_$9w().$6f]=a[b];if(a.length<=0)return;var d=this.$4Zi(a);this.$CO.$jt(d,true)},$4Zi:function(a){if(a.length===1)return String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphSingle,a[0].get_$9w().$HM);for(var c=new Array(0),d=a.length,b=0;b<d;b++)Array.add(c,a[b].get_$9w().$HM);return String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphMany,c.join(Box4Intl.Box4Strings.l_DisplayNameSeparator))},$5bQ:function(c,a){if(!this.$f.get_$23()||Common.$0.$6B||!this.$1zM)return;if(this.$17W&&this.$17W.$w(a.$R2)){var b=null;if(a.$1sT&&!(a.$VS.get_$9w().$6f in this.$10Z)){b=this.$3Lx(a.$VS.get_$9w().$HM,true);this.$10Z[a.$VS.get_$9w().$6f]=a.$VS}else if(!a.$1sT){b=this.$3Lx(a.$VS.get_$9w().$HM,false);delete this.$10Z[a.$VS.get_$9w().$6f]}b&&this.$CO.$jt(b,true)}},$3Lx:function(a,b){return String.format(b?Box4Intl.Box4Strings.l_UserJoiningParagraph:Box4Intl.Box4Strings.l_UserLeavingParagraph,a)},$d:function(){this.$FU.$41T(this);this.$4x()},$41v:function(d){if(!d)return false;var b=d.get_$1Z();if(!b)return false;var a=b.get_$11();if(!a)return false;this.$1zM=Box4.$D.$4n(a);var c=a.$D.get_$E();if(c.$w(this.$17W)||!this.$1zM)return false;this.$17W=c;this.$10Z={};return true}};BPr.$eI=function(a,b,c){BPr.$eI.initializeBase(this);this.$R2=a;this.$VS=b;this.$1sT=c};BPr.$eI.prototype={$R2:null,$VS:null,$1sT:false};BPr.$Bb=function(){this.$1MQ={};this.$qf={};BPr.$Bb.initializeBase(this)};BPr.$Bb.prototype={$2Y2:false,add_$1oY:function(a){this.$1O("PPC",a)},remove_$1oY:function(a){this.$2X("PPC",a)},$1ki:function(a){return a.get_$Eb().get_$By().toString()},$3F3:function(a){if(!this.$2Y2){this.$2Y2=true;Diag.$2.$9(4289312,302,50,"First presence added to data manager")}var d=false,f,g,h=(g=this.$5PR(a,f={val:d}),d=f.val,g);if(d){var c=this.$qf[a.get_$9w().$6f];c&&c.length>=0&&c[c.length-1].get_$Eb().set_$1oM(a.get_$Eb().get_$1oM());return}!h&&this.$3rL(a.get_$9w().$6f);var i=this.$1ki(a),e=a.get_$9w().$6f,j=this.$1MQ[i]||new Array(0),b=this.$qf[e]||[];if(b.length>=BPr.$Bb.$30F)b=b.splice(-BPr.$Bb.$3jd,BPr.$Bb.$30F);!h&&Array.add(j,e);Array.add(b,a);this.$1MQ[i]=j;this.$qf[e]=b;!a.get_$Eb().get_$By().$w(Common.$C.get_$1G())&&this.$3pl(a.get_$Eb().get_$By(),a,true)},$5PR:function(c,f){var e=c.get_$9w().$6f,a=this.$qf[e],b=!a||a.length<=0?null:a[a.length-1],d=!!b&&this.$1ki(b)===this.$1ki(c);f.val=d&&b.get_$Eb().get_$1Uu().$w(c.get_$Eb().get_$1Uu())&&b.get_$9w().$w(c.get_$9w());return d},$3rL:function(b){var a=this.$qf[b];if(a&&a.length>0){var c=a[0].get_$Eb().get_$By(),d=this.$1ki(a[0]);delete this.$qf[b];this.$5nc(d,b);!c.$w(Common.$C.get_$1G())&&this.$3pl(c,a[0],false)}},$3X5:function(a){return this.$1MQ[a]},$2D7:function(h,k,l,m){var c=[],e=this.$3X5(h);if(!e)return c;for(var f=0;f<e.length;f++){for(var i=e[f],a=this.$qf[i],g=false,d=a.length-1;d>=0;d--){var b=a[d];if(m){if(b.get_$2Gi()&&b.get_$Eb().get_$By().$w(Common.$C.$7r(h))){g=true;Array.add(c,b);break}continue}var j=BPr.$CY.isInstanceOfType(b)?b.get_$Eb().get_$1oM()===k:b.get_$Eb().get_$1oM()===l;if(j){g=true;b.set_$3iD(true);Array.add(c,b);this.$qf[i]=a.splice(d,a.length);break}}!g&&a.length>0&&a[0].get_$3iD()&&a[0].get_$Eb().get_$By().$w(Common.$C.$7r(h))&&Array.add(c,a[0])}return c},$3pl:function(a,b,c){this.$27("PPC",new BPr.$eI(a,b,c))},$5nc:function(b,c){var a=this.$1MQ[b];Array.remove(a,c)}};BPr.$CY=function(a,b){this.$rL=b;this.$19Z=a};BPr.$CY.$28y=function(b){var a=b;return!a?null:new BPr.$CY(BPr.$A6.$28y(a.user),a.ip?BPr.$HF.$28y(a.ip):null)};BPr.$CY.prototype={$19Z:null,$rL:null,get_$Eb:function(){return this.$rL},$2Ru:false,get_$3iD:function(){return this.$2Ru},set_$3iD:function(a){this.$2Ru=a;return a},$1Hc:false,get_$2Gi:function(){return this.$1Hc},set_$2Gi:function(a){this.$1Hc=a;return a},$1I7:false,get_$374:function(){return this.$1I7},set_$374:function(a){this.$1I7=a;return a},get_$9w:function(){return this.$19Z},$3ax:function(){return new BPr.SerializablePresenceData(this.$rL?this.$rL.$12c():null,this.$19Z.$12c())},$57A:function(){return this.$19Z.$6f+(!this.$rL?Common.$C.get_$1G().toString():this.$rL.get_$By().toString())},$5i:function(){var a=!!this.$19Z&&this.$19Z.$5i(),b=!this.$rL||this.$rL.$5i();return a&&b}};BPr.$ej=function(a){this.$1K=a};BPr.$ej.prototype={$1K:0,get_$2V:function(){return this.$1K},$w:function(b){var a=b;return!a?false:this.$1K===a.$1K}};BPr.$HF=function(a,b,c){this.$R2=Common.$C.$7r(a);this.$g1=new BPr.$ej(b);this.$ke=c};BPr.$HF.$28y=function(a){return!a.paragraphId||isNullOrUndefined(a.cp)||isNullOrUndefined(a.length)?null:new BPr.$HF(a.paragraphId,a.cp,a.length)};BPr.$HF.prototype={$R2:null,get_$By:function(){return this.$R2},$g1:null,get_$1Uu:function(){return this.$g1},$ke:0,get_$1oM:function(){return this.$ke},set_$1oM:function(a){this.$ke=a;return a},$5i:function(){return this.$g1.get_$2V()>=0&&!!this.$R2&&!this.$R2.$w(Common.$C.get_$1G())},$12c:function(){return new BPr.SerializablePresenceIpData(this.$R2.toString(),this.$g1.get_$2V(),this.$ke)}};BPr.$ek=function(a,b){BPr.$ek.initializeBase(this);this.$R2=a;this.$2Ro=b};BPr.$ek.prototype={$R2:null,$2Ro:false};BPr.$Aq=function(a,b,c,d){this.$$d_$5bP=Function.createDelegate(this,this.$5bP);this.dispose=this.$d;BPr.$Aq.initializeBase(this,[null]);this.$KM=a;this.$1O9=b;this.$Pl=c;this.$Gn=d};BPr.$Aq.$5S6=function(){if(!BPr.$Aq.$2Y4){BPr.$Aq.$2Y4=true;Diag.$2.$9(4006594,302,50,"First presence ip rendered on the page")}};BPr.$Aq.$3S4=function(a){return"ipId_"+a.$57A()};BPr.$Aq.prototype={$1O9:null,$Pl:null,$Gn:null,$Ti:null,$1AI:null,$yq:null,$1em:null,$3CM:0,$2ZT:null,$1sk:false,$KM:null,add_$3Ke:function(a){this.$1O("CR",a)},remove_$3Ke:function(a){this.$2X("CR",a)},$3rc:function(a,b,d){BPr.$Aq.$5S6(this.$KM.get_$9w().$6f,a.get_$2o());this.$2ZT=a;if(d){var c=!this.$2B;c&&this.$4Xe(b.ownerDocument);if(c||!this.$2B.parentNode)b.appendChild(this.$2B);else if(this.$2B.parentNode!==b){this.$2B.parentNode.removeChild(this.$2B);b.appendChild(this.$2B)}this.$3CM=a.get_$2o();this.$41f(a)}this.$1sk=!d;this.$3pj()},$3pj:function(){this.$27("CR",new BPr.$ek(this.$KM.get_$Eb().get_$By(),this.$1sk))},$4Xe:function(a){this.$2B=a.createElement("div");this.$2B.className="PresenceIpPaddingDiv";this.$2B.dir=Common.$0.$3z?"rtl":"ltr";this.$Pl.$z("msospPointerOver",this.$2B,this.$$d_$5bP);this.$yq=this.$1j("div");this.$yq.className="presenceIp";this.$1em=this.$1j("div");this.$1em.className="PresenceSmallBox";this.$Ti=this.$1O9.$4XV(this.$1j("div"));this.$Ti.$1P1(this.$KM.get_$9w());this.$Ti.$9M();Sys.UI.DomElement.addCssClass(this.$Ti.get_$1N(),"WacPawn");this.$yq.appendChild(this.$1em);this.$yq.appendChild(this.$Ti.get_$1N());this.$2B.appendChild(this.$yq)},$5bP:function(){this.$Ti&&this.$3tJ(true);this.$41f(this.$2ZT);return false},$4lr:function(){if(this.$1AI){Common.$1J.get_$4().$66(this.$1AI);this.$1AI=null}},$3yB:function(e){for(var b=this.$Ti.get_$5h1(),d=b.length,a=0;a<d;++a){var c=b[a];if(c.$6f===this.$KM.get_$9w().$6f&&!c.$w(this.$KM.get_$9w())){this.$Ti.$1P1(this.$KM.get_$9w());break}}if(e||this.$KM.get_$374()||this.$1IJ===2){this.$Ti.$617();this.$KM.set_$374(false);this.$KM.set_$2Gi(true);this.$1IJ=2;return 2e3}if(!this.$KM.get_$2Gi()||this.$1IJ===1){this.$Ti.$618();this.$KM.set_$2Gi(true);this.$1IJ=1;return 7e3}return 0},$3tJ:function(b){this.$4lr();var a=this.$3yB(b);this.$5rw(a)},$5rw:function(b){var a=this;this.$1AI=new Common.$1e(2,1,b,function(){a.$1AI=null;if(a.$Ti){a.$Ti.$9M();a.$1IJ=0}},56);Common.$1J.get_$4().$2f(this.$1AI)},$68u:function(j){if(!this.$KM.get_$Eb())return;if(!this.$2B||!this.$2B.parentNode)return;var a;try{a=Box4.$20.$ZY(this.$KM.get_$Eb().get_$1Uu().get_$2V(),j,this.$KM.get_$Eb().get_$1Uu().get_$2V()>0,false,false,false)}catch(k){Diag.$2.$9(4301318,302,50,"Could not determine the bounds of IP: isYielding={0} message={1} stack={2}",Common.$1J.get_$4().get_$Iu(),k.message,k.stack);return}if(!a)return;var c=Sys.UI.DomElement.getBounds(this.$2B.parentNode),i=new Sys.UI.Bounds(a.x-c.x,a.y-c.y,2,a.height),d,e,b,f,g,h;this.$5Ab(i,c,this.$2B.parentNode,this.$Gn.get_$4(),f={val:d},g={val:e},h={val:b}),d=f.val,e=g.val,b=h.val;this.$2B.style.height=10+b+"px";this.$2B.style.top=e-5+"px";this.$2B.style.left=d-5+"px";this.$yq.style.height=Math.max(10,b)+"px";this.$3tJ(true)},$H9:function(a){if(a&&this.$2B&&a===this.$2B.parentNode){Common.$J.$Nc(this.$2B);this.$3pj()}},$d:function(){if(this.$2B){this.$H9(this.$2B.parentNode);this.$Pl.$1u("msospPointerOver",this.$2B,this.$$d_$5bP);System.$39.$F9(this.$Ti);this.$Ti=null;this.$2B=null}},$41f:function(b){var a=this.$KM.get_$9w().$HJ;this.$yq.style.borderColor=a;this.$1em.style.borderColor=a;this.$2B.id=BPr.$Aq.$3S4(this.$KM);this.$68u(b)},$5Ab:function(b,f,g,a,c,d,e){d.val=b.y;c.val=b.x;e.val=b.height;var h=Math.abs(f.width-g.offsetWidth)>1||Math.abs(f.height-g.offsetHeight)>1;if(h&&a){d.val=Math.round(d.val/a.get_$Hm());c.val=Math.round(c.val/a.get_$Hm());e.val=Math.round(e.val/a.get_$Hm())}},$1IJ:0};BPr.$Na=function(a,b,c){this.$1JT={};this.$1O9=a;this.$Pl=b;this.$WP=c};BPr.$Na.prototype={$1O9:null,$Pl:null,$WP:null,$5Aa:function(b,d){var c=b.get_$9w().$6f,a=this.$1JT[c];if(a&&a.$KM.get_$9w().$w(b.get_$9w())){a.$KM=b;d.val=true;return a}d.val=false;return this.$1JT[c]=new BPr.$Aq(b,this.$1O9,this.$Pl,this.$WP)},$3XU:function(a){return this.$1JT[a]},$4nd:function(){var a=this.$1JT;for(var b in a){var c={key:b,value:a[b]};c.value.dispose()}}};BPr.$el=function(l,m,n,o,p,q,r,s,t,u,b,c,d,e,f,g,h,i,j,k){this.$$d_$5Za=Function.createDelegate(this,this.$5Za);this.$$d_$5c7=Function.createDelegate(this,this.$5c7);this.$$d_$5bR=Function.createDelegate(this,this.$5bR);this.$$d_$5eR=Function.createDelegate(this,this.$5eR);this.$$d_$5d7=Function.createDelegate(this,this.$5d7);this.$$d_$va=Function.createDelegate(this,this.$va);this.$$d_$1oY=Function.createDelegate(this,this.$1oY);this.$he=new Array(5);this.$1MN={};this.dispose=this.$d;this.$DY=l;this.$f=o;this.$ZO=p;this.$ry=q;this.$4M=s;this.$2X4=t;this.$19X=u;this.$CQ=n;this.$1y9=b;this.$1bL=c;this.$1bM=d;this.$2U2=r;this.$HX=e;this.$lU=f;this.$2g=g;this.$25=h;this.$25G=i;this.$100=k;this.$1MH=m;for(var a=0;a<this.$1MH.length;a++)this.$1MH[a].$5lz(this);this.$ry.add_$1oY(this.$$d_$1oY);this.$DY.add_$vh(this.$$d_$va);this.$ZO.add_$42q(this.$$d_$5d7);j&&this.$4M.add_$14j(this.$$d_$5eR);this.$DY.$335(this)};BPr.$el.prototype={$DY:null,$ZO:null,$f:null,$ry:null,$1MH:null,$CQ:null,$2U2:null,$19X:null,$2X4:0,$247:false,$1bL:null,$1bM:null,$1y9:null,$Kf:false,$HX:null,$lU:null,$2g:null,$25:null,$25G:false,$4M:null,$25p:false,$100:null,$1cF:false,$239:false,$5eR:function(){if(this.$25p)return;var a=this,b=new Common.$1e(1,1,20,function(){var d=a.$2g.$59(3,0);d.$h(a.$lU);var b=a.$19X.$1JT;for(var c in b){var f={key:c,value:b[c]},e=f.value;e.$1sk&&a.$2xB(e.$KM.get_$Eb().get_$By())}a.$239=true;d.dispose();a.$239=false;a.$25p=false},72);this.$25.$2f(b);this.$25p=true},$5Za:function(){if(this.$247){this.$2Ld();this.$247=false}},$1ou:function(a){(!this.$25G||a)&&this.$3rb()},$3rb:function(){var c=this.$2g.$59(3,0);c.$h(this.$lU);var a=this.$1MN;for(var b in a){var d={key:b,value:a[b]},e=Common.$C.$7r(d.key);this.$2xB(e)}c.dispose();this.$1MN={}},$5d7:function(f,e){for(var c=e.$2Sd,a=0;a<c.length;a++)this.$26a(c[a]);for(var d=e.$2QB,b=0;b<d.length;b++)this.$2L0(d[b]);this.$1ou(false)},$2Ld:function(){if(!this.$f.get_$23())return;var a=this.$f.get_$23().get_$1Z();this.$3tp(a,true)},$5c7:function(c,b){var a=b.$Aa.get_$1Z();this.$3tp(a,false)},$3tp:function(a,c){if(!this.$CQ.get_$Aj().get_$v3()&&!c){this.$247=true;return}if(!a){this.$DY.$35L(null);return}var b=this.$4gC(a);if(!b){this.$DY.$35L(null);Diag.$2.$9(4281418,302,50,"Not supported selection context {0}",a.get_$11().$1t);return}this.$DY.$35L(b)},$4gC:function(b){var a=Box4.$D.$6j(b,true,false);return!Box4.$D.$BC(a)?null:this.$3Hp(a)},$3Hp:function(a){var b=a.get_$11().$j,c=a.get_$11().$D.get_$E(),d=this.$1bL(a.get_$11().$D),e=new BPr.$HF(c.toString(),b,d);return e},$va:function(h,f){var c=f.$1IO;for(var d in c){var g={key:d,value:c[d]},a=g.value;if(!a.get_$Eb()){this.$2L0(a.get_$9w().$6f);continue}this.$26a(a)}for(var e=f.$1s2,b=0;b<e.length;++b)this.$4mD(e[b]);this.$1ou(false)},$5AY:function(c){for(var b=new Array(0),a=0;a<c.length;a++){var d=c[a];Array.add(b,this.$5Dr(d))}return b},$26a:function(a){this.$ZO.$5q0(a);if(a.$5i()&&!a.get_$9w().$NU()){a.get_$9w().$HJ=Box4.$2B.$Gs(8421504);a.get_$9w().$HM=Box4Intl.Box4Strings.l_AnonymousUserName}this.$ry.$3F3(a)},$2L0:function(a){this.$ry.$3rL(a)},$4mD:function(b){this.$2L0(b);this.$ZO.$4MZ(b);var a=this.$19X.$3XU(b);if(a){a.remove_$3Ke(this.$$d_$5bR);a.$d()}},$2uT:function(a){if(a.get_$19()!==12)return new Array(0);var b=this.$ry.$2D7(a.get_$E().toString(),this.$1bL(a),this.$1bM(a),false);return b.length<=0?new Array(0):this.$5AY(b)},$5bR:function(c,a){if(!a.$R2){Diag.$2.$m(8758481,302,false,"null paraid");return}var b=a.$R2.toString();this.$695(b,a.$2Ro,this.$1MN,this.$1cF,this.$239)},$695:function(b,c,d,f,e){if(c&&e)return;if(c){this.$100.$38("RendersSaved-OutOfView");return}this.$100.$38("Renders");e&&this.$100.$38("RendersDueToScroll");var a=b in d;if(a)delete d[b];f&&a&&this.$100.$38("RendersSaved-ContentUpdate")},$d:function(){this.$4x();this.$ry.remove_$1oY(this.$$d_$1oY);this.$DY.remove_$vh(this.$$d_$va);this.$ZO.remove_$42q(this.$$d_$5d7);this.$DY.$41T(this);for(var a=0;a<this.$1MH.length;a++)this.$1MH[a].$67b(this);System.$39.$34h([this.$ZO,this.$2U2,this.$DY]);this.$19X.$4nd()},$5Dr:function(e){var a=false,b,c,d=(c=this.$19X.$5Aa(e,b={val:a}),a=b.val,c);!a&&d.add_$3Ke(this.$$d_$5bR);return d},$2xB:function(b){var a=this.$CQ.$2C(b);if(!a){if(!this.$he[0]){Diag.$2.$9(4281420,302,50,"Could not find the node in object space");this.$he[0]=true}this.$2Ku(b);return}if(!Box4.$A.$3D(a)){if(!this.$he[1]){Diag.$2.$9(4281421,302,50,"Not a paragraph node");this.$he[1]=true}this.$2Ku(b);return}if(!a.$4N(this.$4M.get_$2o())){if(!this.$he[2]){Diag.$2.$9(4281422,302,50,"No ViewElement found for this node");this.$he[2]=true}this.$2Ku(b);return}if(!a.$21){if(!this.$he[3]){Diag.$2.$9(4281423,302,50,"node is not anchored");this.$he[3]=true}this.$2Ku(b);return}if(!this.$he[4]){Diag.$2.$9(4564931,302,50,"Valid paragraph node found for rendering ip");this.$he[4]=true}var c=this.$2g.$59(3,0);c.$1o(a);a.$QQ(this.$4M.get_$2o(),32,true);a.$QQ(this.$2X4,32,true);c.dispose()},$2Ku:function(d){var a=this.$ry.$2D7(d.toString(),-1,-1,true);if(!a)return;if(a.length<=0)return;for(var c=0;c<a.length;c++){var b=this.$19X.$3XU(a[c].get_$9w().$6f);b&&b.$2B&&b.$H9(b.$2B.parentNode)}},$5rz:function(b){b.toString()in this.$1MN&&this.$100.$38("RendersSavedByAlreadyPending");this.$1MN[b.toString()]=null;if(this.$25G){if(this.$1cF)return;var a=this,c=new Common.$1e(1,1,200,function(){a.$1cF=false;a.$3rb()},70);this.$25.$2f(c);this.$1cF=true}},$1oY:function(d,a){if(!a.$R2)return;var b=this.$CQ.$2C(a.$R2);if(b){var c=BPr.$CY.isInstanceOfType(a.$VS)?this.$1bL(b):this.$1bM(b);if(c===a.$VS.get_$Eb().get_$1oM())this.$5rz(a.$R2);else this.$100.$38("RendersSaved-VersionCheck")}},$4x:function(){if(!this.$Kf)return;this.$Kf=false;this.$f.remove_$Sg(this.$$d_$5c7);this.$1y9.remove_$3ls(this.$$d_$5Za)},$2k:function(){if(this.$Kf)return;this.$Kf=true;this.$f.add_$Sg(this.$$d_$5c7);this.$1y9.add_$3ls(this.$$d_$5Za);var a=this.$DY.$1k6();delete a[this.$HX.get_$Hi()];this.$va(null,new Common.$Nb(a,new Array(0)));this.$2Ld()},$3y3:function(a){if(!a||!a.$5i()||!a.get_$Eb())return;for(var d=this.$ry.$2D7(a.get_$Eb().get_$By().toString(),-1,-1,false),e=false,b=null,c=0;c<d.length;c++){b=d[c];if(b.get_$9w().$6f===a.get_$9w().$6f){b.set_$374(true);e=true;break}}if(!e)return;this.$2xB(b.get_$Eb().get_$By())}};BPr.$A6=function(a,b,c,d,e,f,g,h){BPr.$A6.initializeBase(this,[a,b,c,d,f,g,h]);this.$KJ=e};BPr.$A6.$28y=function(a){if(!a.clientId)return null;var b=isUndefined(a.capabilities)?0:a.capabilities;return new BPr.$A6(a.clientId,null,null,new Common.$Fy(b),a.localColbaltSessionId,a.skypeChatThreadId,a.email,null)};BPr.$A6.$3LS=function(a,d,e,b,f,g,h,i){if(!a)return null;var c=isUndefined(b)?0:b;return new BPr.$A6(a,d,e,new Common.$Fy(c),f,g,h,i)};BPr.$A6.prototype={$KJ:null,$5i:function(){return!!this.$6f},$NU:function(){return this.$5i()&&!!this.$HJ&&!!this.$HM},$12c:function(){return new BPr.SerializablePresenceUserData(this.$6f,this.$KJ,this.$g3,this.$HI.$HI,this.$15r)},$w:function(a){return!!a&&a.$HJ===this.$HJ&&a.$HM===this.$HM&&a.$6f===this.$6f},$3aQ:function(b){var a=b.value;return a?a.get_$9w():null}};BPr.$ep=function(a,b){BPr.$ep.initializeBase(this);this.$2Sd=a;this.$2QB=b};BPr.$ep.prototype={$2Sd:null,$2QB:null};BPr.$Tc=function(b,c,d,e,f){this.$$d_$2JQ=Function.createDelegate(this,this.$2JQ);this.$17=new Common.$2y;this.$1MX={};this.dispose=this.$d;BPr.$Tc.initializeBase(this,[b]);this.$1ad=c;this.$FU=d;this.$HX=f;this.$1fc=e;var a=this.$296(this.$HX.get_$Hi());this.$424(a);this.$FU.add_$1Gp(this.$$d_$2JQ);this.$3RZ()};BPr.$Tc.$4js=function(b){var a=new Common.$Fy(0);if(b.Capabilities){b.Capabilities.SupportsRealtimeChannel&&a.$2MF(1);b.Capabilities.SupportsRename&&a.$2MF(2);b.Capabilities.SupportsChat&&a.$2MF(4)}return a};BPr.$Tc.prototype={$1ad:null,$HX:null,$FU:null,$2eb:false,$2ea:false,$1fc:null,$7I:false,add_$42q:function(a){this.$17.$1O("UserInfoCompEK",a)},remove_$42q:function(a){this.$17.$2X("UserInfoCompEK",a)},$424:function(a){this.$HX.set_$1gj(a.$HI);this.$HX.set_$1h3(a.$HJ);this.$HX.set_$wh(a.$HM)},$3RZ:function(){if(this.$I9){Diag.$2.$9(4289313,302,50,"Creating editors table AddMe request");this.$I9.$nf(null,null,null)}else this.$2eb=true},$3RY:function(){if(this.$I9)this.$I9.$Ob(null,null,null);else this.$2ea=true},$31c:function(a,b){BPr.$qP.prototype.$31c.call(this,a,b);this.$2eb&&this.$3RZ();this.$2ea&&this.$3RY()},$2JQ:function(b,a){if(a.$6a===1){Diag.$2.$9(4289314,302,50,"EditorsTableUpdate notification received");this.$3RY()}},$4MZ:function(a){if(this.$1MX)delete this.$1MX[a]},$5q0:function(a){var b=a.get_$9w().$6f;this.$3oP(a.get_$9w());if(!a.get_$9w()||!a.get_$9w().$NU())this.$1MX[b]=a},$296:function(b){var a=new BPr.$A6(b);this.$3oP(a);return a},$3oP:function(b){var a=this.$1ad.$2tE(b.$6f);if(a){b.$HI=BPr.$Tc.$4js(a);b.$HJ=this.$54L(a);b.$HM=a.Name}},$54L:function(a){return a.ColorIndex>0?Box4.$2B.$Gs(this.$54K(a.ColorIndex)):null},$5Ds:function(){var a=this.$1ad.$1k5(),b=new Array(0);if(!a)return b;for(var c=0;c<a.length;c++)Array.add(b,this.$296(a[c].Id));return b},$54K:function(a){if(a>=0&&a<this.$1fc.length)return this.$1fc[a];Diag.$2.$9(3716507,302,50,"Invalid color index. index={0}. Returning default color",a);return this.$1fc[0]},$jX:function(){var b=this.$296(this.$HX.get_$Hi());if(!this.$HX.$3Za().$w(b)&&b.$NU()){this.$424(b);this.$FU.$5t1(1,this.$HX.get_$Hi());Diag.$2.$9(4289315,302,50,"Metadata of current user is in Editors Table. Color:{0}",this.$HX.get_$1h3())}var a=[],j=new Array(0),f=this.$1MX;for(var h in f){var d={key:h,value:f[h]},m=d.key,n=this.$296(m);if(n.$NU()){Array.add(a,d.value);Array.add(j,d.key)}}for(var e=0;e<a.length;e++)delete this.$1MX[j[e]];var c=new Array(0),l=this.$FU.$1k6(),g=l;for(var i in g){var o={key:i,value:g[i]},k=o.key;!this.$1ad.$2tE(k)&&Array.add(c,k)}(a.length>0||c.length>0)&&this.$17.$27("UserInfoCompEK",new BPr.$ep(a,c))},$d:function(){if(!this.$7I){this.$FU.remove_$1Gp(this.$$d_$2JQ);this.$7I=true}}};BPr.$s6=function(a,b,c,d,e,f,g){this.$$d_$2JQ=Function.createDelegate(this,this.$2JQ);this.$$d_$va=Function.createDelegate(this,this.$va);this.$$d_$144=Function.createDelegate(this,this.$144);this.$17=new Common.$2y;this.$22T=new(Common.Collections.$2d.$$(AppRealtimeChannel.$9A,Object));this.dispose=this.$d;BPr.$s6.initializeBase(this,[c]);this.$HX=g;this.$HX.set_$Hi(a.get_$Hi());this.$9U=a;this.$2X8=b;this.$gt=e;this.$2YK=f;this.$25=d;this.$lF=new(Common.Collections.$1E.$$(BPr.$SX))(null);this.$9U=a;this.$bQ.add_$2jn(this.$$d_$jX)};BPr.$s6.prototype={$lF:null,$2YK:null,$gt:null,$2X8:null,$2cS:false,$25:null,$2bK:false,$HX:null,$9U:null,get_$tA:function(){return this.$9U.get_$tA()},add_$vh:function(a){this.$17.$1O("PU",a)},remove_$vh:function(a){this.$17.$2X("PU",a)},add_$1hB:function(a){this.$17.$1O("CSC",a)},remove_$1hB:function(a){this.$17.$2X("CSC",a)},$3tl:function(){return null},get_$Hi:function(){return this.$9U.get_$Hi()},add_$1Gp:function(a){this.$17.$1O("UN",a)},remove_$1Gp:function(a){this.$17.$2X("UN",a)},$7Y:function(){this.$9U.add_$1hB(this.$$d_$144);this.$9U.add_$vh(this.$$d_$va);this.$9U.add_$1Gp(this.$$d_$2JQ);this.$3KG()},$335:function(a){var b=this;if(!this.$lF.$4V(a,function(a,b){return a===b})){this.$lF.$F(a);this.get_$tA()===2&&a.$2k()}},$41T:function(b){for(var a=0;a<this.$lF.get_$N();a++)if(this.$lF.get_$5(a)===b){this.$lF.$Kp(a);break}},$3KE:function(){if(this.$2bK)return;this.$9U.$3KE()},$29k:function(){this.$9U.$29k()},$4mQ:function(b){return BPr.$CY.$28y(b)},$3tu:function(b,c){var a=new BPr.$CY(b,c);return a.$3ax()},$35L:function(b){var a;if(b&&b.$5i()&&!this.$gt())a=this.$9U.$3tl(this.$3tu(this.$HX.$3Za(),b));else a=$$sc.$30.$iV(Object,null);return a},$1Fs:function(a,b){return this.$9U.$1Fs(a,b)},$1k6:function(){return this.$3LG(this.$9U.$1k6())},$5t1:function(a,b){if(this.get_$tA()===2)this.$1Fs(a,b);else this.$22T.set_$5(a,b)},get_$3i2:function(){return this.$9U.get_$3i2()},$144:function(e,a){if(a.$YC===2){var b=this;this.$22T.$2m(function(a,c){b.$1Fs(a,c);return true});this.$22T=new(Common.Collections.$2d.$$(AppRealtimeChannel.$9A,Object));var c=this;this.$lF.$2m(function(a){a.$2k();return true})}if(!a.$YC){var d=this;this.$lF.$2m(function(a){a.$4x();return true})}this.$17.$27("CSC",a)},$3R5:function(a){return a.toLowerCase()},$va:function(g,a){if(this.$gt())return;var c=this.$3LG(a.$1IO),d=this.$4Yz(a.$1s2),e=new Common.$Nb(c,d),b=this,f=new Common.$1e(1,1,0,function(){b.$17.$27("PU",e)},57);this.$25.$2f(f)},$3LG:function(f){var e={},c=f;for(var d in c){var a={key:d,value:c[d]},b=this.$4mQ(a.value);if(!b||!b.$5i()){Diag.$2.$9(4564932,302,50,"No Valid User {0}",Common.$1s.$5B(a.value));continue}e[this.$3R5(a.key)]=b}return e},$4Yz:function(b){for(var c=new Array(b.length),a=0;a<b.length;a++)c[a]=this.$3R5(b[a]);return c},$2JQ:function(d,c){var a=this,b=new Common.$1e(1,1,0,function(){a.$17.$27("UN",c)},58);this.$25.$2f(b)},$d:function(){this.$lF=new(Common.Collections.$1E.$$(BPr.$SX))(null);this.$9U.remove_$1hB(this.$$d_$144);this.$9U.remove_$vh(this.$$d_$va);this.$9U.remove_$1Gp(this.$$d_$2JQ);this.$bQ.remove_$2jn(this.$$d_$jX);this.$9U.$29k();Diag.$2.$9(4564935,302,50,"Disposing of rtcProxyCompleted")},$jX:function(){this.$3KG()},$3KG:function(){var a=this.$2X8.$5ze(this.$bQ.get_$Je())||this.$2YK();if(!this.$9U.get_$tA()&&a){this.$3KE();Diag.$2.$9(4564936,302,50,"Connecting because there are other authors in the doc")}else if(this.$9U.get_$tA()===2&&!a){this.$29k();Diag.$2.$9(4564937,302,50,"Disconnecting because there are no other users in the doc")}if(!this.$2cS&&a){Diag.$2.$9(4203466,302,50,"There are other real-time authors in this session");this.$2cS=true}},$29l:function(){this.$2bK=true;this.$29k();Diag.$2.$9(4564938,302,50,"DisconnectForever")}};BPr.$qP=function(a){this.$$d_$31c=Function.createDelegate(this,this.$31c);this.$$d_$jX=Function.createDelegate(this,this.$jX);this.dispose=this.$d;this.$bQ=a;this.$I9=a.get_$nU();if(this.$I9)this.$I9.add_$jX(this.$$d_$jX);else a.add_$1WL(this.$$d_$31c)};BPr.$qP.prototype={$I9:null,$bQ:null,$7I_0:false,$31c:function(){this.$I9=this.$bQ.get_$nU();this.$I9.add_$jX(this.$$d_$jX);this.$bQ.remove_$1WL(this.$$d_$31c)},$d:function(){if(this.$7I_0)return;if(this.$I9)this.$I9.remove_$jX(this.$$d_$jX);else this.$bQ.remove_$1WL(this.$$d_$31c);this.$7I_0=true}};BPr.SerializablePresenceData.registerClass("BPr.SerializablePresenceData");BPr.SerializablePresenceIpData.registerClass("BPr.SerializablePresenceIpData");BPr.SerializablePresenceUserData.registerClass("BPr.SerializablePresenceUserData");BPr.$qQ.registerClass("BPr.$qQ");BPr.$A6.registerClass("BPr.$A6",Common.$A6,Common.$Mq);BPr.$A6.prototype.toString=Common.$A6.prototype.toString;BPr.$NC.registerClass("BPr.$NC",BPr.$A6,BPr.$It,Common.$Mr);BPr.$NC.prototype.toString=Common.$A6.prototype.toString;BPr.$ei.registerClass("BPr.$ei",null,Sys.IDisposable,BPr.$SX);BPr.$eI.registerClass("BPr.$eI",Sys.EventArgs);BPr.$Bb.registerClass("BPr.$Bb",Common.$2y);BPr.$CY.registerClass("BPr.$CY",null,BPr.$li);BPr.$ej.registerClass("BPr.$ej",null,BPr.$lj);BPr.$HF.registerClass("BPr.$HF",null,BPr.$lk);BPr.$ek.registerClass("BPr.$ek",Sys.EventArgs);BPr.$Aq.registerClass("BPr.$Aq",Common.App.CollabControls.$PY,Box4.$oB,Sys.IDisposable);BPr.$Na.registerClass("BPr.$Na");BPr.$el.registerClass("BPr.$el",null,Box4.$oC,Sys.IDisposable,BPr.$SX,Common.$SI);BPr.$ep.registerClass("BPr.$ep",Sys.EventArgs);BPr.$qP.registerClass("BPr.$qP",null,Sys.IDisposable);BPr.$Tc.registerClass("BPr.$Tc",BPr.$qP,BPr.$ll,Sys.IDisposable);BPr.$s6.registerClass("BPr.$s6",BPr.$qP,BPr.$c6,Sys.IDisposable,Common.$oi,Box4.$nE);BPr.$Bb.$30F=10;BPr.$Bb.$3jd=2;BPr.$Aq.$2Y4=false;Type.registerNamespace("B4RT");B4RT.$mE=function(){};B4RT.$mE.registerInterface("B4RT.$mE");B4RT.$J2=function(){};B4RT.$J2.registerInterface("B4RT.$J2");B4RT.$lx=function(){};B4RT.$lx.registerInterface("B4RT.$lx");B4RT.$ly=function(){};B4RT.$ly.registerInterface("B4RT.$ly");B4RT.$lz=function(){};B4RT.$lz.registerInterface("B4RT.$lz");B4RT.$m7=function(){};B4RT.$m7.registerInterface("B4RT.$m7");B4RT.$m9=function(){};B4RT.$m9.registerInterface("B4RT.$m9");B4RT.$Mw=function(){};B4RT.$Mw.registerInterface("B4RT.$Mw");B4RT.$mB=function(){};B4RT.$mB.registerInterface("B4RT.$mB");B4RT.$QP=function(){};B4RT.$nS=function(){};B4RT.$nS.registerInterface("B4RT.$nS");B4RT.$Mx=function(){};B4RT.$Mx.registerInterface("B4RT.$Mx");B4RT.$LN=function(a,b,c){this.$zN=a;this.$gW=c;this.$mk=b};B4RT.$LN.prototype={$zN:null,$gW:null,$mk:null,$x:function(a,b){return new B4RT.$Z3(this.$zN,this.$mk,this.$gW,a,b)}};B4RT.$Z3=function(b,c,d,e,a){var f=this;b.add_$5b4(function(){a.$33m()});var g=this;b.add_$5cT(function(c,b){a.$33k(b.$2Su,b.$kd)});var h=this;b.add_$5cS(function(c,b){a.$5HF(b.$2Sv,b.$kd)});var i=this;b.add_$5av(function(){a.$3s2()});var j=this;c.add_$5ci(function(c,b){a.$64m(b.$1tE,b.$16Y,b.$15k)});var k=this;c.add_$5XU(function(c,b){a.$64l(b.$1tE,b.$16Y,b.$15k)});var l=this;d.add_$2J4(function(){a.$39c()});var m=this;e.add_$1Gp(function(c,b){b.$6a===6&&a.$2LN(b.$1fU)})};B4RT.$ea=function(a){this.$4A=a};B4RT.$ea.prototype={$4A:null,$x:function(){return new B4RT.$eZ(this.$4A)}};B4RT.$NJ=function(a,b){this.$1ME=a;this.$2dy=b};B4RT.$NJ.prototype={$1ME:null,$2dy:null,$x:function(a,b,c,d,e,f,g){return new B4RT.$dw(this.$1ME,a,b,c,this.$2dy,d,e,f,g)}};B4RT.$dw=function(b,c,d,e,a,f,g,h,i){this.$$d_$1Fs=Function.createDelegate(this,this.$1Fs);this.$1ME=b;this.$2XI=c;this.$2ed=d;this.$FU=e;this.$1OK=a.$x("TypingToOutboundReplicationStart",f,g,20);this.$1Ms=a.$x("OutboundReplicationStartToOutboundReplicationEnd",h,i,20)};B4RT.$dw.prototype={$1ME:null,$2XI:null,$2ed:null,$FU:null,$1OK:null,$1Ms:null,$1ef:true,$16F:null,$1Hq:null,$39c:function(){if(!this.$16F&&this.$1ef){this.$1ef=this.$2XI();if(this.$1ef){this.$16F=this.$1ME.$x(this.$$d_$1Fs,this.$2ed(),this.$1OK,this.$1Ms);this.$16F.$39c()}}},$33m:function(){this.$1ef=true;this.$1Hq=this.$16F;if(this.$1Hq){this.$16F=null;this.$1Hq.$33m()}},$3s2:function(){this.$16F=null},$33k:function(a,b){this.$1Hq&&this.$1Hq.$33k(a,b)},$1Fs:function(a){this.$FU.$1Fs(6,a)}};B4RT.$NK=function(a,b,c){this.$cz=a;this.$Yc=b;this.$cq=c};B4RT.$NK.prototype={$cz:null,$Yc:null,$cq:null,$x:function(a,b,c,d){return new B4RT.$dx(this.$cz,a,this.$Yc,this.$cq,b,c,d)}};B4RT.$dx=function(a,b,c,d,e,f,g){this.$4L=Box4.App.$20;this.$1uE=[];this.$1au={};this.$cz=a;this.$2gS=b;this.$Yc=c;this.$cq=d;this.$1eg=e;this.$1MY=null;this.$1au.TypingStartStage=null;this.$1au.ReplicationStartStage="TypingStartStage";this.$1au.ReplicationEndStage="ReplicationStartStage";this.$25t=this.get_$1iB()>1;this.$1OK=f;this.$1Ms=g};B4RT.$dx.prototype={$cz:null,$2gS:null,$Yc:null,$cq:null,$1eg:false,$FV:0,$JD:0,$1OL:null,$zV:null,$1MY:null,$2ep:null,$m0:0,$25t:false,$1OK:null,$1Ms:null,get_$1iB:function(){return this.$cq()},$39c:function(){if(!this.$2lT("TypingStartStage"))return;this.$32w("TypingStartStage");Diag.$2.$m(8257931,324,!this.$zV&&!this.$JD,"ReplicationStart or ReplicationEnd were calledbefore TypingStart");this.$FV=this.$Yc();this.$1OL=this.$cz.$x();this.$3ym(this.$1OL,"TypingToOutboundReplicationStart")},$33m:function(){if(!this.$2lT("ReplicationStartStage"))return;this.$32w("ReplicationStartStage");Diag.$2.$m(8257932,324,!!this.$1OL,"TypingStart not called");if(this.$1OL){var a=[this.$2nH(this.$1MY)],b=this.$3Oh(this.$1OL,this.$1eg,a);this.$1OK.$33n(b)}this.$zV=this.$cz.$x();this.$3ym(this.$zV,"OutboundReplicationStartToOutboundReplicationEnd")},$33k:function(a,e){if(!this.$2lT("ReplicationEndStage"))return;this.$32w("ReplicationEndStage");this.$JD=this.$Yc();this.$m0=e;Diag.$2.$m(8257933,324,!!this.$zV,"ReplicationStart not called");if(this.$zV){Diag.$2.$m(8193425,324,!!this.$zV,"ReplicationStart not called");var b=[this.$2nH(a)],c=this.$3Oh(this.$zV,this.$1eg,b);this.$1Ms.$33n(c)}Diag.$2.$m(8257934,324,!!this.$FV,"StartTime not set. No message sent to other editors.");if(this.$FV){var d=B4RT.$Fj.$4c6(this.$JD-this.$FV,a,this.$1eg,this.$m0);this.$2gS(d.get_$5jx())}},$2lT:function(a){if(this.$1au[a]===this.$2ep)return true;Diag.$2.$m(8422940,324,false,"{0}",{"Previous stage mismatch":this.$44V()});return false},$44V:function(){var a=new Sys.StringBuilder;a.append("Actual Phase:");for(var b=0;b<this.$1uE.length;b++)a.append(" "+this.$1uE[b]);return a.toString()},$32w:function(a){Array.add(this.$1uE,a);this.$2ep=a},$2nH:function(b){var a,c=(a=new B4RT.$QP,a.pivotName="UserCount",a.pivotValue=B4RT.$Fk.$3bm(this.get_$1iB()),a.userCount=this.get_$1iB(),a.compositeAdditiveDuration=0,a.compositeRevisionId=!b?"":b.toString(),a.failureCount=this.$m0,a.compositeFailureCount=0,a);return c},$3ym:function(a,b){this.$25t&&a.$2k(b,null)},$3Oh:function(a,b,c){return this.$25t?a.$1P(b,c):-1}};B4RT.$be=function(a,b,c,d,e,f){this.$YF={};this.$18Q=a;this.$Yc=b;this.$2cc=c;this.$1yr=d.$x("RtcNotificationToInboundReplicationEnd",e,f,20)};B4RT.$be.prototype={$18Q:null,$Yc:null,$2cc:0,$1yr:null,$5or:function(b,g){this.$3J0();Diag.$2.$m(8229761,324,b.length>0,null);for(var d=b,h=d.length,c=0;c<h;++c){var i=d[c],a=i.toString();if(!(a in this.$YF)){var e=this.$18Q.$x(this.$1yr);e.$3u0(b,g);this.$YF[a]=e}else{var f=this.$YF[a];if(!f.get_$3tz()){f.$3u0(b,g);delete this.$YF[a]}}}},$2LN:function(a){Diag.$2.$m(8257930,304,a.get_$3gm(),"Expected data not sent on the wire");if(!a.get_$3gm())return;if(a.get_$2LI()in this.$YF){var b=this.$YF[a.get_$2LI()];if(!b.get_$5qy()){b.$2LN(a.get_$1p7(),a.get_$3nA(),a.get_$3xS(),a.get_$3je());delete this.$YF[a.get_$2LI()]}}else{var c=this.$18Q.$x(this.$1yr);c.$2LN(a.get_$1p7(),a.get_$3nA(),a.get_$3xS(),a.get_$3je());this.$YF[a.get_$2LI()]=c}this.$3J0()},$3J0:function(){var b=$$sc.$6O.$eP(this.$YF);if(b&&b.length>this.$2cc)for(var c=b,h=c.length,a=0;a<h;++a){var d=c[a],e=this.$YF[d],f=e.get_$4ZM(),g=this.$Yc();if(g-f>6e4){var i=e.get_$3tz()?"RtcNotification":"ServerRevision";Diag.$p.$1k(8438528,304,50,"{0}",{"Not Received":i,Duration:g-f});delete this.$YF[d]}}},$YF:null};B4RT.$Mc=function(a,b,c,d){this.$cz=a;this.$Pc=b;this.$18Q=c;this.$2iA=d};B4RT.$Mc.prototype={$cz:null,$Pc:null,$18Q:null,$2iA:null,$x:function(a,b){return new B4RT.$be(this.$18Q,this.$Pc,50,this.$2iA,a,b)}};B4RT.$bf=function(a,b,c,d){this.$4L=Box4.App.$20;this.$cz=a;this.$2QP=b();this.$1AG=false;this.$21u=0;this.$cq=c;this.$2Zj=d};B4RT.$bf.prototype={$cz:null,$1bm:null,$21u:0,$1AG:false,$cq:null,$1MY:null,$2Zj:null,$1YA:false,get_$5qy:function(){return this.$1YA},$1YE:false,get_$3tz:function(){return this.$1YE},$1tH:null,$2QP:0,get_$4ZM:function(){return this.$2QP},$kd:0,$2SP:0,get_$1iB:function(){return this.$cq()},$2LN:function(a,b,c,d){if(!this.$1YA){this.$1AG=c;this.$21u=b;this.$1MY=a;this.$2SP=d;this.$1YA=true;if(!this.$1YE)this.$3yr();else this.$3On()}},$3u0:function(a,b){if(!this.$1YE){this.$kd=b;this.$1YE=true;this.$1tH=a;this.$1YA&&this.$3On()}},$3yr:function(){this.$1bm=this.$cz.$x();this.$1bm.$2k("RtcNotificationToInboundReplicationEnd","TypingToInboundReplicationEnd")},$3On:function(){!this.$1bm&&this.$3yr();var a=[this.$2nH(),this.$4fl()],b=this.$1bm.$1P(this.$1AG,a);this.$2Zj.$33n(b)},$2nH:function(){return this.$3Ly("UserCount")},$4fl:function(){return this.$3Ly("RevisionChainLength")},$3Ly:function(c){var a,b=(a=new B4RT.$QP,a.compositeAdditiveDuration=this.$21u,a.compositeRevisionId=this.$1MY.toString(),a.failureCount=this.$kd,a.compositeFailureCount=this.$2SP+this.$kd,a.userCount=this.get_$1iB(),a.revisionChainLength=this.$1tH.length,a.pivotName=c,a);if(c==="UserCount")b.pivotValue=B4RT.$Fk.$3bm(this.get_$1iB());else if(c==="RevisionChainLength")b.pivotValue=B4RT.$Fk.$5BN(this.$1tH.length);return b}};B4RT.$Md=function(a,b,c){this.$Vq=a;this.$Yc=b;this.$cq=c};B4RT.$Md.prototype={$Vq:null,$Yc:null,$cq:null,$x:function(a){return new B4RT.$bf(this.$Vq,this.$Yc,this.$cq,a)}};B4RT.$eZ=function(a){this.$4A=a};B4RT.$eZ.prototype={$4A:null,$24e:null,$1vp:null,$2k:function(a,b){this.$24e=this.$4A.$8G("UserAction",a);this.$1vp=b},$1P:function(h,f){if(h)if(f){for(var d=f,g=d.length,c=0;c<g;++c){var b=d[c],e=null;b.compositeName=this.$1vp;if(!this.$oX(b.pivotName)&&!this.$oX(b.pivotValue)){var a;e=(a=new DiagUse.$QY,a.PivotName=b.pivotName,a.PivotValue=b.pivotValue,a.CompositeName=this.$1vp,a.CompositeDurationInMilliseconds=b.compositeAdditiveDuration,a.ExtraInfoContext=b,a)}this.$24e.$62v(e,false)}return this.$24e.get_$10n()}return-1},$oX:function(a){return!a||a===""}};B4RT.$qL=function(){};B4RT.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new B4RT.$HL)};B4RT.$HL=function(){};B4RT.$HL.$3Xn=function(){var a=Box4.App.$20;return a?a.get_$2oo():0};B4RT.$HL.prototype={get_$5j:function(){return"Box4.ReplicationTelemetry"},$t9:function(a){var b=this;a.$e(B4RT.$J2).$p().$n(function(){return new B4RT.$ea(Box4.App.get_$X().get_$CN())});var c=this;a.$e(B4RT.$Mx).$p().$n(function(){return new B4RT.$iH});var d=this;a.$e(B4RT.$Mw).$p().$n(function(){return new B4RT.$iG(a.$J(B4RT.$Mx))});var e=this;a.$e(B4RT.$NK).$p().$n(function(){return new B4RT.$NK(a.$J(B4RT.$J2),function(){return+new Date},B4RT.$HL.$3Xn)});var f=this;a.$e(B4RT.$NJ).$p().$n(function(){return new B4RT.$NJ(a.$J(B4RT.$NK),a.$J(B4RT.$Mw))});var g=this;a.$e(B4RT.$Md).$p().$n(function(){return new B4RT.$Md(a.$J(B4RT.$J2),function(){return+new Date},B4RT.$HL.$3Xn)});var h=this;a.$e(B4RT.$Mc).$p().$n(function(){return new B4RT.$Mc(a.$J(B4RT.$J2),function(){return+new Date},a.$J(B4RT.$Md),a.$J(B4RT.$Mw))});var i=this;a.$e(Common.$SQ).$p().$n(function(){return new Common.$fA});var j=this;a.$e(B4RT.$Nk).$p().$n(function(){return new B4RT.$Nk(a.$J(B4RT.$NJ),a.$J(B4RT.$Mc),a.$J(Common.$SQ))});var k=this;a.$e(B4RT.$LN).$n(function(){return new B4RT.$LN(Box4.$6U.get_$4(),a.$J(B4RT.$Mx),Box4.$13.get_$4().get_$41())})},$7Y:function(){var a=Common.$0.$o,c=a.$1A("Box4ReplicationTelemetryIsEnabled");if(c){var d=a.$5L("Box4ReplicationTelemetrySamplePercent",0),e=a.$5L("Box4ReplicationTelemetryPhaseSamplePercent",0),f=a.$5L("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),g=a.$5L("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),h=a.$5L("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),i=a.$5L("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),j=a.$5L("Box4ReplicationTelemetryInboundOperationThreshold",0),k=a.$5L("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),b=Common.Utils.$8.get_$4().$J(BPr.$D3).$2Df(),l=this;b.CW(function(){var a=b.get_$5k(),c=Common.Utils.$8.get_$4().$J(B4RT.$Nk);c.$7Y(a,d,e,f,g,h,i,j,k);var l=Common.Utils.$8.get_$4().$J(B4RT.$LN);l.$x(a,c);Diag.$2.$9(8257935,305,50,"ReplicationTelemetry init")})}},$d:function(){}};B4RT.$Nk=function(a,b,c){this.$2dx=a;this.$2Zi=b;this.$22w=c};B4RT.$Nk.prototype={$2dx:null,$2Zi:null,$22w:null,$1MD:null,$1yp:null,$7Y:function(e,f,g,h,i,j,k,l,m){var c=this.$22w.$x(f/100),d=this.$22w.$x(g/100),a=c,b=d;this.$1MD=this.$2dx.$x(a.$$d_$36s||(a.$$d_$36s=Function.createDelegate(a,a.$36s)),b.$$d_$36s||(b.$$d_$36s=Function.createDelegate(b,b.$36s)),e,h,i,j,k);this.$1yp=this.$2Zi.$x(l,m)},$39c:function(){this.$1MD.$39c()},$33m:function(){this.$1MD.$33m()},$3s2:function(){this.$1MD.$3s2()},$33k:function(a,b){this.$1MD.$33k(a,b)},$5HF:function(a,b){this.$1yp.$5or(a,b)},$2LN:function(a){this.$1yp.$2LN(B4RT.$Fj.$4c4(a))},$64m:function(a,b,c){Diag.$p.$1k(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.$2n9(a,b,c))},$64l:function(a,b,c){Diag.$p.$1k(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.$2n9(a,b,c))},$2n9:function(b,c,d){var a={};a.PhaseName=b;a.ThresholdValue=c;a.ActualValue=d;return a}};B4RT.$Fj=function(a){this.$mE=a};B4RT.$Fj.$4c4=function(a){return new B4RT.$Fj(a)};B4RT.$Fj.$4c6=function(b,c,d,e){var a={};a.Duration=b.toString();a.RevisionID=c.toString();a.ShouldSample=d.toString();a.NumSequentialFailures=e.toString();return new B4RT.$Fj(a)};B4RT.$Fj.prototype={$mE:null,get_$5jx:function(){return this.$mE},$30:function(a){return!!this.$mE&&a in this.$mE},get_$3gm:function(){return this.$30("Duration")&&this.$30("RevisionID")&&this.$30("ShouldSample")},get_$1p7:function(){if(this.$30("RevisionID"))return Common.$C.$7r(this.$mE.RevisionID);else throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");},get_$2LI:function(){if(this.$30("RevisionID"))return this.$mE.RevisionID;else throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");},get_$3nA:function(){if(this.$30("Duration"))return Number.parseInvariant(this.$mE.Duration);else throw Error.create("Unable to parse DurationKey key from dictionary into int");},get_$3xS:function(){if(this.$30("RevisionID"))return Boolean.parse(this.$mE.ShouldSample);else throw Error.create("Unable to parse ShouldSample key from dictionary into bool");},get_$3je:function(){if(this.$30("NumSequentialFailures"))return Number.parseInvariant(this.$mE.NumSequentialFailures);else throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}};B4RT.$Fk=function(){};B4RT.$Fk.$3bm=function(a){return a<=5?"5AndFewer":a<=10?"6To10":a<=15?"11To15":a<=20?"15To20":a<=25?"21To25":a<=30?"26To30":"31AndAbove"};B4RT.$Fk.$5BN=function(a){return a<=9?a.toString():"10AndAbove"};B4RT.$iG=function(a){this.$mk=a};B4RT.$iG.prototype={$mk:null,$x:function(a,b,c,d){return new B4RT.$iF(this.$mk,a,b,c,d)}};B4RT.$iF=function(a,b,c,d,e){this.$22X=b;this.$25F=c;this.$1ug=d;this.$mk=a;this.$2cn=e};B4RT.$iF.prototype={$22X:null,$25F:0,$1ug:0,$25W:0,$ml:0,$2cn:0,$mk:null,$33n:function(a){a>this.$25F&&this.$mk.$64e(this.$22X,this.$25F,a);this.$25W+=a;this.$ml++;this.$25W/this.$ml>this.$1ug&&this.$ml>this.$2cn&&this.$mk.$4IM(this.$22X,this.$1ug,this.$25W/this.$ml)}};B4RT.$Ua=function(a,b,c){B4RT.$Ua.initializeBase(this);this.$1tE=a;this.$16Y=b;this.$15k=c};B4RT.$Ua.prototype={$1tE:null,$16Y:0,$15k:0};B4RT.$iH=function(){this.$17=new Common.$2y};B4RT.$iH.prototype={$64e:function(a,b,c){this.$17.$27("TSVTE",new B4RT.$Ua(a,b,c))},$4IM:function(a,b,c){this.$17.$27("TSVATE",new B4RT.$Ua(a,b,c))},add_$5ci:function(a){this.$17.$1O("TSVTE",a)},add_$5XU:function(a){this.$17.$1O("TSVATE",a)}};B4RT.$QP.registerClass("B4RT.$QP");B4RT.$LN.registerClass("B4RT.$LN");B4RT.$Z3.registerClass("B4RT.$Z3");B4RT.$ea.registerClass("B4RT.$ea",null,B4RT.$J2);B4RT.$NJ.registerClass("B4RT.$NJ");B4RT.$dw.registerClass("B4RT.$dw");B4RT.$NK.registerClass("B4RT.$NK",null,B4RT.$ly);B4RT.$dx.registerClass("B4RT.$dx",null,B4RT.$lx);B4RT.$be.registerClass("B4RT.$be",null,B4RT.$lz);B4RT.$Mc.registerClass("B4RT.$Mc");B4RT.$bf.registerClass("B4RT.$bf",null,B4RT.$m7);B4RT.$Md.registerClass("B4RT.$Md",null,B4RT.$m9);B4RT.$eZ.registerClass("B4RT.$eZ",null,B4RT.$mE);B4RT.$qL.registerClass("B4RT.$qL");B4RT.$HL.registerClass("B4RT.$HL",null,Common.App.$jx,Common.Utils.$l6);B4RT.$Nk.registerClass("B4RT.$Nk");B4RT.$Fj.registerClass("B4RT.$Fj",null,B4RT.$nS);B4RT.$Fk.registerClass("B4RT.$Fk");B4RT.$iG.registerClass("B4RT.$iG",null,B4RT.$Mw);B4RT.$iF.registerClass("B4RT.$iF",null,B4RT.$mB);B4RT.$Ua.registerClass("B4RT.$Ua",Sys.EventArgs);B4RT.$iH.registerClass("B4RT.$iH",null,B4RT.$Mx);B4RT.$qL.$5Sr();Type.registerNamespace("Box4.Symbols");Box4.Symbols.$Sp=function(){};Box4.Symbols.$Sp.registerInterface("Box4.Symbols.$Sp");Box4.Symbols.$Sq=function(){};Box4.Symbols.$Sq.registerInterface("Box4.Symbols.$Sq");Box4.Symbols.$Mv=function(){};Box4.Symbols.$Mv.registerInterface("Box4.Symbols.$Mv");Box4.Symbols.$Dv=function(){};Box4.Symbols.$Dv.get_$Gx=function(){return CommonUI.$4l.$Oc(Box4.Symbols.$Dv.$Ak,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")};Box4.Symbols.$32=function(a,b,c){this.$$d_$63a=Function.createDelegate(this,this.$63a);this.$$d_$63X=Function.createDelegate(this,this.$63X);this.$$d_$63Y=Function.createDelegate(this,this.$63Y);this.$$d_$5Jt=Function.createDelegate(this,this.$5Jt);Box4.Symbols.$32.initializeBase(this);this.$K=a;this.$2I=b;this.$hX=c;this.$5l(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.$5l(0,CommonUIStrings.l_DialogClose);this.$rA=false;this.$FN=Box4.Symbols.$Dv.get_$Gx()};Box4.Symbols.$32.prototype={$K:null,$2I:null,$hX:null,$1AS:null,$hW:null,$2bT:null,$1z1:0,get_$13T:function(){return false},dispose:function(){Box4.Symbols.$32.$25U>0&&Diag.$2.$9(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.$1z1,Box4.Symbols.$32.$25U);Box4.Symbols.$32.$2Wj++;Diag.$2.$9(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Box4.Symbols.$32.$2Wj);var c=$get("symbolsContainer");if(c){var a=c.getElementsByTagName("a");if(a)for(var b=0;b<a.length;b++)Common.$W.$3qq(a[b])}this.$hX=null;this.$K=null;CommonUI.$4l.prototype.dispose.call(this)},$3xc:function(){this.$LB(Box4Intl.Box4Strings.L_SymbolSingle,this.$$d_$5Jt,null);this.$1z1=0;Box4.Symbols.$32.$2Wk++;Diag.$2.$9(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Box4.Symbols.$32.$2Wk);var a=this.$2v7("symbol_d_"+Box4.Symbols.$32.$1LI);a&&a.focus()},$5Jt:function(a){if(a===1){this.$31W("symbol_d_"+Box4.Symbols.$32.$1LI);this.$2I.$1DF().$9t.$VB(this.$HQ);this.$HQ.focus()}else this.$9M()},$3lD:function(){CommonUI.$4l.prototype.$3lD.call(this);var a=$get("symbolsContainer");if(a){a.innerHTML=this.$hX.$4K5();var b=a.getElementsByTagName("a");if(b)for(var c=0;c<b.length;c++)Common.$W.$1O(b[c],"focus",this.$$d_$63Y)}},$15A:function(){var c=450,d=360;if(!Box4.Symbols.$32.$z2||!Box4.Symbols.$32.$18k){CommonUI.$4l.prototype.$15A.call(this);return}var b=CommonUI.$1k.get_$2KK()+Box4.Symbols.$32.$18k,a=CommonUI.$1k.get_$2KH()+Box4.Symbols.$32.$z2;if(b+d>CommonUI.$1k.get_$P1())b=CommonUI.$1k.get_$P1()-d;if(a+c>CommonUI.$1k.get_$LS())a=CommonUI.$1k.get_$LS()-c;this.$5I.style.top=(b<0?0:b)+"px";if(Common.$7.get_$I0()&&Common.$0.$3z)this.$5I.style.right=(a<0?0:a)+"px";else this.$5I.style.left=(a<0?0:a)+"px";this.$5I.style.width=String.format("{0}px",c.toString());this.$5I.style.display="Block"},$3sQ:function(){this.$15A()},$3H0:function(){var a=$get("symbolsContainer");if(a){if(!this.$1AS){this.$1AS=this.$$d_$63X;this.$Cx.$z("click",a,this.$1AS)}if(!this.$hW){this.$hW=this.$$d_$63a;this.$7m.$z("keydown",a,this.$hW);this.$7m.$z("keypress",a,this.$hW);this.$7m.$z("keyup",a,this.$hW)}}CommonUI.$1k.prototype.$3H0.call(this)},$3NR:function(){var a=$get("symbolsContainer");if(a){if(this.$1AS){this.$Cx.$1u("click",a,this.$1AS);this.$1AS=null}if(this.$hW){this.$7m.$1u("keydown",a,this.$hW);this.$7m.$1u("keypress",a,this.$hW);this.$7m.$1u("keyup",a,this.$hW);this.$hW=null}}CommonUI.$1k.prototype.$3NR.call(this)},$9M:function(){Box4.Symbols.$32.$18k=this.$2uQ(this.$5I.style.top);if(Box4.Symbols.$32.$18k)Box4.Symbols.$32.$18k=Box4.Symbols.$32.$18k-CommonUI.$1k.get_$2KK();if(Common.$7.get_$I0()&&Common.$0.$3z)Box4.Symbols.$32.$z2=this.$2uQ(this.$5I.style.right);else Box4.Symbols.$32.$z2=this.$2uQ(this.$5I.style.left);if(Box4.Symbols.$32.$z2)Box4.Symbols.$32.$z2=Box4.Symbols.$32.$z2-CommonUI.$1k.get_$2KH();CommonUI.$1k.prototype.$9M.call(this)},$5c1:function(a){this.$3we("symbol_d_"+Box4.Symbols.$32.$1LI,false);Box4.Symbols.$32.$1LI=parseInt(a.substr(a.lastIndexOf("_")+1));this.$3we(a,true);var b=$get("SymbolNameValueLabel");if(b){var c=this.$2v6(Box4.Symbols.$32.$1LI);b.innerHTML=Common.$9.$oL(c.$1XE)}},$2v6:function(c){var a=this.$hX.get_$3zQ().get_$2Nb().get_$Q(),b=$$sc.$6O.$eP(a);return a[b[c]]},$63Y:function(a){if(a.target!==this.$2bT){var b=this.$2I.$1DF();if(b&&b.$9t){b.$9t.$VB(a.target);this.$2bT=a.target}}this.$5c1(a.target.id)},$63X:function(b){var a=b.get_$3d();if(a.tagName.toLowerCase()!=="a")return false;this.$31W(a.id);this.$2I.$1DF().$9t.$VB(a);a.focus();return true},$63a:function(a){var b=a.get_$3d();if(b.tagName.toLowerCase()!=="a")return false;var c=parseInt(b.id.substr(b.id.lastIndexOf("_")+1));if(a.$1c.ctrlKey||a.$1c.altKey||a.$1c.keyCode>=112&&a.$1c.keyCode<=123)return false;if(a.$QB==="keydown"){var e=a.$1c.keyCode,d=-1;if(e===13){this.$31W(b.id);this.$2I.$1DF().$9t.$VB(b);b.focus()}else if(e===38)d=c-15;else if(e===40)d=c+15;else if(e===37)d=Common.$0.$3z?c+1:c-1;else if(e===39)d=Common.$0.$3z?c-1:c+1;if(d>=0){var f=this.$2v7("symbol_d_"+d);f&&f.focus()}}return true},$31W:function(c){this.$1z1++;Box4.Symbols.$32.$25U++;var a=parseInt(c.substr(c.lastIndexOf("_")+1)),d=this.$2v6(a),b={};b.SourceControlId="symbol_"+a+"_"+d.$1YP;this.$K.$4J(3966968829,2,b);this.$2I.$14V("dialog",true);Diag.$2.$9(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",a)},$2v7:function(b){var a=$get("symbolsContainer");return a?a.querySelector("#"+b):null},$3we:function(b,c){var a=this.$2v7(b);if(a)if(c)a.setAttribute("selected","true");else a.removeAttribute("selected")},$2uQ:function(c){if(!c)return null;var a=c;if(a.endsWith("px"))a=a.substring(0,a.length-2);if(CommonUI.$1k.$3fv(a)){var b=parseInt(a);if(!b)b=1;return b}else return null}};Box4.Symbols.$Wj=function(){};Box4.Symbols.$Wj.$5Sr=function(){Common.App.$f.get_$4().$3M(new Box4.Symbols.$Wj)};Box4.Symbols.$Wj.prototype={$U:null,get_$5j:function(){return"Box4.Symbols"},$7Y:function(){if(!Common.$0.$o.$1A("InsertSymbolIsEnabled"))return;var a=this.$U.$J(Box4.Symbols.$Sp);a.$3F()},$d:function(){},$t9:function(c){this.$U=c;this.$U.$e(Box4.Symbols.$OS).$1p(Box4.Symbols.$Sq).$p();var a=this;this.$U.$e(Box4.Symbols.$UP).$1p(Box4.Symbols.$Mv).$p().$n(function(){return new Box4.Symbols.$UP(a.$U.$J(Box4.Symbols.$Sq))});var b=this;this.$U.$e(Box4.Symbols.$Az).$1p(Box4.Symbols.$Sp).$p().$n(function(){return new Box4.Symbols.$Az(Common.$0.get_$r(),new Box4.$4A,new Box4.$5X,b.$U.$J(Box4.Symbols.$Mv),Box4.$o.get_$4(),Box4.$3.get_$4(),Box4.$h.get_$4())})}};Box4.Symbols.$2E=function(a,b){this.$1YP=a;this.$1XE=b};Box4.Symbols.$2E.prototype={$1YP:null,$1XE:null};Box4.Symbols.$Az=function(b,c,d,a,e,f,g){this.$$d_$61B=Function.createDelegate(this,this.$61B);this.$$d_$5Js=Function.createDelegate(this,this.$5Js);this.$$d_$5Ju=Function.createDelegate(this,this.$5Ju);this.$$d_$5jM=Function.createDelegate(this,this.$5jM);this.$$d_$63b=Function.createDelegate(this,this.$63b);this.$$d_$5gB=Function.createDelegate(this,this.$5gB);this.$$d_$5iy=Function.createDelegate(this,this.$5iy);this.$$d_$3bD=Function.createDelegate(this,this.$3bD);this.$K=b;this.$1y=c;this.$2hX=new($$sc.$x.$$(String))(this.$$d_$3bD);this.$1Ni=a.get_$3zQ().get_$2Nb();this.$2g=d;this.$hX=a;this.$z8=e;this.$2Ub=f;this.$f=g};Box4.Symbols.$Az.get_$65=function(){return Box4.Symbols.$Az.$2N||(Box4.Symbols.$Az.$2N=Common.Utils.$8.get_$4().$J(Box4.$4r))};Box4.Symbols.$Az.prototype={$K:null,$1y:null,$2hX:null,$2g:null,$1Ni:null,$hX:null,$z8:null,$2Ub:null,$f:null,$3bD:function(){return this.$hX.$3Ha()},$3F:function(){this.$K.$1W(1262150728,1,this.$$d_$5iy,96);this.$K.$P(1256496096,2,this.$$d_$5gB);this.$K.$P(3471878106,2,this.$$d_$63b);this.$K.$P(816646517,2,this.$$d_$5jM);this.$K.$P(3966968829,2,this.$$d_$5Ju);this.$K.$P(1256496096,4,this.$$d_$5gB);this.$K.$P(3471878106,4,this.$$d_$63b);this.$K.$P(816646517,4,this.$$d_$5jM);this.$K.$P(3966968829,4,this.$$d_$5Js);this.$K.$2G(1256496096,100);this.$K.$2G(3471878106,12);this.$K.$2G(816646517,100);this.$K.$2G(3966968829,12);if(Common.$0.$o&&Common.$0.$o.$1A("InsertMoreSymbolsIsEnabled")){this.$K.$P(3574218963,2,this.$$d_$61B);this.$K.$P(3574218963,4,this.$$d_$61B);this.$K.$2G(3574218963,100)}},$5jM:function(g,h,e,i,f){if(e===1)return 32;var a=f,b=this.$hX.$3nr(a),c=this.$hX.get_$63Z(),d=String.format(c,b.character);a[CommandUI.Controls.$3Q.InnerHTML]=d;a[CommandUI.Controls.$3Q.On]=false;return 32},$5Ju:function(s,n,q,o,r){var b,c,d,f,g,h,i;if(i=this.$3Mp(n,q,f={val:b},g={val:c},h={val:d}),b=f.val,c=g.val,d=h.val,i)return d;var p=Box4.$D.$4n(c),j=true,a=8,k=this.$2g.$59(15,0);k.$1o(b.$5p);if(!p){a=this.$K.$5D(n,1172238996,2,true,o,null);var l=a===32;Diag.$2.$m(6407387,348,l,"DeleteForReplace did not succeed. Response is {0}",a);j=l}if(j){var e=b.$f.get_$74(),m=Box4.$D.$4n(e);Diag.$2.$m(6407388,348,m,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",e.get_$3t());a=8;if(m){a=this.$K.$5D(e,3966968829,2,false,o,r);Diag.$2.$m(6407389,348,a===32,"Insertion at IP context did not succeed. Response is {0}",a);a===32&&Common.$b.$4().$8x(b.$KI)}}k.dispose();return a},$3Mp:function(e,f,a,c,b){var d=e;a.val=null;if(d.$2Q.get_$3n())a.val=d.$2Q;c.val=null;if(!a.val||!a.val.$f){Diag.$p.$1k(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",e.toString());b.val=8;return true}c.val=a.val.$f.get_$74();if(!c.val){b.val=2;return true}if(this.$2Ub.get_$5(14)&&this.$z8.$i8(c.val)){b.val=8;return true}if(a.val.$f.get_$23().$MQ){b.val=2;return true}b.val=32;return f===1?true:false},$5Js:function(l,b,i,j,k){if(i===1)return 32;var f=k,c=this.$hX.$3nr(f);j.$Q8=c.index;var d=b,a=this.$1y.$DI(d.$D),g=a.$1X(11);Diag.$2.$m(6379466,324,g,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",Box4.$6.toString(d.$D.get_$19()));var e=this.$2g.$59(15,0);e.$Bd(a);Box4.Symbols.$Az.get_$65().$6u(b,c.character);var h=Box4.$L.$4I(a.get_$A(),b.$j+1);this.$f.$2s(h,null,false,false);e.dispose();return 32},$5gB:function(e,f,c,g,d){if(c===1)return 32;var a=d,b=this.$2hX.get_$Q();a.PopulationXML=b;return 32},$63b:function(j,h,i){var f,g,a,b,c,d,e;e=this.$3Mp(h,i,b={val:f},c={val:g},d={val:a}),f=b.val,g=c.val,a=d.val,e;return a},$61B:function(d,e,c){var a=32;if(c===2){var b=new Box4.Symbols.$32(this.$K,Common.$b.$4(),Common.Utils.$8.get_$4().$J(Box4.Symbols.$Mv));b.$3xc()}return a},$5iy:function(){return 32}};Box4.Symbols.$OS=function(){this.$1Ni=new($$sc.$x.$$(Object))(Box4.Symbols.$OS.$3MI)};Box4.Symbols.$OS.$3MI=function(){var a={};a["\u2022"]=new Box4.Symbols.$2E("\u2022",Box4Intl.Box4Strings.L_Bullet);a["\u20ac"]=new Box4.Symbols.$2E("\u20ac",Box4Intl.Box4Strings.L_EuroSign);a["\u00a3"]=new Box4.Symbols.$2E("\u00a3",Box4Intl.Box4Strings.L_PoundSign);a["\u00a5"]=new Box4.Symbols.$2E("\u00a5",Box4Intl.Box4Strings.L_YenSign);a["\u00a9"]=new Box4.Symbols.$2E("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);a["\u00ae"]=new Box4.Symbols.$2E("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);a["\u2122"]=new Box4.Symbols.$2E("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);a["\u00b1"]=new Box4.Symbols.$2E("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);a["\u2260"]=new Box4.Symbols.$2E("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);a["\u2264"]=new Box4.Symbols.$2E("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);a["\u2265"]=new Box4.Symbols.$2E("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);a["\u00f7"]=new Box4.Symbols.$2E("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);a["\u00d7"]=new Box4.Symbols.$2E("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);a["\u221e"]=new Box4.Symbols.$2E("\u221e",Box4Intl.Box4Strings.L_Infinity);a["\u00b5"]=new Box4.Symbols.$2E("\u00b5",Box4Intl.Box4Strings.L_MicroSign);a["\u03b1"]=new Box4.Symbols.$2E("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);a["\u03b2"]=new Box4.Symbols.$2E("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);a["\u03c0"]=new Box4.Symbols.$2E("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);a["\u03a9"]=new Box4.Symbols.$2E("\u03a9",Box4Intl.Box4Strings.L_OhmSign);a["\u03a3"]=new Box4.Symbols.$2E("\u03a3",Box4Intl.Box4Strings.L_NArySummation);a["\u00b0"]=new Box4.Symbols.$2E("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);a["\u0394"]=new Box4.Symbols.$2E("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);a["\u263a"]=new Box4.Symbols.$2E("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);a["\u2665"]=new Box4.Symbols.$2E("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);a["\u20b9"]=new Box4.Symbols.$2E("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);a["\u00bf"]=new Box4.Symbols.$2E("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);a["\u00a1"]=new Box4.Symbols.$2E("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);a["\u2014"]=new Box4.Symbols.$2E("\u2014",Box4Intl.Box4Strings.L_EmDash);a["\u2026"]=new Box4.Symbols.$2E("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);a["\u00c0"]=new Box4.Symbols.$2E("\u00c0\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);a["\u00c1"]=new Box4.Symbols.$2E("\u00c1\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);a["\u00c2"]=new Box4.Symbols.$2E("\u00c2\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);a["\u00c3"]=new Box4.Symbols.$2E("\u00c3\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);a["\u00c4"]=new Box4.Symbols.$2E("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);a["\u00c5"]=new Box4.Symbols.$2E("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);a["\u00c6"]=new Box4.Symbols.$2E("\u00c6\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);a["\u00c7"]=new Box4.Symbols.$2E("\u00c7\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);a["\u00c8"]=new Box4.Symbols.$2E("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);a["\u00c9"]=new Box4.Symbols.$2E("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);a["\u00ca"]=new Box4.Symbols.$2E("\u00ca\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);a["\u00cb"]=new Box4.Symbols.$2E("\u00cb\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);a["\u00cc"]=new Box4.Symbols.$2E("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);a["\u00cd"]=new Box4.Symbols.$2E("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);a["\u00ce"]=new Box4.Symbols.$2E("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);a["\u00cf"]=new Box4.Symbols.$2E("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);a["\u00d1"]=new Box4.Symbols.$2E("\u00d1\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);a["\u00d2"]=new Box4.Symbols.$2E("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);a["\u00d3"]=new Box4.Symbols.$2E("\u00d3\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);a["\u00d4"]=new Box4.Symbols.$2E("\u00d4\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);a["\u00d5"]=new Box4.Symbols.$2E("\u00d5\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);a["\u00d6"]=new Box4.Symbols.$2E("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);a["\u00d9"]=new Box4.Symbols.$2E("\u00d9\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);a["\u00da"]=new Box4.Symbols.$2E("\u00da\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);a["\u00db"]=new Box4.Symbols.$2E("\u00db\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);a["\u00dc"]=new Box4.Symbols.$2E("\u00dc\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);a["\u00df"]=new Box4.Symbols.$2E("\u00df\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);a["\u00e0"]=new Box4.Symbols.$2E("\u00e0\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);a["\u00e1"]=new Box4.Symbols.$2E("\u00e1\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);a["\u00e2"]=new Box4.Symbols.$2E("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);a["\u00e3"]=new Box4.Symbols.$2E("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);a["\u00e4"]=new Box4.Symbols.$2E("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);a["\u00e5"]=new Box4.Symbols.$2E("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);a["\u00e6"]=new Box4.Symbols.$2E("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);a["\u00e7"]=new Box4.Symbols.$2E("\u00e7\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);a["\u00e8"]=new Box4.Symbols.$2E("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);a["\u00e9"]=new Box4.Symbols.$2E("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);a["\u00ea"]=new Box4.Symbols.$2E("\u00ea\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);a["\u00eb"]=new Box4.Symbols.$2E("\u00eb\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);a["\u00ec"]=new Box4.Symbols.$2E("\u00ec\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);a["\u00ed"]=new Box4.Symbols.$2E("\u00ed\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);a["\u00ee"]=new Box4.Symbols.$2E("\u00ee\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);a["\u00ef"]=new Box4.Symbols.$2E("\u00ef\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);a["\u00f1"]=new Box4.Symbols.$2E("\u00f1\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);a["\u00f2"]=new Box4.Symbols.$2E("\u00f2\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);a["\u00f3"]=new Box4.Symbols.$2E("\u00f3\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);a["\u00f4"]=new Box4.Symbols.$2E("\u00f4\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);a["\u00f5"]=new Box4.Symbols.$2E("\u00f5\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);a["\u00f6"]=new Box4.Symbols.$2E("\u00f6\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);a["\u00f9"]=new Box4.Symbols.$2E("\u00f9\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);a["\u00fa"]=new Box4.Symbols.$2E("\u00fa\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);a["\u00fb"]=new Box4.Symbols.$2E("\u00fb\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);a["\u00fc"]=new Box4.Symbols.$2E("\u00fc\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);a["\u00ff"]=new Box4.Symbols.$2E("\u00ff\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);a["\u011e"]=new Box4.Symbols.$2E("\u011e\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);a["\u011f"]=new Box4.Symbols.$2E("\u011f\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);a["\u0130"]=new Box4.Symbols.$2E("\u0130\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);a["\u0131"]=new Box4.Symbols.$2E("\u0131\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);a["\u0152"]=new Box4.Symbols.$2E("\u0152\u200b",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);a["\u0153"]=new Box4.Symbols.$2E("\u0153\u200b",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);a["\u015e"]=new Box4.Symbols.$2E("\u015e\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);a["\u015f"]=new Box4.Symbols.$2E("\u015f\u200b",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);a["\u0178"]=new Box4.Symbols.$2E("\u0178\u200b",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return a};Box4.Symbols.$OS.prototype={$1Ni:null,$24r:null,get_$2Nb:function(){return this.$1Ni},$585:function(b){if(!this.$24r)this.$24r=$$sc.$6O.$eP(this.$1Ni.get_$Q());var a=Array.indexOf(this.$24r,b);return a}};Box4.Symbols.$UP=function(a){this.$1IF=a};Box4.Symbols.$UP.prototype={$1IF:null,get_$3zQ:function(){return this.$1IF},get_$63Z:function(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'},$3nr:function(d){var c=d.SourceControlId,b=c.split("_"),a={};if(b.length===2){a.character=b[1];a.index=this.$1IF.$585(a.character)}else{a.character=b[2];a.index=parseInt(b[1])}return a},$3Ha:function(){return this.$3bD()},$4K5:function(){var f='<td unselectable="on"><a href=# id="{0}" aria-hidden="true" title="{2}" tabindex="0">{1}</a></td>',b=new Sys.StringBuilder;b.append('<table class="moreSymbolsTable">');var d=this.$1IF.get_$2Nb().get_$Q(),c=$$sc.$6O.$eP(d),a=0;while(a<c.length){!(a%15)&&b.append("<tr>");var e=d[c[a]],g="symbol_d_"+a;b.append(String.format(f,g,Common.$9.$oL(e.$1YP),Common.$9.$oL(e.$1XE)));a++;(!(a%15)||a===c.length)&&b.append("</tr>")}b.append("</table>");return b.toString()},$3bD:function(){var a=new Sys.StringBuilder;a.append('<Menu Id="menuSymbolsDropDown">');this.$4FT(a);Common.$0.$o&&Common.$0.$o.$1A("InsertMoreSymbolsIsEnabled")&&this.$4Bi(a);a.append("</Menu>");return a.toString()},$4Bi:function(a){a.append('<MenuSection Id="msMoreSymbols" Title="" DisplayMode="Menu16">');a.append('<Controls Id="ctrlMoreSymbols">');var b='<Button Id="{0}" Command="{1}" LabelText="{2}" Alt="{3}" Image16by16="{4}" Image16by16Class="{5}"/>';a.append(String.format(b,"btnMoreSymbols",3574218963,Common.$9.$3O(Box4Intl.Box4Strings.L_InsertMoreSymbols),Common.$9.$3O(Box4Intl.Box4Strings.L_InsertMoreSymbols),Common.$0.$9R,Common.$n.$6d("Symbol_16x16x32")));a.append("</Controls>");a.append("</MenuSection>")},$4FT:function(a){a.append('<MenuSection Id="msSymbolsPosition" ShowMenuSectionSeparator="false" >');var e='<Gallery Id="gallerySymbolsPosition" Width="{0}" ElementDimensions="Size16by16">';a.append(String.format(e,"5"));for(var c=this.$1IF.get_$2Nb().get_$Q(),d=$$sc.$6O.$eP(c),f=Math.min(25,d.length),b=0;b<f;b++)a.append(this.$56t(b,c[d[b]]));a.append("</Gallery>");a.append("</MenuSection>")},$56t:function(c,a){var b="symbol_"+c+"_"+a.$1YP;return this.$3YQ(b,Common.$9.$3O(a.$1XE))},$3YQ:function(c,d){var a='<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" Alt="{3}" InnerHTML="" />',b=String.format(a,c,3966968829,816646517,d);return b}};Box4.Symbols.$Dv.registerClass("Box4.Symbols.$Dv");Box4.Symbols.$32.registerClass("Box4.Symbols.$32",CommonUI.$4l);Box4.Symbols.$Wj.registerClass("Box4.Symbols.$Wj",null,Common.App.$jx,Common.Utils.$l6);Box4.Symbols.$2E.registerClass("Box4.Symbols.$2E");Box4.Symbols.$Az.registerClass("Box4.Symbols.$Az",null,Box4.Symbols.$Sp);Box4.Symbols.$OS.registerClass("Box4.Symbols.$OS",null,Box4.Symbols.$Sq);Box4.Symbols.$UP.registerClass("Box4.Symbols.$UP",null,Box4.Symbols.$Mv);Box4.Symbols.$Dv.$Ak="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Box4.Symbols.$32.$1LI=0;Box4.Symbols.$32.$18k=null;Box4.Symbols.$32.$z2=null;Box4.Symbols.$32.$2Wk=0;Box4.Symbols.$32.$2Wj=0;Box4.Symbols.$32.$25U=0;Box4.Symbols.$Az.$2N=null;Box4.Symbols.$Wj.$5Sr();Type.registerNamespace("WoSk");WoSk.$Js=function(a){this.$$d_$5ZC=Function.createDelegate(this,this.$5ZC);this.$$d_$31K=Function.createDelegate(this,this.$31K);WoSk.$Js.initializeBase(this);this.$qh=a};WoSk.$Js.prototype={$qh:null,$4L:null,$cL:null,$lk:false,$1yv:false,$7Y:function(){return this.$qh.CW(this.$$d_$31K)},$31K:function(){if(this.$lk)return;this.$4L=this.$qh.get_$5k();this.$4L.get_$Ug().Capabilities.SupportsChat=true;this.$cL=this.$4L.get_$nU();this.$cL.add_$jX(this.$$d_$5ZC);this.$2qE();this.$1yv=true},$2qE:function(){this.$cL.$nf(null,null,null)},$5ZC:function(){if(this.$lk)return;for(var e=this.$1k5(),c=e,d=c.length,b=0;b<d;++b){var a=c[b];if(a.Capabilities&&a.Capabilities.SupportsChat&&a.Capabilities.ChatThreadId&&a.Id!==this.$4L.get_$Ug().Id){this.$32j(a.Capabilities.ChatThreadId);return}}},$1k5:function(){return this.$4L.get_$wY().$1k5()},$4x:function(){if(this.$lk)return;if(this.$1yv){this.$cL.remove_$jX(this.$$d_$5ZC);this.$1yv=false}this.$lk=true},$3jU:function(b){var a=this;return this.$qh.CW(function(){if(a.$4L.get_$Ug().Capabilities.ChatThreadId)return;a.$4L.get_$Ug().Capabilities.ChatThreadId=b;a.$2qE()})}};WoSk.$Ut=function(a,b,c,d,e,f){WoSk.$Ut.initializeBase(this,[a,b,c,d,e]);this.$2V0=f};WoSk.$Ut.prototype={$2V0:null,$3xk:function(){this.$2V0.$60w()},$1FP:function(){Box4.App.get_$X().$4p.$K1(this.get_$1GB().$E);Box4.App.$BH.get_$Ko().$3tE()}};WoSk.$KA=function(a){this.$$d_$31K=Function.createDelegate(this,this.$31K);this.$$d_$5ZD=Function.createDelegate(this,this.$5ZD);this.$$d_$5Sj=Function.createDelegate(this,this.$5Sj);this.$AP=new($$sc.$5l.$$(Boolean));WoSk.$KA.initializeBase(this);this.$qh=a};WoSk.$KA.prototype={$qh:null,$4L:null,$cL:null,$h4:null,$21P:0,$2MW:function(a){Diag.$2.$9(16922829,333,50,"Setting availability to {0}",a);this.$21P++;if(this.$21P>=10)return;this.$21P++;if(!this.$4L||!this.$4L.get_$Ug())return;this.$4L.get_$Ug().Capabilities.SupportsChat=a;this.$2qE()},$1B5:function(){var a=this.$4GV();this.$1oh(a);return a},$4GV:function(){if(!this.$4L)return false;var b=this.$4L.get_$wY();if(!b)return false;var a=b.$1k5();return!a||a.length<=1?false:this.$3ge(a)},$31K:function(){this.$4L=this.$qh.get_$5k();this.$h4=this.$4L.get_$Ug().EmailAddress;this.$cL=this.$4L.get_$nU();if(!this.$h4){this.$4L.get_$wY().add_$1C3(this.$$d_$5Sj);return}this.$4L.get_$wY().add_$1C3(this.$$d_$5ZD);this.$2MW(true);this.$AP.$9D(true)},$5Sj:function(){this.$h4=this.$4L.get_$Ug().EmailAddress;if(this.$h4){this.$4L.get_$wY().remove_$1C3(this.$$d_$5Sj);this.$31K(null)}},$5ZD:function(){this.$1B5()},$3ge:function(d){if(!d)return false;for(var c=d,e=c.length,b=0;b<e;++b){var a=c[b];if(a.EmailAddress&&a.Capabilities&&a.Capabilities.SupportsChat&&a.EmailAddress!==this.$h4)return true}return false},$2qE:function(){this.$cL.$nf(null,null,null)},$7Y:function(){this.$qh.CW(this.$$d_$31K);return this.$AP.get_$8z()}};WoSk.$j8=function(a,b,c){this.$$d_$4NM=Function.createDelegate(this,this.$4NM);WoSk.$j8.initializeBase(this,[c]);this.$2I=b;this.$4m=a};WoSk.$j8.prototype={$2I:null,$4m:null,$7Y:function(){var a=this;return Common.App.SkypeChat.$rG.prototype.$7Y.call(this).CW(function(){var b=a.$2I.$2w("chatpane");b.$7E="main";b.$ZU(a.$$d_$4NM);a.$4m.$Py("chatpane")})},$4p7:function(a){if(a)this.$4m.$IX("chatpane");else this.$4m.$Gw("chatpane")},$3Ih:function(a){if(!a)this.$4m.$1l3(0,null,2,null,null);else this.$4m.$2Es(0,null,2,null,null)},$4NM:function(){this.$5tI()}};WoSk.$Js.registerClass("WoSk.$Js",Common.App.SkypeChat.$rH);WoSk.$Ut.registerClass("WoSk.$Ut",Common.App.SkypeChat.$UC);WoSk.$KA.registerClass("WoSk.$KA",Common.App.SkypeChat.$rI);WoSk.$j8.registerClass("WoSk.$j8",Common.App.SkypeChat.$rG);var ActivityFeedTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"ActivityFeedTaskPane",Title:"STR@L_Activity",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PlaceholderContainer",IsStretched:"false"}},{name:"Group",attrs:{Id:"ActivityFeedViewContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("B4AF");B4AF.$G5=function(a,b){B4AF.$G5.initializeBase(this,[a,b]);this.$Cz=a.get_$7T();this.$45=this.get_$2r().$1j("div");this.$45.className=B4AF.$G5.$3E8;this.$9E(this.$45);this.$DR(this.$45)};B4AF.$G5.prototype={$Cz:null,$45:null,$15b:function(){},$we:function(a){Box4.$1u.prototype.$we.call(this,a);(!this.$45.parentNode||this.$45.parentNode!==this.$Cz)&&this.$Cz.appendChild(this.$45);while(this.$45.children.length>1)this.$45.removeChild(this.$45.lastChild);for(var c=a.$eK(1),b=0;b<c;++b){var d=a.$NR(b,1),e=d.$4N(a.$NA).get_$4E();this.$45.appendChild(e);a.$1M()}this.$2A_0.$2PR=a.$eK(1);this.$2A_0.$41w()}};B4AF.$G5.$8s=function(){};B4AF.$G5.$8s.prototype={$x:function(a,b){return new B4AF.$G5(a,b)}};B4AF.$By=function(c,b,d,e,f,g,h){this.$$d_$5Wm=Function.createDelegate(this,this.$5Wm);B4AF.$By.initializeBase(this,[c,b]);this.$Re=b;this.$2i7=String.format(Box4Intl.Box4Strings.L_ActivityFeedTimeElementFormat,d,e);this.$45=this.get_$2r().$1j("div");this.$45.tabIndex=0;this.$45.className="ActivityGroupViewElement";this.$9E(this.$45);this.$DR(this.$45);this.$1O4=this.get_$2r().$1j("div");this.$1O4.className="ActivityGroupViewTimeElement";this.$45.appendChild(this.$1O4);this.$9E(this.$1O4);var a=this.$52X(this.$Re);if(a){this.$1Kl=this.get_$2r().$1j("div");this.$1Kl.className="ActivityGroupViewIconElement";this.$45.appendChild(this.$1Kl);this.$9E(this.$1Kl);this.$JH=Common.$n.$Fp(24,24,a,null,true,null);this.$JH.setAttribute("aria-hidden","true");this.$1Kl.appendChild(this.$JH);this.$9E(this.$JH)}this.$gN=this.get_$2r().$1j("div");this.$gN.className="ActivityGroupViewDescriptionElement";this.$kp=this.get_$2r().$1j("span");this.$kp.id=Common.$1O.$x().toString();this.$2PN=this.$kp.id;this.$kp.className="ActivityGroupViewActionElement";this.$gN.appendChild(this.$kp);this.$9E(this.$kp);this.$45.appendChild(this.$gN);this.$9E(this.$gN);this.$B1=h;this.$B1.$z("click",this.$kp,this.$$d_$5Wm);this.$JH&&this.$B1.$z("click",this.$JH,this.$$d_$5Wm);this.$1y=f;this.$K=g};B4AF.$By.$5z2=function(){var a=new(Common.Collections.$2d.$$(Box4.$VF,String));a.$F(1,"EditGeneric_24x24x32");a.$F(2,"Table_24x24x32");a.$F(3,"html_insert_image_24x24x8");a.$F(4,"CommentComment_24x24x32");return a};B4AF.$By.prototype={$Re:null,$45:null,$1O4:null,$1Kl:null,$JH:null,$gN:null,$kp:null,$2i7:null,$1y:null,$K:null,$B1:null,$2PN:null,$5Wm:function(){var a=this.$1y.$DI(this.$Re);a.$3u()&&this.$K.$4J(2309792997,2,a.get_$A());this.$1CQ();return true},$15b:function(){this.$1O4.innerText=this.$52Y(this.$Re);this.$kp.innerText=this.$52W(this.$Re)},$we:function(a){Box4.$1u.prototype.$we.call(this,a);var e=this.$Re.$s(Number,Box4.AppProperties.$1.$1fx);while(this.$gN.children.length>1)this.$gN.removeChild(this.$gN.lastChild);if(e)for(var f=this.$3WA(this.$Re).length>1,d=a.$eK(1),b=0;b<d;++b){var g=a.$NR(b,1),c=g.$4N(a.$NA).get_$4E();this.$gN.appendChild(c);this.$9E(c);f&&b<d-1&&this.$gN.removeChild(c);a.$1M()}},$52Y:function(){var a=this.$Re.$s(Date,Box4.AppProperties.$5.$1hi);return a?Common.$49.$1Qe(a,this.$2i7,Common.$49.get_$1Br()):""},$3WA:function(d){for(var b=d.$s(Array,Box4.AppProperties.$1.$2qL),c=[],a=0;a<b.length;++a)c.push(b[a]);return c},$52V:function(c,e){var f=e.$s(Number,Box4.AppProperties.$1.$1fx),b=0,d=e.$v(Box4.AppProperties.$1.$1Bd);if(d)b=e.$s(Number,Box4.AppProperties.$1.$1Bd);var a="";switch(f){case 1:if(c===1)a=Box4Intl.Box4Strings.L_ParagraphEdited;if(c===2)a=Box4Intl.Box4Strings.L_ParagraphEditedBy2;if(c>2)a=Box4Intl.Box4Strings.L_ParagraphEditedByMany;break;case 3:if(!d)break;if(!b)a=Box4Intl.Box4Strings.L_ImageAdded;if(b===1)a=Box4Intl.Box4Strings.L_ImageDeleted;break;case 2:if(!d)break;if(!b)a=Box4Intl.Box4Strings.L_TableAdded;if(b===2){if(c===1)a=Box4Intl.Box4Strings.L_TableEdited;if(c===2)a=Box4Intl.Box4Strings.L_TableEditedBy2;if(c>2)a=Box4Intl.Box4Strings.L_TableEditedByMany}if(b===1)a=Box4Intl.Box4Strings.L_TableDeleted;break;case 4:if(!d)break;if(!b)a=Box4Intl.Box4Strings.L_CommentAdded;if(b===2)a=Box4Intl.Box4Strings.L_CommentEdited;if(b===1)a=Box4Intl.Box4Strings.L_CommentDeleted}return a},$52W:function(c){var a=this.$3WA(c),b=this.$52V(a.length,c);if(a.length<=2)return String.format.apply(null,[b].concat(a));var d=[a[0],(a.length-1).toString()];return String.format.apply(null,[b].concat(d))},$52X:function(b){var a=b.$s(Number,Box4.AppProperties.$1.$1fx);return B4AF.$By.$2vh.$30(a)?B4AF.$By.$2vh.get_$5(a):""},$1CQ:function(){if(this.$45){Common.$b.$4().$HC("ActivityFeedTaskPane");this.$45.focus()}else Diag.$2.$m(18213069,306,false,null)},$d:function(){this.$B1.$1u("click",this.$kp,this.$$d_$5Wm);this.$JH&&this.$B1.$1u("click",this.$JH,this.$$d_$5Wm);Box4.$1u.prototype.$d.call(this)}};B4AF.$By.$8s=function(a,b,c,d,e){this.$2gl=a;this.$2gm=b;this.$1y=c;this.$K=d;this.$B1=e};B4AF.$By.$8s.prototype={$2gl:null,$2gm:null,$1y:null,$K:null,$B1:null,$x:function(a,b){return new B4AF.$By(a,b,this.$2gl,this.$2gm,this.$1y,this.$K,this.$B1)}};B4AF.$VH=function(a,b,c,d,e){this.$$d_$5Wl=Function.createDelegate(this,this.$5Wl);B4AF.$VH.initializeBase(this,[a,b]);this.$Re=b;this.$45=this.get_$2r().$1j("div");this.$45.tabIndex=0;this.$45.setAttribute("role","button");this.$45.className="ActivityViewElement";this.$9E(this.$45);this.$DR(this.$45);this.$Pg=this.$5A9();this.$45.appendChild(this.$Pg);this.$9E(this.$Pg);this.$B1=d;this.$B1.$z("click",this.$45,this.$$d_$5Wl);this.$K=c;this.$51=a;this.$1y=e};B4AF.$VH.prototype={$Re:null,$Pg:null,$45:null,$K:null,$B1:null,$1y:null,$51:null,$5Wl:function(){this.$K.$4J(2309792997,2,this.$Re);this.$1CQ();return true},$15b:function(){this.$Pg.innerText=this.$Re.$R(String,Box4.AppProperties.$1.$2mW,"");var b=this.$Re.$s(Number,Box4.AppProperties.$1.$1Bd);if(b===1)Sys.UI.DomElement.addCssClass(this.$45,"ContentActivityDeleteOperation");else Sys.UI.DomElement.removeCssClass(this.$45,"ContentActivityDeleteOperation");if(this.$Re.$R(Boolean,Box4.AppProperties.$K.$Bv,false))Sys.UI.DomElement.addCssClass(this.$45,"SelectedActivity");else Sys.UI.DomElement.removeCssClass(this.$45,"SelectedActivity");var a=this.$1y.$7f();a.$h(this.$Re);a.$1X(57);a.$1M();var c=a.get_$A().$Cj(this.$51.get_$2o()),d=c.$2PN+" "+this.$Pg.id;Common.$1y.$HD(this.$45,"aria-labelledby",d)},$5A9:function(){var a=this.get_$2r().$1j("span");a.id=Common.$1O.$x().toString();a.setAttribute("aria-hidden","true");a.tabIndex=0;a.className="ActivityViewText";return a},$1CQ:function(){if(this.$45){Common.$b.$4().$HC("ActivityFeedTaskPane");this.$45.focus()}else Diag.$2.$m(18213070,306,false,null)},$d:function(){this.$B1.$1u("click",this.$45,this.$$d_$5Wl);Box4.$1u.prototype.$d.call(this)}};B4AF.$VH.$8s=function(a,b,c){this.$K=a;this.$B1=b;this.$1y=c};B4AF.$VH.$8s.prototype={$K:null,$B1:null,$1y:null,$x:function(a,b){return new B4AF.$VH(a,b,this.$K,this.$B1,this.$1y)}};B4AF.$8n=function(){};B4AF.$Ht=function(a,b,c,d,e,f,g,h,i){this.$$d_$44U=Function.createDelegate(this,this.$44U);this.$$d_$5qn=Function.createDelegate(this,this.$5qn);this.dispose=this.$d;this.$227=a;this.$Ax=b;this.$lU=c;this.$2VU=d;this.$1y=e;this.$2g=f;this.$2cR=g;this.$2UL=h;this.$2fN=i};B4AF.$Ht.prototype={$227:null,$Ax:null,$lU:null,$2VU:null,$1y:null,$2g:null,$2UL:null,$2fN:null,$2cR:null,$2zT:false,$23F:null,$2R9:false,$2k:function(){this.$2UL(this.$$d_$5qn);this.$Sa();this.$227.$3F()},$d:function(){this.$2fN(this.$$d_$5qn);this.$227.$d()},$5qn:function(d,c){var a=c,b=a.NewContextId;if(!this.$2zT&&b.indexOf("tabReview")>=0){this.$2cR("Microsoft.Office.Web.WordEditor.IWordEditorActivityFeedClientSettings");this.$2zT=true}},$Sa:function(){if(!this.$23F){var a=this;this.$23F=new Common.$1e(2,1,25,function(){a.$5oo()},75);Common.$0.get_$2e().$2f(this.$23F)}},$5oo:function(){this.$lU.$1B2(this.$Ax);var c=this.$2VU.$7s(1074135146),a=this.$1y.$DI(this.$Ax),b=this.$2g.$59(3,0);b.$Bd(a);a.$1Au(c,50,B4AF.$8n.$1fw);b.dispose();this.$Ax.get_$dj().$Ob(null,this.$$d_$44U,null)},$44U:function(b,a){if(a===123){this.$2R9=true;this.$Ax.get_$dj().$CS=0}else Diag.$2.$m(18213065,306,false,"Server returned unknown error {0}",a)}};B4AF.$DQ=function(b,c,d,e,f,g,h,i,j,k,a){this.$$d_$31e=Function.createDelegate(this,this.$31e);this.$$d_$jP=Function.createDelegate(this,this.$jP);this.$$d_$5so=Function.createDelegate(this,this.$5so);this.$$d_$5sq=Function.createDelegate(this,this.$5sq);this.$$d_$5sU=Function.createDelegate(this,this.$5sU);this.$$d_$5jT=Function.createDelegate(this,this.$5jT);this.$$d_$64x=Function.createDelegate(this,this.$64x);this.$K=b;this.$2I=c;this.$4m=d;this.$IU=e;this.$1uD=f;this.$RU=g;this.$1y7=h;this.$Ax=i;this.$1y=j;this.$7m=k;this.$2VE=a};B4AF.$DQ.prototype={$K:null,$2P:null,$IU:null,$2I:null,$4m:null,$mC:null,$1Z5:null,$1Yq:null,$1If:null,$1uD:null,$RU:null,$1y7:null,$Ax:null,$dB:null,$1y:null,$7m:null,$2VE:null,get_$jN:function(){return!this.$2P?false:this.$2P.$VQ},get_$DN:function(){return this.$RU.get_$Q()},set_$5se:function(a){this.$dB&&this.$dB.$9C(Box4.AppProperties.$K.$Bv,false);this.$dB=a;this.$dB&&this.$dB.$9C(Box4.AppProperties.$K.$Bv,true);return a},$3F:function(){this.$K.$P(148541933,2147483648,this.$$d_$64x);this.$K.$1W(3032463659,2147483648,this.$$d_$5jT,96);this.$K.$P(2309792997,2147483648,this.$$d_$5sU);this.$K.$P(2254629670,2147483648,this.$$d_$5sq);this.$K.$P(3530211866,2147483648,this.$$d_$5so);this.$K.$P(36098707,2147483648,Common.$1f.$BO);this.$K.$P(505937268,2147483648,Common.$1f.$BO);this.$K.$P(1099727869,2147483648,Common.$1f.$BO);this.$K.$P(4258527239,2147483648,Common.$1f.$BO);this.$K.$P(1227387632,2147483648,Common.$1f.$BO);this.$K.$P(1190405690,2147483648,Common.$1f.$BO)},$5Rs:function(a,b){switch(a){case 1074135126:this.$K.$2u(36098707,2);break;case 1074135124:this.$K.$2u(1099727869,2);break;case 1074135122:this.$K.$2u(505937268,2)}switch(b){case 393233:this.$K.$2u(4258527239,2);return;case 393250:this.$K.$2u(1190405690,2);return;case 393230:this.$K.$2u(1227387632,2);return;case 1074135127:return}Diag.$2.$m(18213066,306,false,null)},$5so:function(){var a;if(this.$dB&&this.$dB.get_$7C()){a=this.$1y.$DI(this.$dB);a.$1X(56);if(!a.$QO()){if(!a.$8j())return 32;a.$3u()}}else{var b=this.$Ax.get_$3V().$2C(B4AF.$8n.$1fw);a=this.$1y.$DI(b);if(!a.$3u())return 32;if(!a.$3u())return 32}this.$K.$4J(2309792997,2,a.get_$A());return 32},$5sq:function(){var a;if(this.$dB&&this.$dB.get_$7C()){a=this.$1y.$DI(this.$dB);a.$1X(56);if(!a.$L7()){a.$1M();if(!a.$L7())return 32;a.$UM()}}else{var b=this.$Ax.get_$3V().$2C(B4AF.$8n.$1fw);a=this.$1y.$DI(b);if(!a.$UM())return 32;if(!a.$UM())return 32}this.$K.$4J(2309792997,2,a.get_$A());return 32},$d:function(){if(this.$2P){this.$IU.$11Z("ActivityFeedTaskPane",this.$2P);this.$7m.$1u("keydown",this.$1If,this.$$d_$jP);this.$7m.$1u("keydown",this.$mC,this.$$d_$jP);this.$2P=null}},$29B:function(){var a=new Common.$t(Box4.$2R.$WW,Box4Intl.Box4Strings,null,null,null);this.$2P=this.$IU.$1Pr("ActivityFeedTaskPane",1,300,"ActivityFeedTaskPaneData",a)},$5GL:function(){this.$1SF();return 32},$31e:function(a){this.$2P===a&&this.$1SF()},$1SF:function(){this.$36C();this.$IU.$133(this.$2P)},$5sU:function(n,o,p,q,m){var a=m,j=a.$s(Number,Box4.AppProperties.$1.$1Bd);this.set_$5se(a);if(j===1)return 32;if(!a.$v(Box4.AppProperties.$1.$2mV)){Diag.$2.$m(18213067,306,false,"Content object Id not found for activity {0}",a.get_$E());return 8}var f=Box4.$1t.$KB(a.$s(String,Box4.AppProperties.$1.$2mV)),g=this.get_$DN().$2C(f),b=0;if(a.$v(Box4.AppProperties.$1.$2mU))b=a.$s(Number,Box4.AppProperties.$1.$2mU);var h=a.$s(Number,Box4.AppProperties.$1.$3KS);if(h===393233){var k=a.$s(Boolean,Box4.AppProperties.$1.$3KT);if(!k){var l=Box4.$1t.$KB(a.$s(String,Box4.AppProperties.$1.$3KU)),c=this.get_$DN().$2C(l);if(c)for(var d=0;d<c.$i.get_$N();d++){var e=c.$i.get_$5(d);if(e.$2i){var i=$$as(Box4.$Gl,e.$2i);if(i&&i.$E.$w(f)){this.$1y7.$fK(c,b,e.$1K);break}}}}}else g&&this.$1y7.$fK(g,b,-1);this.$2I.$HC("ActivityFeedTaskPane");a.$4N(this.$1uD.$y).get_$4E().focus();this.$5Rs(b,h);return 32},$3wt:function(){var a=this.$2I.$2w("ActivityFeedTaskPane");a.$7E="app";var b=this;a.$ZU(function(){b.$mC.focus()});this.$4m.$Py("ActivityFeedTaskPane");a.$1T(Common.$G.$1F(38,0),2254629670);a.$1T(Common.$G.$1F(40,0),3530211866);this.$7m.$z("keydown",this.$1If,this.$$d_$jP);this.$7m.$z("keydown",this.$mC,this.$$d_$jP)},$jP:function(b){var a=b.$1c;if(a.altKey||a.ctrlKey||a.keyCode===38||a.keyCode===40)return false;this.$2VE(a);return true},$64x:function(b,c,a){return a===1?32:this.get_$jN()?this.$5GL():this.$Xf()},$5jT:function(d,e,b,f,c){if(b===1)return 32;var a=c;a.On=this.get_$jN();return 32},$Xf:function(){if(!this.$2P){this.$29B();this.$1If=CommonUI.$1D.$9m("div","ActivityFeedViewElement","ActivityFeedViewElementClass");this.$1Yq=this.$1kr(B4AF.$DQ.$3EA);this.$1Z5=CommonUI.$1D.$9m("div","ActivityFeedAriaInfo","ActivityFeedAriaInfo");this.$1Z5.innerText=Box4Intl.Box4Strings.L_ActivityNavigationInfo;this.$1Z5.setAttribute("aria-hidden","true");this.$1Yq.appendChild(this.$1Z5);this.$mC=CommonUI.$1D.$9m("div","ActivityFeedIntro","ActivityFeedIntro");this.$mC.setAttribute("role","description");var a="ActivityFeedIntro ActivityFeedAriaInfo";this.$mC.setAttribute("aria-labelledby",a);this.$mC.tabIndex=0;this.$1Yq.appendChild(this.$mC);this.$1Yq.appendChild(this.$1If);this.$1uD.$4Hw(this.$1If,this.$mC);this.$3wt()}this.$IU.$Xf(this.$2P);this.$2P.$14b(this.$$d_$31e);this.$1pk();return 32},$1pk:function(){this.$4m.$IX("ActivityFeedTaskPane")},$36C:function(){this.$4m.$Gw("ActivityFeedTaskPane");this.$2I.get_$AS()&&this.$2I.get_$AS().$5j==="ActivityFeedTaskPane"&&this.$2I.$8x("document")},$1kr:function(c){var b=this.$2P.$19U,a=b[c];return CommandUI.$Dk.isInstanceOfType(a)?a.$Vn:null}};B4AF.$G6=function(a,b,c,d){B4AF.$G6.initializeBase(this,[a]);this.$FO=b;this.set_$Jk(c);this.set_$6m(B4AF.$8n.$3x0);this.$3U=d.$11N(this)};B4AF.$G6.prototype={$oI:function(){return false}};B4AF.$KI=function(a,b,c,d,e,f,g,h){this.$$d_$4lZ=Function.createDelegate(this,this.$4lZ);this.$$d_$45O=Function.createDelegate(this,this.$45O);B4AF.$KI.initializeBase(this);this.$Ax=a;this.$lU=b;this.$K=c;this.$2UE=d;this.$2UF=e;this.$xY=f;this.$1y=g;this.$2g=h};B4AF.$KI.prototype={$Ax:null,$lU:null,$K:null,$2UE:null,$2UF:null,$xY:null,$1y:null,$2g:null,$xX:null,$2PR:0,$1sP:null,get_$44P:function(){return this.$xY.get_$Q()},get_$13D:function(){return Box4.$rd.prototype.get_$13D.call(this)|256|2|192|16},$4Hw:function(a,b){this.$xX=this.$Ax.get_$3V().$2C(B4AF.$8n.$1fw);if(this.$xX){this.$1BI(a);this.$NG(this.$xX,this.$lU);this.$1sP=b;this.$41w();this.$Ax.set_$1Sd(true);this.$3F()}else Diag.$2.$m(18213068,306,false,null)},$41w:function(){if(this.get_$44P().$2R9)this.$1sP.innerText=Box4Intl.Box4Strings.L_ActivityFeed_Error;else this.$1sP.innerText=!this.$2PR?Box4Intl.Box4Strings.L_ActivityFeed_BootPlaceholder:Box4Intl.Box4Strings.L_ActivityFeedInfo},$3F:function(){this.$K.$1W(2688515373,1,this.$$d_$45O,96);this.$K.$1W(2903527192,1,this.$$d_$4lZ,96)},$45O:function(l,m,n,o,f){if(this.$xX&&f){var c=f,h=this.$2UE.$3Zi(c),a=this.$1y.$DI(this.$xX),e=this.$2g.$59(3,0);e.$Bd(a);a.$3p(h,1);if(c.hasOwnProperty("activities")){a.$F3(1);for(var i=c.activities,d=i,g=d.length,b=0;b<g;++b){var j=d[b],k=this.$2UF.$3Zi(j);a.$3p(k,1)}}e.dispose()}return 32},$4lZ:function(){if(this.$xX){var a=this.$1y.$DI(this.$xX),b=this.$2g.$59(3,0);b.$Bd(a);while(a.$9L(1)){a.$1J(1);a.$4v()}b.dispose()}return 32}};B4AF.$WW=function(){};B4AF.$WW.$5Sr=function(){Common.App.$f.get_$4().$3M(new B4AF.$WW)};B4AF.$WW.prototype={$U:null,$26:null,$xY:null,get_$5j:function(){return"Box4.ActivityFeed"},$t9:function(d){this.$U=d;this.$26=this.$U.$J(Box4.$2o);var e=this;this.$U.$e(B4AF.$G6).$p().$n(function(){return new B4AF.$G6(-1,Box4.App.$K5,Box4.App.$2LL,Box4.$2g.$T)});var c=this;this.$U.$e(B4AF.$Ht).$p().$n(function(){return new B4AF.$Ht(c.$U.$J(B4AF.$DQ),c.$U.$J(B4AF.$G6),Box4.App.$7j.get_$KA(),Box4.$2g.$T,new Box4.$4A,new Box4.$5X,Common.$0.$13l,function(a){CommandUI.$5d.add_$3mH(a)},function(a){CommandUI.$5d.remove_$3mH(a)})});var a=this;this.$U.$e(B4AF.$KI).$p().$n(function(){return new B4AF.$KI(a.$U.$J(B4AF.$G6),Box4.App.$7j.get_$KA(),Common.$0.get_$r(),a.$U.$J(Box4.$Hu),a.$U.$J(Box4.$Hv),a.$U.$7a(B4AF.$Ht),new Box4.$4A,new Box4.$5X)});var b=this;this.$U.$e(B4AF.$DQ).$p().$n(function(){return new B4AF.$DQ(Common.$0.get_$r(),Common.$0.get_$1Y().get_$38z(),Common.$0.get_$1Y().get_$bC(),Box4.TaskPaneManager.$3k.get_$4(),b.$U.$J(B4AF.$KI),new($$sc.$x.$$(Box4.$Ag))(function(){return Box4.App.get_$X().$1L.get_$2v().get_$3V()}),b.$U.$J(Box4.$Rk),b.$U.$J(B4AF.$G6),new Box4.$4A,Common.$G.get_$4(),Common.$W.$Ai)});var f=this;this.$U.$e(B4AF.$G5.$8s).$1p(Box4.$R1).$p().$n(function(){return new B4AF.$G5.$8s});var g=this;this.$U.$e(B4AF.$By.$8s).$1p(Box4.$R2).$p().$n(function(){return new B4AF.$By.$8s(Common.$0.$2Mn,Common.$0.$1pw,new Box4.$4A,Common.$0.get_$r(),Box4.App.get_$X().$B1)});var h=this;this.$U.$e(B4AF.$VH.$8s).$1p(Box4.$R3).$p().$n(function(){return new B4AF.$VH.$8s(Common.$0.get_$r(),Box4.App.get_$X().$B1,new Box4.$4A)})},$7Y:function(){var a=this;this.$26.get_$SM().CW(function(){a.$ap()})},$d:function(){this.$xY&&this.$xY.$d()},$ap:function(){if(!Common.$0.$o.$1A("WordEditorActivityFeedPaneIsEnabled"))return;this.$xY=this.$U.$J(B4AF.$Ht);this.$xY.$2k()}};B4AF.$G5.registerClass("B4AF.$G5",Box4.$1u);B4AF.$G5.$8s.registerClass("B4AF.$G5.$8s",null,Box4.$R1);B4AF.$By.registerClass("B4AF.$By",Box4.$1u);B4AF.$By.$8s.registerClass("B4AF.$By.$8s",null,Box4.$R2);B4AF.$VH.registerClass("B4AF.$VH",Box4.$1u);B4AF.$VH.$8s.registerClass("B4AF.$VH.$8s",null,Box4.$R3);B4AF.$8n.registerClass("B4AF.$8n");B4AF.$Ht.registerClass("B4AF.$Ht",null,Sys.IDisposable);B4AF.$DQ.registerClass("B4AF.$DQ");B4AF.$G6.registerClass("B4AF.$G6",Box4.$5q);B4AF.$KI.registerClass("B4AF.$KI",Box4.$3z);B4AF.$WW.registerClass("B4AF.$WW",null,Common.App.$jx,Common.Utils.$l6);B4AF.$G5.$3E8="ActivityContainerViewElement";B4AF.$By.$2vh=B4AF.$By.$5z2();B4AF.$8n.$3x0=new Common.$C(Common.$1O.$7r("857E33A1-121C-41C0-82D1-B49306D333AA"),1);B4AF.$8n.$1fw=new Common.$C(Common.$1O.$7r("0D092D27-6B91-4C21-BC90-5E75B1111550"),1);B4AF.$DQ.$3EA="ActivityFeedViewContainer";B4AF.$WW.$5Sr();Type.registerNamespace("WEDSM");WEDSM.$3F=function(){};WEDSM.$3F.prototype={noResultYet:-1,upToDate:0,sessionLost:1,userSignedOut:2,previousRequestPending:3,requestFailed:4,shuttingDown:5,nullResponseData:6,invalidResponseData:7,failedRevisionLookup:8,savedWithinThreshold:9,notSavedWarning:10,kickoutThreshold:11,unknownRevision:12,contentNotYetLoaded:13,sessionExpired:14};WEDSM.$3F.registerEnum("WEDSM.$3F",false);WEDSM.$kv=function(){};WEDSM.$kv.registerInterface("WEDSM.$kv");WEDSM.$l7=function(){};WEDSM.$l7.registerInterface("WEDSM.$l7");WEDSM.$CA=function(g,h,i,j,k,l,m,n,o,p,a,b,c,d,e,f){this.$$d_$4Ng=Function.createDelegate(this,this.$4Ng);this.$$d_$4Nh=Function.createDelegate(this,this.$4Nh);this.$$d_$4tD=Function.createDelegate(this,this.$4tD);this.$$d_$5qN=Function.createDelegate(this,this.$5qN);this.$2cu=Common.$C.get_$1G();this.$rK=g;this.$2is=h;this.$2gn=i;this.$2bN=j;this.$1wr=k;this.$60=l;this.$OB=m;this.$Pe=n;this.$18D=o;this.$2bE=p;this.$18c=a;this.$2az=b;this.$gt=c;this.$C5=d;this.$2fe=e;this.$2Y7=f;this.$Lr=new Common.$UI(-1);this.$Lr.add_$3yt(this.$$d_$5qN)};WEDSM.$CA.$3iW=function(d,e){var a=e;for(var b in a){var c={key:b,value:a[b]};d[c.key]=c.value}};WEDSM.$CA.prototype={$rK:0,$2is:0,$2gn:false,$2bN:0,$60:null,$18D:null,$2bE:null,$18c:null,$2az:null,$OB:null,$gt:null,$Pe:null,$C5:null,$2fe:null,$2Y7:false,$1wr:null,$17j:0,$1cH:false,$2fd:null,$YT:0,$Lr:null,get_$3gi:function(){return!this.$1kH()||this.$2cu.$w(this.$1kH().get_$E())},get_$4QQ:function(){return this.$YT},$2k:function(){this.$17j=this.$1wr.$4jC(this.$$d_$4tD,this.$rK)},$68P:function(a){if(!this.$17j||this.$rK===a)return;this.$rK=a;this.$4x("Changing save monitor interval");this.$2k()},$4x:function(a){this.$66(a)},$66:function(a){if(this.$17j){Diag.$2.$9(5830084,343,50,"Stopping DocxSaveMonitor because {0}!",a);this.$1wr.$66(this.$17j);this.$17j=0}},$4tD:function(){if(this.$gt()){this.$Lr.$Di(5,null);this.$4x("Session has shut down");return}var a=this.$18D();if(!a){this.$Lr.$Di(13,null);return}if(this.$18c()){this.$Lr.$Di(1,null);this.$4x("session is lost");return}if(this.get_$3gi()){this.$Lr.$Di(0,null);return}if(this.$2az()){this.$Lr.$Di(14,null);this.$4x("session is expired");!this.$2Y7&&this.$er();return}if(!this.$2bE()){this.$Lr.$Di(2,null);return}if(this.$1cH){this.$Lr.$Di(3,null);if(this.$C5().getTime()-this.$2fd.getTime()>12e4){this.$4x("stuck on "+WEDSM.$3F.toString(3));this.$er()}return}var c=Box4.$65.$28Z(WEDSM.$N2.$Jh(a)),b={};b["Content-Type"]="application/json; charset=utf-8";this.$1cH=true;this.$2fd=this.$2fe();this.$60.$DC(WEDSM.$CA.$3u1,2,c,b,false,2,this.$$d_$4Nh,this.$$d_$4Ng,null,null,false,6e4,12e4,null)},$3XR:function(){return this.$18D().get_$4R()},$1kH:function(){return this.$3XR().get_$Aj()},$4Ng:function(){this.$YT++;this.$1cH=false;this.$Lr.$Di(4,null)},$4Nh:function(d){this.$YT=0;this.$1cH=false;if(this.$gt()||!this.$17j){this.$Lr.$Di(5,null);return}if(!d.$1v||!d.$1v.$7c){this.$Lr.$Di(6,null);return}var a=this.$29f(d.$1v.$7c);if(!a){this.$Lr.$Di(7,null);return}this.$Pe.$1Go(a);if(a.StatusCode){var k={OperationResult:a.StatusCode};this.$Lr.$Di(8,k);a.StatusCode===104&&this.$4x("this operation is disabled on the server");return}var e={LastSavedRevisionId:a.LastSavedRevisionId},f=Box4.$1t.$KB(a.LastSavedRevisionId);this.$2cu=f;var j=this.$3XR(),g=j.get_$Be().$eT(f);if(g){var h=null,c=this.$1kH(),i=g.$1kF(c),l=!i?Common.$C.get_$1G():i.get_$E(),b=c;while(b&&!b.get_$E().$w(l)){h=b;b=b.get_$Dd()}var m=this.$5FH(h,e,c);!m&&this.$Lr.$Di(9,null)}else this.$Lr.$Di(12,e)},$5FH:function(b,c,e){var d=false;if(b){var a=this.$C5().getTime()-b.get_$4ka().getTime();if(a>=this.$2is){d=true;WEDSM.$CA.$3iW(c,this.$5BO(b,a,e));if(a>=this.$2bN&&this.$Lr.$1HE===10){this.$Lr.$Di(11,c);this.$er()}else{this.$Lr.$Di(10,c);this.$3Rb()}}}return d},$29f:function(d){var a,b,c;return(c=Box4.ServerResponseGroup.$1Gd(d,b={val:a}),a=b.val,c)?a.Responses[0]:null},$5BO:function(b,d,c){var a={};a.FirstUnsavedRevisionId=b.get_$E().toString();a.FirstUnsavedRevisionLengthToRoot=b.get_$UX();a.UnsavedTimeInMs=d;a.CurrentRevisionId=c.get_$E().toString();a.CurrentRevisionLengthToRoot=c.get_$UX();return a},$3Rb:function(){WordEditor.$3g.$3Rc(8,null,null,null)},$er:function(){this.$2gn&&this.$OB.get_$Q().$er(5242978,new Wonca.$FQ,null)},$5qN:function(e,b){var a={};a.DocxSaveMonitorState=WEDSM.$3F.toString(b.$YC);a.PreviousState=WEDSM.$3F.toString(b.$1t8);a.PreviousStateHits=b.$1t9;var c=b.$2TI;c&&WEDSM.$CA.$3iW(a,c);var d=b.$YC;switch(d){case 13:Diag.$2.$9(5830086,343,50,"{0}",a);break;case 1:Diag.$2.$9(5884125,343,50,"{0}",a);break;case 0:Diag.$2.$9(5830087,343,50,"{0}",a);break;case 2:Diag.$2.$9(5830088,343,50,"{0}",a);break;case 3:Diag.$2.$9(5830089,343,50,"{0}",a);break;case 4:Diag.$2.$9(5884126,343,50,"{0}",a);break;case 5:Diag.$2.$9(5884127,343,50,"{0}",a);break;case 6:Diag.$2.$m(5830090,343,false,"{0}",a);break;case 7:Diag.$2.$m(5830091,343,false,"{0}",a);break;case 8:Diag.$2.$9(5830092,343,15,"{0}",a);break;case 10:Diag.$2.$9(5830094,343,15,"{0}",a);break;case 9:Diag.$2.$9(5884128,343,50,"{0}",a);break;case 11:Diag.$2.$9(5830096,343,15,"{0}",a);break;case 12:Diag.$2.$9(5830095,343,50,"{0}",a);break;case 14:Diag.$2.$9(6575508,343,50,"{0}",a);break;default:Diag.$2.$m(5884129,343,false,"Bad category:{0}, logInfo")}}};WEDSM.$Yd=function(a,b){this.$$d_$683=Function.createDelegate(this,this.$683);this.$$d_$5fE=Function.createDelegate(this,this.$5fE);this.$d9=a;this.$2ZA=b};WEDSM.$Yd.prototype={$d9:null,$2ZA:null,$3F:function(a){a.$P(52378640,2,this.$$d_$5fE);a.$P(2018620975,2,this.$$d_$683);a.$2G(2018620975,101)},$5fE:function(){var a=this.$2ZA();return a!==32?a:!this.$d9||this.$d9.get_$3gi()?32:this.$d9.get_$4QQ()>=2?8:4},$683:function(c,d,e,f,b){if(this.$d9){var a=parseInt(b.toString());this.$d9.$68P(a)}return 32}};WEDSM.$GQ=function(){};WEDSM.$GQ.prototype={$4jC:function(a,b){return window.setInterval(a,b)},$66:function(a){window.clearInterval(a)}};WEDSM.$N2=function(){WEDSM.$N2.initializeBase(this)};WEDSM.$N2.$Jh=function(b){var a=new WEDSM.$N2;a.FileId=b.$5T().get_$11k();a.CellId=Box4.$1t.$5B(b.get_$4R().get_$E());return a};WEDSM.$N2.prototype={$12a:function(){return 37},FileId:null,CellId:null};WEDSM.$sb=function(){WEDSM.$sb.initializeBase(this)};WEDSM.$sb.prototype={LastSavedRevisionId:null};WEDSM.$jF=function(){this.$$d_$5DB=Function.createDelegate(this,this.$5DB)};WEDSM.$jF.$5Sr=function(){Common.App.$f.get_$4().$3M(new WEDSM.$jF)};WEDSM.$jF.prototype={$d9:null,get_$5j:function(){return"WordEditor.DocxSaveMonitor"},$7Y:function(){this.$d9=this.$4hN();var b=this,a=new WEDSM.$Yd(this.$d9,function(){return Wonca.$1Q.get_$GZ().$3ce()});a.$3F(Common.$0.get_$r())},$4hN:function(){var a=Common.$0.$o;if(!a.$1A("DocxSaveMonitorEnabled"))return null;var c=a.$1A("DocxSaveMonitorKickoutEnabled"),d=a.$5L("DocxSaveMonitorIntervalMs",6e4),e=a.$5L("DocxSaveMonitorWarningTimeMs",12e4),f=a.$5L("DocxSaveMonitorKickoutTimeMs",6e5),g=a.$1A("FixQoSDocxSaveMonitorKickoutIsEnabled"),h=this,i=this,j=this,k=this,l=this,b=new WEDSM.$CA(d,e,c,f,WEDSM.$GQ.$4,Common.$0.$7Q,Common.Utils.$8.get_$4().$7a(Wonca.$Ir),Box4.$1Z.get_$4(),this.$$d_$5DB,function(){return!Common.$0.$1nc||Common.$4w.get_$4().get_$2Ft()},function(){return Box4.App.$lr},Common.$0.$pS,function(){return Common.$0.$6B},function(){return new Date},function(){return new Date},g);b.$2k();var m=this;Common.Utils.$8.get_$4().$3j(Common.$J4).$46(function(a){a.add_$1US(function(){b.$4x("session expiried")})});Diag.$2.$9(5884131,343,50,"SaveMonitor initialized");return b},$5DB:function(){var a=Box4.App.get_$X().$1L.$3o;return a?a.get_$Bf():null},$d:function(){this.$d9&&this.$d9.$4x("WordEditorDocxSaveMonitorPackage is being disposed")},$t9:function(){}};WEDSM.$CA.registerClass("WEDSM.$CA",null,WEDSM.$kv);WEDSM.$Yd.registerClass("WEDSM.$Yd");WEDSM.$GQ.registerClass("WEDSM.$GQ",null,WEDSM.$l7);WEDSM.$N2.registerClass("WEDSM.$N2",Box4.$sS);WEDSM.$sb.registerClass("WEDSM.$sb",Box4.$sI);WEDSM.$jF.registerClass("WEDSM.$jF",null,Common.App.$jx,Common.Utils.$l6);WEDSM.$CA.$3u1=Box4.App.$15i+"OneNote.ashx";WEDSM.$GQ.$4=new WEDSM.$GQ;WEDSM.$jF.$5Sr();Type.registerNamespace("WordEditor.GraphMerge");WordEditor.GraphMerge.$l5=function(){};WordEditor.GraphMerge.$l5.registerInterface("WordEditor.GraphMerge.$l5");WordEditor.GraphMerge.$l3=function(){};WordEditor.GraphMerge.$l3.registerInterface("WordEditor.GraphMerge.$l3");WordEditor.GraphMerge.$l2=function(){};WordEditor.GraphMerge.$l2.registerInterface("WordEditor.GraphMerge.$l2");WordEditor.GraphMerge.$f2=function(){};WordEditor.GraphMerge.$f2.prototype={};WordEditor.GraphMerge.$f2.registerEnum("WordEditor.GraphMerge.$f2",false);WordEditor.GraphMerge.$kz=function(){};WordEditor.GraphMerge.$kz.registerInterface("WordEditor.GraphMerge.$kz");WordEditor.GraphMerge.$ky=function(){};WordEditor.GraphMerge.$ky.registerInterface("WordEditor.GraphMerge.$ky");WordEditor.GraphMerge.$kx=function(){};WordEditor.GraphMerge.$kx.registerInterface("WordEditor.GraphMerge.$kx");WordEditor.GraphMerge.$AM=function(){WordEditor.GraphMerge.$AM.initializeBase(this,[null])};WordEditor.GraphMerge.$AM.$Bo=function(){return new WordEditor.GraphMerge.$AM};WordEditor.GraphMerge.$AM.get_$4=function(){return WordEditor.GraphMerge.$AM.$T.get_$Q()};WordEditor.GraphMerge.$AM.prototype={get_$29W:function(){return 7}};WordEditor.GraphMerge.$AN=function(){WordEditor.GraphMerge.$AN.initializeBase(this,[null])};WordEditor.GraphMerge.$AN.$Bo=function(){return new WordEditor.GraphMerge.$AN};WordEditor.GraphMerge.$AN.get_$4=function(){return WordEditor.GraphMerge.$AN.$T.get_$Q()};WordEditor.GraphMerge.$AN.prototype={get_$29W:function(){return 7},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$NZ),1);return a},$66b:function(a,b){if(b===Common.$i.$2L(Box4.AppProperties.$5.$NZ)){var c=a.$Eh,d=a.$Ox;Diag.$Q.get_$4().$1k(6633221,1,3,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",c.get_$E(),c.get_$48(),b);var e=d.$2ui(a.$7e.get_$Q().$5m,Box4.AppProperties.$5.$NZ),f=d.$2ui(a.$Fi.get_$Q().$5m,Box4.AppProperties.$5.$NZ);e<f&&this.$54X(a);a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$NZ));return true}Diag.$Q.get_$4().$1k(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),b);return false},$54X:function(a){var b=a.$Fi.get_$Q().$5m,c=a.$Eh;this.$5od(b,c);this.$2tI(a,Box4.AppProperties.$1.$1gI);this.$2tI(a,Box4.AppProperties.$1.$276);this.$2tI(a,Box4.AppProperties.$1.$26s)},$2tI:function(a,h){var e=a.$Ox,f=a.$Eh;if(!e.$v(f,h))return;var b=e.$8E(f,h);if(!b||!b.get_$N())return;for(var g=a.$f2.$2M.$J4,k=a.$f2.$2M.$Kt,i=a.$f2.$2M.$Jx,c=0;c<b.get_$N();c++){var d=b.get_$5(c);if(!g.$30(d))continue;var j=g.get_$5(d).$OS();i.$F(d,new WordEditor.GraphMerge.$7m(j,false))}}};WordEditor.GraphMerge.$AO=function(){WordEditor.GraphMerge.$AO.initializeBase(this,[null])};WordEditor.GraphMerge.$AO.$Bo=function(){return new WordEditor.GraphMerge.$AO};WordEditor.GraphMerge.$AO.get_$4=function(){return WordEditor.GraphMerge.$AO.$T.get_$Q()};WordEditor.GraphMerge.$AO.prototype={get_$29W:function(){return 7}};WordEditor.GraphMerge.$AP=function(){WordEditor.GraphMerge.$AP.initializeBase(this,[null])};WordEditor.GraphMerge.$AP.$Bo=function(){return new WordEditor.GraphMerge.$AP};WordEditor.GraphMerge.$AP.get_$4=function(){return WordEditor.GraphMerge.$AP.$T.get_$Q()};WordEditor.GraphMerge.$AP.prototype={get_$29W:function(){return 7}};WordEditor.GraphMerge.$AQ=function(){WordEditor.GraphMerge.$AQ.initializeBase(this,[null])};WordEditor.GraphMerge.$AQ.$Bo=function(){return new WordEditor.GraphMerge.$AQ};WordEditor.GraphMerge.$AQ.get_$4=function(){return WordEditor.GraphMerge.$AQ.$T.get_$Q()};WordEditor.GraphMerge.$AQ.prototype={$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$hv),1);return a},$66b:function(a,d){if(d===Common.$i.$2L(Box4.AppProperties.$1.$hv)){var c=a.$Eh,b=a.$Ox;Diag.$Q.get_$4().$1k(6633224,1,3,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",c.get_$E(),c.get_$48(),d);var g=b.$8E(a.$7e.get_$Q().$KL,Box4.AppProperties.$1.$hv),h=b.$8E(a.$7e.get_$Q().$5m,Box4.AppProperties.$1.$hv),i=b.$8E(a.$Fi.get_$Q().$5m,Box4.AppProperties.$1.$hv),e=this.$5Tw(a,g,h,i),f=c;if(e.get_$N()>0)b.$Sz(f,Box4.AppProperties.$1.$hv,e);else f.$4z(Box4.AppProperties.$1.$hv);a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$hv));return true}Diag.$Q.get_$4().$1k(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),d);return false},$5Tw:function(c,j,k,l){var a=this.$5U5(Common.$C,j,k,l),f=j.$k7(),m=k.$k7(),n=l.$k7(),o=this,g=WordEditor.GraphMerge.$4R.$1QX(Common.$C,a,function(a){return!f.$4V(a)&&m.$4V(a)}),p=this,h=WordEditor.GraphMerge.$4R.$1QX(Common.$C,a,function(a){return!f.$4V(a)&&n.$4V(a)});if(!g.get_$N()||!h.get_$N())return a;var b=new(Common.Collections.$2d.$$(String,WordEditor.GraphMerge.$AQ.$3dR)),d=this;g.$2m(function(a){var e=new WordEditor.GraphMerge.$AQ.$3dR(a,d.$3WU(c,a,false)),f=d.$3WQ(c,a,false);f.$2m(function(a){b.$F(a,e);return true});return true});var i=new(Common.Collections.$4y.$$(Common.$C)),e=this;h.$2m(function(a){var d=e.$3WU(c,a,true),f=e.$3WQ(c,a,true);f.$2m(function(c){if(b.$30(c)){i.$F(b.get_$5(c).$2TC>=d?a:b.get_$5(c).$3Q);return false}return true});return true});var q=this;return WordEditor.GraphMerge.$4R.$1QX(Common.$C,a,function(a){return!i.$4V(a)})},$3WU:function(b,c,d){var a=this.$2uj(b,c,d);return!a?0:b.$Ox.$2ui(a,Box4.AppProperties.$5.$NZ)},$2uj:function(b,c,d){var a=d?b.$f2.$2M.$J4:b.$f2.$2M.$Kt;return a.$30(c)?a.get_$5(c):null},$3WQ:function(h,k,j){var b=new(Common.Collections.$1E.$$(String))(null),c=new(Common.Collections.$4y.$$(String)),d=h.$Ox,i=this.$2uj(h,k,j),e=this.$3aa(d,i);if(e){b.$F(e);c.$F(e);for(var f=d.$8E(i,Box4.AppProperties.$1.$1gI),g=0;f&&g<f.get_$N();g++){var a=this.$3aa(d,this.$2uj(h,f.get_$5(g),j));if(!a)break;if(c.$4V(a))continue;b.$F(a);c.$F(a)}}return b},$3aa:function(a,b){if(!a.$v(b,Box4.AppProperties.$1.$1gH)||!a.$v(b,Box4.AppProperties.$1.$1gJ)||!a.$v(b,Box4.AppProperties.$1.$1gK))return null;var c=a.$oA(b,Box4.AppProperties.$1.$1gH),d=a.$oA(b,Box4.AppProperties.$1.$1gJ),e=a.$oA(b,Box4.AppProperties.$1.$1gK);return Common.$9.$8K(c+";"+d+";"+e)}};WordEditor.GraphMerge.$AQ.$3dR=function(a,b){this.$3Q=a;this.$2TC=b};WordEditor.GraphMerge.$AQ.$3dR.prototype={$3Q:null,$2TC:0};WordEditor.GraphMerge.$AW=function(){WordEditor.GraphMerge.$AW.initializeBase(this,[null])};WordEditor.GraphMerge.$AW.$Bo=function(){return new WordEditor.GraphMerge.$AW};WordEditor.GraphMerge.$AW.get_$4=function(){return WordEditor.GraphMerge.$AW.$T.get_$Q()};WordEditor.GraphMerge.$AW.prototype={$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$6r),1);return a},$66b:function(a,d){if(d===Common.$i.$2L(Box4.AppProperties.$5.$6r)){var c=a.$Eh,b=a.$Ox;Diag.$Q.get_$4().$1k(4511579,1,3,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",c.get_$E(),c.get_$48(),d);var g=b.$8E(a.$7e.get_$Q().$KL,Box4.AppProperties.$5.$6r),h=b.$8E(a.$7e.get_$Q().$5m,Box4.AppProperties.$5.$6r),i=b.$8E(a.$Fi.get_$Q().$5m,Box4.AppProperties.$5.$6r),e=this.$5U0(g,h,i),f=c;if(e.get_$N()>0)b.$Sz(f,Box4.AppProperties.$5.$6r,e);else f.$4z(Box4.AppProperties.$5.$6r);a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$6r));return true}Diag.$Q.get_$4().$1k(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),d);return false},$5U0:function(c,d,e){var a=new(Common.Collections.$1E.$$(Common.$C))(null),b=new(Common.Collections.$2d.$$(Common.$C,WordEditor.GraphMerge.$AW.$4PY));this.$4s7(c,e,a,b);return this.$4ma(d,b,a)},$4s7:function(b,c,d,a){b=b||new(Common.Collections.$1E.$$(Common.$C))(null);c=c||new(Common.Collections.$1E.$$(Common.$C))(null);var e=this;b.$2m(function(b){a.set_$5(b,1);return true});var f=this;c.$2m(function(b){var f,c,e;if(e=a.$9F(b,c={val:f}),f=c.val,e)a.set_$5(b,2);else{a.set_$5(b,0);d.$F(b)}return true})},$4ma:function(c,a,d){c=c||new(Common.Collections.$1E.$$(Common.$C))(null);var b=new(Common.Collections.$1E.$$(Common.$C))(null),e=this;c.$2m(function(d){var g=true,c,e,f;if(f=a.$9F(d,e={val:c}),c=e.val,f)if(!c)a.set_$5(d,2);else if(c===1)g=false;g&&b.$F(d);return true});var f=this;d.$2m(function(c){var g=false,d,e,f;if(f=a.$9F(c,e={val:d}),d=e.val,f)if(!d){g=true;a.set_$5(c,2)}g&&b.$F(c);return true});return b}};WordEditor.GraphMerge.$AW.$4PY=function(){};WordEditor.GraphMerge.$AW.$4PY.prototype={};WordEditor.GraphMerge.$AW.$4PY.registerEnum("WordEditor.GraphMerge.$AW.$4PY",false);WordEditor.GraphMerge.$AX=function(){WordEditor.GraphMerge.$AX.initializeBase(this,[null])};WordEditor.GraphMerge.$AX.$Bo=function(){return new WordEditor.GraphMerge.$AX};WordEditor.GraphMerge.$AX.get_$4=function(){return WordEditor.GraphMerge.$AX.$T.get_$Q()};WordEditor.GraphMerge.$AX.prototype={$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$1BY),3);return a}};WordEditor.GraphMerge.$Ad=function(){WordEditor.GraphMerge.$Ad.initializeBase(this,[null])};WordEditor.GraphMerge.$Ad.$Bo=function(){return new WordEditor.GraphMerge.$Ad};WordEditor.GraphMerge.$Ad.get_$4=function(){return WordEditor.GraphMerge.$Ad.$T.get_$Q()};WordEditor.GraphMerge.$Ad.prototype={$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$S2),4);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$iT),1);return a},$66b:function(a,d){if(d===Common.$i.$2L(Box4.AppProperties.$1.$iT)){var c=a.$Eh,b=a.$Ox;Diag.$Q.get_$4().$1k(4063307,1,3,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",c.get_$E(),c.get_$48(),d);var g=b.$8E(a.$7e.get_$Q().$KL,Box4.AppProperties.$1.$iT),h=b.$8E(a.$7e.get_$Q().$5m,Box4.AppProperties.$1.$iT),i=b.$8E(a.$Fi.get_$Q().$5m,Box4.AppProperties.$1.$iT),j=this,e=this.$3ia(Common.$C,g,h,i,function(a,b){return a.$w(b)}),f=c;if(e.get_$N()>0)b.$Sz(f,Box4.AppProperties.$1.$iT,e);else f.$4z(Box4.AppProperties.$1.$iT);a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$iT));return true}Diag.$Q.get_$4().$1k(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),d);return false}};WordEditor.GraphMerge.$Ae=function(){WordEditor.GraphMerge.$Ae.initializeBase(this,[null])};WordEditor.GraphMerge.$Ae.$Bo=function(){return new WordEditor.GraphMerge.$Ae};WordEditor.GraphMerge.$Ae.get_$4=function(){Diag.$Q.get_$4().$1k(5002526,1,3,"FootnoteEndnoteNodeComplexMerge: Got Instance");return WordEditor.GraphMerge.$Ae.$T.get_$Q()};WordEditor.GraphMerge.$Ae.prototype={get_$29W:function(){return 3},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$Wn),1);return a},$66b:function(a,b){var c=a.$Eh,i=c,d=a.$Ox;if(b===Common.$i.$2L(Box4.AppProperties.$1.$Wn)){var g=-1,e=g;Diag.$Q.get_$4().$1k(5002527,1,3,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",c.get_$E(),c.get_$48(),b);var f=d.$1DY(a.$7e.get_$Q().$5m,Box4.AppProperties.$1.$Wn),h=d.$1DY(a.$Fi.get_$Q().$5m,Box4.AppProperties.$1.$Wn);if(f!=null&&f!==g)e=f;else if(h!=null)e=h;d.$36Y(i,Box4.AppProperties.$1.$Wn,e);a.$AD.$F(b);return true}Diag.$Q.get_$4().$1k(5002528,1,3,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$KL.get_$E(),b);return false}};WordEditor.GraphMerge.$aU=function(a,b){this.$$d_$4Pw=Function.createDelegate(this,this.$4Pw);this.$$d_$61j=Function.createDelegate(this,this.$61j);this.$AI=a||new Box4.$Ai;this.$bj=b||this.$2uE()};WordEditor.GraphMerge.$aU.prototype={$bj:null,$AI:null,$2uE:function(){return[this.$$d_$61j,this.$$d_$4Pw]},$5z9:function(e,f,g,b,c,d){var h=this,i=this,j=this,a=new WordEditor.GraphMerge.$aT(e,g,new($$sc.$x.$$(WordEditor.GraphMerge.$CT))(function(){return new WordEditor.GraphMerge.$CT(b.$8S,c)}),new($$sc.$x.$$(WordEditor.GraphMerge.$CT))(function(){return new WordEditor.GraphMerge.$CT(b.$8S,d)}),new($$sc.$x.$$(WordEditor.GraphMerge.$CT))(function(){return new WordEditor.GraphMerge.$CT(d,c)}),f.$3LV(c));a.$AD=b.$3bh();a.$2KT=new(Common.Collections.$1E.$$(Number))(null);return a},$XK:function(f,g,h,i,j,k,c){for(var a=this.$5z9(f,g,h,i,j,k),d=true,b=0;b<this.$bj.length&&d;b++){var e=this.$bj[b];d=e(a)}c.val=a.$1T1&&a.$Eh?new WordEditor.GraphMerge.$7m(a.$Eh,false):null;c.val&&c.val.$5yq(a.$AD);return a.$1T1},$61j:function(a){var b=a.$2En.get_$2KW();if(!a.$Fi.get_$Q().$1lv(b)||!a.$2mO.get_$Q().$1lv(b)){a.$1T1=true;return false}if(!a.$7e.get_$Q().$1lv(b)){var c=a.$Fi.get_$Q().$5m;a.$1T1=true;a.$Eh=c.$OS();return false}return true},$4Pw:function(a){var b=a.$Fi.get_$Q().$5m;a.$1GF&&Diag.$Q.get_$4().$1k(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.get_$E(),b.get_$48());var c=a.$2En.$66c(a);a.$1T1=c;Diag.$Q.get_$4().$1k(4018184,1,c?4:3,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",c?"Succeeded":"Failed",b.get_$E(),b.get_$48(),!!a.$Eh);return c}};WordEditor.GraphMerge.$4R=function(a){this.$$d_$66d=Function.createDelegate(this,this.$66d);this.$$d_$4Op=Function.createDelegate(this,this.$4Op);this.$$d_$66k=Function.createDelegate(this,this.$66k);this.$bj=a||this.$2uE()};WordEditor.GraphMerge.$4R.$Bo=function(){return new WordEditor.GraphMerge.$4R(null)};WordEditor.GraphMerge.$4R.get_$4=function(){return WordEditor.GraphMerge.$4R.$T.get_$Q()};WordEditor.GraphMerge.$4R.$1g7=function(d,b,c,a){if(!b.$4V(a)){c.$F(a);b.$F(a)}};WordEditor.GraphMerge.$4R.$1QX=function(b,c,d){var a=new(Common.Collections.$1E.$$(b))(null);c.$2m(function(b){d(b)&&a.$F(b);return true});return a};WordEditor.GraphMerge.$4R.$57W=function(){return[Common.$i.$2L(Box4.AppProperties.$5.$2p1),Common.$i.$2L(Box4.AppProperties.$5.$13f),Common.$i.$2L(Box4.AppProperties.$5.$I2),Common.$i.$2L(Box4.AppProperties.$5.$1VM),Common.$i.$2L(Box4.AppProperties.$5.$2LJ),Common.$i.$2L(Box4.AppProperties.$N.$1nk),Common.$i.$2L(Box4.AppProperties.$1.$2mL),Common.$i.$2L(Box4.AppProperties.$1.$1QD),Common.$i.$2L(Box4.AppProperties.$1B.$Xc)]};WordEditor.GraphMerge.$4R.prototype={$bj:null,$2uE:function(){return[this.$$d_$66k,this.$$d_$4Op,this.$$d_$66d]},get_$29W:function(){return 5},$2f4:null,get_$2KW:function(){return this.$2f4||(this.$2f4=new WordEditor.GraphMerge.$f1(this.$MA(),this.get_$29W()))},$66b:function(b){var a=b.$7e.get_$Q().$5m;Diag.$Q.get_$4().$1k(4016352,1,3,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",a.get_$E(),a.get_$48());return false},$66c:function(c){var a=c.$7e.get_$Q();Diag.$Q.get_$4().$1k(4016353,1,4,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",a.$5m.get_$E(),a.$5m.get_$48());for(var b=0;b<this.$bj.length;b++){var d=this.$bj[b];if(!d(c)){Diag.$Q.get_$4().$1k(4016354,1,3,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",a.$5m.get_$E(),a.$5m.get_$48(),b);this.$5S4(c);c.$Eh=null;return false}}Diag.$Q.get_$4().$1k(4016355,1,4,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",a.$5m.get_$E(),a.$5m.get_$48());return true},$5S4:function(a){if(a.$2P6)return;a.$2P6=true;var b=a.$f2.$2M.$Wp,c=a.$Ox;WordEditor.GraphMerge.$7Z.$oi(b,a.$7e.get_$Q().$KL,"Base",c,1);WordEditor.GraphMerge.$7Z.$oi(b,a.$7e.get_$Q().$5m,"Favored",c,1);WordEditor.GraphMerge.$7Z.$oi(b,a.$Fi.get_$Q().$5m,"Conflict",c,1)},$66k:function(b){var a=b.$7e.get_$Q(),d=this.get_$2KW();if(!a.get_$UR())return true;var c=true,e=this;a.get_$vl().$2m(function(e,g){if(!g.get_$UR()||b.$AD.$4V(e))return true;var f=d.get_$5(e);if(f===5){var h=a.$KL.get_$48();Diag.$Q.get_$4().$1k(4018176,1,3,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",h,e,f);c=false;return false}f===6&&b.$2KT.$F(e);return true});return c},$4Op:function(a){var c=a.$7e.get_$Q();a.$Eh=c.$5m.$OS();var b=a.$2KT,d=a.$Eh;if(b){var e=this;b.$2m(function(a){d.$4z(Common.$i.$1Qh(a));return true})}return true},$66d:function(b){var c=b.$Fi.get_$Q(),e=c.$KL.get_$48(),f=this.get_$2KW(),a=true,d=this;c.get_$vl().$2m(function(c,h){var g=f.get_$5(c);a=d.$66e(b,h,c,g);if(!a){b.$Eh=null;Diag.$Q.get_$4().$1k(4018177,1,3,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",e,c,g)}return a});return a},$66e:function(c,e,b,a){var h=c.$Eh;if(!e.get_$UR())return true;if(a===2||a===7||c.$AD.$4V(b))return true;if(a===5)return false;if(a===4||a===3){var d,i=c.$7e.get_$Q(),f,g;if(g=i.get_$vl().$9F(b,f={val:d}),d=f.val,g)if(d.get_$UR())return a!==4;a=0}if(!a){if(!e.get_$1Sg()){h.$1Vz(Common.$i.$1Qh(b),e.$q8);return true}a=6}if(a===6){h.$4z(Common.$i.$1Qh(b));return true}return a===1?this.$66b(c,b):false},$5U4:function(d,h,e,f,l,k){h=h||new(Common.Collections.$1E.$$(d))(null);e=e||new(Common.Collections.$1E.$$(d))(null);f=f||new(Common.Collections.$1E.$$(d))(null);for(var a=h.$pV(),i=new(Common.Collections.$4y.$$(d)),b=a.get_$N(),g=b;g<e.get_$N();g++){var j=e.$4W(g);a.$F(j);i.$F(j)}for(;b<f.get_$N();b++){var c=f.$4W(b);if(!i.$4V(c)){a.$F(c);k(c)}else Diag.$Q.get_$4().$1k(4018180,1,4,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",c)}return a},$3ia:function(a,k,f,g){k=k||new(Common.Collections.$1E.$$(a))(null);f=f||new(Common.Collections.$1E.$$(a))(null);g=g||new(Common.Collections.$1E.$$(a))(null);for(var e=new(Common.Collections.$1E.$$(a))(null),h=new(Common.Collections.$2d.$$(a,Number)),i=new(Common.Collections.$4y.$$(a)),j=0;j<k.get_$N();j++){var r=k.$4W(j);h.set_$5(r,j)}var b=0,c=0,d=-1;while(b<f.get_$N()&&c<g.get_$N()){var l=f.$4W(b),o=g.$4W(c),m=h.$uX(l,d),n=h.$uX(o,d);if(m===d){WordEditor.GraphMerge.$4R.$1g7(a,i,e,l);b++}else if(n===d){WordEditor.GraphMerge.$4R.$1g7(a,i,e,o);c++}else if(m===n){WordEditor.GraphMerge.$4R.$1g7(a,i,e,l);b++;c++}else if(m<n)b++;else c++}for(;b<f.get_$N();b++){var p=f.$4W(b),s=h.$uX(p,d);s===d&&WordEditor.GraphMerge.$4R.$1g7(a,i,e,p)}for(;c<g.get_$N();c++){var q=g.$4W(c),t=h.$uX(q,d);t===d&&WordEditor.GraphMerge.$4R.$1g7(a,i,e,q)}return e},$5U5:function(b,c,d,e){c=c||new(Common.Collections.$1E.$$(b))(null);d=d||new(Common.Collections.$1E.$$(b))(null);e=e||new(Common.Collections.$1E.$$(b))(null);var f=c.$k7(),g=d.$k7(),h=e.$k7(),i=this,a=WordEditor.GraphMerge.$4R.$1QX(b,c,function(a){return g.$4V(a)&&h.$4V(a)}),l=a.$k7(),j=this;a.$SO(a.get_$N(),WordEditor.GraphMerge.$4R.$1QX(b,d,function(a){return!f.$4V(a)}));var k=this;a.$SO(a.get_$N(),WordEditor.GraphMerge.$4R.$1QX(b,e,function(a){return!f.$4V(a)&&!g.$4V(a)}));return a},$1hS:function(b,c,a){if(b.$v(a))c.$1Vz(a,b.$ix(a));else c.$4z(a)},$5od:function(g,c){for(var j=c.$LK(),d=j,h=d.length,a=0;a<h;++a){var l=d[a];c.$4z(l)}for(var k=g.$LK(),e=k,i=e.length,b=0;b<i;++b){var f=e[b];c.$1Vz(f,g.$ix(f))}},$3gy:function(e,g,h,f,d){var b=e.$1DY(g,d),c=e.$1DY(h,d),a;if(b!=null&&c!=null)a=Math.max(b,c);else if(c!=null)a=c;else if(b!=null)a=b;else a=null;if(a!=null)e.$36Y(f,d,a);else f.$4z(d)},$3Iq:function(l,a,g,h,i,b,d,j,k){var e=a(g,b),f=a(h,b);d.val=a(i,b);var c=e.$k7();j.val=c.$3KO(f);k.val=c.$3KO(d.val)},$MA:function(){for(var b=WordEditor.GraphMerge.$4R.$3D8.get_$Q(),c=new(Common.Collections.$2d.$$(Number,WordEditor.GraphMerge.$f2)),a=0;a<b.length;a++)c.set_$5(b[a],7);return c}};WordEditor.GraphMerge.$Qq=function(){};WordEditor.GraphMerge.$Qq.prototype={$3LV:function(a){switch(a.get_$48()){case 131073:var b=a;if(b.$v(Box4.AppProperties.$1.$ud))return WordEditor.GraphMerge.$8x.get_$4();break;case 1074135140:return WordEditor.GraphMerge.$AM.get_$4();case 1074135137:return WordEditor.GraphMerge.$AN.get_$4();case 1074135139:return WordEditor.GraphMerge.$AO.get_$4();case 1074135138:return WordEditor.GraphMerge.$AP.get_$4();case 1074135136:return WordEditor.GraphMerge.$AQ.get_$4();case 1074135126:return WordEditor.GraphMerge.$AW.get_$4();case 1074135127:return WordEditor.GraphMerge.$AX.get_$4();case 1074135124:return WordEditor.GraphMerge.$Ad.get_$4();case 1074135125:return WordEditor.GraphMerge.$Ae.get_$4();case 1074135122:return WordEditor.GraphMerge.$Af.get_$4();case 393233:return WordEditor.GraphMerge.$8x.get_$4();case 393234:return WordEditor.GraphMerge.$Aj.get_$4();case 393229:return WordEditor.GraphMerge.$Ak.get_$4();case 393241:return WordEditor.GraphMerge.$Al.get_$4();case 393227:return WordEditor.GraphMerge.$An.get_$4();case 393271:return WordEditor.GraphMerge.$Ao.get_$4();case 393230:return WordEditor.GraphMerge.$8a.get_$4();case 131140:return WordEditor.GraphMerge.$As.get_$4();case 1179649:return WordEditor.GraphMerge.$Ax.get_$4();case 393252:return WordEditor.GraphMerge.$B1.get_$4();case 393250:return WordEditor.GraphMerge.$8h.get_$4();case 393251:return WordEditor.GraphMerge.$B2.get_$4();case 4325465:return WordEditor.GraphMerge.$B5.get_$4();case 1073872968:return WordEditor.GraphMerge.$B8.get_$4()}return WordEditor.GraphMerge.$4R.get_$4()}};WordEditor.GraphMerge.$aT=function(a,b,c,d,e,f){this.$1GF=a.$2M.$1GF;this.$f2=a;this.$Ox=b;this.$7e=c;this.$Fi=d;this.$2mO=e;this.$2En=f};WordEditor.GraphMerge.$aT.prototype={$1GF:false,$Ox:null,$f2:null,$7e:null,$Fi:null,$2mO:null,$2En:null,$AD:null,$2KT:null,$2P6:false,$1T1:false,$Eh:null};WordEditor.GraphMerge.$Af=function(){WordEditor.GraphMerge.$Af.initializeBase(this,[null])};WordEditor.GraphMerge.$Af.$Bo=function(){return new WordEditor.GraphMerge.$Af};WordEditor.GraphMerge.$Af.get_$4=function(){return WordEditor.GraphMerge.$Af.$T.get_$Q()};WordEditor.GraphMerge.$Af.prototype={get_$29W:function(){return 3},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$jr),4);return a}};WordEditor.GraphMerge.$8x=function(){WordEditor.GraphMerge.$8x.initializeBase(this,[null])};WordEditor.GraphMerge.$8x.$Bo=function(){return new WordEditor.GraphMerge.$8x};WordEditor.GraphMerge.$8x.get_$4=function(){return WordEditor.GraphMerge.$8x.$T.get_$Q()};WordEditor.GraphMerge.$8x.prototype={get_$29W:function(){return 3},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$2LO),5);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$3v),5);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$oN),5);a.set_$5(Common.$i.$2L(Box4.AppProperties.$N.$j6),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$oM),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$135),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$1Uq),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$N.$1X7),1);return a},$66b:function(a,b){if(b===Common.$i.$2L(Box4.AppProperties.$5.$oM)||b===Common.$i.$2L(Box4.AppProperties.$1.$135)||b===Common.$i.$2L(Box4.AppProperties.$5.$1Uq)||b===Common.$i.$2L(Box4.AppProperties.$N.$j6)||b===Common.$i.$2L(Box4.AppProperties.$N.$1X7)){var e=a.$Eh,h=a.$Ox;Diag.$Q.get_$4().$1k(4018185,1,3,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",e.get_$E(),e.get_$48(),b);var f=h.$1DY(a.$7e.get_$Q().$5m,Box4.AppProperties.$N.$j6),g=h.$1DY(a.$Fi.get_$Q().$5m,Box4.AppProperties.$N.$j6);if(f!=null&&(!f||f===2))return true;if(g!=null&&(!g||g===2)){var c=a.$Fi.get_$Q().$5m,d=e;this.$1hS(c,d,Box4.AppProperties.$5.$oM);this.$1hS(c,d,Box4.AppProperties.$1.$135);this.$1hS(c,d,Box4.AppProperties.$5.$1Uq);this.$1hS(c,d,Box4.AppProperties.$N.$j6);this.$1hS(c,d,Box4.AppProperties.$N.$1X7);a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$oM));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$135));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$1Uq));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$N.$j6));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$N.$1X7));return true}}Diag.$Q.get_$4().$1k(4018186,1,3,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$KL.get_$E(),b);return false}};WordEditor.GraphMerge.$Aj=function(){WordEditor.GraphMerge.$Aj.initializeBase(this,[null])};WordEditor.GraphMerge.$Aj.$Bo=function(){return new WordEditor.GraphMerge.$Aj};WordEditor.GraphMerge.$Aj.get_$4=function(){return WordEditor.GraphMerge.$Aj.$T.get_$Q()};WordEditor.GraphMerge.$Aj.prototype={get_$29W:function(){return 3}};WordEditor.GraphMerge.$Ak=function(){WordEditor.GraphMerge.$Ak.initializeBase(this,[null])};WordEditor.GraphMerge.$Ak.$Bo=function(){return new WordEditor.GraphMerge.$Ak};WordEditor.GraphMerge.$Ak.get_$4=function(){return WordEditor.GraphMerge.$Ak.$T.get_$Q()};WordEditor.GraphMerge.$Ak.prototype={get_$29W:function(){return 0},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$10p),1);return a},$66b:function(a,b){var c=a.$Eh,d=c,e=a.$Ox;if(b===Common.$i.$2L(Box4.AppProperties.$1.$10p)){this.$3gy(e,a.$7e.get_$Q().$5m,a.$Fi.get_$Q().$5m,d,Box4.AppProperties.$1.$10p);a.$AD.$F(b);return true}Diag.$Q.get_$4().$1k(4207940,1,3,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$KL.get_$E(),b);return false}};WordEditor.GraphMerge.$Al=function(){WordEditor.GraphMerge.$Al.initializeBase(this,[null])};WordEditor.GraphMerge.$Al.$Bo=function(){return new WordEditor.GraphMerge.$Al};WordEditor.GraphMerge.$Al.get_$4=function(){return WordEditor.GraphMerge.$Al.$T.get_$Q()};WordEditor.GraphMerge.$Al.prototype={$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$10p),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$tR),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1B.$iU),1);return a},$66b:function(a,c){var i=a.$Eh,d=i,b=a.$Ox;if(c===Common.$i.$2L(Box4.AppProperties.$1.$10p)){this.$3gy(b,a.$7e.get_$Q().$5m,a.$Fi.get_$Q().$5m,d,Box4.AppProperties.$1.$10p);a.$AD.$F(c);return true}if(c===Common.$i.$2L(Box4.AppProperties.$1.$tR)){var e=b.$2E4(a.$7e.get_$Q().$5m,Box4.AppProperties.$1.$tR),f=b.$2E4(a.$Fi.get_$Q().$5m,Box4.AppProperties.$1.$tR),j=e==null?false:e&&f==null?false:f;b.$3wI(d,Box4.AppProperties.$1.$tR,j);a.$AD.$F(c);return true}if(c===Common.$i.$2L(Box4.AppProperties.$1B.$iU)){var g=b.$2E4(a.$7e.get_$Q().$5m,Box4.AppProperties.$1B.$iU),h=b.$2E4(a.$Fi.get_$Q().$5m,Box4.AppProperties.$1B.$iU),k=g==null?true:g||h==null?true:h;b.$3wI(d,Box4.AppProperties.$1B.$iU,k);a.$AD.$F(c);return true}Diag.$Q.get_$4().$1k(4057305,1,3,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$KL.get_$E(),c);return false}};WordEditor.GraphMerge.$An=function(){WordEditor.GraphMerge.$An.initializeBase(this,[null])};WordEditor.GraphMerge.$An.$Bo=function(){return new WordEditor.GraphMerge.$An};WordEditor.GraphMerge.$An.get_$4=function(){return WordEditor.GraphMerge.$An.$T.get_$Q()};WordEditor.GraphMerge.$An.prototype={get_$29W:function(){return 2},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$1lA),3);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$H6),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$Iv),1);return a},$66b:function(a,k){if(k===Common.$i.$2L(Box4.AppProperties.$1.$H6)||k===Common.$i.$2L(Box4.AppProperties.$1.$Iv)){var h=a.$Ox,i,b,c,f=h,l,m,n;this.$3Iq(Number,f.$$d_$2E5||(f.$$d_$2E5=Function.createDelegate(f,f.$2E5)),a.$7e.get_$Q().$KL,a.$7e.get_$Q().$5m,a.$Fi.get_$Q().$5m,Box4.AppProperties.$1.$H6,l={val:i},m={val:b},n={val:c}),i=l.val,b=m.val,c=n.val;if(!c&&!b){Diag.$Q.get_$4().$1k(4318873,1,3,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),Common.$i.$2L(Box4.AppProperties.$1.$H6));return true}var j,d,e,g=h,o,p,q;this.$3Iq(Common.$C,g.$$d_$8E||(g.$$d_$8E=Function.createDelegate(g,g.$8E)),a.$7e.get_$Q().$KL,a.$7e.get_$Q().$5m,a.$Fi.get_$Q().$5m,Box4.AppProperties.$1.$Iv,o={val:j},p={val:d},q={val:e}),j=o.val,d=p.val,e=q.val;if(!d&&!e){Diag.$Q.get_$4().$1k(4318874,1,3,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),Common.$i.$2L(Box4.AppProperties.$1.$Iv));return true}var s=b&&!c,r=d&&!e;if(s!==r){Diag.$Q.get_$4().$1k(4318875,1,3,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",a.$7e.get_$Q().$5m.get_$E(),Common.$i.$2L(Box4.AppProperties.$1.$H6),Common.$i.$2L(Box4.AppProperties.$1.$Iv));return false}if(r){h.$Sz(a.$Eh,Box4.AppProperties.$1.$Iv,j);h.$2Ma(a.$Eh,Box4.AppProperties.$1.$H6,i)}Diag.$Q.get_$4().$1k(4318877,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",a.$7e.get_$Q().$5m.get_$E(),Common.$i.$2L(Box4.AppProperties.$1.$H6),b,c,Common.$i.$2L(Box4.AppProperties.$1.$Iv),d,e);a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$Iv));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$H6));return true}Diag.$Q.get_$4().$1k(4318878,1,3,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),k);return false}};WordEditor.GraphMerge.$Ao=function(){WordEditor.GraphMerge.$Ao.initializeBase(this,[null])};WordEditor.GraphMerge.$Ao.$Bo=function(){return new WordEditor.GraphMerge.$Ao};WordEditor.GraphMerge.$Ao.get_$4=function(){return WordEditor.GraphMerge.$Ao.$T.get_$Q()};WordEditor.GraphMerge.$Ao.prototype={$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$fV),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$DD),2);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$DE),2);return a},$66b:function(a,d){if(d===Common.$i.$2L(Box4.AppProperties.$1.$fV)){var b=a.$Ox,e=b.$8E(a.$7e.get_$Q().$KL,Box4.AppProperties.$1.$fV),f=b.$8E(a.$7e.get_$Q().$5m,Box4.AppProperties.$1.$fV),g=b.$8E(a.$Fi.get_$Q().$5m,Box4.AppProperties.$1.$fV),h=this,i=this,c=this.$5U4(Common.$C,e,f,g,function(a,b){return a.$w(b)},function(e){var b,f=a.$f2.$2M,c,d;if(d=f.$J4.$9F(e,c={val:b}),b=c.val,d)a.$f2.$2M.$Jx.set_$5(e,new WordEditor.GraphMerge.$7m(b,false));else Diag.$Q.get_$4().$m(4034653,1,false,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")});if(c.get_$N()>0){b.$Sz(a.$Eh,Box4.AppProperties.$1.$fV,c);a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$fV));return true}}Diag.$Q.get_$4().$1k(4018187,1,3,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),d);return false}};WordEditor.GraphMerge.$8a=function(){WordEditor.GraphMerge.$8a.initializeBase(this,[null])};WordEditor.GraphMerge.$8a.$Bo=function(){return new WordEditor.GraphMerge.$8a};WordEditor.GraphMerge.$8a.get_$4=function(){return WordEditor.GraphMerge.$8a.$T.get_$Q()};WordEditor.GraphMerge.$8a.$410=function(b,c,d,e,f){var a=new WordEditor.GraphMerge.$6v(b,c,d,e,null);return a.$39N(f)};WordEditor.GraphMerge.$8a.prototype={get_$29W:function(){return 0},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$9O),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$bB),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$fh),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$jW),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$Ei),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$Dw),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$3v),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$fc),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$ao),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1B.$QU),6);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1B.$pn),6);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$289),7);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1B.$QU),6);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$37O),2);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1B.$2mS),2);return a},$66b:function(a,b){if(b===Common.$i.$2L(Box4.AppProperties.$5.$9O)||b===Common.$i.$2L(Box4.AppProperties.$5.$bB)||b===Common.$i.$2L(Box4.AppProperties.$5.$fh)||b===Common.$i.$2L(Box4.AppProperties.$1.$jW)||b===Common.$i.$2L(Box4.AppProperties.$1.$Ei)||b===Common.$i.$2L(Box4.AppProperties.$1.$Dw)||b===Common.$i.$2L(Box4.AppProperties.$1.$3v)||b===Common.$i.$2L(Box4.AppProperties.$5.$fc)||b===Common.$i.$2L(Box4.AppProperties.$5.$ao)){var i=a.$Fi.get_$Q().$KL,j=a.$Fi.get_$Q().$5m,k=a.$7e.get_$Q().$5m,f=new(Common.Collections.$1E.$$(Box4.$5r))(null);f.$F(i);var g=new(Common.Collections.$1E.$$(Box4.$5r))(null);g.$F(j);var h=new(Common.Collections.$1E.$$(Box4.$5r))(null);h.$F(k);var c,d,e;if(!(e=WordEditor.GraphMerge.$8a.$410(a.$f2,f,h,g,d={val:c}),c=d.val,e)){a.$2P6=true;a.$Eh=null;return false}a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$9O));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$bB));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$fh));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$Ei));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$jW));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$Dw));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$3v));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$fc));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$ao));a.$Eh=c.$4W(0).$8S;return true}return false}};WordEditor.GraphMerge.$f1=function(a,b){this.$2XP=a;this.$29W=b};WordEditor.GraphMerge.$f1.prototype={$2XP:null,$29W:0,get_$5:function(a){return this.$2XP.$uX(a,this.$29W)}};WordEditor.GraphMerge.$As=function(){WordEditor.GraphMerge.$As.initializeBase(this,[null])};WordEditor.GraphMerge.$As.$Bo=function(){return new WordEditor.GraphMerge.$As};WordEditor.GraphMerge.$As.get_$4=function(){return WordEditor.GraphMerge.$As.$T.get_$Q()};WordEditor.GraphMerge.$As.prototype={get_$29W:function(){return 0}};WordEditor.GraphMerge.$Ax=function(){WordEditor.GraphMerge.$Ax.initializeBase(this,[null])};WordEditor.GraphMerge.$Ax.$Bo=function(){return new WordEditor.GraphMerge.$Ax};WordEditor.GraphMerge.$Ax.get_$4=function(){return WordEditor.GraphMerge.$Ax.$T.get_$Q()};WordEditor.GraphMerge.$Ax.prototype={$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$1TA),7);return a}};WordEditor.GraphMerge.$B1=function(){WordEditor.GraphMerge.$B1.initializeBase(this,[null])};WordEditor.GraphMerge.$B1.$Bo=function(){return new WordEditor.GraphMerge.$B1};WordEditor.GraphMerge.$B1.get_$4=function(){return WordEditor.GraphMerge.$B1.$T.get_$Q()};WordEditor.GraphMerge.$B1.prototype={get_$29W:function(){return 0},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$6r),4);return a}};WordEditor.GraphMerge.$8h=function(){WordEditor.GraphMerge.$8h.initializeBase(this,[null])};WordEditor.GraphMerge.$8h.$Bo=function(){return new WordEditor.GraphMerge.$8h};WordEditor.GraphMerge.$8h.get_$4=function(){return WordEditor.GraphMerge.$8h.$T.get_$Q()};WordEditor.GraphMerge.$8h.$3Nt=function(d,e,f){if(d.get_$UR()){var a,b,c;c=e.get_$vl().$9F(Common.$i.$2L(Box4.AppProperties.$5.$6r),b={val:a}),a=b.val,c;if(a.get_$UR()){Diag.$Q.get_$4().$1k(4273305,1,3,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",f);return true}}return false};WordEditor.GraphMerge.$8h.prototype={get_$29W:function(){return 0},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$6r),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$Xl),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$ff),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$1WT),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$1WW),1);return a},$66b:function(a,b){if(b===Common.$i.$2L(Box4.AppProperties.$5.$6r)||b===Common.$i.$2L(Box4.AppProperties.$5.$Xl)||b===Common.$i.$2L(Box4.AppProperties.$1.$1WT)||b===Common.$i.$2L(Box4.AppProperties.$1.$1WW)||b===Common.$i.$2L(Box4.AppProperties.$5.$ff)){var d=a.$Eh,c=a.$Ox;Diag.$Q.get_$4().$1k(4273303,1,3,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",d.get_$E(),d.get_$48(),b);if(this.$4nv(a))return false;var g=c.$8E(a.$7e.get_$Q().$KL,Box4.AppProperties.$5.$6r),h=c.$8E(a.$7e.get_$Q().$5m,Box4.AppProperties.$5.$6r),i=c.$8E(a.$Fi.get_$Q().$5m,Box4.AppProperties.$5.$6r),j=this,e=this.$3ia(Common.$C,g,h,i,function(a,b){return a.$w(b)});if(e.get_$N()>0){var f=d;c.$Sz(f,Box4.AppProperties.$5.$6r,e);c.$36Y(f,Box4.AppProperties.$5.$ff,e.get_$N());a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$6r));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$Xl));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$5.$ff));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$1WT));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$1WW));return true}}Diag.$Q.get_$4().$1k(4018189,1,3,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$5m.get_$E(),b);return false},$4nv:function(i){var g=i.$Fi.get_$Q(),h=i.$7e.get_$Q(),a,b,c,d;d=g.get_$vl().$9F(Common.$i.$2L(Box4.AppProperties.$5.$Xl),c={val:a}),a=c.val,d;var e,f;f=h.get_$vl().$9F(Common.$i.$2L(Box4.AppProperties.$5.$Xl),e={val:b}),b=e.val,f;if(!a.get_$UR()&&!b.get_$UR())return false;if(a.get_$UR()&&b.get_$UR()){Diag.$Q.get_$4().$1k(4273304,1,3,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",a.$1Hn,b.$q8,a.$q8);return true}return WordEditor.GraphMerge.$8h.$3Nt(a,h,"BaseConflict")?true:WordEditor.GraphMerge.$8h.$3Nt(b,g,"BaseFavored")?true:false}};WordEditor.GraphMerge.$B2=function(){WordEditor.GraphMerge.$B2.initializeBase(this,[null])};WordEditor.GraphMerge.$B2.$Bo=function(){return new WordEditor.GraphMerge.$B2};WordEditor.GraphMerge.$B2.get_$4=function(){return WordEditor.GraphMerge.$B2.$T.get_$Q()};WordEditor.GraphMerge.$B2.prototype={get_$29W:function(){return 0},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$3v),3);a.set_$5(Common.$i.$2L(Box4.AppProperties.$5.$6r),4);return a}};WordEditor.GraphMerge.$B5=function(){WordEditor.GraphMerge.$B5.initializeBase(this,[null])};WordEditor.GraphMerge.$B5.$Bo=function(){return new WordEditor.GraphMerge.$B5};WordEditor.GraphMerge.$B5.get_$4=function(){return WordEditor.GraphMerge.$B5.$T.get_$Q()};WordEditor.GraphMerge.$B5.prototype={get_$29W:function(){return 0},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$Nh),1);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$VE),1);return a},$66b:function(a,b){var c=a.$Ox;if(b===Common.$i.$2L(Box4.AppProperties.$1.$VE)||b===Common.$i.$2L(Box4.AppProperties.$1.$Nh)){var d=a.$f2;c.$1pq(a.$Eh,Box4.AppProperties.$1.$VE,d.$DO.$Na.$5w().get_$E().toString());c.$Sz(a.$Eh,Box4.AppProperties.$1.$Nh,new(Common.Collections.$1E.$$(Common.$C))(null));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$VE));a.$AD.$F(Common.$i.$2L(Box4.AppProperties.$1.$Nh));return true}Diag.$Q.get_$4().$1k(17162315,1,3,"UpdateHintsContainerNodeComplexMerge: Failed to merge UpdateHintsContainerNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",a.$7e.get_$Q().$KL.get_$E(),b);return false}};WordEditor.GraphMerge.$B8=function(){WordEditor.GraphMerge.$B8.initializeBase(this,[null])};WordEditor.GraphMerge.$B8.$Bo=function(){return new WordEditor.GraphMerge.$B8};WordEditor.GraphMerge.$B8.get_$4=function(){return WordEditor.GraphMerge.$B8.$T.get_$Q()};WordEditor.GraphMerge.$B8.prototype={get_$29W:function(){return 0},$MA:function(){var a=WordEditor.GraphMerge.$4R.prototype.$MA.call(this);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$2oJ),3);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$3v),3);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$30T),5);a.set_$5(Common.$i.$2L(Box4.AppProperties.$1.$jr),5);return a}};WordEditor.GraphMerge.$E6=function(a,b){this.$i6=a;this.$39a=b};WordEditor.GraphMerge.$E6.prototype={$i6:0,$39a:null};WordEditor.GraphMerge.$AU=function(a,b,c,d,e){this.$$d_$5fL=Function.createDelegate(this,this.$5fL);this.$$d_$5FC=Function.createDelegate(this,this.$5FC);this.$$d_$5gj=Function.createDelegate(this,this.$5gj);this.$$d_$5dk=Function.createDelegate(this,this.$5dk);this.$$d_$6B0=Function.createDelegate(this,this.$6B0);this.$$d_$5e2=Function.createDelegate(this,this.$5e2);this.$AI=a||new Box4.$Ai;this.$2SU=b||WordEditor.GraphMerge.$8a.$410;this.$1Hm=c||this.$59a();this.$TF=d||new WordEditor.GraphMerge.$XA;this.$1st=e||this.$58s()};WordEditor.GraphMerge.$AU.$3nt=function(a,b){!b.$30(a.get_$48())&&b.set_$5(a.get_$48(),new(Common.Collections.$1E.$$(Box4.$5r))(null));b.get_$5(a.get_$48()).$F(a);return true};WordEditor.GraphMerge.$AU.$4si=function(d,e,f){var a=new(Common.Collections.$1E.$$(Common.$C))(null),b=e.$k7(),c=f.$k7();d.$2m(function(d){b.$4V(d)&&c.$4V(d)&&a.$F(d);return true});return a};WordEditor.GraphMerge.$AU.prototype={$AI:null,$2SU:null,$1Hm:null,$1st:null,$TF:null,$59a:function(){return[new WordEditor.GraphMerge.$E6(393227,this.$$d_$5e2),new WordEditor.GraphMerge.$E6(1073872968,this.$$d_$6B0),new WordEditor.GraphMerge.$E6(393241,this.$$d_$5dk),new WordEditor.GraphMerge.$E6(393252,this.$$d_$5dk),new WordEditor.GraphMerge.$E6(1074135125,this.$$d_$5dk),new WordEditor.GraphMerge.$E6(1074135123,this.$$d_$5dk),new WordEditor.GraphMerge.$E6(1074135127,this.$$d_$5dk)]},$58s:function(){return[this.$$d_$5gj,this.$$d_$5FC,this.$$d_$5fL]},$5Tz:function(d){for(var a=0,b=true;a<this.$1st.length&&b;a++){var c=this.$1st[a];b=c(d)}!b&&Diag.$Q.get_$4().$1k(4273296,1,3,"MergeChildNodeLists: Merged failed. [Function: {0}]",a);return b},$5gj:function(a){var c=new(Common.Collections.$2d.$$(Box4.ClassIds.$Ki,Common.Collections.$CO.$$(Box4.$5r))),d=new(Common.Collections.$2d.$$(Box4.ClassIds.$Ki,Common.Collections.$CO.$$(Box4.$5r))),f=new(Common.Collections.$4y.$$(Common.$C)),g=this;a.$2M.$Kt.$2m(function(b,a){return WordEditor.GraphMerge.$AU.$3nt(a,c)});var h=this;a.$2M.$J4.$2m(function(b,a){return WordEditor.GraphMerge.$AU.$3nt(a,d)});for(var e=0;e<this.$1Hm.length;e++){var b=this.$1Hm[e].$i6;a.$2M.$vU.set_$5(b,new(Common.Collections.$2d.$$(Common.$C,WordEditor.GraphMerge.$JM)));if(c.$30(b)){var i=this;c.get_$5(b).$2m(function(c){var d=a.$2M.$EJ.get_$5(c.get_$E());if(d){var e=new WordEditor.GraphMerge.$JM(d,c,a.$2M.$J4.$uX(c.get_$E(),d));a.$2M.$vU.get_$5(b).$F(c.get_$E(),e);f.$F(c.get_$E())}return true})}if(d.$30(b)){var j=this;d.get_$5(b).$2m(function(c){if(f.$4V(c.get_$E()))return true;var d=a.$2M.$EJ.get_$5(c.get_$E());d&&a.$2M.$vU.get_$5(b).$F(c.get_$E(),new WordEditor.GraphMerge.$JM(d,d,c));return true})}}a.$2M.$Qm("PrepareObjectGroupings");return true},$5fL:function(c){for(var a=true,b=0;a&&b<this.$1Hm.length;b++){var d=this.$1Hm[b],e=d.$i6,f=this;c.$2M.$vU.get_$5(e).$2m(function(f,b){if(!c.$2M.$115.$4V(b.$Ia.get_$E()))a=!!(a&d.$39a(c,b));!a&&Diag.$Q.get_$4().$1k(4273297,1,3,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",e,b.$Ia.get_$E());return a});c.$2M.$Qm("PerformThreewayChildMerge"+b)}return a},$5e2:function(b,a){if(a.$2KV(Box4.AppProperties.$5.$6r)){Diag.$Q.get_$4().$1k(4030551,1,3,"Punting attempted merge as there appears to be an added or removed WordSection.");return false}return true},$6B0:function(g,e){if(e.$2KV(Box4.AppProperties.$5.$6r)){var l=new(Common.Collections.$4y.$$(Common.$C)),m=new(Common.Collections.$4y.$$(Common.$C)),h=new(Common.Collections.$4y.$$(Common.$C)),i=new(Common.Collections.$4y.$$(Common.$C)),f=this.$AI.$8E(e.$Ia,Box4.AppProperties.$5.$6r),n=f.$k7();if(!(this.$437(e.$dw,n,l,"Favored")&&this.$437(e.$kA,n,m,"Unfavored")))return false;var q=this;f.$2m(function(a){!l.$4V(a)&&h.$F(a);!m.$4V(a)&&i.$F(a);return true});for(var j=e.$Ia.$OS(),c=new(Common.Collections.$1E.$$(Common.$C))(null),k=0;k<f.get_$N();k++){var b=f.$4W(k);if(h.$4V(b)||i.$4V(b)){g.$2M.$115.$F(b);if(!c.get_$N())continue;var p=c.$4W(c.get_$N()-1),a=g.$2M.$vU.get_$5(393241).get_$5(p),d=g.$2M.$vU.get_$5(393241).get_$5(b);if(!a||!d)continue;if(!h.$4V(b)){a.$Ia=a.$Ia.$OS();a.$dw=a.$dw.$OS();this.$26u(a.$Ia,d.$Ia);this.$26u(a.$dw,d.$dw)}else if(!i.$4V(b)){a.$Ia=a.$Ia.$OS();a.$kA=a.$kA.$OS();this.$26u(a.$Ia,d.$Ia);this.$26u(a.$kA,d.$kA)}continue}c.$F(b)}this.$AI.$Sz(j,Box4.AppProperties.$5.$6r,c);var o=new WordEditor.GraphMerge.$7m(j,true);o.$NE(Box4.AppProperties.$5.$6r);g.$2M.$Jx.set_$5(j.get_$E(),o)}return true},$26u:function(e,f){var a=e,c=this.$AI.$8E(a,Box4.AppProperties.$5.$6r),d=this.$AI.$8E(f,Box4.AppProperties.$5.$6r),b=c.$pV(),g=this;d.$2m(function(a){b.$F(a);return true});this.$AI.$Sz(a,Box4.AppProperties.$5.$6r,b)},$437:function(b,c,d,e){var a=true,f=this;this.$AI.$8E(b,Box4.AppProperties.$5.$6r).$2m(function(b){if(!c.$4V(b)){a=false;Diag.$Q.get_$4().$1k(4273298,1,3,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",e,b);return false}d.$F(b);return true});return a},$5FC:function(c){var b=true,a=this;c.$2M.$vU.get_$5(393241).$2m(function(k,d){if(a.$5N2(d)){Diag.$Q.get_$4().$1k(4220302,1,3,"OutlineGroup {0} requires inter-OG merge.",d.$Ia.get_$E());var f,e,g=new WordEditor.GraphMerge.$eU(c,a.$AI,a.$TF),h,i,j;if(j=a.$665(c,g.$5AK(),d,h={val:f},i={val:e}),f=h.val,e=i.val,j){Diag.$Q.get_$4().$1k(4220303,1,3,"Merging WordSection {0} as a unit.",e);b=!!(b&g.$1YM&&a.$5U8(c,e,f));!b&&Diag.$Q.get_$4().$1k(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [ParentObjectFinder.Success: {1}].",d.$Ia.get_$E(),g.$1YM);return b}}return true});return b},$5N2:function(a){if(!a.$2KV(Box4.AppProperties.$5.$6r))return false;var c=this.$AI.$8E(a.$Ia,Box4.AppProperties.$5.$6r),b=c.get_$5(0),d=this.$AI.$8E(a.$dw,Box4.AppProperties.$5.$6r),e=this.$AI.$8E(a.$kA,Box4.AppProperties.$5.$6r),f=this,g=this;return!d.$4V(b,function(a,b){return a.$w(b)})||!e.$4V(b,function(a,b){return a.$w(b)})},$665:function(b,l,d,e,a){a.val=l.get_$5(d.$Ia.get_$E());Diag.$Q.get_$4().$1k(4220304,1,3,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",d.$Ia.get_$E(),a.val);if(b.$2M.$115.$4V(a.val)){Diag.$Q.get_$4().$1k(4220305,1,4,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",a.val);e.val=null;return false}var c=new WordEditor.GraphMerge.$JO,f=b.$2M.$EJ.get_$5(a.val),g=this.$AI.$8E(f,Box4.AppProperties.$5.$6r),m=this;g.$2m(function(a){c.$26t(a);return true});var h=this.$TF.$15T(a.val,b.$2M.$Kt,b.$2M.$EJ),i=this.$AI.$8E(h,Box4.AppProperties.$5.$6r),n=this;i.$2m(function(a){c.$26v(a);return true});var j=this.$TF.$15T(a.val,b.$2M.$J4,b.$2M.$EJ),k=this.$AI.$8E(j,Box4.AppProperties.$5.$6r),o=this;k.$2m(function(a){c.$26z(a);return true});e.val=c;return true},$32T:function(d,e,f,b,g){var a=true,c=this;d.$2m(function(d){var h=e(d),i=c.$AI.$8E(h,Box4.AppProperties.$5.$6r);i.$2m(function(c){f.$F(c);if(b.$30(c)){a=!!(a&b.get_$5(c).$w(d));!a&&Diag.$Q.get_$4().$1k(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",g,c,d,b.get_$5(c));return a}b.set_$5(c,d);return true});return true});return a},$59t:function(c,d,e,f,g,a){e.val=new(Common.Collections.$1E.$$(Common.$C))(null);f.val=new(Common.Collections.$1E.$$(Common.$C))(null);g.val=new(Common.Collections.$1E.$$(Common.$C))(null);a.val=new(Common.Collections.$2d.$$(Common.$C,Common.$C));var b=c.$2M.$EJ,j=this;if(!this.$32T(d.$xh,function(a){return b.get_$5(a)},e.val,a.val,"Base"))return false;var h=this;if(!this.$32T(d.$yR,function(a){return h.$TF.$15T(a,c.$2M.$Kt,b)},f.val,a.val,"Favored"))return false;var i=this;return!this.$32T(d.$10U,function(a){return i.$TF.$15T(a,c.$2M.$J4,b)},g.val,a.val,"Unfavored")?false:true},$4tA:function(a,d,l,m){var b=true,h=a.$2M.$EJ,i=a.$2M.$Kt,j=a.$2M.$J4,c=a.$2M.$Jx,e=new(Common.Collections.$1E.$$(Common.$C))(null),f=new(Common.Collections.$2d.$$(Common.$C,Common.Collections.$CO.$$(Common.$C))),n=this;l.$2m(function(d){var c=m.get_$5(d);if(!c){Diag.$Q.get_$4().$1k(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",d);b=false;return false}if(!c.$w(e.$5w())){e.$F(c);f.$F(c,new(Common.Collections.$1E.$$(Common.$C))(null))}f.get_$5(c).$F(d);a.$2M.$115.$F(d);return true});if(!b)return false;var g=this;f.$2m(function(d,f){var e=g.$TF.$40s(d,i,j,h).$OS();g.$AI.$Sz(e,Box4.AppProperties.$5.$6r,f);c.set_$5(d,new WordEditor.GraphMerge.$7m(e,true));c.get_$5(d).$NE(Box4.AppProperties.$5.$6r);a.$2M.$115.$F(d);return b});var k=this.$TF.$40s(d,i,j,h).$OS();this.$AI.$Sz(k,Box4.AppProperties.$5.$6r,e);c.set_$5(d,new WordEditor.GraphMerge.$7m(k,true));c.get_$5(d).$NE(Box4.AppProperties.$5.$6r);a.$2M.$115.$F(d);return b},$5U8:function(e,m,n){var a,b,c,d,f,g,h,i,j;if(!(j=this.$59t(e,n,f={val:a},g={val:b},h={val:c},i={val:d}),a=f.val,b=g.val,c=h.val,d=i.val,j))return false;var l=this.$3nu(a,b,c),k=this.$3nC(e,l);return!!k&&this.$4tA(e,m,k,d)},$5dk:function(b,a){if(a.$2KV(Box4.AppProperties.$5.$6r)){var e=this.$59s(a),d=this.$3nC(b,e);if(!d){Diag.$Q.get_$4().$1k(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",a.$Ia.get_$E());WordEditor.GraphMerge.$7Z.$oi(b.$2M.$Wp,a.$Ia,"OutlineElementContainerThreewayChildMerge_Base",this.$AI,1);WordEditor.GraphMerge.$7Z.$oi(b.$2M.$Wp,a.$dw,"OutlineElementContainerThreewayChildMerge_Favored",this.$AI,1);WordEditor.GraphMerge.$7Z.$oi(b.$2M.$Wp,a.$kA,"OutlineElementContainerThreewayChildMerge_Unfavored",this.$AI,1);return false}var c=a.$dw.$OS();this.$AI.$Sz(c,Box4.AppProperties.$5.$6r,d);b.$2M.$Jx.set_$5(c.get_$E(),new WordEditor.GraphMerge.$7m(c,true));b.$2M.$Jx.get_$5(c.get_$E()).$NE(Box4.AppProperties.$5.$6r)}return true},$59s:function(g){var a,b,c,d,e,f;this.$55w(g,d={val:a},e={val:b},f={val:c}),a=d.val,b=e.val,c=f.val;return this.$3nu(a,b,c)},$3nC:function(b,d){Diag.$Q.get_$4().$1k(4220309,1,4,"Considering {0} OutlineElement collections for merge.",d.get_$N());var e=new(Common.Collections.$1E.$$(Common.$C))(null),a=false,c=this;d.$2m(function(f){if(!f){Diag.$Q.get_$4().$m(4740611,1,false,"Mapping is null.");a=false;return false}if(f.get_$5UL()===1&&f.get_$5Tj()===1){var g=f.$xh.get_$5(0),p=f.$yR.get_$5(0),q=f.$10U.get_$5(0);if(g&&g.$w(p)&&g.$w(q)){e.$F(g);return true}if(d.get_$N()!==1){Diag.$Q.get_$4().$m(4030554,1,false,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",g,p,q,d.get_$N());a=false;return false}}var h=new(Common.Collections.$2d.$$(Common.$C,Common.$C)),m=new(Common.Collections.$1E.$$(Box4.$5r))(null),n=new(Common.Collections.$1E.$$(Box4.$5r))(null),o=new(Common.Collections.$1E.$$(Box4.$5r))(null),j=b.$2M.$EJ;f.$xh.$2m(function(d){a=c.$32e(d,function(a){return j.get_$5(a)},m,h,b.$2M.$Wp,"Base");return a});if(!a){Diag.$Q.get_$4().$1k(4285026,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines.");return false}f.$yR.$2m(function(d){a=c.$32e(d,function(a){return c.$TF.$15T(a,b.$2M.$Kt,j)},n,h,b.$2M.$Wp,"Favored");return a});if(!a){Diag.$Q.get_$4().$1k(4285027,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines.");return false}f.$10U.$2m(function(d){a=c.$32e(d,function(a){return c.$TF.$15T(a,b.$2M.$J4,j)},o,h,b.$2M.$Wp,"Unfavored");return a});if(!a){Diag.$Q.get_$4().$1k(4285056,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines.");return false}var i,k,l;if(!(l=c.$2SU(b,m,n,o,k={val:i}),i=k.val,l)||!i){a=false;return false}i.$2m(function(a){a.$3bh().get_$14()>0&&b.$2M.$Jx.set_$5(a.$8S.get_$E(),a);e.$F(h.get_$5(a.$8S.get_$E()));return true});return true});return a?e:null},$32e:function(a,g,h,i,j,b){var c=g(a);if(!c){Diag.$Q.get_$4().$1k(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",b,a);return false}var d=this.$AI.$8E(c,Box4.AppProperties.$5.$1hG);if(!d||!d.get_$N()){Diag.$Q.get_$4().$1k(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",b,a);WordEditor.GraphMerge.$7Z.$oi(j,c,"ProcessOutlineElement_"+b,this.$AI,1);return false}var e=d.$4W(0),f=g(e);if(!f){Diag.$Q.get_$4().$1k(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",b,e,a);return false}h.$F(f);i.$F(e,a);return true},$55w:function(a,b,c,d){b.val=this.$AI.$8E(a.$Ia,Box4.AppProperties.$5.$6r);c.val=this.$AI.$8E(a.$dw,Box4.AppProperties.$5.$6r);d.val=this.$AI.$8E(a.$kA,Box4.AppProperties.$5.$6r)},$3nu:function(e,f,g){for(var k=WordEditor.GraphMerge.$AU.$4si(e,f,g),b=0,c=0,d=0,a=new WordEditor.GraphMerge.$JO,i=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$JO))(null),j=0;j<k.get_$N();j++){var h=k.$4W(j+1);a.$26t(e.$4W(b));a.$26v(f.$4W(c));a.$26z(g.$4W(d));b++;c++;d++;while(b<e.get_$N()&&(!h||!h.$w(e.$4W(b)))){a.$26t(e.$4W(b));b++}while(c<f.get_$N()&&(!h||!h.$w(f.$4W(c)))){a.$26v(f.$4W(c));c++}while(d<g.get_$N()&&(!h||!h.$w(g.$4W(d)))){a.$26z(g.$4W(d));d++}i.$F(a);a=new WordEditor.GraphMerge.$JO}while(b<e.get_$N()){a.$26t(e.$4W(b));b++}while(c<f.get_$N()){a.$26v(f.$4W(c));c++}while(d<g.get_$N()){a.$26z(g.$4W(d));d++}!a.get_$7N()&&i.$F(a);return i}};WordEditor.GraphMerge.$XA=function(){};WordEditor.GraphMerge.$XA.prototype={$15T:function(a,b,c){return b.$uX(a,c.get_$5(a))},$40s:function(b,g,h,i){var a,c,d,e,f;return!(d=g.$9F(b,c={val:a}),a=c.val,d)&&!(f=h.$9F(b,e={val:a}),a=e.val,f)?i.get_$5(b):a}};WordEditor.GraphMerge.$Qo=function(a,c,d,e,f,g,b,h){this.$$d_$3ME=Function.createDelegate(this,this.$3ME);this.$$d_$4Bg=Function.createDelegate(this,this.$4Bg);this.$$d_$66h=Function.createDelegate(this,this.$66h);this.$$d_$2wp=Function.createDelegate(this,this.$2wp);this.$$d_$5I1=Function.createDelegate(this,this.$5I1);this.$$d_$5Mw=Function.createDelegate(this,this.$5Mw);this.$$d_$5dg=Function.createDelegate(this,this.$5dg);if(!a){var i=this;a=function(a){return new Box4.$85(a)}}this.$2St=a;this.$AI=c||new Box4.$Ai;this.$2Q6=g||new WordEditor.GraphMerge.$AU(null,null,null,null,null);this.$bj=d||this.$2uE();this.$2R4=e||new WordEditor.GraphMerge.$Qq;this.$2R5=f||new WordEditor.GraphMerge.$aU(this.$AI,null);this.$1Hg=isNullOrUndefined(b)||b===-1?WordEditor.App.$3B2:b;this.$1sD=h||WordEditor.App.$Wp};WordEditor.GraphMerge.$Qo.$56x=function(a){return a.$DO.$11L?2:a.$DO.$V7?3:1};WordEditor.GraphMerge.$Qo.prototype={$2St:null,$AI:null,$bj:null,$2R4:null,$2R5:null,$1Hg:0,$2Q6:null,$1sD:false,$30R:function(e,f,q,o,k,l,m){var a=this.$4ee(e,f,o,k,l,m),b=0,g=a.$2M.$1px;try{if(g){var c=!e.get_$N()?null:e.$4W(e.get_$N()-1),d=!f.get_$N()?null:f.$4W(f.get_$N()-1);Diag.$Q.get_$4().$1k(4051606,1,3,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",e.get_$N(),!c?Common.$C.get_$1G():c.get_$E(),!c?Common.$C.get_$1G():!c.get_$Rq()?Common.$C.get_$1G():c.get_$Rq().get_$E(),f.get_$N(),!d?Common.$C.get_$1G():d.get_$E(),!d?Common.$C.get_$1G():!d.get_$Rq()?Common.$C.get_$1G():d.get_$Rq().get_$E(),k,l,this.$1Hg,this.$1sD,m)}for(var i=true;b<this.$bj.length&&i;b++){var n=this.$bj[b];i=n(a)}return a.$DO.$Na}catch(p){var h=!a.$DO.$1qg;a.$DO.$11L=h;var j=this.$15G("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",h?"Crashed":"Timed Out",this.$2td(p),!!a.$DO.$Na);if(h)Diag.$Q.get_$4().$bF(4051608,1,1,"MergeChanges Crash",j);else Diag.$Q.get_$4().$bF(4993346,1,2,"MergeChanges Timeout",j);if(a.$DO.$Na)return a.$DO.$Na;throw p;}finally{if(a.$DO.$V7)g&&Diag.$Q.get_$4().$1k(4059162,1,3,this.$1kL(a,b,"Succeeded"));else if(a.$DO.$1qg)Diag.$Q.get_$4().$1k(4059163,1,2,this.$1kL(a,b,"Timeout"));else if(!a.$DO.$11L)g&&Diag.$Q.get_$4().$1k(4059164,1,3,this.$1kL(a,b,"Rejection"));else if(a.$DO.$Na)Diag.$Q.get_$4().$1k(4059165,1,1,this.$1kL(a,b,"Crash - Rejection"));else Diag.$Q.get_$4().$m(4059166,1,false,this.$1kL(a,b,"Crash - Failed"));this.$5sv(a)}},$5SL:function(a,b){Diag.$Q.get_$4().$1k(4535064,1,3,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.$DO.$11L,a.$DO.$1qg,b)},$1kL:function(c,d,e){var a=c.$DO.$Na,b=!a||!a.get_$N()?null:a.$4W(a.get_$N()-1);return this.$15G("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",e,this.$2tS()-c.$98.$1GL,d,!a?0:a.get_$N(),!b?Common.$C.get_$1G():b.get_$E(),!b?Common.$C.get_$1G():!b.get_$Rq()?Common.$C.get_$1G():b.get_$Rq().get_$E(),c.$98.$4d)},$4ee:function(f,g,h,i,j,k){var c=new WordEditor.GraphMerge.$TI,a=c.$98;a.$Xn=f;a.$pr=g;a.$6m=h;a.$Uh=i;a.$1SL=j;a.$1GL=this.$2tS();a.$4d=k;var d=c.$2M;d.$Wp=this.$1sD;d.$1GF=Diag.$Q.get_$4().$1WD(1,4);d.$1px=Diag.$Q.get_$4().$1WD(1,3);var e="",b=this;d.$Qm=function(f){if(!b.$1Hg)return;var d=b.$2tS()-a.$1GL,g=d>b.$1Hg;e+=b.$15G(" ({0}: {1})",f,d);if(g){c.$DO.$1qg=true;var h=b.$15G("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",b.$1Hg,f,d,e);b.$64f(h)}};return c},$2uE:function(){var a=this.$2Q6;return[this.$$d_$5dg,this.$$d_$5Mw,this.$$d_$5I1,this.$$d_$2wp,a.$$d_$5Tz||(a.$$d_$5Tz=Function.createDelegate(a,a.$5Tz)),this.$$d_$66h,this.$$d_$4Bg]},$5dg:function(c){var d=c.$98,a=d.$Xn,b=c.$DO;if(!a){Diag.$Q.get_$4().$1k(4051609,1,4,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge.");b.$Na=a;b.$V7=true;return false}if(!a.get_$N()){Diag.$Q.get_$4().$1k(4051610,1,4,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge.");b.$Na=a;b.$V7=true;return false}return true},$5Mw:function(i){var a=i.$98,b=a.$Xn,d=a.$pr,g=a.$6m,e=a.$Uh,h=a.$1SL,f=i.$DO;if(!d||!d.get_$N()){f.$Na=b;return false}var c=true;if(e!==2&&e!==1){f.$Na=b;return false}if(!g||g===Common.$C.get_$1G())c=false;var j=h?2:1;if(b.get_$N()<j){Diag.$Q.get_$4().$1k(4051614,1,4,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",h);c=false}if(!c)f.$Na=e===2?b:d;return c},$2wp:function(a){var e=a.$98,h=e.$Xn,i=e.$pr,u=e.$Uh,v=e.$1SL,b,c,d,m,n,o;this.$58F(a,h,i,v,m={val:b},n={val:c},o={val:d}),b=m.val,c=n.val,d=o.val;if(!d){Diag.$Q.get_$4().$1k(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",b.get_$E(),c.get_$E());this.$3hy(b,h.get_$N(),"TheirChanges");this.$3hy(c,i.get_$N(),"YourChanges");a.$DO.$Na=u===2?h:i;return false}a.$2M.$1Ba=d;var f,g,p,q;this.$4mj(u,b,c,p={val:f},q={val:g}),f=p.val,g=q.val;var j,k,l,r,s,t;this.$591(a,f,g,d,r={val:j},s={val:k},t={val:l}),j=r.val,k=s.val,l=t.val;a.$2M.$EJ=l;a.$2M.$J4=j;a.$2M.$Kt=k;a.$2M.$Jx=new(Common.Collections.$2d.$$(Common.$C,WordEditor.GraphMerge.$7m));a.$2M.$2pl=g.get_$E();a.$2M.$39i=f.get_$E();a.$2M.$vU=new(Common.Collections.$2d.$$(Box4.ClassIds.$Ki,Common.Collections.$Sy.$$(Common.$C,WordEditor.GraphMerge.$JM)));a.$2M.$115=new(Common.Collections.$4y.$$(Common.$C));return true},$3hy:function(h,i,j){var g=50,a=new(Common.Collections.$1E.$$(Box4.$FL))(null),b=h;while(b){a.$F(b);b=b.get_$Rq()}var c=new Sys.StringBuilder;c.append(this.$15G("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",j,i,a.get_$N()));var d=a.get_$N(),e=0,f=this;a.$2m(function(j){var b,h,i;return i=f.$4FO(g,c,j,a,b={val:d},h={val:e}),d=b.val,e=h.val,i});Diag.$Q.get_$4().$1k(4273302,1,3,c.toString())},$4FO:function(e,b,c,f,d,a){b.append(this.$15G(" [{0} {1} {2}]",d.val,c.get_$v3()?"S":"B",c.get_$E()));d.val--;a.val++;if(e<a.val&&f.get_$N()!==a.val){b.append(" ...Truncated.");return false}return true},$58F:function(f,a,b,g,c,d,h){var e=g?1:0;c.val=a.$4W(a.get_$N()-1-e);d.val=b.$4W(b.get_$N()-1);h.val=c.val.$1kF(d.val);f.$2M.$Qm("GetCommonBase")},$591:function(a,g,h,d,i,j,k){g.$1Tm(d,i);a.$2M.$Qm("GetUnfavoredChanges");var c=new(Common.Collections.$2d.$$(Common.$C,Box4.$5r)),e,f;f=h.$1Tm(d,e={val:c}),c=e.val,f;if(a.$98.$4d===5){a.$2M.$3Q1=Box4.$85.$3af(h.$40K());a.$2M.$2OO=Box4.$85.$3af(g.$40K())}j.val=c;a.$2M.$Qm("GetFavoredChanges");var b=d;k.val=new(Common.Collections.$JF.$$(Common.$C,Box4.$5r))(b.$$d_$uV||(b.$$d_$uV=Function.createDelegate(b,b.$uV)));a.$2M.$Qm("GetModifiedObjects")},$4mj:function(e,a,b,c,d){if(e===2){d.val=a;c.val=b}else{d.val=b;c.val=a}},$5I1:function(b){var a=b.$98,c=a.$Xn,d=a.$pr,e=a.$Uh,f=b.$DO,g=e===2?c:d;f.$Na=g.$pV();b.$2M.$Qm("InitializeOutputMergeState");return true},$4Bg:function(a){var d=a.$98.$6m,e=a.$2M.$Jx,b=a.$DO.$Na,c=this.$4ed(a,b.$4W(b.get_$N()-1),d,Common.$C.$x());this.$4sA(a,c,e);c.$2A5();b.$F(c);a.$DO.$V7=true;return true},$4ed:function(d,e,b,c){d.$2M.$1px&&Diag.$Q.get_$4().$1k(4051616,1,3,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",b,c);var a=this.$2St(c);a.$4Ii(e,b);return a},$4sA:function(b,c,a){b.$2M.$1px&&Diag.$Q.get_$4().$1k(4059167,1,3,"FillRevision: Adding {0} objects to merged revision.",a.get_$14());var d=this;a.$2m(function(b,a){c.$4FB(a.$8S);return true})},$66h:function(a){var e=a.$2M,f=e.$EJ,j=e.$J4,k=e.$Kt,c=e.$Jx,b=true,l=a.$2M.$1GF,m=50,h=0,i=0,g=0,d=this;j.$2m(function(e,n){l&&Diag.$Q.get_$4().$1k(4051617,1,4,"Merging Object: [Id: {0}] [ClassId: {1}]",e,n.get_$48());i++;if(m===i){h++;a.$2M.$Qm(d.$15G("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",h,g));i=0}if(d.$61n(n.get_$48()))return true;var q=k.$BQ(e);if(!q){if(c.$30(e))c.get_$5(e).$3ic(n);else c.set_$5(e,new WordEditor.GraphMerge.$7m(n,false));return true}if(!f.get_$5(e)){var s=!!a.$98.$Xn&&!!a.$98.$Xn.$5w()&&a.$98.$Xn.$5w().$aY(e),t=!!a.$98.$pr&&!!a.$98.$pr.$5w()&&a.$98.$pr.$5w().$aY(e);Diag.$Q.get_$4().$1k(4051618,1,2,"Merging Object: Failing [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {2}] [ReferencedInUnfavored: {3}].",e,n.get_$48(),s,t);b=false;return false}var r=c.$uX(e,new WordEditor.GraphMerge.$7m(f.get_$5(e),true)),j,o,p;b=(p=d.$2R5.$XK(a,d.$2R4,d.$AI,r,q,n,o={val:j}),j=o.val,p);g++;if(b){a.$2M.$Qm(d.$15G("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",e,n.get_$48(),g,h));if(j)if(c.$30(j.$8S.get_$E()))c.get_$5(j.$8S.get_$E()).$3ic(j.$8S);else c.set_$5(j.$8S.get_$E(),j)}return b});if(b&&a.$98.$4d===5&&a.$2M.$2OO.get_$N()){var n=this;k.$2m(function(c,d){if(d.get_$48()===393230&&a.$2M.$2OO.$4V(c,function(a,b){return a.$w(b)})){if(!f.get_$5(c))b=false;else{var e=new Box4.$Ai,g=new WordEditor.GraphMerge.$EG(Box4.AppProperties.$5.$9O,e.$oA(f.get_$5(c),Box4.AppProperties.$5.$9O),e.$oA(d,Box4.AppProperties.$5.$9O));b=!g.get_$UR()}if(!b){Diag.$Q.get_$4().$1k(16869081,1,2,"Failed to Merge Object {0} which was changed in the favored and removed in the unfavored.",c);return false}}return true})}l&&Diag.$Q.get_$4().$1k(4059168,1,4,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",j.get_$14(),g);return b},$61n:function(a){switch(a){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:return true}return false},$4hV:function(c,a,d,n,o,p){var e=new(Common.Collections.$1E.$$(c))(null),f=new(Common.Collections.$1E.$$(c))(null),g=new(Common.Collections.$1E.$$(c))(null),b=a.$2M.$1Ba,h=!b?Common.$C.get_$1G():b.get_$E(),i=this.$2zH(b,null),q=this;i.$2m(function(a){e.$F(d(a));return true});var j=a.$98.$Xn.$4W(a.$98.$Xn.get_$N()-1),k=this.$2zH(j,h),r=this;k.$2m(function(a){f.$F(d(a));return true});var l=a.$98.$pr.$4W(a.$98.$pr.get_$N()-1),m=this.$2zH(l,h),s=this;m.$2m(function(a){g.$F(d(a));return true});n.val=e;o.val=f;p.val=g},$2zH:function(a,c){var b=new(Common.Collections.$1E.$$(Box4.$FL))(null);if(!c)c=Common.$C.get_$1G();while(a&&!c.$w(a.get_$E())){b.$F(a);a=a.get_$Rq()}b.$34L();return b},$2tS:function(){return+new Date},$15G:function(c){for(var b=[],a=1;a<arguments.length;++a)b[a-1]=arguments[a];return String.format.apply(null,[c].concat(b))},$64f:function(a){throw Common.$4Z.$1SY(a);},$2td:function(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",a.name,a.message,a.stack)},$5sv:function(a){var n=!a.$DO.$V7&&(WordEditor.App.$3B0||a.$DO.$11L),o=!!a.$98.$Xn&&a.$98.$Xn.get_$N()>0,b=WordEditor.App.$3B1&&o&&(WordEditor.App.$3Az||n);if(!b)return;var j=b?Common.$C.$x():Common.$C.get_$1G(),p=b?String.format(" [Merge Request Id: {0}]",j):"";this.$5SL(a,p);var c,d,e,g,h,i;this.$4hV(Box4.$Fn,a,this.$$d_$3ME,g={val:c},h={val:d},i={val:e}),c=g.val,d=h.val,e=i.val;var k=WordEditor.GraphMerge.$Qo.$56x(a),l=WordEditor.GraphMerge.$L1.$Jh(c.$k6(),d.$k6(),e.$k6(),a.$98.$1SL,a.$98.$Uh,a.$98.$6m,j,a.$98.$4d,k),q=a.$DO.$Na;if(k===3&&q.get_$N()>0)l.MergedRevision=this.$3ME(a.$DO.$Na.$5w());var f=new Box4.$Bm;f.set_$MV(l);f.$3I=1;var m=new Box4.$Cn(1,null);m.$Rm(f);m.$tP()},$3ME:function(c){var b=c.get_$Rq(),d=c,a=Box4.App.get_$X().$1L.get_$2v();return new Box4.$Fn(d,b,a.get_$3V(),a.$O1,a.$mF,a.$1t,!b?Common.$C.get_$1G():b.get_$E(),false,true)},$2oW:function(b,c){var a=new WordEditor.GraphMerge.$Qp(b,null,null);return a.$2oW(c)},$2oV:function(b,c,d,e){var a=new WordEditor.GraphMerge.$Qp(b,null,null);return a.$2oV(c,d,e)}};WordEditor.GraphMerge.$CT=function(b,c){this.$$d_$4qz=Function.createDelegate(this,this.$4qz);this.$KL=b;this.$5m=c;var a=this;this.$1L3=new($$sc.$x.$$(Boolean))(function(){return a.$1lv(null)});this.$2f3=new($$sc.$x.$$(Common.Collections.$2d.$$(Number,WordEditor.GraphMerge.$EG)))(this.$$d_$4qz)};WordEditor.GraphMerge.$CT.prototype={$1L3:null,$2f3:null,$KL:null,$5m:null,get_$2Fq:function(){return!!this.$5m&&!this.$KL},get_$1Sg:function(){return!this.$5m&&!!this.$KL},get_$UR:function(){return this.get_$2Fq()||this.get_$1Sg()||this.$1L3.get_$Q()},get_$vl:function(){return this.$2f3.get_$Q()},$1lv:function(b){var a=false,c=this;this.get_$vl().$2m(function(c,d){a=d.get_$UR()&&(!b||b.get_$5(c)!==7);return!a});return a},$4qz:function(){var b=new(Common.Collections.$2d.$$(Number,WordEditor.GraphMerge.$EG)),a=this.$5m,c=this.$KL;if(this.get_$2Fq())for(var l=a.$LK(),f=0;f<l.length;f++){var g=l[f],p=Common.$i.$2L(g);b.set_$5(p,new WordEditor.GraphMerge.$EG(g,null,a.$ix(g)))}else if(this.get_$1Sg())for(var m=c.$LK(),h=0;h<m.length;h++){var i=m[h],q=Common.$i.$2L(i);b.set_$5(q,new WordEditor.GraphMerge.$EG(i,c.$ix(i),null))}else{for(var n=c.$LK(),j=0;j<n.length;j++){var d=n[j],r=Common.$i.$2L(d),s=c.$ix(d),t=a.$v(d)?a.$ix(d):null;b.set_$5(r,new WordEditor.GraphMerge.$EG(d,s,t))}for(var o=a.$LK(),k=0;k<o.length;k++){var e=o[k];if(c.$v(e))continue;var u=Common.$i.$2L(e),v=a.$ix(e);b.set_$5(u,new WordEditor.GraphMerge.$EG(e,null,v))}}return b}};WordEditor.GraphMerge.$7p=function(a,b,c){this.$3G=a;this.$4d=b;this.$6E=c};WordEditor.GraphMerge.$7p.prototype={$3G:0,$4d:0,$6E:null,$E2:null,get_$1GQ:function(){return false},get_$5MX:function(){return(this.$4d&1)===1},get_$5MY:function(){return(this.$4d&2)===2},get_$5MZ:function(){return(this.$4d&4)===4},$XD:function(){return false},toString:function(){return String.format("[Source: {0}] [Type: {1}]",this.$53R(),this.$53S())},$53R:function(){var a="";if(this.get_$5MX())a+="Base";if(this.get_$5MY())a+="FavoredUpdate";if(this.get_$5MZ())a+="UnfavoredUpdate";return a},$53S:function(){return""},$oV:function(a){return this.$3G===a.$3G},$2NC:function(){var a=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null);a.$F(this);return a},get_$N:function(){return 0}};WordEditor.GraphMerge.$s0=function(a,b,c){WordEditor.GraphMerge.$s0.initializeBase(this,[a,b,c])};WordEditor.GraphMerge.$s0.prototype={$62A:function(a,b){b.val=null;if(!this.get_$2b())return false;if(!this.get_$1GQ())return false;if(a<=0||a>=this.get_$N())return false;b.val=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null);var c=this.$3l();c.set_$2b(WordEditor.GraphMerge.$5u.$1GP(this.get_$2b(),0,a));var d=this.$3l();d.set_$2b(WordEditor.GraphMerge.$5u.$1GP(this.get_$2b(),a,this.get_$N()-a));b.val.$F(c);b.val.$F(d);return true},$XD:function(){return true},get_$N:function(){return this.get_$2b().length}};WordEditor.GraphMerge.$K4=function(a,b,c,d){WordEditor.GraphMerge.$K4.initializeBase(this,[5,a,b]);this.set_$2b(c);this.$1IP=d};WordEditor.GraphMerge.$K4.prototype={$7G:null,get_$2b:function(){return this.$7G},set_$2b:function(a){this.$7G=a;return a},$1IP:null,$3l:function(){return new WordEditor.GraphMerge.$K4(this.$4d,this.$6E,this.get_$2b(),this.$1IP)},get_$1GQ:function(){return!this.get_$2b()||!this.get_$2b().length?false:true},toString:function(){var a=WordEditor.GraphMerge.$7p.prototype.toString.call(this);return String.format("{0}",a)}};WordEditor.GraphMerge.$WL=function(a,b,c,d,e,f,g,h,i,j){WordEditor.GraphMerge.$WL.initializeBase(this,[b,c,d]);this.$5z=e;this.$Mh=f;this.$fz=h;this.$Le=g;this.$15l=a;this.$kX=i;this.$kS=j};WordEditor.GraphMerge.$WL.prototype={$5z:0,$Mh:0,$fz:false,$15l:null,$Le:null,get_$2Ay:function(){return this.$15l(this.$Le)},$kX:false,$kS:false,toString:function(){var a=WordEditor.GraphMerge.$7p.prototype.toString.call(this);return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [FormatId: {4}]",this.$5z,this.$Mh,this.$fz,a,this.$Le.toString())},$oV:function(b,c,d){if(!WordEditor.GraphMerge.$7p.prototype.$oV.call(this,b,c,d))return false;var a=b;if(d)return true;if(this.$Le.$w(a.$Le)||this.$Le.$w(Common.$C.get_$1G())||a.$Le.$w(Common.$C.get_$1G()))return true;var e=new WordEditor.GraphMerge.$CT(this.get_$2Ay(),a.get_$2Ay()),f=c.$3LV(this.get_$2Ay());return!e.$1lv(f.get_$2KW())?true:false}};WordEditor.GraphMerge.$5u=function(){};WordEditor.GraphMerge.$5u.$64v=function(a){return a.toString().charCodeAt(0)};WordEditor.GraphMerge.$5u.$5Oz=function(a){return a>=55296&&a<=57343};WordEditor.GraphMerge.$5u.$We=function(a,b){return a.charAt(b)};WordEditor.GraphMerge.$5u.$4Hg=function(a,b){if(a===b)return true;if(a==="\u00a0")a=" ";if(b==="\u00a0")b=" ";return a===b};WordEditor.GraphMerge.$5u.$3Gt=function(a,b){if(a===b)return true;if(!a||!b)return false;if(a.length!==b.length)return false;a=WordEditor.GraphMerge.$5u.$3rz(a);b=WordEditor.GraphMerge.$5u.$3rz(b);return a===b};WordEditor.GraphMerge.$5u.$3rz=function(a){return a.replace(WordEditor.GraphMerge.$5u.$3iC," ")};WordEditor.GraphMerge.$5u.$1GP=function(b,a,c){return b.substring(a,a+c)};WordEditor.GraphMerge.$Pp=function(a,b,c,d,e,f,g,h,i,j){WordEditor.GraphMerge.$Pp.initializeBase(this,[a,3,b,c,d,e,f,h,i,j]);this.$kL=g};WordEditor.GraphMerge.$Pp.prototype={$kL:null,get_$2b:function(){return this.$kL.toString()},set_$2b:function(a){throw Common.$4Z.$2Ik();return a},toString:function(){var a=WordEditor.GraphMerge.$WL.prototype.toString.call(this);return String.format("{0}",a)},$53S:function(){return"CharRun"},$3l:function(){return new WordEditor.GraphMerge.$Pp(this.$15l,this.$4d,this.$6E,this.$5z,this.$Mh,this.$Le,this.$kL,this.$fz,this.$kX,this.$kS)},$oV:function(a,b,c){return!WordEditor.GraphMerge.$WL.prototype.$oV.call(this,a,b,c)?false:a.$kL===this.$kL?true:WordEditor.GraphMerge.$5u.$4Hg(a.$kL,this.$kL)}};WordEditor.GraphMerge.$K1=function(b,c,d,e,f,g,h,i,j,k,a){WordEditor.GraphMerge.$K1.initializeBase(this,[b,1,c,d,e,f,g,i,k,a]);this.$BL=h;this.$1ez=j};WordEditor.GraphMerge.$K1.prototype={$BL:null,get_$2b:function(){return this.$BL},set_$2b:function(a){this.$BL=a;return a},$1ez:false,get_$1GQ:function(){return!this.$1ez?false:!this.$BL||!this.$BL.length?false:true},toString:function(){var a=WordEditor.GraphMerge.$WL.prototype.toString.call(this);return String.format("{0} [SupportsSplit: {1}]",a,this.$1ez)},$53S:function(){return"TextRun"},$3l:function(){return new WordEditor.GraphMerge.$K1(this.$15l,this.$4d,this.$6E,this.$5z,this.$Mh,this.$Le,this.$BL,this.$fz,this.$1ez,this.$kX,this.$kS)},$oV:function(a,b,c){return!WordEditor.GraphMerge.$WL.prototype.$oV.call(this,a,b,c)?false:WordEditor.GraphMerge.$5u.$3Gt(this.$BL,a.$BL)},$2NC:function(){for(var c=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),b=0;b<this.get_$2b().length;b++){var a=WordEditor.GraphMerge.$5u.$We(this.$BL,b);if(WordEditor.GraphMerge.$5u.$5Oz(WordEditor.GraphMerge.$5u.$64v(a))){var d="";d+=a;a=WordEditor.GraphMerge.$5u.$We(this.$BL,++b);d+=a;var f=new WordEditor.GraphMerge.$K1(this.$15l,this.$4d,this.$6E,this.$5z,this.$Mh,this.$Le,d,this.$fz,false,this.$kX,this.$kS);c.$F(f);continue}var e=new WordEditor.GraphMerge.$Pp(this.$15l,this.$4d,this.$6E,this.$5z,this.$Mh,this.$Le,a,this.$fz,this.$kX,this.$kS);c.$F(e)}return c}};WordEditor.GraphMerge.$De=function(a,b,c){WordEditor.GraphMerge.$De.initializeBase(this,[2,a,b]);this.$4a=c};WordEditor.GraphMerge.$De.prototype={$4a:0,toString:function(){var a=WordEditor.GraphMerge.$7p.prototype.toString.call(this);return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",a,this.$4a,this.$6E)},$53S:function(){return"Eop"},$3l:function(){return new WordEditor.GraphMerge.$De(this.$4d,this.$6E,this.$4a)},$oV:function(a,b,c){return!WordEditor.GraphMerge.$7p.prototype.$oV.call(this,a,b,c)?false:a.$4a===this.$4a},get_$N:function(){return 1}};WordEditor.GraphMerge.$UU=function(a,b){WordEditor.GraphMerge.$UU.initializeBase(this,[4,a,b])};WordEditor.GraphMerge.$UU.prototype={toString:function(){var a=WordEditor.GraphMerge.$7p.prototype.toString.call(this);return String.format("{0} [GraphNodeId: {1}]",a,this.$6E)},$53S:function(){return"Table"},$3l:function(){return new WordEditor.GraphMerge.$UU(this.$4d,this.$6E)},$oV:function(a,b,c){return!WordEditor.GraphMerge.$7p.prototype.$oV.call(this,a,b,c)?false:this.$6E.$w(a.$6E)},get_$N:function(){return 1}};WordEditor.GraphMerge.$Jk=function(a,b){WordEditor.GraphMerge.$Jk.initializeBase(this,[6,a,b])};WordEditor.GraphMerge.$Jk.prototype={toString:function(){var a=WordEditor.GraphMerge.$7p.prototype.toString.call(this);return String.format("{0} [GraphNodeId: {1}]",a,this.$6E)},$53S:function(){return"Selection"},$3l:function(){return new WordEditor.GraphMerge.$Jk(this.$4d,this.$6E)},$oV:function(){return false},get_$N:function(){return 0}};WordEditor.GraphMerge.$TG=function(){};WordEditor.GraphMerge.$TG.$54x=function(c,a,b,d,e){if(a.get_$48()===393230)return new WordEditor.GraphMerge.$eN(c,a,b,d,e);if(a.get_$48()===393250)return new WordEditor.GraphMerge.$hq(a,b);Diag.$Q.get_$4().$1k(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",a.get_$48());return null};WordEditor.GraphMerge.$TG.prototype={$2jv:function(a,b){a+="[Block: "+b+"] ";return a}};WordEditor.GraphMerge.$eN=function(c,a,d,e,f){this.$30I=Number.MAX_VALUE;WordEditor.GraphMerge.$eN.initializeBase(this);this.$2UQ=c;this.$N3=a;this.$EH=d;this.$2h5=e;this.$6Z=f||new Box4.$Ai;if(!this.$6Z.$v(this.$N3,Box4.AppProperties.$5.$9O)){Diag.$Q.get_$4().$1k(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",a.get_$E());return}if(!this.$6Z.$v(this.$N3,Box4.AppProperties.$1.$3v)){Diag.$Q.get_$4().$1k(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",a.get_$E());return}if(!this.$6Z.$v(this.$N3,Box4.AppProperties.$1.$Dw)){Diag.$Q.get_$4().$1k(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",a.get_$E());return}if(!this.$6Z.$v(this.$N3,Box4.AppProperties.$1.$Ei)){Diag.$Q.get_$4().$1k(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",a.get_$E());return}if(!this.$6Z.$v(this.$N3,Box4.AppProperties.$5.$bB)){Diag.$Q.get_$4().$1k(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",a.get_$E());return}this.$zi=this.$6Z.$oA(this.$N3,Box4.AppProperties.$5.$9O);this.$2j1=this.$6Z.$5As(this.$N3,Box4.AppProperties.$1.$3v);this.$JU=this.$6Z.$2E5(this.$N3,Box4.AppProperties.$1.$Dw);this.$1MP=this.$6Z.$2E5(this.$N3,Box4.AppProperties.$1.$Ei);this.$1bB=this.$6Z.$8E(this.$N3,Box4.AppProperties.$5.$bB);if(!this.$zi&&this.$zi!==""){Diag.$Q.get_$4().$1k(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",a.get_$E());return}if(!this.$zi.length&&this.$1bB.get_$N()===1){if(!this.$JU.get_$N()){this.$JU.$F(0);Diag.$Q.get_$4().$1k(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")}if(!this.$1MP.get_$N()){this.$1MP.$F(0);Diag.$Q.get_$4().$1k(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it")}}this.$217=this.$2t3(this.$N3,Box4.AppProperties.$1.$jW,this.$JU.get_$N(),false);this.$19S=this.$2t3(this.$N3,Box4.AppProperties.$5.$ao,this.$JU.get_$N(),false);this.$1AN=this.$2t3(this.$N3,Box4.AppProperties.$5.$fc,this.$JU.get_$N(),false);var b;if(this.$6Z.$v(this.$N3,Box4.AppProperties.$5.$fh))b=this.$6Z.$2E5(this.$N3,Box4.AppProperties.$5.$fh);else b=new(Common.Collections.$1E.$$(Number))(null);this.$5y7(b);if(this.$JU.get_$N()!==this.$1MP.get_$N()){Diag.$Q.get_$4().$1k(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",a.get_$E());return}if(this.$JU.get_$N()!==this.$1bB.get_$N()){Diag.$Q.get_$4().$1k(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",a.get_$E());return}if(this.$JU.get_$N()!==this.$217.get_$N()){Diag.$Q.get_$4().$1k(4208071,1,1,"MergeBlockIterator: Length of NewlyTypedRuns and ParaIds does not match on [Object: {0}]",a.get_$E());return}if(this.$JU.get_$N()!==this.$19S.get_$N()||this.$JU.get_$N()!==this.$1AN.get_$N()){this.$JU.get_$N()!==this.$19S.get_$N()&&Diag.$Q.get_$4().$1k(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",a.get_$E(),this.$JU.get_$N(),this.$19S.get_$N());this.$JU.get_$N()!==this.$1AN.get_$N()&&Diag.$Q.get_$4().$1k(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",a.get_$E(),this.$JU.get_$N(),this.$1AN.get_$N());this.$19S=this.$2n2(this.$JU.get_$N(),true);this.$1AN=this.$2n2(this.$JU.get_$N(),false)}this.$mP.get_$N()!==this.$JU.get_$N()+1&&Diag.$Q.get_$4().$1k(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",a.get_$E(),this.$JU.get_$N(),this.$mP.get_$N());this.$2bF=true};WordEditor.GraphMerge.$eN.prototype={$2UQ:null,$N3:null,$6Z:null,$2j1:0,$zi:null,$JU:null,$1MP:null,$mP:null,$1bB:null,$217:null,$19S:null,$1AN:null,$mO:0,$2aV:false,$2bF:false,$EH:0,$1Lc:"",$2h5:false,$2t3:function(a,b,c,d){return this.$6Z.$v(a,b)?this.$6Z.$5Aq(a,b):this.$2n2(c,d)},$2n2:function(c,d){for(var a=new(Common.Collections.$1E.$$(Boolean))(null),b=0;b<c;b++)a.$F(d);return a},$5y7:function(b){this.$mP=new(Common.Collections.$1E.$$(Number))(null);this.$mP.$F(0);for(var a=0;a<b.get_$N();a++)this.$mP.$B8(a+1,b.$4W(a));this.$mP.$B8(this.$mP.get_$N(),this.$zi.length)},$5DL:function(a){var b=this.$mP.$4W(a),c=this.$mP.$4W(a+1);return this.$zi.substring(b,c)},$3Zc:function(){if(this.$2aV)return null;var a=this.$mO<this.$JU.get_$N()?this.$JU.$4W(this.$mO):this.$30I;if(a===this.$30I||this.$2h5&&!this.$zi.length){this.$2aV=true;var d=new WordEditor.GraphMerge.$De(this.$EH,this.$N3.get_$E(),this.$2j1);this.$1Lc=this.$2jv(this.$1Lc,d.toString());return d}var e=this.$1MP.$4W(this.$mO),f=this.$1bB.$4W(this.$mO),g=this.$217.$4W(this.$mO),h=this.$19S.$4W(this.$mO),i=this.$1AN.$4W(this.$mO),b=this.$5DL(this.$mO);this.$mO++;var j=b.startsWith("\ufddfHYPERLINK "),c=new WordEditor.GraphMerge.$K1(this.$2UQ,this.$EH,this.$N3.get_$E(),e,a,f,b,g,!j,h,i);this.$1Lc=this.$2jv(this.$1Lc,c.toString());return c},$58q_0:function(b,c){b.val=null;c.val="";if(!this.$2bF)return;var a=this.$3Zc();if(a){b.val=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null);b.val.$F(a)}while(a=this.$3Zc())b.val.$F(a);c.val=this.$1Lc}};WordEditor.GraphMerge.$hq=function(a,b){WordEditor.GraphMerge.$hq.initializeBase(this);this.$1uq=new WordEditor.GraphMerge.$UU(b,a.get_$E())};WordEditor.GraphMerge.$hq.prototype={$1uq:null,$58q_0:function(a,b){a.val=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null);a.val.$F(this.$1uq);b.val=this.$2jv("",this.$1uq.toString())}};WordEditor.GraphMerge.$JH=function(a,b){this.$2k=a;this.$1P=b};WordEditor.GraphMerge.$JH.prototype={$2k:0,$1P:0};WordEditor.GraphMerge.$JG=function(a,b,c,d,e){this.$18F=d||new WordEditor.GraphMerge.$Qq;this.$6Z=e||new Box4.$Ai;this.$Me=a.$pV();this.$HL=b.$pV();this.$KR=new WordEditor.GraphMerge.$JH(0,0);this.$Lz=new WordEditor.GraphMerge.$JH(0,0);this.$1bh=c;this.$4Ly();this.$5xL()};WordEditor.GraphMerge.$JG.prototype={$Me:null,$HL:null,$9y:0,$E0:0,$bZ:0,$Y2:0,$1uh:null,$1Al:null,$KR:null,$Lz:null,$18F:null,$6Z:null,$1bh:false,get_$4mv:function(){for(var b=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),a=this.$1uh.$2k;a<this.$1uh.$1P;a++)b.$F(this.$Me.$4W(a));return b},get_$2o8:function(){for(var b=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),a=this.$1Al.$2k;a<this.$1Al.$1P;a++)b.$F(this.$HL.$4W(a));return b},$2oU:function(a){if(this.$E0<a.$E0){if(this.$E0+this.$bZ>a.$E0)return true}else if(this.$E0>a.$E0){if(a.$E0+a.$bZ>this.$E0)return true}else if(this.$9y===2&&a.$9y===3||this.$9y===3&&a.$9y===2||this.$9y===2&&a.$9y===2||this.$9y===3&&a.$9y===3)return true;return false},$3ry:function(a,b,c,d){a.$Kp(b);a.$SO(b,c);d.val+=c.get_$N()-1},$3ya:function(e,f,g,j,k){var a=this.$Me.$4W(e),b=this.$HL.$4W(f);if(!a||!b)return false;if(!a.get_$1GQ()&&!b.get_$1GQ())return false;var c=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),d=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null);if(a.get_$1GQ()){c=a.$2NC();var h=g?0:c.get_$N()-1;a=c.$4W(h)}if(b.get_$1GQ()){d=b.$2NC();var i=g?0:d.get_$N()-1;b=d.$4W(i)}if(!a.$oV(b,this.$18F,this.$1bh))return false;c.get_$N()&&this.$3ry(this.$Me,e,c,j);d.get_$N()&&this.$3ry(this.$HL,f,d,k);return true},$4sX:function(e,f,g,h,a,b){while(a.val<=g&&b.val<=h){var c=e.$4W(a.val),d=f.$4W(b.val);if(!c.$oV(d,this.$18F,this.$1bh))break;this.$KR.$2k+=c.get_$N();this.$Lz.$2k+=d.get_$N();a.val++;b.val++}},$4sV:function(c,d,e,f,a,b){while(a.val>=e&&b.val>=f){if(!c.$4W(a.val).$oV(d.$4W(b.val),this.$18F,this.$1bh))return true;a.val--;b.val--}return false},$4sW:function(b,c,d,e){var a=false;do{this.$4sX(this.$Me,this.$HL,d.val,e.val,b,c);a=this.$3ya(b.val,c.val,true,d,e)}while(a)},$4sU:function(e,f,a,b){var c=false;do{var d=this.$4sV(this.$Me,this.$HL,e,f,a,b);if(!d)break;c=this.$3ya(a.val,b.val,false,a,b)}while(c)},$4Ly:function(){var c=0,d=0,a=this.$Me.get_$N()-1,b=this.$HL.get_$N()-1,s=this.$Me.$4W(a),t=this.$HL.$4W(b),g,h,i,j;this.$4sW(g={val:c},h={val:d},i={val:a},j={val:b}),c=g.val,d=h.val,a=i.val,b=j.val;if(c<a||d<b){var k,l;this.$4sU(c,d,k={val:a},l={val:b}),a=k.val,b=l.val}a++;b++;this.$1uh=new WordEditor.GraphMerge.$JH(c,a);this.$1Al=new WordEditor.GraphMerge.$JH(d,b);this.$KR.$1P=this.$KR.$2k;this.$Lz.$1P=this.$Lz.$2k;for(var e=c;e<a;e++){var m=this.$Me.$4W(e);this.$KR.$1P+=m.get_$N()}for(var f=d;f<b;f++){var n=this.$HL.$4W(f);this.$Lz.$1P+=n.get_$N()}Diag.$Q.get_$4().$1k(3993809,1,3,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",c,a,d,b);Diag.$Q.get_$4().$1k(3993810,1,3,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.$KR.$2k,this.$KR.$1P,this.$Lz.$2k,this.$Lz.$1P);if(this.$KR.$2k<=this.$KR.$1P&&this.$Lz.$2k<=this.$Lz.$1P){var o=this.$Me.$4W(c),p=this.$HL.$4W(d),q=this.$Me.$4W(a),r=this.$HL.$4W(b);Diag.$Q.get_$4().$1k(3993811,1,3,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",o,q,p,r)}},$5xL:function(){this.$E0=this.$KR.$2k;this.$bZ=this.$Y2=0;if(this.$KR.$2k===this.$KR.$1P&&this.$Lz.$2k===this.$Lz.$1P)this.$9y=0;else if(this.$KR.$2k===this.$KR.$1P&&this.$Lz.$2k<this.$Lz.$1P){this.$9y=1;this.$Y2=this.$Lz.$1P-this.$Lz.$2k}else if(this.$Lz.$2k===this.$Lz.$1P&&this.$KR.$2k<this.$KR.$1P){this.$9y=2;this.$bZ=this.$KR.$1P-this.$KR.$2k}else{this.$9y=3;this.$bZ=this.$KR.$1P-this.$KR.$2k;this.$Y2=this.$Lz.$1P-this.$Lz.$2k}Diag.$Q.get_$4().$1k(3993814,1,3,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.$9y,this.$E0,this.$bZ,this.$Y2)},$5NL:function(c,d){if(!c.$XD())return false;if(!d.$XD())return false;var a=c,b=d;return a.$Mh===b.$Mh&&a.$5z===b.$5z},$5Ow:function(e){if(!e.$XD())return false;var f="\ufffc",c=e;if(c.get_$2b()!==f)return false;var d=c.get_$2Ay();if(!d)return false;var a=d;if(a.$v(Box4.AppProperties.$1.$1h7)||a.$v(Box4.AppProperties.$1.$S2)||a.$v(Box4.AppProperties.$1.$ud)||a.$v(Box4.AppProperties.$1.$1EO)||a.$v(Box4.AppProperties.$1.$1mX))return true;if(a.$v(Box4.AppProperties.$1.$Qc)){var b=this.$6Z.$1DY(a,Box4.AppProperties.$1.$Qc);if(b&&(b===36||b===35||b===24||b===23||b===33||b===34))return true}return false},$1mH:function(a){return a.$XD()&&!this.$5Ow(a)},$4Md:function(){if(this.$9y===2)return false;var e=this.$1Al.$2k;if(!e)return false;for(var b=null,d=this.$1Al.$2k;d<this.$1Al.$1P;d++){var f=this.$HL.$4W(d);if(this.$1mH(f)){b=f;break}}if(!b)return false;var c=e-1,a=this.$HL.$4W(c);while(a&&!this.$1mH(a)){c--;a=this.$HL.$4W(c)}return a&&this.$5NL(a,b)?true:false},$3YR:function(c){for(var a=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),b=0;b<c.get_$N();b++)if(c.get_$5(b).get_$1GQ())a.$SO(a.get_$N(),c.get_$5(b).$2NC());else a.$B8(a.get_$N(),c.get_$5(b));return a},$5NN:function(){if(this.$9y!==3)return false;if(this.$bZ!==this.$Y2)return false;var b=this.$3YR(this.get_$4mv()),c=this.$3YR(this.get_$2o8());if(b.get_$N()!==c.get_$N())return false;for(var a=0;a<b.get_$N();a++)if(!b.get_$5(a).$oV(c.get_$5(a),this.$18F,true))return false;return true},$5NM:function(){if(this.$9y&&this.$9y!==3)return false;if(this.$Me.get_$N()!==this.$HL.get_$N())return false;for(var b=false,a=0;a<this.$Me.get_$N();a++){if(!this.$Me.get_$5(a).$oV(this.$HL.get_$5(a),this.$18F,true))return false;if(this.$Me.get_$5(a).$3G===3||this.$Me.get_$5(a).$3G===1){var c=this.$Me.get_$5(a),d=this.$HL.get_$5(a);b=!!(b|(c.$Mh!==d.$Mh||c.$5z!==d.$5z))}}return b}};WordEditor.GraphMerge.$2z=function(){};WordEditor.GraphMerge.$2z.$40p=function(a,j,f,g,k,l){g.val=0;k.val=false;l.val=0;var b=0,h,i;if(!(i=WordEditor.GraphMerge.$2z.$1qm(a,j,h={val:b}),b=h.val,i))return false;if(!f&&a.get_$5(b).$3G===2){g.val=b;return true}if(!a.get_$5(b).$XD())return false;for(var c=false,d=0,e=b;e<a.get_$N()&&a.get_$5(e).$6E.$w(j);e++){if(f===d){c=true;break}if(f>d&&f<d+a.get_$5(e).get_$N()){c=true;k.val=true;l.val=f-d;break}d+=a.get_$5(e).get_$N()}if(!c&&f===d)c=true;if(c)g.val=e;return c};WordEditor.GraphMerge.$2z.$1Wj=function(a,b,f){var c,d,e;if(a.get_$5(b).$XD()&&(e=a.get_$5(b).$62A(f,d={val:c}),c=d.val,e)){a.$SO(b+1,c);a.$Kp(b);return true}return false};WordEditor.GraphMerge.$2z.$2OM=function(i,j,k,d){d.val=0;var a,b,c,e,f,g,h;if(!(h=WordEditor.GraphMerge.$2z.$40p(i,j,k,e={val:a},f={val:c},g={val:b}),a=e.val,c=f.val,b=g.val,h))return false;if(!c){d.val=a;return true}if(WordEditor.GraphMerge.$2z.$1Wj(i,a,b)){d.val=a+1;return true}return false};WordEditor.GraphMerge.$2z.$1qm=function(b,d,c){c.val=0;for(var a=0;a<b.get_$N();a++)if(b.get_$5(a).$6E.$w(d)){c.val=a;return true}return false};WordEditor.GraphMerge.$2z.$1Wi=function(b,d,c){c.val=-1;for(var a=d;a<b.get_$N();a++)if(b.get_$5(a).$3G===2){c.val=a;return true}return false};WordEditor.GraphMerge.$2z.$2OJ=function(b,d,e,c){c.val=-1;for(var a=e;a<b.get_$N();a++)if(b.get_$5(a).$3G===2&&b.get_$5(a).$6E.$w(d)){c.val=a;return true}return false};WordEditor.GraphMerge.$2z.$66P=function(b,d,e){e.val=0;var c,f,g;if(!(g=WordEditor.GraphMerge.$2z.$1qm(b,d,f={val:c}),c=f.val,g)){Diag.$Q.get_$4().$1k(17342616,1,2,"Unable to find [GraphNodeId: {0}] in the list",d);return false}for(var a=c;a<b.get_$N();a++){if(b.get_$5(a).$3G===6)continue;if(b.get_$5(a).$3G===2)return true;Diag.$Q.get_$4().$m(17342617,1,!b.get_$5(a).$XD()||!b.get_$5(a).$6E.$w(d),"We found something other than text or the graph node Id was wrong");e.val=e.val+b.get_$5(a).get_$N()}return false};WordEditor.GraphMerge.$2z.$3l=function(c){for(var b=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),a=0;a<c.get_$N();a++)b.$F(c.get_$5(a).$3l());return b};WordEditor.GraphMerge.$7Z=function(){};WordEditor.GraphMerge.$7Z.$oi=function(k,a,f,b,i){if(!a){Diag.$Q.get_$4().$1k(4293845,i,1,f,"{0}: Node was null.",f);return}b=b||new Box4.$Ai;if(!k){a=a.$OS();for(var c=a,g=c.$LK(),d=0;d<g.length;d++){var e=g[d];if(Common.$4.$3Rr(e)===Common.$4.$2D){var h=b.$oA(c,e),j=!h?"null":"Redacted: "+h.length;b.$1pq(c,e,j)}}}Diag.$Q.get_$4().$bF(4273285,i,3,f,a.$40F(true))};WordEditor.GraphMerge.$JO=function(){this.$xh=new(Common.Collections.$1E.$$(Common.$C))(null);this.$yR=new(Common.Collections.$1E.$$(Common.$C))(null);this.$10U=new(Common.Collections.$1E.$$(Common.$C))(null)};WordEditor.GraphMerge.$JO.prototype={get_$7N:function(){return!this.$xh.get_$N()&&!this.$yR.get_$N()&&!this.$10U.get_$N()},get_$5Tj:function(){return Math.max(Math.max(this.$xh.get_$N(),this.$yR.get_$N()),this.$10U.get_$N())},get_$5UL:function(){return Math.min(Math.min(this.$xh.get_$N(),this.$yR.get_$N()),this.$10U.get_$N())},$26t:function(a){this.$xh.$F(a)},$26v:function(a){this.$yR.$F(a)},$26z:function(a){this.$10U.$F(a)}};WordEditor.GraphMerge.$JM=function(a,b,c){this.$Ia=a;this.$kA=c;this.$dw=b};WordEditor.GraphMerge.$JM.prototype={$2KV:function(g){var a,b,c,d,e,f;return(d=this.$40t(this.$kA,g,c={val:a}),a=c.val,d)&&a.get_$UR()||(f=this.$40t(this.$dw,g,e={val:b}),b=e.val,f)&&b.get_$UR()},$40t:function(a,b,c){return new WordEditor.GraphMerge.$CT(this.$Ia,a).get_$vl().$9F(Common.$i.$2L(b),c)},$Ia:null,$kA:null,$dw:null};WordEditor.GraphMerge.$eM=function(g,a,b,c,h,i){this.$6z=g;this.$E4=a;this.$Rj=c;this.$RP=b;this.$lL=h;this.$6Z=i||new Box4.$Ai;var d=WordEditor.GraphMerge.$2t.$1Rp(a),e=WordEditor.GraphMerge.$2t.$1Rp(b),f=WordEditor.GraphMerge.$2t.$1Rp(c);Diag.$Q.get_$4().$1k(4301141,1,3,"ParagraphMerge: Merging [BaseObject: {0}] [FavoredObjects: {1}] [UnfavoredObjects: {2}]",d.$Ap(" "),e.$Ap(" "),f.$Ap(" "))};WordEditor.GraphMerge.$eM.prototype={$6z:null,$E4:null,$Rj:null,$RP:null,$6Z:null,$Ep:null,$8b:null,$1da:null,$1eL:null,$li:false,$kx:null,$lK:null,$hg:null,$1uj:null,$1xO:null,$25k:null,$lL:null,$3ae:function(b){var a=new(Common.Collections.$4y.$$(Common.$C)),c=this;b.$Me.$2m(function(b){b.$3G===2&&a.$F(b.$6E);return true});var d=this;b.$HL.$2m(function(b){b.$3G===2&&a.$73(b.$6E);return true});return a},$3ZV:function(b){var a=new(Common.Collections.$1E.$$(Common.$C))(null),c=this;b.$HL.$2m(function(b){b.$3G===2&&a.$F(b.$6E);return true});return a},$3K1:function(a){var c=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$eM.$3na))(null),b=0,d=0,e=this;a.$HL.$2m(function(f){if(f.$3G===2){var e;if(b<a.$E0)e=b;else if(b<a.$E0+a.$Y2)e=a.$E0;else e=b-a.$Y2+a.$bZ;c.$F(new WordEditor.GraphMerge.$eM.$3na(f.$6E,e));b=d}d+=f.get_$N();return true});return c},$4Q5:function(k,l){for(var i=this.$3K1(k),c=this.$3K1(l),j=this.$3ae(k),m=this.$3ae(l),f=new(Common.Collections.$1E.$$(Common.$C))(null),d=new(Common.Collections.$4y.$$(Common.$C)),a=0,h=0;h<i.get_$N();h++){var e=i.get_$5(h);if(a<c.get_$N()){var b=c.get_$5(a);while(a<c.get_$N()&&b.$1ST<=e.$1ST){if(b.$E.$w(e.$E)){a++;break}if(!j.$4V(b.$E)&&!d.$4V(b.$E)){f.$F(b.$E);d.$F(b.$E)}a++;b=c.get_$5(a)}}if(m.$4V(e.$E))continue;f.$F(e.$E);d.$F(e.$E)}while(a<c.get_$N()){var g=c.get_$5(a);if(!j.$4V(g.$E)&&!d.$4V(g.$E)){f.$F(g.$E);d.$F(g.$E)}a++}return f},$8F:function(){if(this.$li)return!!this.$Ep&&!!this.$8b;this.$li=true;var a,b,c,d,e,f,g;if(!(g=WordEditor.GraphMerge.$2t.$3Lm(this.$6z,this.$6Z,this.$E4,this.$RP,this.$Rj,false,a={val:this.$kx},b={val:this.$lK},c={val:this.$hg},d={val:this.$1uj},e={val:this.$1xO},f={val:this.$25k}),this.$kx=a.val,this.$lK=b.val,this.$hg=c.val,this.$1uj=d.val,this.$1xO=e.val,this.$25k=f.val,g))return false;this.$Ep=new WordEditor.GraphMerge.$JG(this.$kx,this.$lK,false,null,null);this.$8b=new WordEditor.GraphMerge.$JG(this.$kx,this.$hg,false,null,null);return true},$39N:function(a){a.val=null;if(!this.$8F()){this.$1TL();return false}if(!this.$4oL()){this.$1TL();return false}if(!WordEditor.GraphMerge.$2t.$3ZS(this.$6z,this.$6Z,this.$lL,this.$1eL,this.$1da,a)){this.$1TL();return false}return true},$1TL:function(){Diag.$Q.get_$4().$bF(4478665,1,1,"BaseRevisionMergeBlocksList: {0}",this.$1uj);Diag.$Q.get_$4().$bF(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.$1xO);Diag.$Q.get_$4().$bF(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.$25k);var a=new(Common.Collections.$1E.$$(Common.$C))(null);WordEditor.GraphMerge.$2t.$1TK(this.$6z,this.$6Z,"BaseObjects_",this.$E4,a);WordEditor.GraphMerge.$2t.$1TK(this.$6z,this.$6Z,"FavoredObjects_",this.$RP,a);WordEditor.GraphMerge.$2t.$1TK(this.$6z,this.$6Z,"ConflictObjects_",this.$Rj,a);WordEditor.GraphMerge.$2t.$5S3(this.$6z,this.$6Z,a)},$3ID:function(c,a,b){a.val=0;b.val=0;if(!this.$Ep.$9y)a.val=this.$8b.$E0;else if(this.$Ep.$9y===1)if(this.$8b.$E0<this.$Ep.$E0)a.val=this.$8b.$E0;else if(this.$8b.$E0===this.$Ep.$E0)if(!c&&this.$8b.$9y===1)a.val=this.$8b.$E0;else a.val=this.$8b.$E0+this.$Ep.$Y2;else a.val=this.$8b.$E0+this.$Ep.$Y2;else if(this.$Ep.$9y===2||this.$Ep.$9y===3)if(this.$8b.$E0<=this.$Ep.$E0)a.val=this.$8b.$E0;else a.val=this.$8b.$E0+(this.$Ep.$Y2-this.$Ep.$bZ);if(this.$8b.$9y===2||this.$8b.$9y===3)b.val=a.val+this.$8b.$bZ},$3Qh:function(d,b,h){h.val=0;if(!b)return true;var a=0,c=0;while(a<d.get_$N()){for(var e=null,f=a;f<d.get_$N();f++){a=f;e=d.get_$5(f);var g=e.get_$N();c+=g;if(c<b)continue;if(c>b)if(e.get_$1GQ()){d.$Kp(a);d.$SO(a,e.$2NC());c-=g}else{Diag.$Q.get_$4().$1k(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",b);return false}break}if(c===b){a++;h.val=a;return true}}Diag.$Q.get_$4().$1k(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",b);return false},$4HW:function(i,n,o){var a=0,b=0,j=false,e=this.$8b.get_$2o8().$pV();if(this.$8b.$4Md())for(var c=n-1;c>=0;c--){var m=i.get_$5(c);if(this.$8b.$1mH(m)){var k=i.get_$5(c);a=k.$Mh;b=k.$5z;j=true;break}}if(!j){var f=i.get_$5(o);if(f&&this.$8b.$1mH(f)){var l=f;a=l.$Mh;b=l.$5z}else{a=0;b=0}}for(var g=0;g<e.get_$N();g++){var h=e.get_$5(g);if(h.$XD()){var d=h;if(this.$8b.$1mH(h)){d.$Mh=a;d.$5z=b}else{d.$Mh=0;d.$5z=0}}}return e},$4oL:function(){var e=this.$Ep.$5NM();if(!e&&!this.$Ep.$9y){this.$1eL=this.$8b.$HL.$pV();this.$1da=this.$3ZV(this.$8b);return true}if(!this.$8b.$9y){this.$1eL=this.$Ep.$HL.$pV();this.$1da=this.$3ZV(this.$Ep);return true}if(!e){var h=this.$Ep.$2oU(this.$8b);if(h&&this.$lL(20)){Diag.$Q.get_$4().$1k(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids");this.$Ep=new WordEditor.GraphMerge.$JG(this.$kx,this.$lK,true,null,null);this.$8b=new WordEditor.GraphMerge.$JG(this.$kx,this.$hg,true,null,null);h=this.$Ep.$2oU(this.$8b)}if(h){Diag.$Q.get_$4().$1k(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions");return false}}var f,g,a,c=0;this.$1da=this.$4Q5(this.$Ep,this.$8b);var j,k;this.$3ID(false,j={val:f},k={val:g}),f=j.val,g=k.val;var b=this.$Ep.$HL.$pV(),l,m;if(!(m=this.$3Qh(b,f,l={val:a}),a=l.val,m))return false;var n,o;if((this.$8b.$9y===2||this.$8b.$9y===3)&&!(o=this.$3Qh(b,g,n={val:c}),c=n.val,o))return false;if(this.$8b.$9y===2||this.$8b.$9y===3){this.$1Vo(b,c);this.$1Vo(b,a-1);for(var i=c-1;i>=a;i--)b.$Kp(i);Diag.$Q.get_$4().$1k(4019726,1,3,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",c-a-1,a)}if(this.$8b.$9y===1||this.$8b.$9y===3){var d=this.$8b.get_$2o8();if(e)d=this.$4HW(b,a,c);this.$1Vo(b,a-1);this.$1Vo(b,a);this.$1Vo(d,0);this.$1Vo(d,d.get_$N()-1);b.$SO(a,d);Diag.$Q.get_$4().$1k(4019727,1,3,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",a,e,d.$Ap(" "))}this.$1eL=b;this.$6z.$2M.$EJ.get_$5(Box4.$4O.$Mc)&&WordEditor.GraphMerge.$2t.$3LL(this.$6z,this.$6Z);return true},$1Vo:function(c,a){if(a<0||a>=c.get_$N())return;var b=c.get_$5(a);if(WordEditor.GraphMerge.$WL.isInstanceOfType(b))b.$kX=true},$39y:function(g,a,h,c){h.val=g;c.val=a;if(!this.$8F())return false;if(this.$8b.$2oU(this.$Ep)){this.$1TL();return false}if(!this.$8b.$9y||this.$8b.$9y===3&&this.$8b.$5NN()){c.val=a;return true}var b,f,d,e;this.$3ID(true,d={val:b},e={val:f}),b=d.val,f=e.val;if(a<b||a===b&&(this.$8b.$9y!==1||this.$8b.$9y===1&&this.$Ep.$9y===1&&a===this.$Ep.$E0+this.$Ep.$Y2))c.val=a;else{c.val=a+this.$8b.$Y2-this.$8b.$bZ;if(c.val<b)c.val=b}return true}};WordEditor.GraphMerge.$eM.$3na=function(a,b){this.$E=a;this.$1ST=b};WordEditor.GraphMerge.$eM.$3na.prototype={$E:null,$1ST:0};WordEditor.GraphMerge.$6v=function(a,b,c,d,e){this.$6z=a;this.$E4=b;this.$RP=c;this.$Rj=d;this.$lL=e||WordEditor.GraphMerge.$6v.$2n7()};WordEditor.GraphMerge.$6v.get_$3A=function(){return WordEditor.GraphMerge.$6v.$26||(WordEditor.GraphMerge.$6v.$26=Common.Utils.$8.get_$4().$2S(Box4.$2o))};WordEditor.GraphMerge.$6v.$2n7=function(){return function(a){return a===30||a===20||a===3||a===21||a===15||a===44||a===45?WordEditor.GraphMerge.$6v.get_$3A()?WordEditor.GraphMerge.$6v.get_$3A().$3S(a):false:false}};WordEditor.GraphMerge.$6v.prototype={$6z:null,$E4:null,$RP:null,$Rj:null,$lL:null,$4o9:function(){return!!this.$6z.$2M.$EJ.get_$5(Box4.$4O.$Mc)},$42r:function(){var a;if(this.$6z.$98.$4d===1||this.$6z.$98.$4d===2)a=21;else if(this.$6z.$98.$4d===4||this.$6z.$98.$4d===3)a=15;else if(this.$6z.$98.$4d===5)a=44;else if(this.$6z.$98.$4d===6)a=45;else return false;return this.$4o9()&&this.$lL(a)},$2Dy:function(a){return a?new WordEditor.GraphMerge.$eO(this.$6z,this.$E4,this.$RP,this.$Rj,WordEditor.GraphMerge.$6v.$2n7(),null,null):new WordEditor.GraphMerge.$eM(this.$6z,this.$E4,this.$RP,this.$Rj,WordEditor.GraphMerge.$6v.$2n7(),null)},$39N:function(d){var c=this.$42r(),a=this.$2Dy(c),b=a.$39N(d),e=c&&!b&&a.$16J;if(e){a=this.$2Dy(false);b=a.$39N(d)}return b},$39y:function(d,e,f,g){var c=this.$42r(),a=this.$2Dy(c),b=a.$39y(d,e,f,g),h=c&&!b&&a.$16J;if(h){if(this.$6z.$98.$Uh===2){var i=this.$Rj;this.$Rj=this.$RP;this.$RP=i;var j=this.$6z.$2M.$J4;this.$6z.$2M.$J4=this.$6z.$2M.$Kt;this.$6z.$2M.$Kt=j}a=this.$2Dy(false);b=a.$39y(d,e,f,g)}return b}};WordEditor.GraphMerge.$eO=function(a,e,f,g,k,l,m){this.$1b0=new(Common.Collections.$1E.$$(Box4.$D4))(null);this.$1Ak=new(Common.Collections.$1E.$$(Box4.$D4))(null);this.$6z=a;this.$E4=e;this.$Rj=g;this.$RP=f;this.$lL=k;this.$1ZD=new(Common.Collections.$4y.$$(Common.$C));for(var b=0;b<this.$E4.get_$N();b++)this.$1ZD.$F(this.$E4.get_$5(b).get_$E());this.$1xN=new(Common.Collections.$4y.$$(Common.$C));for(var c=0;c<this.$RP.get_$N();c++)this.$1xN.$F(this.$RP.get_$5(c).get_$E());this.$25j=new(Common.Collections.$4y.$$(Common.$C));for(var d=0;d<this.$Rj.get_$N();d++)this.$25j.$F(this.$Rj.get_$5(d).get_$E());this.$6Z=l||new Box4.$Ai;this.$10X=m||Box4.$B4.$10X;var h=WordEditor.GraphMerge.$2t.$1Rp(e),i=WordEditor.GraphMerge.$2t.$1Rp(f),j=WordEditor.GraphMerge.$2t.$1Rp(g);Diag.$Q.get_$4().$1k(17162306,1,3,"ParagraphMergeUsingHints: Merging [BaseRevisionId: {0}] [FavoredRevisionId: {1}] [UnfavoredRevisionId: {2}] [BaseObjects: {3}] [FavoredObjects: {4}] [UnfavoredObjects: {5}]",a.$2M.$1Ba.get_$E(),a.$2M.$2pl,a.$2M.$39i,h.$Ap(" "),i.$Ap(" "),j.$Ap(" "))};WordEditor.GraphMerge.$eO.prototype={$6z:null,$E4:null,$Rj:null,$RP:null,$1ZD:null,$25j:null,$1xN:null,$6Z:null,$kx:null,$lK:null,$hg:null,$IP:null,$lL:null,$10X:null,$A2:false,$16J:false,$5IG:function(){var a=true;if(this.$6z.$2M.$Kt.$30(Box4.$4O.$Mc)){var f=this.$6z.$2M.$Kt.get_$5(Box4.$4O.$Mc),b,c;a=this.$432(f,"favored")&&(c=this.$3dz(f,this.$1ZD,this.$1xN,this.$6z.$2M.$Kt,"favored",b={val:this.$1b0}),this.$1b0=b.val,c)}if(a&&this.$6z.$2M.$J4.$30(Box4.$4O.$Mc)){var g=this.$6z.$2M.$J4.get_$5(Box4.$4O.$Mc),d,e;a=this.$432(g,"unfavored")&&(e=this.$3dz(g,this.$1ZD,this.$25j,this.$6z.$2M.$J4,"unfavored",d={val:this.$1Ak}),this.$1Ak=d.val,e)}return a},$432:function(c,d){var b=this.$6Z.$oA(c,Box4.AppProperties.$1.$VE),a=Common.$C.$7r(b);if(!this.$6z.$2M.$1Ba.get_$E().$w(a)){Diag.$Q.get_$4().$1k(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintContainerBaseId: {1}] [RevisionType: {2}]",this.$6z.$2M.$1Ba.get_$E(),a,d);return false}return true},$3dz:function(j,k,l,h,e,i){i.val=new(Common.Collections.$1E.$$(Box4.$D4))(null);for(var a=this.$6Z.$8E(j,Box4.AppProperties.$1.$Nh).$pV(),f="",b=0;b<a.get_$N();b++){if(!h.$30(a.get_$5(b))){Diag.$Q.get_$4().$1k(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",a.get_$5(b),e);return false}var c=h.get_$5(a.get_$5(b)),g=this.$6Z.$3aV(c,Box4.AppProperties.$1.$Xs);if(k.$4V(g)||l.$4V(g)){var d=this.$10X.$2EV(c);if(!d){Diag.$Q.get_$4().$1k(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",c.get_$E(),e);return false}i.val.$F(d);f+=" {"+d.$Ap()+"}"}}a.get_$N()>0&&Diag.$Q.get_$4().$1k(17162308,1,4,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",e,a.$Ap(" "),f);return true},$5Hz:function(){var h,i,j,a,b,c,d,e,f,g;return!(g=WordEditor.GraphMerge.$2t.$3Lm(this.$6z,this.$6Z,this.$E4,this.$RP,this.$Rj,true,a={val:this.$kx},b={val:this.$lK},c={val:this.$hg},d={val:h},e={val:i},f={val:j}),this.$kx=a.val,this.$lK=b.val,this.$hg=c.val,h=d.val,i=e.val,j=f.val,g)?false:true},$5IE:function(){var c,a,b,e=this,d=(b=WordEditor.GraphMerge.$2t.$293(this.$6Z,function(a){return e.$6z.$2M.$EJ.get_$5(a)},this.$E4,1,true,a={val:c}),c=a.val,b);if(!d){Diag.$Q.get_$4().$1k(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived");return false}this.$IP=new WordEditor.GraphMerge.$A4(d);return true},$8F:function(){if(this.$A2)return false;this.$A2=true;return!this.$5IG()?false:!this.$5Hz()?false:!this.$5IE()?false:true},$3ZU:function(e){for(var d=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$eO.$30Q))(null),b="",c=0;c<e.get_$N();c++){var a=e.get_$5(c);if(a.$XD())b+=e.get_$5(c).get_$2b();else if(a.$3G===2){d.$F(new WordEditor.GraphMerge.$eO.$30Q(a.$6E,a.$3G,b,a.$4a));b=""}else if(a.$3G===4){d.$F(new WordEditor.GraphMerge.$eO.$30Q(a.$6E,a.$3G,null,null));b=""}}return d},$3Al:function(e,f,g){var a=this.$3ZU(f),c=this.$3ZU(e),d=true;if(a.get_$N()===c.get_$N())for(var b=0;b<a.get_$N();b++)if(!a.get_$5(b).$ST(c.get_$5(b))){d=false;break}!d&&Diag.$Q.get_$4().$1k(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",g,c.$Ap(" "),a.$Ap(" "));return d},$3Gd:function(o,e,f,p){p.val=new(Common.Collections.$1E.$$(Box4.$D4))(null);for(var b=true,c=0,a=null,g=0;g<this.$1b0.get_$N()&&b;g++){a=this.$1b0.get_$5(g);if(c<this.$1Ak.get_$N()&&a.get_$E()===this.$1Ak.get_$5(c).get_$E()){var n,i,j;b=(j=this.$IP.$3Ge(a,i={val:n}),n=i.val,j);c++}else b=this.$IP.$3Gf(a)}if(!b){Diag.$Q.get_$4().$1k(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}] [Type: {1}]",a.get_$E(),a.get_$19());return false}if(!this.$3Al(this.$IP.$3R,this.$lK,"Favored"))return false;if(o&&this.$6z.$98.$Uh===1&&!this.$IP.$4H5(e,f)){Diag.$Q.get_$4().$1k(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",e,f);return false}b=true;for(var m=new(Common.Collections.$1E.$$(Box4.$D4))(null),h=c;h<this.$1Ak.get_$N()&&b;h++){a=this.$1Ak.get_$5(h);var d,k,l;b=(l=this.$IP.$3Ge(a,k={val:d}),d=k.val,l);b&&d&&m.$F(d)}if(!b){Diag.$Q.get_$4().$1k(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",a.get_$E(),a.get_$19());return false}if(!this.$3Al(this.$IP.$9W,this.$hg,"Unfavored"))return false;if(o&&this.$6z.$98.$Uh===2&&!this.$IP.$4H4(e,f)){Diag.$Q.get_$4().$1k(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",e,f);return false}p.val=m;return true},$58r:function(o){var b=0,l=0,c=0,m=Common.$C.get_$1G();o.val=new(Common.Collections.$2d.$$(Common.$C,Common.Collections.$CO.$$(WordEditor.GraphMerge.$7p)));while(c<this.$IP.$9W.get_$N()){var a=this.$IP.$9W.get_$5(c);if(!m.$w(a.$6E)){b=0;m=a.$6E}if(a.$3G===5){l=b+a.get_$N();var d,e,f=WordEditor.GraphMerge.$2z.$3l(this.$hg),h,i,j,k;if(!(i=WordEditor.GraphMerge.$2z.$2OM(f,a.$6E,b,h={val:d}),d=h.val,i)||!(k=WordEditor.GraphMerge.$2z.$2OM(f,a.$6E,l,j={val:e}),e=j.val,k)){Diag.$Q.get_$4().$1k(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",a.$1IP);return false}for(var n=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),g=d;g<e;g++)n.$F(f.get_$5(g));o.val.set_$5(a.$1IP,n)}b+=a.get_$N();c++}return true},$4HE:function(g,h){h.val=null;var c,e,f;if(!(f=this.$58r(e={val:c}),c=e.val,f))return false;for(var a=new WordEditor.GraphMerge.$A4(WordEditor.GraphMerge.$2z.$3l(this.$lK)),d=0;d<g.get_$N();d++)if(!a.$3Gf(g.get_$5(d)))return false;for(var b=a.$3R.get_$N()-1;b>=0;b--)if(a.$3R.get_$5(b).$3G===5){var i=a.$3R.get_$5(b).$1IP;a.$3R.$Kp(b);a.$3R.$SO(b,c.get_$5(i))}if(!this.$3Al(this.$IP.$3R,a.$3R,"Merged"))return false;h.val=a.$3R;return true},$4Hb:function(c){var d,i,j;if(!(j=this.$IP.$4sj(WordEditor.GraphMerge.$2z.$3l(this.$hg),i={val:d}),d=i.val,j))return false;for(var f=0;f<d.get_$N();f++){var a=d.get_$5(f),b,e,k,l,m,n;if(!(l=WordEditor.GraphMerge.$2z.$2OM(c,a.$5z,a.$4e,k={val:b}),b=k.val,l)||!(n=WordEditor.GraphMerge.$2z.$2OM(c,a.$5z,a.$4e+a.$1tp.get_$N(),m={val:e}),e=m.val,n)){Diag.$Q.get_$4().$1k(17335386,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list");return false}for(var g=false,h=b;h<e&&!g;h++)g=!a.$2Ps.$Le.$w(c.get_$5(h).$Le);if(g)continue;for(var o=b;o<e;o++)c.$Kp(b);c.$B8(b,a.$1tp)}return true},$52u:function(f){f.val=new(Common.Collections.$1E.$$(Box4.$D4))(null);if(!this.$6z.$98.$1SL)return true;var a=this.$6z.$98.$Xn.$5w(),b=a.$uV(Box4.$4O.$Mc);if(!b){Diag.$Q.get_$4().$1k(17162309,1,2,"GetAlreadyMergedUpdateHintFromLastServerRevision: UpdateHintContainerNode not found in last server merged [RevisionId: {0}]",a.get_$E());return false}var g=this.$6Z.$oA(b,Box4.AppProperties.$1.$VE),d=Common.$C.$7r(g);if(a.get_$Rq()&&!d.$w(a.get_$Rq().get_$E())){Diag.$Q.get_$4().$1k(17162310,1,2,"GetAlreadyMergedUpdateHintFromLastServerRevision: Base revision ids do not match [UpdateHintContainerBaseId: {0}] [ServerMergedRevisionBaseId: {1}]",d,a.get_$Rq().get_$E());return false}for(var e=this.$6Z.$8E(b,Box4.AppProperties.$1.$Nh),c=0;c<e.get_$N();c++){var h=a.$uV(e.get_$5(c)),i=Box4.$B4.$10X.$2EV(h);f.val.$F(i)}return true},$5AO:function(b,e,m){m.val=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7m))(null);var c=new(Common.Collections.$1E.$$(Common.$C))(null);if(this.$6z.$2M.$Jx.$30(Box4.$4O.$Mc))e.val=this.$6z.$2M.$Jx.get_$5(Box4.$4O.$Mc);else e.val=WordEditor.GraphMerge.$2t.$5IF(this.$6z,this.$6Z);var d,h,i;if(!(i=this.$52u(h={val:d}),d=h.val,i))return false;for(var j=new(Common.Collections.$1E.$$(Common.$C))(null),a=0;a<b.get_$N();a++){if(d.get_$N()>a){if(!b.get_$5(a).$ST(d.get_$5(a))){Diag.$Q.get_$4().$1k(17162311,1,2,"GetPartialMergeResultForUpdateHintNodes: Update hint from last merged revision on server revision does not match [UpdateHintId: {0}]",b.get_$5(a).get_$E());return false}continue}if(this.$6z.$2M.$Jx.$30(b.get_$5(a).get_$E())){Diag.$Q.get_$4().$m(17044293,1,false,"[UpdateHint: {0}] is already in the merged object. Failing merge.",b.get_$5(a).get_$E());return false}j.$F(b.get_$5(a).get_$E());for(var k=b.get_$5(a).$2Dt(),l=new WordEditor.GraphMerge.$7m(k,true),o=k,p=o.$LK(),g=p,n=g.length,f=0;f<n;++f){var q=g[f];l.$NE(q)}m.val.$F(l)}c=this.$6Z.$8E(e.val.$8S,Box4.AppProperties.$1.$Nh);c.$SO(c.get_$N(),j);this.$6Z.$Sz(e.val.$8S,Box4.AppProperties.$1.$Nh,c);return true},$2td:function(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",a.name,a.message,a.stack)},$39N:function(l){l.val=null;var h,a,b,i;try{var d,e,f,g;i=(g=this.$65z(d={val:h},l,e={val:a},f={val:b}),h=d.val,a=e.val,b=f.val,g);if(i){this.$6z.$2M.$Jx.set_$5(a.$8S.get_$E(),a);for(var c=0;c<b.get_$N();c++){var k=b.get_$5(c);this.$6z.$2M.$Jx.set_$5(k.$8S.get_$E(),k)}var j=a.$8S,m=this.$6Z.$8E(j,Box4.AppProperties.$1.$Nh),n=this.$6Z.$oA(j,Box4.AppProperties.$1.$VE);Diag.$Q.get_$4().$1k(17162312,1,4,"ParagraphMergeUsingHints returned success [UpdateHintContainerNodeIds: {0}] [UpdateHintContainerBaseId: {1}]",m.$Ap(" "),n);return true}}catch(o){Diag.$Q.get_$4().$1k(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.$2td(o))}WordEditor.GraphMerge.$2t.$3LL(this.$6z,this.$6Z);this.$16J=true;if(this.$IP&&this.$IP.$YB)this.$16J=false;Diag.$Q.get_$4().$1k(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeConflict:{0}] [RetryMergeWithoutHints:{1}]",!!this.$IP&&this.$IP.$YB,this.$16J);this.$1TL();return false},$65z:function(m,j,k,l){j.val=null;k.val=null;l.val=null;var a=false;a=this.$8F();var c=null,e,f;a=a&&(f=this.$3Gd(false,Common.$C.get_$1G(),0,e={val:c}),c=e.val,f);var b=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),g,h;a=a&&(h=this.$4HE(c,g={val:b}),b=g.val,h);if(a)!this.$4Hb(b)&&Diag.$Q.get_$4().$1k(17162314,1,2,"TryDoMerge: Failed to apply unfavored formatting changes. We will let the merge succeed anyways");for(var i=new(Common.Collections.$1E.$$(Common.$C))(null),d=0;d<b.get_$N();d++)b.get_$5(d).$3G===2&&i.$F(b.get_$5(d).$6E);a=a&&WordEditor.GraphMerge.$2t.$3ZS(this.$6z,this.$6Z,this.$lL,b,i,j);a=a&&this.$5AO(c,k,l);m.val=!!this.$IP&&this.$IP.$YB;return a},$1TL:function(){var a=new(Common.Collections.$1E.$$(Common.$C))(null);WordEditor.GraphMerge.$2t.$1TK(this.$6z,this.$6Z,"BaseObjects_",this.$E4,a);WordEditor.GraphMerge.$2t.$1TK(this.$6z,this.$6Z,"FavoredObjects_",this.$RP,a);WordEditor.GraphMerge.$2t.$1TK(this.$6z,this.$6Z,"ConflictObjects_",this.$Rj,a)},$4M1:function(d,e){d.val=Common.$C.get_$1G();e.val=-1;for(var b=0,c=0;c<this.$IP.$3R.get_$N();c++){var a=this.$IP.$3R.get_$5(c);if(a.$XD())b+=a.get_$N();else if(a.$3G!==6)b=0;else{d.val=a.$6E;e.val=b;return true}}Diag.$Q.get_$4().$1k(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return false},$39y:function(g,h,b,c){c.val=h;b.val=g;try{var a=this.$8F(),f=null,d,e;a=a&&(e=this.$3Gd(true,g,h,d={val:f}),f=d.val,e);a=a&&this.$4M1(b,c);a&&Diag.$Q.get_$4().$1k(17409924,1,4,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",b.val,c.val);return a}catch(i){Diag.$Q.get_$4().$1k(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.$2td(i))}Diag.$Q.get_$4().$1k(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeConflict:{0}] [RetryMergeWithoutHints:{1}]",!!this.$IP&&this.$IP.$YB,this.$16J);this.$1TL();return false}};WordEditor.GraphMerge.$eO.$30Q=function(a,b,c,d){this.$1kw=a;this.$19=b;this.$2b=c;this.$3v=d};WordEditor.GraphMerge.$eO.$30Q.prototype={$1kw:null,$19:0,$2b:null,$3v:null,$ST:function(a){return a.$1kw.$w(this.$1kw)&&this.$19===a.$19&&this.$3v===a.$3v&&WordEditor.GraphMerge.$5u.$3Gt(this.$2b,a.$2b)},toString:function(){return String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.$1kw,this.$3v,this.$19)}};WordEditor.GraphMerge.$A4=function(a){this.$9W=a;this.$3R=WordEditor.GraphMerge.$2z.$3l(a);WordEditor.GraphMerge.$A4.$4QN(this.$9W,this.$3R)};WordEditor.GraphMerge.$A4.$3If=function(b,c,d){for(var a=d-1;a>=0;a--){if(!b.get_$5(a).$XD()&&b.get_$5(a).$3G!==6){Diag.$Q.get_$4().$m(17311187,1,b.get_$5(a).$3G===2||b.get_$5(a).$3G===4,"Found merge block of type "+b.get_$5(a).$3G);return}b.get_$5(a).$6E=c}};WordEditor.GraphMerge.$A4.$3f9=function(a){if(!a){Diag.$Q.get_$4().$1k(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints.");return true}return false};WordEditor.GraphMerge.$A4.$4QN=function(b,c){for(var a=0;a<b.get_$N();a++){b.get_$5(a).$E2=c.get_$5(a);c.get_$5(a).$E2=b.get_$5(a)}};WordEditor.GraphMerge.$A4.prototype={$9W:null,$3R:null,$YB:false,$3Gf:function(a){switch(a.get_$19()){case 1:return this.$4H7(a);case 2:return this.$4Gy(a);case 3:return this.$4HN(a);case 4:return this.$4HG(a);case 5:return this.$4Gr(a);case 6:return this.$4Gw(a);default:return false}},$3Ge:function(a,b){switch(a.get_$19()){case 1:return this.$4H6(a,b);case 2:return this.$4Gx(a,b);case 3:return this.$4HM(a,b);case 4:return this.$4HF(a,b);case 5:return this.$4Gq(a,b);case 6:return this.$4Gv(a,b);default:b.val=null;return false}},$4H7:function(a){var g,b,h,c,d,e,f;if(!(f=this.$wP(a.$5z,false,a.$4e,false,c={val:b},d={val:g},e={val:h}),b=c.val,g=d.val,h=e.val,f))return false;var i=new WordEditor.GraphMerge.$K4(2,a.$5z,a.$7G,a.$3Q);this.$3R.$B8(b,i);return true},$4Gy:function(a){var m,c,n,e,f,g,h;if(!(h=this.$wP(a.$5z,false,a.$4e,false,e={val:c},f={val:m},g={val:n}),c=e.val,m=f.val,n=g.val,h))return false;var o,d,p,i,j,k,l;if(!(l=this.$wP(a.$5z,false,a.$4e+a.$7G.length,false,i={val:d},j={val:o},k={val:p}),d=i.val,o=j.val,p=k.val,l))return false;for(var b=c;b<d;b++){this.$3R.get_$5(b).$E2.$E2=null;this.$3R.$Kp(b)}return true},$4HN:function(b){var a,g,h,c,d,e,f;if(!(f=this.$3Ys(b,false,c={val:a},d={val:g},e={val:h}),a=c.val,g=d.val,h=e.val,f))return false;this.$3R.$B8(a,new WordEditor.GraphMerge.$De(2,b.$9x,b.$bM));return true},$4HG:function(d){var a,b,c;if(!(c=this.$3Yt(d,this.$3R,"Derived",b={val:a}),a=b.val,c))return false;this.$3R.get_$5(a).$E2.$E2=null;this.$3R.$Kp(a);return true},$4Gr:function(f){var a,b,c,d,e;if(!(e=this.$3ZT(f,false,c={val:a},d={val:b}),a=c.val,b=d.val,e))return false;this.$3R.$B8(b,a);return true},$4Gw:function(d){var a,b,c;if(!(c=this.$3Yq(d,this.$3R,"Derived",b={val:a}),a=b.val,c))return false;this.$3R.get_$5(a).$E2.$E2=null;this.$3R.$Kp(a);return true},$4H5:function(h,j){var f,a,g,b,c,d,e;if(!(e=this.$wP(h,false,j,true,b={val:a},c={val:f},d={val:g}),a=b.val,f=c.val,g=d.val,e))return false;var i=new WordEditor.GraphMerge.$Jk(2,h);this.$3R.$B8(a,i);return true},$4H6:function(a,o){o.val=null;if(WordEditor.GraphMerge.$A4.$3f9(a.$7G.length))return false;var c,b,d,f,g,h,i;if(!(i=this.$wP(a.$5z,true,a.$4e,false,f={val:c},g={val:b},h={val:d}),c=f.val,b=g.val,d=h.val,i))return false;var e,j,k;k=WordEditor.GraphMerge.$2z.$1Wi(this.$3R,b,j={val:e}),e=j.val,k;var l=this.$3R.get_$5(e).$6E,m=new WordEditor.GraphMerge.$K4(4,a.$5z,a.$7G,a.$3Q),n=new WordEditor.GraphMerge.$K4(4,l,a.$7G,a.$3Q);this.$11C(m,n);this.$9W.$B8(c,m);this.$3R.$B8(b,n);o.val=new Box4.$Dw(l,d,a.$7G,a.$3Q);return true},$4Gx:function(a,v){v.val=null;if(WordEditor.GraphMerge.$A4.$3f9(a.$7G.length))return false;var d,c,e,k,l,m,n;if(!(n=this.$wP(a.$5z,true,a.$4e,false,k={val:d},l={val:c},m={val:e}),d=k.val,c=l.val,e=m.val,n))return false;var f,g,u,o,p,q,r;if(!(r=this.$wP(a.$5z,true,a.$4e+a.$7G.length,false,o={val:f},p={val:g},q={val:u}),f=o.val,g=p.val,u=q.val,r))return false;for(var h="",b=g-1;b>=c;b--){if(this.$3R.get_$5(b).$3G===6)continue;if(!this.$3R.get_$5(b).$E2){Diag.$Q.get_$4().$1k(17044294,1,2,"ApplyDeleteTextHintToBaseAndDerived: The range of merge blocks, that we are trying to delete in Base has new content in Derived");this.$YB=true;return false}h=this.$3R.get_$5(b).get_$2b()+h;this.$3R.$Kp(b)}for(var j=f-1;j>=d;j--)this.$9W.$Kp(j);var i,s,t;t=WordEditor.GraphMerge.$2z.$1Wi(this.$3R,c,s={val:i}),i=s.val,t;var w=this.$3R.get_$5(i).$6E;v.val=new Box4.$DZ(w,e,h,a.$3Q);return true},$4HM:function(d,v){v.val=null;var h,a,i,j,k,l,m;if(!(m=this.$3Ys(d,true,j={val:h},k={val:a},l={val:i}),h=j.val,a=k.val,i=l.val,m))return false;var b,n,o;if(!(o=WordEditor.GraphMerge.$2z.$1Wi(this.$3R,a,n={val:b}),b=n.val,o)){Diag.$Q.get_$4().$1k(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list.");return false}var w=this.$3R.get_$5(b).$6E,x=this.$3R.get_$5(b).$4a,c,e,f,g,p,q,r,s;this.$59F(d,b,p={val:c},q={val:e},r={val:f},s={val:g}),c=p.val,e=q.val,f=r.val,g=s.val;this.$3Id(this.$3R,c,e,g,a);var t=new WordEditor.GraphMerge.$De(4,d.$9x,d.$bM),u=new WordEditor.GraphMerge.$De(4,c,f);this.$11C(t,u);this.$9W.$B8(h,t);this.$3R.$B8(a,u);v.val=new Box4.$Fq(w,x,i,c,f,e,g,d.$3Q);return true},$4HF:function(k,z){z.val=null;var b,a,e,l,m;if(!(m=this.$3Yt(k,this.$9W,"Base",l={val:b}),b=l.val,m))return false;var n,o;if(!this.$9W.get_$5(b).$E2||!(o=WordEditor.GraphMerge.$2z.$2OJ(this.$3R,this.$9W.get_$5(b).$E2.$6E,0,n={val:a}),a=n.val,o)){Diag.$Q.get_$4().$1k(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one");this.$YB=true;return false}var p,q;if(!(q=WordEditor.GraphMerge.$2z.$1Wi(this.$3R,a+1,p={val:e}),e=p.val,q)){Diag.$Q.get_$4().$1k(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null");this.$YB=true;return false}var c,f,g,d,h,i,j,r,s,t,u,v,w;this.$552(k,a,e,r={val:c},s={val:d},t={val:f},u={val:h},v={val:g},w={val:i}),c=r.val,d=s.val,f=t.val,h=u.val,g=v.val,i=w.val;var x,y;if(!(y=WordEditor.GraphMerge.$2z.$66P(this.$3R,c,x={val:j}),j=x.val,y))return false;this.$3Ic(this.$3R,c,d,a);this.$3R.$Kp(a);this.$9W.$Kp(b);z.val=new Box4.$FT(f,h,j,g,i,c,d,k.$3Q);return true},$4Gq:function(b,n){n.val=null;var c,a,d,f,g,h;if(!(h=this.$3ZT(b,true,f={val:d},g={val:c}),d=f.val,c=g.val,h))return false;var i,j;if(!(j=this.$2Dd(this.$9W,this.$3R,c,true,i={val:a}),a=i.val,j)){Diag.$Q.get_$4().$1k(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list.");return false}if(a>0&&this.$3R.get_$5(a-1).$3G!==2){this.$YB=true;Diag.$Q.get_$4().$1k(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para");return false}var e=null,k,l;if(!(l=this.$3W8(a,k={val:e}),e=k.val,l))return false;var m=new WordEditor.GraphMerge.$De(4,b.$5z,b.$4a);this.$11C(d,m);this.$9W.$B8(c,d);this.$3R.$B8(a,m);n.val=new Box4.$Ej(b.$5z,b.$4a,e,b.$3Q);return true},$4Gv:function(d,k){k.val=null;var a,b,e,f;if(!(f=this.$3Yq(d,this.$9W,"Base",e={val:b}),b=e.val,f))return false;if(!this.$9W.get_$5(b).$E2||this.$9W.get_$5(b).$E2.$6E!==d.$5z){Diag.$Q.get_$4().$1k(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one");this.$YB=true;return false}var g,h;if(!(h=this.$2Dd(this.$9W,this.$3R,b,true,g={val:a}),a=g.val,h)){Diag.$Q.get_$4().$1k(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided");return false}if(a>0&&this.$3R.get_$5(a).$3G!==2){Diag.$Q.get_$4().$1k(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list");this.$YB=true;return false}var l=this.$3R.get_$5(a).$6E,m=this.$3R.get_$5(a).$4a;this.$3R.$Kp(a);this.$9W.$Kp(b);var c=null,i,j;j=this.$3W8(a,i={val:c}),c=i.val,j;a>0&&this.$3R.get_$5(a-1).$3G===6&&this.$5gL(a-1,c);k.val=new Box4.$Ew(l,m,c,d.$3Q);return true},$4H4:function(m,o){var b,a,j,d,e,f,g;if(!(g=this.$wP(m,true,o,true,d={val:b},e={val:a},f={val:j}),b=d.val,a=e.val,j=f.val,g))return false;var c,h,i;i=WordEditor.GraphMerge.$2z.$1Wi(this.$3R,a,h={val:c}),c=h.val,i;var n=this.$3R.get_$5(c).$6E,k=new WordEditor.GraphMerge.$Jk(4,m),l=new WordEditor.GraphMerge.$Jk(4,n);this.$11C(k,l);this.$9W.$B8(b,k);this.$3R.$B8(a,l);return true},$552:function(a,b,c,d,e,f,g,h,i){if(a.$q6.$w(a.$5z))d.val=this.$3R.get_$5(b).$6E;else d.val=this.$3R.get_$5(c).$6E;if(a.$q7===a.$4a)e.val=this.$3R.get_$5(b).$4a;else e.val=this.$3R.get_$5(c).$4a;f.val=this.$3R.get_$5(b).$6E;g.val=this.$3R.get_$5(b).$4a;h.val=this.$3R.get_$5(c).$6E;i.val=this.$3R.get_$5(c).$4a},$59F:function(a,b,e,f,g,h){var c=a.$5z.$w(a.$9x)?a.$PF:a.$9x,d=a.$4a===a.$bM?a.$Qv:a.$bM;if(a.$5z.$w(a.$9x)){e.val=this.$3R.get_$5(b).$6E;f.val=c}else{e.val=c;f.val=this.$3R.get_$5(b).$6E}if(a.$4a===a.$bM){g.val=this.$3R.get_$5(b).$4a;h.val=d}else{g.val=d;h.val=this.$3R.get_$5(b).$4a}},$3Ie:function(b,d,e,f){for(var a=f;a<b.get_$N();a++){if(!b.get_$5(a).$XD()&&b.get_$5(a).$3G!==6&&b.get_$5(a).$3G!==2){Diag.$Q.get_$4().$m(17311188,1,false,"Found merge block of type "+b.get_$5(a).$3G);return}b.get_$5(a).$6E=d;if(b.get_$5(a).$3G===2){var c=b.get_$5(a);c.$4a=e;return}}},$3Id:function(a,c,d,e,b){this.$3Ie(a,d,e,b);WordEditor.GraphMerge.$A4.$3If(a,c,b)},$3Ic:function(a,b,d,c){this.$3Ie(a,b,d,c+1);WordEditor.GraphMerge.$A4.$3If(a,b,c-1)},$3Yt:function(a,b,g,d){var c=-1;if(!WordEditor.GraphMerge.$2z.$2OJ(b,a.$5z,0,d)){Diag.$Q.get_$4().$1k(17342622,1,2,"GetIndicesForMergePara: Failed to find index in "+g+"GraphNodeId "+a.$5z);return false}var e,f;if(!(f=WordEditor.GraphMerge.$2z.$1Wi(b,d.val+1,e={val:c}),c=e.val,f)||!b.get_$5(c).$6E.$w(a.$PF)){Diag.$Q.get_$4().$1k(17342623,1,2,"GetIndicesForMergePara: Failed to find index in "+g);return false}this.$3Ic(b,a.$q6,a.$q7,d.val);return true},$3Ys:function(a,b,c,f,g){var d=b?this.$9W:this.$3R,e=b?"Base":"Derived";if(!this.$wP(a.$5z,b,a.$4e,false,c,f,g)){Diag.$Q.get_$4().$1k(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+e);return false}this.$3Id(d,a.$9x,a.$PF,a.$Qv,c.val);return true},$3Yq:function(g,d,e,f){f.val=-1;var a,b,c;if(!(c=WordEditor.GraphMerge.$2z.$1qm(d,g.$5z,b={val:a}),a=b.val,c)){Diag.$Q.get_$4().$1k(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+e);return false}if(d.get_$5(a).$3G!==2){Diag.$Q.get_$4().$1k(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+e);return false}f.val=a;return true},$5gL:function(a,c){var f=this.$3R.get_$5(a);if(c){var b,d,e;e=WordEditor.GraphMerge.$2z.$2OJ(this.$3R,c,0,d={val:b}),b=d.val,e;var g=f.$3l();g.$6E=c;this.$3R.$Kp(a);this.$3R.$B8(b,g)}else if(this.$3R.get_$N()>a&&(this.$3R.get_$5(a+1).$XD()||this.$3R.get_$5(a+1).$3G===2))f.$6E=this.$3R.get_$5(a+1).$6E},$3ZT:function(a,c,g,b){var d=c?this.$9W:this.$3R,e=c?4:2,f=c?"Base":"Derived";g.val=new WordEditor.GraphMerge.$De(e,a.$5z,a.$4a);if(a.$9x){if(!WordEditor.GraphMerge.$2z.$2OJ(d,a.$9x,0,b)){Diag.$Q.get_$4().$1k(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",a.$9x,f);return false}b.val=b.val+1}else b.val=0;return true},$3W8:function(b,c){c.val=null;var a=b-1;if(a===-1)return true;if(this.$3R.get_$5(a).$3G===6)a--;if(this.$3R.get_$5(a).$3G===2||this.$3R.get_$5(a).$3G===4){c.val=this.$3R.get_$5(a).$6E;return true}Diag.$Q.get_$4().$1k(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.$3R.get_$5(b-1).$3G);return false},$2Dd:function(c,e,a,i,b){var d=true;b.val=-1;if(a>c.get_$N()){Diag.$Q.get_$4().$1k(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds");return false}if(a<c.get_$N()){if(a>-1&&a<c.get_$N()&&!c.get_$5(a).$E2){d=false;for(var f=a+1;f<c.get_$N();f++)if(c.get_$5(f).$E2){a=f;d=true;break}}if(!d)return false;d=false;for(var g=0;c.get_$5(a)&&g<e.get_$N();g++)if(e.get_$5(g).$E2===c.get_$5(a)){b.val=g;d=true;break}if(!d)return false}else b.val=e.get_$N();if(b.val>0&&i&&!e.get_$5(b.val-1).$E2){for(var h=b.val-1;h>=0;h--)if(e.get_$5(h).$E2)break;b.val=h+1;if(e.get_$5(b.val).$3G===6)b.val++}return true},$wP:function(s,j,v,t,i,f,u){var c=this.$9W,b=this.$3R;if(!j){c=this.$3R;b=this.$9W}i.val=0;f.val=0;u.val=0;var a,e=false,g=0,k,l,m,n;if(!(n=WordEditor.GraphMerge.$2z.$40p(c,s,v,k={val:a},l={val:e},m={val:g}),a=k.val,e=l.val,g=m.val,n)){Diag.$Q.get_$4().$1k(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete");return false}if(a>=0&&a<c.get_$N()&&!c.get_$5(a).$E2&&e&&!t){Diag.$Q.get_$4().$1k(17044296,1,2,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge");this.$YB=true;return false}if(!c.get_$5(a).$E2&&e&&t){e=false;g=0}var d,o,p;if(!j&&!(p=WordEditor.GraphMerge.$2z.$1qm(b,s,o={val:d}),d=o.val,p)){i.val=a;return true}var q,r;if(!(r=this.$2Dd(c,b,a,j&&!e,q={val:d}),d=q.val,r)){Diag.$Q.get_$4().$1k(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist.");this.$YB=true;return false}if(e&&!(WordEditor.GraphMerge.$2z.$1Wj(c,a,g)&&WordEditor.GraphMerge.$2z.$1Wj(b,d,g))){Diag.$Q.get_$4().$m(17044297,1,false,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed");return false}i.val=a;f.val=d;if(e){this.$11C(c.get_$5(a),b.get_$5(d));this.$11C(c.get_$5(a+1),b.get_$5(d+1));i.val=a+1;f.val=d+1}if(f.val>=b.get_$N()){Diag.$Q.get_$4().$m(17311190,1,false,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+f.val+" secondaryList length was "+b.get_$N());return false}for(var h=0;h<f.val;h++){if(!b.get_$5(h).$6E.$w(b.get_$5(f.val).$6E))continue;u.val+=b.get_$5(h).get_$N()}return true},$11C:function(a,b){a.$E2=b;b.$E2=a},$5De:function(d,h,i){h.val=-1;i.val=-1;if(!d.$E2)return false;var b,c=0,g=false,e,f;if(!(f=WordEditor.GraphMerge.$2z.$1qm(this.$3R,d.$E2.$6E,e={val:b}),b=e.val,f))return false;for(var a=b;a<this.$3R.get_$N();a++){if(d.$E2===this.$3R.get_$5(a)){h.val=a;i.val=c;g=true;break}c=c+this.$3R.get_$5(a).get_$N()}return g},$4sj:function(c,o){o.val=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$A4.$3iX))(null);var b=0,a=0;while(b<c.get_$N()){if(a>=this.$9W.get_$N()){Diag.$Q.get_$4().$m(17335388,1,false,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range");return false}if(c.get_$5(b).get_$N()>this.$9W.get_$5(a).get_$N()){if(!WordEditor.GraphMerge.$2z.$1Wj(c,b,this.$9W.get_$5(a).get_$N())){Diag.$Q.get_$4().$1k(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",b,this.$9W.get_$5(a).get_$N());return false}}else if(c.get_$5(b).get_$N()<this.$9W.get_$5(a).get_$N()){var e=!!this.$9W.get_$5(a).$E2,d=0,h,i;if(e&&!(i=this.$2Dd(this.$9W,this.$3R,a,false,h={val:d}),d=h.val,i)){Diag.$Q.get_$4().$m(17335390,1,false,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",a);return false}if(!WordEditor.GraphMerge.$2z.$1Wj(this.$9W,a,c.get_$5(b).get_$N())||e&&!WordEditor.GraphMerge.$2z.$1Wj(this.$3R,d,c.get_$5(b).get_$N())){Diag.$Q.get_$4().$1k(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks");return false}if(e){this.$11C(this.$9W.get_$5(a),this.$3R.get_$5(d));this.$11C(this.$9W.get_$5(a+1),this.$3R.get_$5(d+1))}}if(this.$9W.get_$5(a).$E2&&this.$9W.get_$5(a).$3G!==5&&this.$9W.get_$5(a).$XD()){var m=this.$9W.get_$5(a),n=c.get_$5(b);if(!m.$Le.$w(n.$Le)){var f,g,j,k,l;if(!(l=this.$5De(this.$9W.get_$5(a),j={val:f},k={val:g}),f=j.val,g=k.val,l))return false;o.val.$F(new WordEditor.GraphMerge.$A4.$3iX(this.$3R.get_$5(f).$6E,g,m,n))}}b++;a++}return true}};WordEditor.GraphMerge.$A4.$3iX=function(a,b,c,d){this.$5z=a;this.$4e=b;this.$2Ps=c;this.$1tp=d};WordEditor.GraphMerge.$A4.$3iX.prototype={$5z:null,$4e:0,$2Ps:null,$1tp:null};WordEditor.GraphMerge.$2t=function(){};WordEditor.GraphMerge.$2t.$293=function(j,k,h,l,m,i){i.val="";for(var b=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),c=0;c<h.get_$N();c++){var d,a,g=WordEditor.GraphMerge.$TG.$54x(k,h.get_$5(c),l,m,j);if(!g)return null;var e,f;g.$58q_0(e={val:a},f={val:d}),a=e.val,d=f.val;if(!a)return null;i.val+=d;b.$SO(b.get_$N(),a)}return b};WordEditor.GraphMerge.$2t.$3Lm=function(a,b,j,k,l,c,d,e,f,i,g,h){d.val=null;e.val=null;f.val=null;i.val=null;g.val=null;h.val=null;d.val=WordEditor.GraphMerge.$2t.$293(b,function(b){return a.$2M.$EJ.get_$5(b)},j,1,c,i);if(!d.val){Diag.$Q.get_$4().$1k(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision");return false}e.val=WordEditor.GraphMerge.$2t.$293(b,function(b){return a.$2M.$Kt.get_$5(b)||a.$2M.$EJ.get_$5(b)},k,2,c,g);if(!e.val){Diag.$Q.get_$4().$1k(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision");return false}f.val=WordEditor.GraphMerge.$2t.$293(b,function(b){return a.$2M.$J4.get_$5(b)||a.$2M.$EJ.get_$5(b)},l,4,c,h);if(!f.val){Diag.$Q.get_$4().$1k(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision");return false}return true};WordEditor.GraphMerge.$2t.$4PO=function(f){var e=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7p))(null),b=0;while(b<f.get_$N()){var c=f.get_$5(b);if(c.$3G===1||c.$3G===4||c.$3G===2){e.$F(c);b++}else if(c.$3G===3){var a=c,g="";g+=a.$kL;b++;for(var i=a.$kX,h=false;b<f.get_$N();b++){var j=f.get_$5(b);if(j.$3G===3){var d=j;if(a.$Mh===d.$Mh&&a.$Le.$w(d.$Le)&&a.$fz===d.$fz&&a.$kS===d.$kS){g+=d.$kL;if(d.$kX)i=true}else h=true}else h=true;if(h){var k=new WordEditor.GraphMerge.$K1(null,a.$4d,a.$6E,a.$5z,a.$Mh,a.$Le,g,a.$fz,true,i,a.$kS);e.$F(k);break}}}}Diag.$Q.get_$4().$1k(17044302,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",e.$Ap(" "));return e};WordEditor.GraphMerge.$2t.$5xs=function(b,i,a,j,k,l,m,f,n,d,g,h){b.$1pq(a.$8S,Box4.AppProperties.$5.$9O,k);b.$3wJ(a.$8S,Box4.AppProperties.$1.$3v,j);b.$2Ma(a.$8S,Box4.AppProperties.$1.$Dw,l);b.$2Ma(a.$8S,Box4.AppProperties.$1.$Ei,m);b.$Sz(a.$8S,Box4.AppProperties.$5.$bB,n);b.$v(a.$8S,Box4.AppProperties.$1.$C1)&&b.$3wJ(a.$8S,Box4.AppProperties.$1.$C1,WordEditor.GraphMerge.$2t.$4um());for(var e=false,c=0;c<d.get_$N();c++)if(d.get_$5(c)){e=true;break}e&&b.$36X(a.$8S,Box4.AppProperties.$1.$jW,d);i(30)&&WordEditor.GraphMerge.$2t.$4Lx(b,a,g,h);a.$NE(Box4.AppProperties.$5.$9O);a.$NE(Box4.AppProperties.$1.$3v);a.$NE(Box4.AppProperties.$1.$Dw);a.$NE(Box4.AppProperties.$1.$Ei);a.$NE(Box4.AppProperties.$5.$bB);a.$NE(Box4.AppProperties.$1.$jW);a.$NE(Box4.AppProperties.$5.$fh);a.$NE(Box4.AppProperties.$5.$fc);a.$NE(Box4.AppProperties.$5.$ao);b.$v(a.$8S,Box4.AppProperties.$1.$C1)&&a.$NE(Box4.AppProperties.$1.$C1);if(f.get_$N()>0)b.$2Ma(a.$8S,Box4.AppProperties.$5.$fh,f);else a.$8S.$4z(Box4.AppProperties.$5.$fh)};WordEditor.GraphMerge.$2t.$4Lx=function(h,b,c,i){for(var f=new(Common.Collections.$1E.$$(Boolean))(null),d=false,e=false,a=0;a<c.get_$N();a++){var g=i.get_$5(a)&&!c.get_$5(a);f.$F(g);d=!!(d|c.get_$5(a));e=!!(e|g)}if(d)h.$36X(b.$8S,Box4.AppProperties.$5.$ao,c);else b.$8S.$4z(Box4.AppProperties.$5.$ao);if(e)h.$36X(b.$8S,Box4.AppProperties.$5.$fc,f);else b.$8S.$4z(Box4.AppProperties.$5.$fc)};WordEditor.GraphMerge.$2t.$4um=function(){var a=0;a=Common.$1N.$Sj();return a};WordEditor.GraphMerge.$2t.$3Zo=function(a,b){return a.$2M.$Kt.$uX(b,a.$2M.$EJ.get_$5(b)||a.$2M.$J4.$BQ(b))};WordEditor.GraphMerge.$2t.$3ZS=function(w,C,D,q,r,s){s.val=new(Common.Collections.$1E.$$(WordEditor.GraphMerge.$7m))(null);var d=WordEditor.GraphMerge.$2t.$4PO(q),l=0,m="",e=new(Common.Collections.$1E.$$(Number))(null),f=new(Common.Collections.$1E.$$(Number))(null),b=new(Common.Collections.$1E.$$(Number))(null),g=new(Common.Collections.$1E.$$(Common.$C))(null),j=new(Common.Collections.$1E.$$(Boolean))(null),h=new(Common.Collections.$1E.$$(Boolean))(null),i=new(Common.Collections.$1E.$$(Boolean))(null),n=d.get_$5(d.get_$N()-1);if(!(n.$3G===2||n.$3G===4)){Diag.$Q.get_$4().$1k(17044304,1,2,"GetMergableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",n.$3G);return false}for(var o=0,k=0;k<d.get_$N();k++){var c=d.get_$5(k),a=null;if(c.$3G===1||c.$3G===3){a=c;m+=a.get_$2b()}else if(c.$3G===4){var x=c.$6E,y=WordEditor.GraphMerge.$2t.$3Zo(w,x),z=new WordEditor.GraphMerge.$7m(y,true);s.val.$F(z);continue}if(a){e.$F(a.$Mh);f.$F(a.$5z);o+=a.get_$2b().length;b.$F(o);g.$F(a.$Le);j.$F(a.$fz);h.$F(a.$kX);i.$F(a.$kS)}else if(!e.get_$N()){e.$F(0);f.$F(0);b.$F(0);g.$F(Common.$C.get_$1G());j.$F(false);h.$F(false);i.$F(false)}if(c.$3G===2){var p=c,A=p.$4a;b.$Kp(b.get_$N()-1);var t=r.get_$5(l);if(!t){Diag.$Q.get_$4().$1k(17044307,1,2,"GetMergableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",l,r.get_$N(),q.get_$N(),k,d.get_$N());Diag.$Q.get_$4().$bF(17044308,1,3,"GetMergableObjectsFromMergeBlocks Paragraphs",r.$Ap(" "));Diag.$Q.get_$4().$bF(17044309,1,3,"GetMergableObjectsFromMergeBlocks MergeBlocks",q.$Ap(" "));Diag.$Q.get_$4().$bF(17044310,1,3,"GetMergableObjectsFromMergeBlocks CombinedMergeBlocks",d.$Ap(" "));return false}var u=WordEditor.GraphMerge.$2t.$3Zo(w,t);if(u){var v=new WordEditor.GraphMerge.$7m(u.$OS(),true);WordEditor.GraphMerge.$2t.$5xs(C,D,v,p.$4a,m,e,f,b,g,j,h,i);s.val.$F(v)}var B="";Diag.$Q.get_$4().$1k(17044312,1,3,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [FormattingIds: {7}] {8}",p.$6E,A,e.$Ap(" "),f.$Ap(" "),b.$Ap(" "),h.$Ap(" "),i.$Ap(" "),g.$Ap(" "),B);l++;m="";e=new(Common.Collections.$1E.$$(Number))(null);f=new(Common.Collections.$1E.$$(Number))(null);b=new(Common.Collections.$1E.$$(Number))(null);g=new(Common.Collections.$1E.$$(Common.$C))(null);j=new(Common.Collections.$1E.$$(Boolean))(null);h=new(Common.Collections.$1E.$$(Boolean))(null);i=new(Common.Collections.$1E.$$(Boolean))(null);o=0}}return true};WordEditor.GraphMerge.$2t.$3LL=function(b,d){var a,e=false;if(b.$2M.$Jx.$30(Box4.$4O.$Mc)){a=b.$2M.$Jx.get_$5(Box4.$4O.$Mc);for(var f=d.$8E(a.$8S,Box4.AppProperties.$1.$Nh),c=0;c<f.get_$N();c++)b.$2M.$Jx.$73(f.get_$5(c))}else{a=new WordEditor.GraphMerge.$7m(b.$2M.$EJ.get_$5(Box4.$4O.$Mc).$OS(),true);e=true}d.$Sz(a.$8S,Box4.AppProperties.$1.$Nh,new(Common.Collections.$1E.$$(Common.$C))(null));d.$1pq(a.$8S,Box4.AppProperties.$1.$VE,Common.$C.get_$1G().toString());if(e){a.$NE(Box4.AppProperties.$1.$Nh);a.$NE(Box4.AppProperties.$1.$VE);b.$2M.$Jx.set_$5(Box4.$4O.$Mc,a)}};WordEditor.GraphMerge.$2t.$5IF=function(b,c){if(b.$2M.$Jx.$30(Box4.$4O.$Mc))return null;var a=new WordEditor.GraphMerge.$7m(b.$2M.$EJ.get_$5(Box4.$4O.$Mc).$OS(),true);c.$1pq(a.$8S,Box4.AppProperties.$1.$VE,b.$DO.$Na.$5w().get_$E().toString());c.$Sz(a.$8S,Box4.AppProperties.$1.$Nh,new(Common.Collections.$1E.$$(Common.$C))(null));a.$NE(Box4.AppProperties.$1.$Nh);a.$NE(Box4.AppProperties.$1.$VE);b.$2M.$Jx.set_$5(Box4.$4O.$Mc,a);return a};WordEditor.GraphMerge.$2t.$1Rp=function(b){var a=new(Common.Collections.$1E.$$(Common.$C))(null);b.$2m(function(b){a.$F(b.get_$E());return true});return a};WordEditor.GraphMerge.$2t.$1TK=function(d,a,e,f,g){var b=d.$2M.$Wp,c=0;f.$2m(function(d){WordEditor.GraphMerge.$7Z.$oi(b,d,e+c++,a,1);if(d.get_$48()===393230){var f=a.$8E(d,Box4.AppProperties.$5.$bB);f.$2m(function(a){g.$F(a);return true})}return true})};WordEditor.GraphMerge.$2t.$5S3=function(b,d,f){var c=b.$2M.$Wp,e=new(Common.Collections.$4y.$$(Common.$C)),a=0;f.$2m(function(f){if(e.$4V(f))return true;e.$F(f);var g,h;if(h=WordEditor.GraphMerge.$2t.$2zS(d,c,"BaseFormatting_",g={val:a},f,function(a){return b.$2M.$EJ.get_$5(a)}),a=g.val,h)return true;var i,j;if(j=WordEditor.GraphMerge.$2t.$2zS(d,c,"FavoredFormatting_",i={val:a},f,function(a){return b.$2M.$Kt.get_$5(a)}),a=i.val,j)return true;var k,l;if(l=WordEditor.GraphMerge.$2t.$2zS(d,c,"ConflictingFormatting_",k={val:a},f,function(a){return b.$2M.$J4.get_$5(a)}),a=k.val,l)return true;a++;return true})};WordEditor.GraphMerge.$2t.$2zS=function(c,d,e,b,f,g){var a=g(f);if(a){WordEditor.GraphMerge.$7Z.$oi(d,a,e+b.val,c,1);if(a.get_$48()===1179649){b.val++;return true}}return false};WordEditor.GraphMerge.$eU=function(a,b,c){this.$16B=a;this.$AI=b;this.$TF=c;this.$1YM=true};WordEditor.GraphMerge.$eU.prototype={$16B:null,$AI:null,$TF:null,$1YM:false,$5AK:function(){Diag.$Q.get_$4().$1k(4220310,1,4,"Evaluating ParentObjects");var a=new(Common.Collections.$2d.$$(Common.$C,Common.$C)),d=this;this.$2kq(a,function(a){return d.$16B.$2M.$EJ.get_$5(a)});var b=this;this.$2kq(a,function(a){return b.$TF.$15T(a,b.$16B.$2M.$Kt,b.$16B.$2M.$EJ)});var c=this;this.$2kq(a,function(a){return c.$TF.$15T(a,c.$16B.$2M.$J4,c.$16B.$2M.$EJ)});return a},$2kq:function(a,c){var d=c(WordEditor.GraphMerge.$AU.$3nL),e=this.$AI.$8E(d,Box4.AppProperties.$5.$6r),b=this;e.$2m(function(d){var e=b.$AI.$8E(c(d),Box4.AppProperties.$5.$6r);e.$2m(function(c){if(a.$30(c)&&!d.$w(a.get_$5(c))){b.$1YM=false;Diag.$Q.get_$4().$1k(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",c,d,a.get_$5(c))}a.set_$5(c,d);return true});return true})}};WordEditor.GraphMerge.$EG=function(a,b,c){this.$$d_$4NY=Function.createDelegate(this,this.$4NY);this.$2Sh=a;this.$1Hn=b;this.$q8=c;this.$1L3=new($$sc.$x.$$(Boolean))(this.$$d_$4NY)};WordEditor.GraphMerge.$EG.prototype={$2Sh:null,$1Hn:null,$q8:null,get_$2Fq:function(){return!!this.$q8&&!this.$1Hn},get_$1Sg:function(){return!this.$q8&&!!this.$1Hn},$1L3:null,get_$UR:function(){return this.get_$2Fq()||this.get_$1Sg()||this.$1L3.get_$Q()},$4NY:function(){return this.get_$2Fq()||this.get_$1Sg()?true:!Common.$i.$3Gu(this.$2Sh,this.$1Hn,this.$q8)}};WordEditor.GraphMerge.$TI=function(){this.$98=new WordEditor.GraphMerge.$TI.$5JE;this.$2M=new WordEditor.GraphMerge.$TI.$5rB;this.$DO=new WordEditor.GraphMerge.$TI.$5ds};WordEditor.GraphMerge.$TI.prototype={$98:null,$2M:null,$DO:null};WordEditor.GraphMerge.$TI.$5JE=function(){};WordEditor.GraphMerge.$TI.$5JE.prototype={$4d:0,$Xn:null,$pr:null,$6m:null,$Uh:0,$1SL:false,$1GL:0};WordEditor.GraphMerge.$TI.$5rB=function(){};WordEditor.GraphMerge.$TI.$5rB.prototype={$1GF:false,$1px:false,$Wp:false,$1Ba:null,$2pl:null,$39i:null,$EJ:null,$Kt:null,$J4:null,$Jx:null,$3Q1:null,$2OO:null,$vU:null,$Qm:null,$115:null};WordEditor.GraphMerge.$TI.$5ds=function(){};WordEditor.GraphMerge.$TI.$5ds.prototype={$11L:false,$V7:false,$1qg:false,$Na:null};WordEditor.GraphMerge.$7m=function(a,b){this.$8S=b?a.$OS():a;this.$1Ai=new(Common.Collections.$4y.$$(Number))};WordEditor.GraphMerge.$7m.prototype={$8S:null,$1Ai:null,$NE:function(a){this.$1Ai.$F(Common.$i.$2L(a))},$3bh:function(){return this.$1Ai},$5yq:function(a){this.$1Ai=a},$3ic:function(c){var b=new WordEditor.GraphMerge.$CT(this.$8S,c),a=this;b.get_$vl().$2m(function(b,c){if(c.get_$UR()&&!a.$1Ai.$4V(b)){a.$1Ai.$F(b);if(c.get_$1Sg()){var d=a.$8S;d.$v(Common.$i.$1Qh(b))&&d.$4z(Common.$i.$1Qh(b))}else a.$8S.$1Vz(Common.$i.$1Qh(b),c.$q8)}return true})}};WordEditor.GraphMerge.$L1=function(){WordEditor.GraphMerge.$L1.initializeBase(this)};WordEditor.GraphMerge.$L1.$Jh=function(d,e,f,g,h,b,c,i,j){var a=new WordEditor.GraphMerge.$L1;a.BaseRevisions=d;a.TheirRevisions=e;a.YourRevisions=f;a.IgnoreConflictsInLastServerRevision=g;a.MergeHint=h;a.ObjectSpaceId=!b?null:Box4.$1t.$5B(b);a.RequestId=!c?null:Box4.$1t.$5B(c);a.Source=i;a.Reason=j;return a};WordEditor.GraphMerge.$L1.prototype={BaseRevisions:null,MergedRevision:null,TheirRevisions:null,YourRevisions:null,IgnoreConflictsInLastServerRevision:false,MergeHint:0,ObjectSpaceId:null,RequestId:null,Source:0,Reason:0,$12a:function(){return 33}};WordEditor.GraphMerge.$aS=function(){};WordEditor.GraphMerge.$aS.prototype={get_$5j:function(){return"WordEditor.GraphMerge"},$t9:function(){},$7Y:function(){if(!Box4.App.$LZ)Box4.App.$LZ=Box4.$GF.$Bo();var a=new WordEditor.GraphMerge.$jH;a.$3F();Box4.App.$LZ.$4Is(a)},$d:function(){}};WordEditor.GraphMerge.$Qp=function(a,b,c){this.$$d_$4oP=Function.createDelegate(this,this.$4oP);this.$JV=a;this.$E4=a.$EJ;this.$lw=a.$391;this.$rc=a.$3BA;this.$2cK=a.$2zM;this.$6Z=b||new Box4.$Ai;this.$2eN=c||this.$$d_$4oP};WordEditor.GraphMerge.$Qp.prototype={$JV:null,$E4:null,$lw:null,$rc:null,$6Z:null,$2cK:false,$2eN:null,$2oW:function(c){for(var b=new(Common.Collections.$1E.$$(Box4.$HW))(null),a=0;a<c.get_$N();a++){var d=this.$4oM(c.get_$5(a));b.$F(d)}return b},$2oV:function(b,h,i){var a=b,g=b.$9v===b.$BP&&b.$jz===b.$iJ;if(h){var c,d;this.$2Oi(b.$9v,b.$jz,c={val:a.$9v},d={val:a.$jz}),a.$9v=c.val,a.$jz=d.val;if(g){a.$BP=a.$9v;a.$iJ=a.$jz}}if(i&&!g){var e,f;this.$2Oi(b.$BP,b.$iJ,e={val:a.$BP},f={val:a.$iJ}),a.$BP=e.val,a.$iJ=f.val}return a},$4oM:function(a){if(a.$9v===a.$BP){var d=new(Common.Collections.$1E.$$(Number))(null),b,c;d.$F(a.$jz);d.$F(a.$iJ);var i,j;this.$3AI(a.$9v,d,i={val:b},j={val:c}),b=i.val,c=j.val;return new Box4.$HW(b,c.get_$5(0),b,c.get_$5(1))}else{var o=new(Common.Collections.$1E.$$(Number))(null),p=new(Common.Collections.$1E.$$(Number))(null),e,f,g,h;o.$F(a.$jz);var k,l;this.$3AI(a.$9v,o,k={val:e},l={val:g}),e=k.val,g=l.val;p.$F(a.$iJ);var m,n;this.$3AI(a.$BP,p,m={val:f},n={val:h}),f=m.val,h=n.val;return new Box4.$HW(e,g.get_$5(0),f,h.get_$5(0))}},$3AI:function(a,b,f,c){f.val=a;c.val=b;var h=this.$E4.get_$5(a);if(!h){Diag.$2.$9(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",a);return}if(this.$lw.$BQ(a))this.$2eN(a,b,f,c);else if(this.$JV.$1lN&&!this.$JV.$1lN.get_$5(this.$JV.$1lN.get_$N()-1).$aY(a)){c.val=new(Common.Collections.$1E.$$(Number))(null);for(var d=0;d<b.get_$N();d++){var e,g;this.$2Oi(a,b.get_$5(d),f,g={val:e}),e=g.val;c.val.$F(e)}}},$3ZO:function(b){var a="",c=this;b.$2m(function(b){a+=b.$40F(true);a+=" ";return true});return a},$4oP:function(b,g,j,k){j.val=b;k.val=g;var n=this.$lw.$BQ(b);if(!n)return;var h=new(Common.Collections.$1E.$$(Box4.$5r))(null);h.$F(n);var q=this.$rc.$BQ(b)||this.$E4.get_$5(b),i=new(Common.Collections.$1E.$$(Box4.$5r))(null);i.$F(q);var o=new(Common.Collections.$1E.$$(Box4.$5r))(null);o.$F(this.$E4.get_$5(b));var c,d,a=new WordEditor.GraphMerge.$TI;a.$98.$4d=6;a.$98.$Uh=this.$JV.$Uh;a.$2M.$EJ=this.$E4;var p=Common.Utils.$8.get_$4().$2S(Box4.$2o),r=p?p.$3S(45):false;if(a.$98.$Uh===1||!r){c=i;d=h;a.$2M.$Kt=this.$rc;a.$2M.$J4=this.$lw}else{c=h;d=i;a.$2M.$Kt=this.$lw;a.$2M.$J4=this.$rc}Diag.$2.$9(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [Favored: {2}] [Unfavored: {3}]",this.$JV.$2Em,this.$JV.$Uh,this.$3ZO(c),this.$3ZO(d));a.$2M.$1Ba=this.$JV.$2m5;var s=new WordEditor.GraphMerge.$6v(a,o,c,d,null);k.val=new(Common.Collections.$1E.$$(Number))(null);for(var e=0;e<g.get_$N();e++){this.$JV.$Qm("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");var f,l,m,t=(m=s.$39y(b,g.get_$5(e),j,l={val:f}),f=l.val,m);k.val.$F(f);if(t)Diag.$2.$9(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",b,g.get_$5(e),j.val,f);else Diag.$2.$9(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",b)}},$5AA:function(b,d,c){c.val=0;for(var a=0;a<b.get_$N();a++)if(d.$w(b.get_$5(a))){c.val=a;return true}return false},$2Oi:function(c,l,m,n){var e=this.$2cK&&!!this.$rc.get_$5(c)&&!this.$E4.get_$5(c),j;j=e?this.$rc:this.$lw;var b=c,d=l,f=false,k=false,a=this;j.$2m(function(h,q){a.$JV.$Qm("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(a.$2xw(q.get_$48()))if(a.$E4.get_$5(h)){var g=null,m;if(e){g=a.$1kg(function(b){return a.$rc.get_$5(b)||a.$E4.get_$5(b)},h);m=a.$2GV(g,c)}else{var r=a.$1kg(function(b){return a.$E4.get_$5(b)},h);m=a.$2GV(r,c)}if(m){k=true;if(!g)g=a.$1kg(function(b){return a.$rc.get_$5(b)||a.$E4.get_$5(b)},h);var p=a.$1kg(function(b){return a.$lw.get_$5(b)||a.$E4.get_$5(b)},h),i=0,n,o;if(o=a.$5AA(g,c,n={val:i}),i=n.val,o){for(var j=i+1;j<g.get_$N();j++)if(a.$2GV(p,g.get_$5(j))){d=0;b=g.get_$5(j);f=true;return false}for(var l=i-1;l>=0;l--)if(a.$2GV(p,g.get_$5(l))){d=Number.MAX_VALUE;b=g.get_$5(l);f=true;return false}}}}return true});if(!f){Diag.$2.$9(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",c,l,e,k);if(this.$JV.$2Em===5){Diag.$2.$9(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",b);var g,h,i;if(i=this.$56U(h={val:g}),g=h.val,i){b=g;d=0;Diag.$2.$9(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",b)}else Diag.$2.$9(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",b)}}m.val=b;n.val=d},$56U:function(c){c.val=Common.$C.get_$1G();var b=new(Common.Collections.$1E.$$(Common.$C))(null),a=this;this.$lw.$2m(function(c,d){a.$JV.$Qm("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(a.$2xw(d.get_$48())){b=a.$1kg(function(b){return a.$lw.get_$5(b)||a.$E4.get_$5(b)},c);return false}return true});if(b.get_$N()>0){c.val=b.get_$5(0);return true}return false},$2xw:function(a){return a===393241||a===393250||a===393251||a===393252},$1kg:function(f,g){var c=f(g),a=new(Common.Collections.$1E.$$(Common.$C))(null);if(!this.$2xw(c.get_$48()))return a;for(var d=this.$6Z.$8E(c,Box4.AppProperties.$5.$6r),b=0;b<d.get_$N();b++){var e=new(Common.Collections.$1E.$$(Common.$C))(null);this.$2uY(f,d.get_$5(b),e);a.$SO(a.get_$N(),e)}return a},$2uY:function(c,f,d){var a=c(f);if(!a)return;if(a.get_$48()===393230){d.$F(f);return}else if(a.get_$48()===393229){var g=this.$6Z.$8E(a,Box4.AppProperties.$5.$1hG).$4W(0);this.$2uY(c,g,d);return}else if(a.get_$48()===393250||a.get_$48()===393251||a.get_$48()===393252){for(var e=this.$6Z.$8E(a,Box4.AppProperties.$5.$6r),b=0;b<e.get_$N();b++)this.$2uY(c,e.get_$5(b),d);return}},$2GV:function(b,c){for(var a=0;a<b.get_$N();a++)if(c.$w(b.get_$5(a)))return true;return false}};WordEditor.GraphMerge.$NY=function(){WordEditor.GraphMerge.$NY.initializeBase(this)};WordEditor.GraphMerge.$NY.$Jh=function(b){var a=new WordEditor.GraphMerge.$NY;a.Location=b;return a};WordEditor.GraphMerge.$NY.prototype={Location:null,$12a:function(){return 34}};WordEditor.GraphMerge.$qL=function(){};WordEditor.GraphMerge.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.GraphMerge.$aS)};WordEditor.GraphMerge.$jH=function(){this.$$d_$5t5=Function.createDelegate(this,this.$5t5);WordEditor.GraphMerge.$jH.initializeBase(this,[null,null,null,null,null,null,-1,false])};WordEditor.GraphMerge.$jH.prototype={$3xJ:function(){return false},$3F:function(){Common.$0.get_$r().$P(1742610028,1,this.$$d_$5t5)},$5t5:function(e,f,g,h,d){var c=WordEditor.GraphMerge.$NY.$Jh(d,false),a=new Box4.$Bm;a.set_$MV(c);a.$3I=1;var b=new Box4.$Cn(1,null);b.$Rm(a);b.$tP();return 32},$3M6:function(a,b){return new Box4.$Tn(a,b,null)},get_$3N6:function(){return null}};WordEditor.GraphMerge.$4R.registerClass("WordEditor.GraphMerge.$4R",null,WordEditor.GraphMerge.$l2);WordEditor.GraphMerge.$AM.registerClass("WordEditor.GraphMerge.$AM",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$AN.registerClass("WordEditor.GraphMerge.$AN",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$AO.registerClass("WordEditor.GraphMerge.$AO",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$AP.registerClass("WordEditor.GraphMerge.$AP",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$AQ.registerClass("WordEditor.GraphMerge.$AQ",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$AQ.$3dR.registerClass("WordEditor.GraphMerge.$AQ.$3dR");WordEditor.GraphMerge.$AW.registerClass("WordEditor.GraphMerge.$AW",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$AX.registerClass("WordEditor.GraphMerge.$AX",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$Ad.registerClass("WordEditor.GraphMerge.$Ad",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$Ae.registerClass("WordEditor.GraphMerge.$Ae",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$aU.registerClass("WordEditor.GraphMerge.$aU",null,WordEditor.GraphMerge.$l5);WordEditor.GraphMerge.$Qq.registerClass("WordEditor.GraphMerge.$Qq",null,WordEditor.GraphMerge.$l3);WordEditor.GraphMerge.$aT.registerClass("WordEditor.GraphMerge.$aT");WordEditor.GraphMerge.$Af.registerClass("WordEditor.GraphMerge.$Af",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$8x.registerClass("WordEditor.GraphMerge.$8x",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$Aj.registerClass("WordEditor.GraphMerge.$Aj",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$Ak.registerClass("WordEditor.GraphMerge.$Ak",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$Al.registerClass("WordEditor.GraphMerge.$Al",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$An.registerClass("WordEditor.GraphMerge.$An",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$Ao.registerClass("WordEditor.GraphMerge.$Ao",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$8a.registerClass("WordEditor.GraphMerge.$8a",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$f1.registerClass("WordEditor.GraphMerge.$f1");WordEditor.GraphMerge.$As.registerClass("WordEditor.GraphMerge.$As",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$Ax.registerClass("WordEditor.GraphMerge.$Ax",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$B1.registerClass("WordEditor.GraphMerge.$B1",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$8h.registerClass("WordEditor.GraphMerge.$8h",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$B2.registerClass("WordEditor.GraphMerge.$B2",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$B5.registerClass("WordEditor.GraphMerge.$B5",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$B8.registerClass("WordEditor.GraphMerge.$B8",WordEditor.GraphMerge.$4R);WordEditor.GraphMerge.$E6.registerClass("WordEditor.GraphMerge.$E6");WordEditor.GraphMerge.$AU.registerClass("WordEditor.GraphMerge.$AU",null,WordEditor.GraphMerge.$kz);WordEditor.GraphMerge.$XA.registerClass("WordEditor.GraphMerge.$XA",null,WordEditor.GraphMerge.$ky);WordEditor.GraphMerge.$Qo.registerClass("WordEditor.GraphMerge.$Qo",null,Box4.$kp);WordEditor.GraphMerge.$CT.registerClass("WordEditor.GraphMerge.$CT");WordEditor.GraphMerge.$7p.registerClass("WordEditor.GraphMerge.$7p",null,Common.$ox);WordEditor.GraphMerge.$s0.registerClass("WordEditor.GraphMerge.$s0",WordEditor.GraphMerge.$7p);WordEditor.GraphMerge.$s0.prototype.toString=WordEditor.GraphMerge.$7p.prototype.toString;WordEditor.GraphMerge.$K4.registerClass("WordEditor.GraphMerge.$K4",WordEditor.GraphMerge.$s0);WordEditor.GraphMerge.$WL.registerClass("WordEditor.GraphMerge.$WL",WordEditor.GraphMerge.$s0);WordEditor.GraphMerge.$5u.registerClass("WordEditor.GraphMerge.$5u");WordEditor.GraphMerge.$Pp.registerClass("WordEditor.GraphMerge.$Pp",WordEditor.GraphMerge.$WL);WordEditor.GraphMerge.$K1.registerClass("WordEditor.GraphMerge.$K1",WordEditor.GraphMerge.$WL);WordEditor.GraphMerge.$De.registerClass("WordEditor.GraphMerge.$De",WordEditor.GraphMerge.$7p);WordEditor.GraphMerge.$UU.registerClass("WordEditor.GraphMerge.$UU",WordEditor.GraphMerge.$7p);WordEditor.GraphMerge.$Jk.registerClass("WordEditor.GraphMerge.$Jk",WordEditor.GraphMerge.$7p);WordEditor.GraphMerge.$TG.registerClass("WordEditor.GraphMerge.$TG");WordEditor.GraphMerge.$eN.registerClass("WordEditor.GraphMerge.$eN",WordEditor.GraphMerge.$TG);WordEditor.GraphMerge.$hq.registerClass("WordEditor.GraphMerge.$hq",WordEditor.GraphMerge.$TG);WordEditor.GraphMerge.$JH.registerClass("WordEditor.GraphMerge.$JH");WordEditor.GraphMerge.$JG.registerClass("WordEditor.GraphMerge.$JG");WordEditor.GraphMerge.$2z.registerClass("WordEditor.GraphMerge.$2z");WordEditor.GraphMerge.$7Z.registerClass("WordEditor.GraphMerge.$7Z");WordEditor.GraphMerge.$JO.registerClass("WordEditor.GraphMerge.$JO");WordEditor.GraphMerge.$JM.registerClass("WordEditor.GraphMerge.$JM");WordEditor.GraphMerge.$eM.registerClass("WordEditor.GraphMerge.$eM",null,WordEditor.GraphMerge.$kx);WordEditor.GraphMerge.$eM.$3na.registerClass("WordEditor.GraphMerge.$eM.$3na");WordEditor.GraphMerge.$6v.registerClass("WordEditor.GraphMerge.$6v",null,WordEditor.GraphMerge.$kx);WordEditor.GraphMerge.$eO.registerClass("WordEditor.GraphMerge.$eO",null,WordEditor.GraphMerge.$kx);WordEditor.GraphMerge.$eO.$30Q.registerClass("WordEditor.GraphMerge.$eO.$30Q");WordEditor.GraphMerge.$A4.registerClass("WordEditor.GraphMerge.$A4");WordEditor.GraphMerge.$A4.$3iX.registerClass("WordEditor.GraphMerge.$A4.$3iX");WordEditor.GraphMerge.$2t.registerClass("WordEditor.GraphMerge.$2t");WordEditor.GraphMerge.$eU.registerClass("WordEditor.GraphMerge.$eU");WordEditor.GraphMerge.$EG.registerClass("WordEditor.GraphMerge.$EG");WordEditor.GraphMerge.$TI.registerClass("WordEditor.GraphMerge.$TI");WordEditor.GraphMerge.$TI.$5JE.registerClass("WordEditor.GraphMerge.$TI.$5JE");WordEditor.GraphMerge.$TI.$5rB.registerClass("WordEditor.GraphMerge.$TI.$5rB");WordEditor.GraphMerge.$TI.$5ds.registerClass("WordEditor.GraphMerge.$TI.$5ds");WordEditor.GraphMerge.$7m.registerClass("WordEditor.GraphMerge.$7m");WordEditor.GraphMerge.$L1.registerClass("WordEditor.GraphMerge.$L1",Box4.$I8);WordEditor.GraphMerge.$aS.registerClass("WordEditor.GraphMerge.$aS",null,Common.App.$jx,Common.Utils.$l6);WordEditor.GraphMerge.$Qp.registerClass("WordEditor.GraphMerge.$Qp");WordEditor.GraphMerge.$NY.registerClass("WordEditor.GraphMerge.$NY",Box4.$I8);WordEditor.GraphMerge.$qL.registerClass("WordEditor.GraphMerge.$qL");WordEditor.GraphMerge.$jH.registerClass("WordEditor.GraphMerge.$jH",WordEditor.GraphMerge.$Qo,Box4.$oW,Box4.$kp);WordEditor.GraphMerge.$AM.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$AM))(WordEditor.GraphMerge.$AM.$Bo);WordEditor.GraphMerge.$AN.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$AN))(WordEditor.GraphMerge.$AN.$Bo);WordEditor.GraphMerge.$AO.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$AO))(WordEditor.GraphMerge.$AO.$Bo);WordEditor.GraphMerge.$AP.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$AP))(WordEditor.GraphMerge.$AP.$Bo);WordEditor.GraphMerge.$AQ.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$AQ))(WordEditor.GraphMerge.$AQ.$Bo);WordEditor.GraphMerge.$AW.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$AW))(WordEditor.GraphMerge.$AW.$Bo);WordEditor.GraphMerge.$AX.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$AX))(WordEditor.GraphMerge.$AX.$Bo);WordEditor.GraphMerge.$Ad.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$Ad))(WordEditor.GraphMerge.$Ad.$Bo);WordEditor.GraphMerge.$Ae.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$Ae))(WordEditor.GraphMerge.$Ae.$Bo);WordEditor.GraphMerge.$4R.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$4R))(WordEditor.GraphMerge.$4R.$Bo);WordEditor.GraphMerge.$4R.$3D8=new($$sc.$x.$$(Array))(WordEditor.GraphMerge.$4R.$57W);WordEditor.GraphMerge.$Af.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$Af))(WordEditor.GraphMerge.$Af.$Bo);WordEditor.GraphMerge.$8x.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$8x))(WordEditor.GraphMerge.$8x.$Bo);WordEditor.GraphMerge.$Aj.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$Aj))(WordEditor.GraphMerge.$Aj.$Bo);WordEditor.GraphMerge.$Ak.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$Ak))(WordEditor.GraphMerge.$Ak.$Bo);WordEditor.GraphMerge.$Al.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$Al))(WordEditor.GraphMerge.$Al.$Bo);WordEditor.GraphMerge.$An.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$An))(WordEditor.GraphMerge.$An.$Bo);WordEditor.GraphMerge.$Ao.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$Ao))(WordEditor.GraphMerge.$Ao.$Bo);WordEditor.GraphMerge.$8a.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$8a))(WordEditor.GraphMerge.$8a.$Bo);WordEditor.GraphMerge.$As.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$As))(WordEditor.GraphMerge.$As.$Bo);WordEditor.GraphMerge.$Ax.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$Ax))(WordEditor.GraphMerge.$Ax.$Bo);WordEditor.GraphMerge.$B1.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$B1))(WordEditor.GraphMerge.$B1.$Bo);WordEditor.GraphMerge.$8h.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$8h))(WordEditor.GraphMerge.$8h.$Bo);WordEditor.GraphMerge.$B2.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$B2))(WordEditor.GraphMerge.$B2.$Bo);WordEditor.GraphMerge.$B5.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$B5))(WordEditor.GraphMerge.$B5.$Bo);WordEditor.GraphMerge.$B8.$T=new($$sc.$x.$$(WordEditor.GraphMerge.$B8))(WordEditor.GraphMerge.$B8.$Bo);WordEditor.GraphMerge.$AU.$3nL=Common.$C.$7r("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");WordEditor.GraphMerge.$5u.$3iC=new RegExp("\u00a0","g");WordEditor.GraphMerge.$6v.$26=null;WordEditor.GraphMerge.$qL.$5Sr();Type.registerNamespace("WordEditor.PageBreak");WordEditor.PageBreak.$lC=function(){};WordEditor.PageBreak.$lC.registerInterface("WordEditor.PageBreak.$lC");WordEditor.PageBreak.$lB=function(){};WordEditor.PageBreak.$lB.registerInterface("WordEditor.PageBreak.$lB");WordEditor.PageBreak.$47=function(){};WordEditor.PageBreak.$47.prototype={$U:null,$21z:null,get_$5j:function(){return"WordEditor.PageBreak"},$t9:function(a){this.$U=a},$7Y:function(){var a=this;this.$U.$J(Box4.$2o).get_$SM().CW(function(){a.$ap()})},$ap:function(){if(!this.$U.$J(Box4.$2o).$3S(22))return;this.$21z=WordEditor.PageBreak.$A3.get_$4();this.$21z.$3F();this.$21z.$1FR();Box4.App.get_$X().$86(false)},$d:function(){}};WordEditor.PageBreak.$A3=function(a,b,c,d,e,f){this.$$d_$5Jh=Function.createDelegate(this,this.$5Jh);this.$$d_$5Ji=Function.createDelegate(this,this.$5Ji);this.$K=a;this.$2Zv=b;this.$2g=c;this.$1zj=d;this.$1JN=e;this.$2ai=f};WordEditor.PageBreak.$A3.$iB=function(){var a=Box4.$o.get_$4();return new WordEditor.PageBreak.$A3(Common.$0.get_$r(),WordEditor.PageBreak.$6J.get_$4(),new Box4.$5X,Box4.$D.$4n,a.$$d_$i8||(a.$$d_$i8=Function.createDelegate(a,a.$i8)),Box4.$2Q.$1Sn)};WordEditor.PageBreak.$A3.get_$4=function(){return WordEditor.PageBreak.$A3.$T||(WordEditor.PageBreak.$A3.$T=WordEditor.PageBreak.$A3.$iB())};WordEditor.PageBreak.$A3.prototype={$K:null,$2Zv:null,$2g:null,$1zj:null,$1JN:null,$2ai:null,$3F:function(){this.$K.$P(3457315319,2,this.$$d_$5Ji);this.$K.$P(3457315319,4,this.$$d_$5Jh);this.$K.$2G(3457315319,4)},$1FR:function(){var a=Common.$b.$4().$2w("editing");Common.$1R.$5t(a,Common.$G.$1F(13,Common.$G.get_$56()),3457315319)},$5Ji:function(p,e,n,k,o){var l=e,b=l.$2Q;if(!b.$PI.$2NU)return 8;var c=b.$f.get_$74();if(!c)return 2;if(Box4.$3.get_$4().get_$5(14)&&this.$1JN(c))return 8;var d=this.$1zj(c),m=d?this.$5N5(c):this.$5O8(b.$f.get_$23());if(m)return 8;if(d&&this.$2ai(c,true))return 8;if(n===1)return 32;var f=true,a=8,g=this.$2g.$59(15,0);g.$1o(b.$5p);if(!d){a=this.$K.$5D(e,1172238996,2,true,k,null);var h=a===32;Diag.$2.$m(4208012,314,h,null);f=h}if(f){var i=b.$f.get_$74(),j=this.$1zj(i);Diag.$2.$m(4208013,314,j,"{0}",{ContextId:e.get_$3t()});a=8;if(j){a=this.$K.$5D(i,3457315319,2,false,k,o);Diag.$2.$m(4208014,314,a===32,null)}}g.dispose();return a},$5N5:function(b){var a=b;return this.$Oq(a.get_$13d())},$5O8:function(d){var a=d.get_$5(0),b=Box4.$D.$6j(a,true,false);if(this.$Oq(b.get_$11().get_$13d()))return true;var c=Box4.$D.$6j(a,false,false);return this.$Oq(c.get_$11().get_$13d())},$Oq:function(a){return a.$1X(14)},$5Jh:function(c,a,b){return b===1?a.get_$3t()===4?32:8:b===2?this.$2Zv.$5JH(a):32}};WordEditor.PageBreak.$6J=function(a,b,c,d,e,f){this.$Eo=c;this.$1MI=d;this.$1y=a;this.$2g=b;this.$31=e;this.$2WG=f||WordEditor.PageBreak.$6J.$OV};WordEditor.PageBreak.$6J.get_$65=function(){return WordEditor.PageBreak.$6J.$2N||(WordEditor.PageBreak.$6J.$2N=Common.Utils.$8.get_$4().$J(Box4.$4r))};WordEditor.PageBreak.$6J.$iB=function(){return new WordEditor.PageBreak.$6J(new Box4.$4A,new Box4.$5X,Common.Utils.$8.get_$4().$J(Box4.$BM),WordEditor.$8Y.get_$4(),Common.Utils.$8.get_$4().$J(Box4.$5P),null)};WordEditor.PageBreak.$6J.get_$4=function(){return WordEditor.PageBreak.$6J.$T||(WordEditor.PageBreak.$6J.$T=WordEditor.PageBreak.$6J.$iB())};WordEditor.PageBreak.$6J.$OV=function(a){return Box4.$P.$OV(a)};WordEditor.PageBreak.$6J.prototype={$1y:null,$2g:null,$2WG:null,$Eo:null,$1MI:null,$31:null,$5JH:function(e){var b=null;b=e;var a=Box4.$E.$Jl(this.$1y.$7f());a.$h(b.$D);a.$1X(10);var c=this.$2g.$59(15,0);c.$Bd(a);this.$62F(a,b);this.$Eo.$1Wk(b.$D,13);var d=Box4.$E.$13(a.get_$Zi());this.$5Jg(a);this.$5ww(d);c.dispose();return 32},$5ww:function(c){var a=Box4.$S.$4j(c,false),b=Box4.$L.$4I(a,0);Box4.$h.get_$4().$2s(b,null,false,false)},$5Jg:function(a){this.$31.$On(a,true,true,null,false,false);var b=Box4.$S.$4j(a,false);this.$5JJ(b)},$62F:function(b,a){var d=Box4.$S.$32(b);if(!a.$j)return;if(Box4.$3.get_$4().get_$5(50)&&Box4.App.$20.$90)a.$j!==Box4.$A.$2Y(a.$D)&&Box4.App.$20.$8M.$Gr(a.$D);this.$31.$On(b,false,true,null,false,false);var c=Box4.$E.$Jl(this.$1y.$7f());c.$h(d);this.$31.$jy(c,b,a,true,true,true)},$5JJ:function(f){var a=this.$2WG(f),b=Wonca.$8k.get_$4().$7s(131073);b.$M(Box4.AppProperties.$1.$31u,true);var d=a.$D.get_$4R(),e=d.$I3(b,Common.$C.$x()),c=this;WordEditor.PageBreak.$6J.get_$65().$oP(a,function(a){return c.$1MI.$294(a,e)},WordEditor.$CV.$29V,null)}};WordEditor.PageBreak.$qL=function(){};WordEditor.PageBreak.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.PageBreak.$47)};WordEditor.PageBreak.$47.registerClass("WordEditor.PageBreak.$47",null,Common.App.$jx,Common.Utils.$l6);WordEditor.PageBreak.$A3.registerClass("WordEditor.PageBreak.$A3",null,WordEditor.PageBreak.$lC);WordEditor.PageBreak.$6J.registerClass("WordEditor.PageBreak.$6J",null,WordEditor.PageBreak.$lB);WordEditor.PageBreak.$qL.registerClass("WordEditor.PageBreak.$qL");WordEditor.PageBreak.$A3.$T=null;WordEditor.PageBreak.$6J.$2N=null;WordEditor.PageBreak.$6J.$T=null;WordEditor.PageBreak.$qL.$5Sr();Type.registerNamespace("WordEditor.Pagination");WordEditor.Pagination.$Im=function(){};WordEditor.Pagination.$Im.registerInterface("WordEditor.Pagination.$Im");WordEditor.Pagination.$MK=function(){};WordEditor.Pagination.$MK.registerInterface("WordEditor.Pagination.$MK");WordEditor.Pagination.$Dy=function(){};WordEditor.Pagination.$Dy.registerInterface("WordEditor.Pagination.$Dy");WordEditor.Pagination.$Y4=function(a,b,c,d,e){this.$$d_$1o6=Function.createDelegate(this,this.$1o6);this.$K=a;this.$f=b;this.$25=c;this.$rS=d;this.$1LM=e;this.$1QF()};WordEditor.Pagination.$Y4.prototype={$K:null,$f:null,$zk:null,$25:null,$rS:null,$1LM:null,$1wL:1,get_$1hq:function(){return this.$1wL},set_$1hq:function(a){if(this.$1wL!==a){this.$1wL=a;this.$K.$2u(3252185243,2)}return a},get_$QZ:function(){return this.$1LM.get_$Q()},get_$MS:function(){return this.$rS.get_$Q()},$1QF:function(){this.$f.add_$Sg(this.$$d_$1o6);this.$2l4()},$1o6:function(){this.$2l4()},$2l4:function(){if(!this.get_$MS()||!this.get_$MS().get_$31v()||!this.get_$MS().get_$2Jc())return;var a=this.$f.get_$23().get_$1Z();if(!a)return;var b=a.$3Y?a.get_$4i():a.get_$11();if(!b||b.$j<0)return;var c=b.$D;if(c&&Box4.$A.$3D(c)&&this.$5Mv(c)){if(this.$zk){this.$25.$66(this.$zk);this.$zk=null}var d=this;this.$zk=new Common.$1e(2,1,400,function(a){d.$4sP(a,c,b.$j)},62);this.$25.$2f(this.$zk)}},$5Mv:function(b){var a=Box4.$E.$13(b);return a.$1X(35)||a.$1X(37)||a.$1X(39)?false:true},$4sP:function(j,k,g){if(this.$zk!==j)return;this.$zk=null;var a=k,e=a.$4N(this.get_$QZ().$y);if(!e)return;var b=Box4.$20.$AQ(e,g,false,false,false);if(!b)return;var f=this.$59u(a),c=f.$4N(this.get_$QZ().$y),h=b.y+Math.floor(b.height/2)-c.$F2().y;if(!this.get_$MS().get_$31v().get_$14())this.set_$1hq(1);else if(this.get_$MS().get_$2Jc().$30(c.get_$16().get_$E())){var i=this.$3b0(c.get_$16().get_$E()),d=this.$555(h,i);if(this.$5N6(g,a))d++;d>0&&this.set_$1hq(d)}else this.set_$1hq(this.$554(f))},$3b0:function(b){var a=this.get_$MS().get_$2Jc().$BQ(b);if(!a)return null;var c=this;a=$$sc.$2M.$2O7(WordEditor.Pagination.$E9,$$sc.$2M.$5dY(WordEditor.Pagination.$E9,Number,a,function(a){return a.$xE}));return a},$554:function(e){var a=Box4.$E.$13(e);a.$AF();a.$3Z(10);var d,b=Box4.$E.$13(e);b.$2l();var c=b.$8j();do{d=a.get_$A();while(c){if(this.get_$MS().get_$2Jc().$30(c.get_$E())){var f=this.$3b0(c.get_$E());return f.get_$5(0).$xE}c=b.$8j()}a.$8j();b.$2H(a);b.$3u();c=b.get_$A()}while(a.get_$A()!==d);return this.get_$MS().get_$31v().get_$14()+1},$59u:function(b){var a=Box4.$E.$13(b);a.$1X(23);return a.$3Z(23)},$5N6:function(b,c){if(b>0&&b===c.$55.length){var a=c.$i.$eL(b-1);if(a&&a.$2i&&a.$2i.get_$82()===8)return true}return false},$555:function(c,a){var d=0,b=a.get_$14()-1;while(d<=b){if(c<a.get_$5(d).$kf)return a.get_$5(d).$xE;else if(c>=a.get_$5(b).$kf)return a.get_$5(b).$xE+1;else if(d+1===b&&c>=a.get_$5(d).$kf&&c<a.get_$5(b).$kf)return a.get_$5(b).$xE;var e=Math.floor((d+b)/2);if(c<a.get_$5(e).$kf&&c>=a.get_$5(e-1).$kf)return a.get_$5(e).$xE;else if(c<a.get_$5(e).$kf)b=e;else if(c>=a.get_$5(e).$kf)d=e}return-1},$Jj:function(){this.$f.remove_$Sg(this.$$d_$1o6)}};WordEditor.Pagination.$AY=function(a){WordEditor.Pagination.$AY.$Vk=a};WordEditor.Pagination.$AY.prototype={$1zL:true,get_$2G2:function(){return this.$1zL},get_$1hq:function(){return WordEditor.Pagination.$AY.$Vk.get_$1hq()},$4p6:function(){this.$1zL=true;WordEditor.Pagination.$AY.$Vk.$1QF()},$4n5:function(){this.$1zL=false;WordEditor.Pagination.$AY.$Vk.$Jj()}};WordEditor.Pagination.$47=function(){this.$$d_$4Gp=Function.createDelegate(this,this.$4Gp)};WordEditor.Pagination.$47.prototype={$U:null,$26:null,$3U:null,$Ya:null,$Vk:null,$W5:false,get_$5j:function(){return"WordEditor.Pagination"},get_$6Av:function(){return this.$26.$3S(25)},get_$3B4:function(){return this.$26.$3S(23)},get_$2G1:function(){return this.$26.$3S(13)},$t9:function(f){this.$U=f;this.$26=this.$U.$J(Box4.$2o);var b=this;this.$U.$e(WordEditor.$J0).$p().$n(function(){return new WordEditor.Pagination.$eE(Common.$0.get_$r(),new($$sc.$x.$$(WordEditor.Pagination.$Dy))(function(){return!b.get_$3B4()?null:b.$U.$J(WordEditor.Pagination.$Dy)}),!b.get_$2G1()?null:b.$U.$J(WordEditor.Pagination.$Im),WordEditor.App.$T4,Box4.App.get_$38x())});var c=this;this.$U.$e(WordEditor.Pagination.$MK).$p().$n(function(){return new WordEditor.Pagination.$AY(!c.get_$2G1()?null:c.$U.$J(WordEditor.Pagination.$Im))});var a=this;this.$U.$e(WordEditor.Pagination.$NP).$p().$n(function(){return new WordEditor.Pagination.$NP(Common.$0.get_$r(),a.$U.$J(WordEditor.$BS),a.$U.$J(WordEditor.$J0),a.$U.$J(WordEditor.Pagination.$MK),new($$sc.$x.$$(WordEditor.Pagination.$Dy))(function(){return!a.get_$3B4()?null:a.$U.$J(WordEditor.Pagination.$Dy)}),a.get_$2G1())});var d=this;this.$U.$e(WordEditor.Pagination.$6V).$1p(WordEditor.Pagination.$Dy).$1p(Box4.$Mn).$p().$n(function(){return new WordEditor.Pagination.$6V(new($$sc.$x.$$(Box4.$3z))(function(){return Box4.App.get_$X().$1L.$3o}),new($$sc.$x.$$(Box4.$Ag))(function(){return Box4.App.get_$X().$1L.get_$2v().get_$3V()}),d.$U.$J(WordEditor.Pagination.$3Z),Box4.$20.$3aC,d.$U.$J(WordEditor.$7l),Common.$1J.get_$4(),Box4.$13.get_$4().get_$41(),WordEditor.Pagination.$6V.$577)});var g=this;this.$U.$e(WordEditor.Pagination.$3Z).$p().$n(function(){return new WordEditor.Pagination.$3Z});var e=this;this.$U.$e(WordEditor.Pagination.$Im).$p().$n(function(){return new WordEditor.Pagination.$Y4(Common.$0.get_$r(),Box4.$h.get_$4(),Common.$1J.get_$4(),new($$sc.$x.$$(WordEditor.Pagination.$Dy))(function(){return!e.get_$3B4()?null:e.$U.$J(WordEditor.Pagination.$Dy)}),new($$sc.$x.$$(Box4.$2N))(function(){return Box4.App.get_$X().$1L.$3o}))})},$7Y:function(){var a=this;this.$26.get_$SM().CW(function(){a.$ap()})},$ap:function(){if(this.get_$6Av()){var a=Box4.App.get_$X().$1L;if(a.get_$2xG())this.$mw();else a.add_$mw(this.$$d_$4Gp)}},$4Gp:function(){this.$mw()},$mw:function(){if(this.$W5)return;this.$W5=true;this.$3U=Common.Utils.$8.get_$4().$J(WordEditor.$J0);this.$Ya=Common.Utils.$8.get_$4().$J(WordEditor.Pagination.$MK);if(this.get_$2G1())this.$Vk=Common.Utils.$8.get_$4().$J(WordEditor.Pagination.$Im);Common.Utils.$8.get_$4().$J(WordEditor.Pagination.$NP).$3F()},$d:function(){if(this.$3U){this.$3U.dispose();this.$3U=null}if(this.$Vk){this.$Vk.$Jj();this.$Vk=null}if(this.$Ya)this.$Ya=null}};WordEditor.Pagination.$E9=function(a,b,c,d,e){this.$kf=a;this.$xE=b;this.$3BW=c;this.$2SR=d;this.$2SS=e};WordEditor.Pagination.$E9.prototype={$kf:0,$xE:0,$3BW:null,$2SR:null,$2SS:null};WordEditor.Pagination.$6V=function(a,b,c,d,e,f,g,h){this.$$d_$5ku=Function.createDelegate(this,this.$5ku);this.$$d_$5kv=Function.createDelegate(this,this.$5kv);this.$$d_$5kt=Function.createDelegate(this,this.$5kt);this.$$d_$5eQ=Function.createDelegate(this,this.$5eQ);this.$$d_$5eP=Function.createDelegate(this,this.$5eP);this.$$d_$2J4=Function.createDelegate(this,this.$2J4);this.dispose=this.$d;this.$1LM=a;this.$8d=b;WordEditor.Pagination.$6V.$19I=c;this.$1xx=d;this.$EF=e;this.$25=f;this.$2Ye=h;this.$re=new(Common.Collections.$2d.$$(Common.$C,$$sc.$F.$$(Box4.$HA)));this.$zc=new($$sc.$F.$$(Box4.$HA));this.$Z5=new($$sc.$F.$$(Box4.$HA));this.$rp=new(Common.Collections.$2d.$$(Common.$C,$$sc.$MY.$$(WordEditor.Pagination.$E9)));this.$gW=g;this.$gW.add_$2J4(this.$$d_$2J4)};WordEditor.Pagination.$6V.$577=function(m){var e=0;try{var f=m.get_$4E(),j=f.firstChild,k=Common.$J.$P2(j.style.marginTop),g=0,h=f.parentNode,a=h.previousSibling;if(!a){var b=h.parentNode,i=b.tagName.toLocaleLowerCase();if(i==="ol"||i==="ul")b=b.parentNode;var c=b.previousSibling;if(c&&c.hasChildNodes()){a=c.lastChild;do{if(Sys.UI.DomElement.containsCssClass(a,"OutlineElement"))break;a=a.previousSibling}while(a)}}if(a){var d=a.firstChild;if(d&&Sys.UI.DomElement.containsCssClass(d,"ParaWrappingDiv")){var l=d.firstChild;g=Common.$J.$P2(l.style.marginBottom)}}e=Math.max(k,g)/2}catch(n){}return e};WordEditor.Pagination.$6V.$3iz=function(b){var a=Box4.$E.$13(b);return a.$1X(23)?a.$3Z(23):null};WordEditor.Pagination.$6V.prototype={$1LM:null,$8d:null,$1xx:null,$EF:null,$25:null,$gW:null,$2Ye:null,$re:null,$zc:null,$Z6:true,$221:false,$Z5:null,$rp:null,$2eF:false,$101:null,$1eC:null,get_$31v:function(){return this.$Z5},get_$2Jc:function(){return this.$rp},get_$QZ:function(){return this.$1LM.get_$Q()},get_$DN:function(){return this.$8d.get_$Q()},$2J4:function(){this.$304()},$3AC:function(e,f){this.$Z6=f;WordEditor.Pagination.$6V.$19I.$3qr();this.$re=new(Common.Collections.$2d.$$(Common.$C,$$sc.$F.$$(Box4.$HA)));this.$zc.$Fk();this.$Z5.$Fk();this.$rp=new(Common.Collections.$2d.$$(Common.$C,$$sc.$MY.$$(WordEditor.Pagination.$E9)));this.$4qG();for(var b=e,d=b.length,a=0;a<d;++a){var c=b[a];this.$Z5.$F(c);this.$33c(c)}},$4qG:function(){if(!this.$2eF){this.get_$QZ().add_$3k0(this.$$d_$5eP);this.get_$QZ().add_$3n0(this.$$d_$5eQ);this.get_$QZ().add_$3lH(this.$$d_$5kt);this.$2eF=true}},$33c:function(c){if(this.$221)return true;var t=c.ParaId,p=c.PageEndType,x=c.CP,a,b=this.$5AC(t);if(!b)return false;if(!b.$21||!b.$3q){this.$3FS(c,b);return false}var d;if(c.HardBreak){var g,h,i;if(!(i=this.$66H(c,b,g={val:a},h={val:d}),a=g.val,d=h.val,i))return false;this.$3Ez(b,c,a,d,null);return true}var e=null;if(!p){var j,k,l;if(!(l=this.$3aB(c,b,j={val:a},k={val:e}),a=j.val,e=k.val,l))return false}else{var m,n,o;if(!(o=this.$5A0(c,b,m={val:a},n={val:e}),a=m.val,e=n.val,o))return false}var f=Box4.$E.$13(b);f.$2l();d=f.$3Z(23);var q=d.$4N(this.get_$QZ().$y),r=q.$F2(),u=f.$vy(),v=u.$4N(this.get_$QZ().$y),w=v.$F2();a-=r.y;var s=WordEditor.Pagination.$6V.$19I.$55h(p,a,this.$Z6,e,r,w);q.get_$4E().appendChild(s);this.$3Ez(b,c,a,d,s);return true},$66H:function(d,a,e,b){b.val=null;var c=a.$4N(this.get_$QZ().$y);e.val=0;if(this.$2H5(d,c,a))return false;b.val=WordEditor.Pagination.$6V.$3iz(a);var f=b.val.$4N(this.get_$QZ().$y),g=f.$F2(),h=Box4.$20.$AQ(c,d.CP,false,false,false);e.val=h.y-g.y;return true},$5AC:function(c){var a=this.$EF.$1DW(c);if(a!==Common.$C.get_$1G()){var b=this.get_$DN().$2C(a);if(b)return b}Diag.$2.$9(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",c,a);return null},$3aB:function(e,f,b,c){var d=e.CP;b.val=0;c.val=null;var a=f.$4N(this.get_$QZ().$y);if(this.$2H5(e,a,f))return false;c.val=a.$F2();if(!d)b.val=c.val.y-this.$2Ye(a);else b.val=this.$1xx($$as(Box4.$2r,a),d);return true},$5A0:function(b,c,d,f){f.val=null;d.val=0;var j=b.PageEndType,a=Box4.$E.$13(c);a.$2l();if(!Box4.$e.$Oq(a)){Diag.$2.$9(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",b.ParaId);return this.$3aB(b,c,d,f)}if(j===1){Box4.$T.$Uu(a);var l=a.get_$A(),h=l.$4N(this.get_$QZ().$y);if(this.$2H5(b,h,c))return false;d.val=h.$F2().y}else{var i=c.$4N(this.get_$QZ().$y);if(this.$2H5(b,i,c))return false;d.val=this.$1xx($$as(Box4.$2r,i),b.CP)}d.val-=1;var g=null,e=null;do{g=e;e=a.$3Z(14)}while(e);a=Box4.$E.$13(g);a.$2l();Box4.$T.$ai(a);var k=a.get_$A().$4N(this.get_$QZ().$y);f.val=k.$F2();return true},$2H5:function(c,a,e){if(!a||a.$1Tw(16)){this.$3FS(c,e);return true}var b=a.$F2();if(!b.width&&!b.height){var d=this.$3F0(c);d&&Diag.$2.$9(6431177,336,10,"PageEndMarkers: Got incorrect content bounds with width and height as 0");return true}return false},$3F0:function(a){if(!this.$zc.$4V(a)){this.$zc.$F(a);return true}return false},$3FS:function(b,c){var a=c.get_$E();!this.$re.$30(a)&&this.$re.set_$5(a,new($$sc.$F.$$(Box4.$HA)));this.$re.get_$5(a).$F(b)},$5eP:function(){for(var a=this.$zc.get_$14()-1;a>=0;a--){var b=this.$zc.get_$5(a),c=this.$33c(b);c&&this.$zc.$Cq(a)}},$5eQ:function(f,d){try{var a=d.get_$E();if(this.$re.$30(a)){for(var c=this.$re.get_$5(a),b=0;b<c.get_$14();b++)this.$3F0(c.get_$5(b));this.$re.$73(a)}}catch(e){}},$304:function(){if(!this.$Z6)return;this.$Z6=false;WordEditor.Pagination.$6V.$19I.$304()},$303:function(){if(this.$Z6)return;this.$Z6=true;WordEditor.Pagination.$6V.$19I.$303()},$61L:function(){this.$221=false;this.$Z5&&this.$3AC(this.$Z5.$8V(),this.$Z6)},$5GR:function(){this.$221=true;WordEditor.Pagination.$6V.$19I.$3qr()},$3Ez:function(e,c,f,a,g){var b=this.$Z5.$2FS(c)+1;if(b<0)return;var d=new WordEditor.Pagination.$E9(f,b,e,c,g);!this.$rp.$30(a.get_$E())&&this.$rp.set_$5(a.get_$E(),new($$sc.$F.$$(WordEditor.Pagination.$E9)));this.$rp.get_$5(a.get_$E()).$F(d)},$3q9:function(c){if(!this.$Z6)return;if(!c.$21||!c.$3q){Diag.$2.$9(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group");return}var b=WordEditor.Pagination.$6V.$3iz(c);if(!b)return;if(this.$101&&this.$101.$Bp&&this.$101.$Bp.get_$E()===b.get_$E())return;var a;this.$101=(a=new Common.$1e(3,1,500,this.$$d_$5kv),a.$Bp=b,a);this.$25.$2f(this.$101)},$5kv:function(f){if(f===this.$101)this.$101=null;if(!this.$Z6)return;var b=f.$Bp,a=this.$rp.$BQ(b.get_$E());if(!a)return;this.$rp.set_$5(b.get_$E(),new($$sc.$F.$$(WordEditor.Pagination.$E9)));Diag.$2.$9(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",a.get_$14(),b.get_$E());for(var c=0;c<a.get_$14();c++){var d=a.get_$5(c),e=d.$2SR;if(!e.HardBreak){var g=d.$2SS;Common.$J.$Nc(g)}this.$33c(e)}},$5kt:function(){if(this.$Z6&&!this.$1eC&&this.$Z5&&this.$Z5.get_$14()>0){this.$1eC=new Common.$1e(3,1,500,this.$$d_$5ku);this.$25.$2f(this.$1eC)}},$5ku:function(){this.$1eC=null;if(this.$Z6&&this.$Z5&&this.$Z5.get_$14()>0){Diag.$2.$9(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document");this.$3AC(this.$Z5.$8V(),this.$Z6)}},$d:function(){if(this.get_$QZ()){this.get_$QZ().remove_$3k0(this.$$d_$5eP);this.get_$QZ().remove_$3n0(this.$$d_$5eQ);this.get_$QZ().remove_$3lH(this.$$d_$5kt)}this.$gW&&this.$gW.remove_$2J4(this.$$d_$2J4)}};WordEditor.Pagination.$3Z=function(){this.$zb=[]};WordEditor.Pagination.$3Z.$5AH=function(b,c,d){if(!WordEditor.Pagination.$3Z.$1Am){WordEditor.Pagination.$3Z.$1Am=CommonUI.$1D.$9m("div","PageEndMarker.Para","PageEndMarker");WordEditor.Pagination.$3Z.$1Am.appendChild(CommonUI.$1D.$9m("div","","Current FullWidth"));WordEditor.Pagination.$3Z.$1Am.appendChild(CommonUI.$1D.$9m("div","","Stale LeftWing"));WordEditor.Pagination.$3Z.$1Am.appendChild(CommonUI.$1D.$9m("div","","Stale RightWing"))}var a=WordEditor.Pagination.$3Z.$1Am.cloneNode(true);a.childNodes[1].style.width=b-10+"px";a.childNodes[2].style.width=c-10+"px";WordEditor.Pagination.$3Z.$42B(a,d);return a};WordEditor.Pagination.$3Z.$5Cw=function(b,c,d,e,f){if(!WordEditor.Pagination.$3Z.$10W){WordEditor.Pagination.$3Z.$10W=CommonUI.$1D.$9m("div","PageEndMarker.Table","PageEndMarker");WordEditor.Pagination.$3Z.$10W.appendChild(CommonUI.$1D.$9m("div","","Current LeftWing"));WordEditor.Pagination.$3Z.$10W.appendChild(CommonUI.$1D.$9m("div","","Current RightWing"));WordEditor.Pagination.$3Z.$10W.appendChild(CommonUI.$1D.$9m("div","","Stale LeftWing"));WordEditor.Pagination.$3Z.$10W.appendChild(CommonUI.$1D.$9m("div","","Stale RightWing"))}var a=WordEditor.Pagination.$3Z.$10W.cloneNode(true);a.childNodes[0].style.width=b+"px";a.childNodes[1].style.width=c+"px";a.childNodes[2].style.width=d-10+"px";a.childNodes[3].style.width=e-10+"px";WordEditor.Pagination.$3Z.$42R(a,f);return a};WordEditor.Pagination.$3Z.$42B=function(a,b){if(b)WordEditor.Pagination.$3Z.$5T3(a);else WordEditor.Pagination.$3Z.$5T4(a)};WordEditor.Pagination.$3Z.$5T4=function(a){a.childNodes[0].style.display="none";a.childNodes[1].style.display="block";a.childNodes[2].style.display="block"};WordEditor.Pagination.$3Z.$5T3=function(a){a.childNodes[0].style.display="block";a.childNodes[1].style.display="none";a.childNodes[2].style.display="none"};WordEditor.Pagination.$3Z.$42R=function(a,b){if(b)WordEditor.Pagination.$3Z.$5T6(a);else WordEditor.Pagination.$3Z.$5T7(a)};WordEditor.Pagination.$3Z.$5T7=function(a){a.childNodes[0].style.display="none";a.childNodes[1].style.display="none";a.childNodes[2].style.display="block";a.childNodes[3].style.display="block"};WordEditor.Pagination.$3Z.$5T6=function(a){a.childNodes[0].style.display="block";a.childNodes[1].style.display="block";a.childNodes[2].style.display="none";a.childNodes[3].style.display="none"};WordEditor.Pagination.$3Z.prototype={$zb:null,$3qr:function(){for(var a=0,b=this.$zb.length;a<b;a++){var c=this.$zb[a];Common.$J.$Nc(c)}Array.clear(this.$zb)},$55h:function(l,m,k,c,d,b){var e=d.x-b.x,f=b.x+b.width-(d.x+d.width),g=c.x-b.x,h=b.x+b.width-c.x-c.width,i=Math.min(g,e),j=Math.min(h,f),a=!l?WordEditor.Pagination.$3Z.$5AH(i,j,k):WordEditor.Pagination.$3Z.$5Cw(g,h,i,j,k);a.style.left=-e+"px";a.style.right=-f+"px";a.style.top=m+"px";Array.add(this.$zb,a);Box4.$1u.$Xe(a,true);return a},$304:function(){this.$429(false)},$303:function(){this.$429(true)},$429:function(c){for(var b=0,d=this.$zb.length;b<d;b++){var a=this.$zb[b];if(a.id==="PageEndMarker.Para")WordEditor.Pagination.$3Z.$42B(a,c);else a.id==="PageEndMarker.Table"&&WordEditor.Pagination.$3Z.$42R(a,c)}}};WordEditor.Pagination.$NP=function(a,b,c,d,e,f){this.$$d_$655=Function.createDelegate(this,this.$655);this.$$d_$5jZ=Function.createDelegate(this,this.$5jZ);this.$$d_$5jV=Function.createDelegate(this,this.$5jV);this.$$d_$69U=Function.createDelegate(this,this.$69U);this.$K=a;this.$IT=b;this.$2eG=c;this.$Ya=d;this.$rS=e;this.$1c0=f};WordEditor.Pagination.$NP.prototype={$IT:null,$2eG:null,$K:null,$rS:null,$Ya:null,$1c0:false,get_$MS:function(){return this.$rS.get_$Q()},$3F:function(){this.$K.$1W(3252185243,1,this.$$d_$69U,96);this.$K.$1W(3373636362,1,this.$$d_$5jV,96);this.$K.$1W(1789804658,1,this.$$d_$5jZ,96);this.$K.$1W(768835250,1,this.$$d_$655,8)},$69U:function(b,c,a){if(a===1)return 32;this.$IT.$14R(this.$1c0?"PageCountButton":"PageCountLabel");return 32},$655:function(c,d,a,b){if(a===1)return 32;if(this.$Ya.get_$2G2()){this.$Ya.$4n5();this.get_$MS()&&this.get_$MS().$5GR()}else{this.$Ya.$4p6();this.get_$MS()&&this.get_$MS().$61L()}this.$IT.$14R("PageCountButton");b.$Q8=this.$Ya.get_$2G2()?1:0;return 32},$5jV:function(g,h,e,i,f){if(e===1)return 32;var b=this.$2eG.get_$40M(),a;if(b===-1)a="";else if(this.$1c0&&this.$Ya.get_$2G2()){var d=this.$Ya.get_$1hq();a=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,d,b)}else if(b===1)a=String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,b);else a=String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,b);var c=f;if(this.$1c0){c[CommandUI.Controls.$3a.Visible]=true;c[CommandUI.Controls.$3a.LabelText]=a}else{c[CommandUI.Controls.$9z.Visible]=true;c.Value=a}return 32},$5jZ:function(d,e,b,f,c){if(b===1)return 32;var a=c;a.On=this.$Ya.get_$2G2();return 32}};WordEditor.Pagination.$eE=function(c,d,e,f,a){this.$$d_$5Zc=Function.createDelegate(this,this.$5Zc);this.$$d_$1o0=Function.createDelegate(this,this.$1o0);this.$1OB=-1;this.dispose=this.$d;WordEditor.Pagination.$eE.initializeBase(this);this.$K=c;this.$rS=d;this.$Vk=e;this.$Rc=f;this.$lp=Common.$C.get_$1G();this.$18l=Common.$C.get_$1G();var b=this;a.CWR(Function,function(){return a.get_$5k().add_$1o0(b.$$d_$1o0)});this.$1i1();this.$3b=new Box4.$OB(1e3,null);this.$3b.$tL();this.$Rc.$e(this)};WordEditor.Pagination.$eE.prototype={$K:null,$cT:null,$rS:null,$Vk:null,$Rc:null,$1w6:0,$18l:null,$lp:null,$yZ:false,get_$MS:function(){return this.$rS.get_$Q()},get_$40M:function(){return this.$1OB},set_$40M:function(a){if(this.$1OB!==a){this.$1OB=a;this.$K.$2u(3252185243,2)}return a},$1o0:function(){Diag.$2.$9(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.$3NY()},$31T:function(b){this.$cT=b;this.$cT.add_$2Iu(this.$$d_$5Zc);var a=this.$cT.get_$3L();this.$26U(a)},$5Zc:function(){var a=this.$cT.get_$CI();if(!Common.$C.$ZX(a,this.$18l)){this.$18l=a;this.$5aC(this.$lp,this.$18l)}},$5aC:function(a,b){if(!Common.$C.$ZX(a,b)){this.get_$MS()&&this.get_$MS().$304();this.$62h()}else{this.get_$MS()&&this.get_$MS().$303();this.$1i1()}},$4p8:function(){this.$CS=2},$1i1:function(){this.$CS=0},$62h:function(){this.$1w6=0;this.$4p8();this.$Ob(null,null,null)},hasChangesToInbound:function(){return!!(this.$CS&2)&&this.$3b.$aQ()},$Ob:function(){this.$3b.$1Qc();this.$Rc.$P4()},$nf:function(){},$2vw:function(){return this.$2R&&this.$2R.$3I===2?true:this.hasChangesToInbound()},$5op:function(){if(this.$1Q===1){this.$2R.set_$MV(Box4.$NQ.$28a(Box4.App.$K5,this.$lp));this.$2R.$3I=1;this.$1Q=3}else if(this.$1Q===3&&this.$2R&&this.$2R.$3I===2){if(Common.$0.$6B){this.$1Q=4;return}this.$3b.$VF();this.$3b.$UO();this.$1Q=1;this.$1w6++;if(this.$2R.$HF!==2){this.$1Q4();return}var b=!this.$2R.$8Z?0:this.$2R.$8Z.length;if(b!==1){this.$1Q4();return}var a=this.$2R.$8Z[0];if(a.StatusCode===104){this.$3NY();return}if(a.StatusCode===101){this.$1Q4();return}if(a.StatusCode===3){this.$1Q4();return}if(a.StatusCode){this.$1Q4();return}if(!a.PageEnds){this.$1Q4();return}this.set_$40M(a.PageEnds.length+1);this.$lp=Box4.$1t.$KB(a.LastKnownPaginationRevision);Diag.$2.$9(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.$1OB,this.$lp);if(this.get_$MS()){this.get_$MS().$3AC(a.PageEnds,Common.$C.$ZX(this.$lp,this.$18l));this.$Vk&&this.$Vk.$2l4()}Diag.$2.$9(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.$1OB,this.$lp);this.$4n9()}},$3NY:function(){this.$cT&&this.$cT.remove_$2Iu(this.$$d_$5Zc);this.$1i1()},$1Q4:function(){this.$1w6>60&&this.$1i1()},$4n9:function(){Common.$C.$ZX(this.$lp,this.$18l)&&this.$1i1()},$d:function(){if(this.$cT){this.$cT.remove_$2Iu(this.$$d_$5Zc);this.$cT.get_$3L()&&this.$2Kt(this.$cT.get_$3L());this.$cT=null}},$26U:function(a){if(!a)return;a.$hq(this);this.$yZ=true},$2Kt:function(a){if(!this.$yZ)return;if(!a)return;a.$vs(this);this.$yZ=false},$5Zd:function(a){this.$2Kt(a)},$5Xc:function(){},$3jv:function(c){var a=c.get_$3V().get_$Aj();if(!a)return;var b=a.get_$E();this.$5YZ(this.$lp,b)},$5X1:function(){},$5YZ:function(a,b){if(Common.$C.$ZX(a,b))this.get_$MS()&&this.get_$MS().$303()}};WordEditor.Pagination.$qL=function(){};WordEditor.Pagination.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.Pagination.$47)};WordEditor.Pagination.$Y4.registerClass("WordEditor.Pagination.$Y4",null,WordEditor.Pagination.$Im);WordEditor.Pagination.$AY.registerClass("WordEditor.Pagination.$AY",null,WordEditor.Pagination.$MK);WordEditor.Pagination.$47.registerClass("WordEditor.Pagination.$47",null,Common.App.$jx,Common.Utils.$l6);WordEditor.Pagination.$E9.registerClass("WordEditor.Pagination.$E9");WordEditor.Pagination.$6V.registerClass("WordEditor.Pagination.$6V",null,WordEditor.Pagination.$Dy,Box4.$Mn,Sys.IDisposable);WordEditor.Pagination.$3Z.registerClass("WordEditor.Pagination.$3Z");WordEditor.Pagination.$NP.registerClass("WordEditor.Pagination.$NP");WordEditor.Pagination.$eE.registerClass("WordEditor.Pagination.$eE",Box4.$qM,WordEditor.$J0,Sys.IDisposable,Box4.$bO);WordEditor.Pagination.$qL.registerClass("WordEditor.Pagination.$qL");WordEditor.Pagination.$AY.$Vk=null;WordEditor.Pagination.$6V.$19I=null;WordEditor.Pagination.$3Z.$1Am=null;WordEditor.Pagination.$3Z.$10W=null;WordEditor.Pagination.$qL.$5Sr();var TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"WordCountFlyout",Command:"0x2F9A3D80",CommandMenuOpen:"0x2F9A3D80",CommandMenuClose:"0x2F9A3D80",Image16by16:"IMGMAP@we@WordCountList_16x16x32",LabelText:"STR@L_WordCountTooltip",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0xE8A1E65C"}},{name:"Button",attrs:{Id:"SelectAllButton",Command:"0x148D0534",Image16by16:"IMGMAP@we@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"Button",attrs:{Id:"SynonymButton",Command:"0x68B14EC4",Image16by16:"IMGMAP@we@Insights_16x16x32",LabelText:"STR@L_TellMeButtonLabel_Synonyms"}},{name:"Button",attrs:{Id:"DefinitionButton",Command:"0x68B14EC4",Image16by16:"IMGMAP@we@Insights_16x16x32",LabelText:"STR@L_TellMeButtonLabel_Definitions"}},{name:"FlyoutAnchor",attrs:{Id:"TextBoxUpSellButton",LabelText:"STR@L_TextBoxUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@we@Word_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMe",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@we@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"TableOfContentsUpSellButton",LabelText:"STR@L_TableOfContentsUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@we@Word_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMe",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@we@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"SmartArtUpSellButton",LabelText:"STR@L_SmartArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@we@Word_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMe",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@we@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@we@Word_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMe",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@we@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"MultiColumnLayoutUpSellButton",LabelText:"STR@L_MultiColumnLayoutUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@we@Word_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMe",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@we@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"InsertEquationUpSellButton",LabelText:"STR@L_InsertEquationUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@we@Word_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMe",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@we@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"Button",attrs:{Id:"btnTellMeOfficeAddIn.WA104124372",Command:"0x67ED56AC",Image16by16:"STR@L_TellMeAppIconUrl_Translator",Description:"STR@L_TellMeAppDescription_Translator",LabelText:"STR@L_TellMeAppTitle_Translator"}},{name:"Button",attrs:{Id:"btnTellMeOfficeAddIn.WA104178141",Command:"0x67ED56AC",Image16by16:"STR@L_TellMeAppIconUrl_PicHit",Description:"STR@L_TellMeAppDescription_PicHit",LabelText:"STR@L_TellMeAppTitle_PicHit"}},{name:"Button",attrs:{Id:"btnTellMeOfficeAddIn.WA104051163",Command:"0x67ED56AC",Image16by16:"STR@L_TellMeAppIconUrl_QR4Office",Description:"STR@L_TellMeAppDescription_QR4Office",LabelText:"STR@L_TellMeAppTitle_QR4Office"}},{name:"Button",attrs:{Id:"btnTellMeOfficeAddIn.WA104379279",Command:"0x67ED56AC",Image16by16:"STR@L_TellMeAppIconUrl_SymbolsCharacters",Description:"STR@L_TellMeAppDescription_SymbolsCharacters",LabelText:"STR@L_TellMeAppTitle_SymbolsCharacters"}},{name:"Button",attrs:{Id:"btnTellMeOfficeAddIn.WA104320163",Command:"0x67ED56AC",Image16by16:"STR@L_TellMeAppIconUrl_WordToHTML",Description:"STR@L_TellMeAppDescription_WordToHTML",LabelText:"STR@L_TellMeAppTitle_WordToHTML"}},{name:"Button",attrs:{Id:"btnTellMeOfficeAddIn.WA104374368",Command:"0x67ED56AC",Image16by16:"STR@L_TellMeAppIconUrl_MapIt",Description:"STR@L_TellMeAppDescription_MapIt",LabelText:"STR@L_TellMeAppTitle_MapIt"}},{name:"Button",attrs:{Id:"btnTellMeOfficeAddIn.WA104043061",Command:"0x67ED56AC",Image16by16:"STR@L_TellMeAppIconUrl_AbbreviationList",Description:"STR@L_TellMeAppDescription_AbbreviationList",LabelText:"STR@L_TellMeAppTitle_AbbreviationList"}},{name:"Button",attrs:{Id:"btnTellMeOfficeAddIn.WA104379673",Command:"0x67ED56AC",Image16by16:"STR@L_TellMeAppIconUrl_HandyCalculator",Description:"STR@L_TellMeAppDescription_HandyCalculator",LabelText:"STR@L_TellMeAppTitle_HandyCalculator"}}]},TellMeControlMetadataOverrides={Image16by16:{btnFootnote:"IMGMAP@we@Footnote_16x16x32",btnNewComment:"IMGMAP@we@NewComment_16x16x32",cellShadingColor:"IMGMAP@we@FillColorSplitDropdown_16x16x32",jbtnDirectPrint:"IMGMAP@we@Print_16x16x32",jbtnPrintToPdf:"IMGMAP@we@Print_16x16x32",jbtnTermsOfUse:"IMGMAP@we@Info_16x16x32",jbtnWheresTheSaveButton:"IMGMAP@we@WheresTheSaveButtonMenuItem_16x16x32"},LabelText:{btnDeleteComment:"STR@L_btnDeleteComment_FriendlyLabel",btnEndnote:"STR@L_btnEndnote_FriendlyLabel",btnFootnote:"STR@L_btnFootnote_FriendlyLabel",btnImageGrow:"STR@L_btnImageGrow_FriendlyLabel",btnImageShrink:"STR@L_btnImageShrink_FriendlyLabel",btnInsertHeaderFooter:"STR@L_btnInsertHeaderFooter_FriendlyLabel",btnjClose:"STR@L_btnjClose_FriendlyLabel",btnNextComment:"STR@L_btnNextComment_FriendlyLabel",btnPreviousComment:"STR@L_btnPreviousComment_FriendlyLabel",btnViewHeaderFooter:"STR@L_btnViewHeaderFooter_FriendlyLabel",buttonBandedColumn:"STR@L_buttonBandedColumn_FriendlyLabel",buttonBandedRow:"STR@L_buttonBandedRow_FriendlyLabel",buttonFirstColumn:"STR@L_buttonFirstColumn_FriendlyLabel",buttonFirstRow:"STR@L_buttonFirstRow_FriendlyLabel",buttonLastColumn:"STR@L_buttonLastColumn_FriendlyLabel",buttonLastRow:"STR@L_buttonLastRow_FriendlyLabel",buttonMarginsCustom:"STR@L_buttonMarginsCustom_FriendlyLabel",buttonMarginsModerate:"STR@L_buttonMarginsModerate_FriendlyLabel",buttonMarginsNarrow:"STR@L_buttonMarginsNarrow_FriendlyLabel",buttonMarginsNormal:"STR@L_buttonMarginsNormal_FriendlyLabel",buttonMarginsOffice2003:"STR@L_buttonMarginsOffice2003_FriendlyLabel",buttonMarginsWide:"STR@L_buttonMarginsWide_FriendlyLabel",buttonNumberStyle1:"STR@L_buttonNumberStyle1_FriendlyLabel",buttonNumberStyle2:"STR@L_buttonNumberStyle2_FriendlyLabel",buttonNumberStyle3:"STR@L_buttonNumberStyle3_FriendlyLabel",buttonNumberStyle4:"STR@L_buttonNumberStyle4_FriendlyLabel",buttonNumberStyle5:"STR@L_buttonNumberStyle5_FriendlyLabel",buttonOrientationLandscape:"STR@L_buttonOrientationLandscape_FriendlyLabel",buttonOrientationPortrait:"STR@L_buttonOrientationPortrait_FriendlyLabel",buttonSizeA4:"STR@L_buttonSizeA4_FriendlyLabel",buttonSizeA5:"STR@L_buttonSizeA5_FriendlyLabel",buttonSizeExecutive:"STR@L_buttonSizeExecutive_FriendlyLabel",buttonSizeLegal:"STR@L_buttonSizeLegal_FriendlyLabel",buttonSizeLetter:"STR@L_buttonSizeLetter_FriendlyLabel",CenterJustify:"STR@L_CenterJustify_FriendlyLabel",EditingFind:"STR@L_FindInDocument",faAbout:"STR@L_faAbout_FriendlyLabel",faNew:"STR@L_faNew_FriendlyLabel",flyInsertSymbols:"STR@L_InsertSymbolFriendlyName",flyInsertTable:"STR@L_MenuInsertTable",flyOrientation:"STR@L_flyOrientation_FriendlyLabel",flySize:"STR@L_flySize_FriendlyLabel",fseaInsertClipart:"STR@L_fseaInsertClipart_FriendlyLabel",fseaInsertHyperlink:"STR@L_fseaInsertHyperlink_FriendlyLabel",fseaInsertPageBreak:"STR@L_fseaInsertPageBreak_FriendlyLabel",fseaInsertOnlinePicture:"STR@L_fseaInsertOnlinePicture_FriendlyLabel",fseaInsertPicture:"STR@L_fseaInsertPicture_FriendlyLabel",fsfaMoreStyles:"STR@L_fsfaMoreStyles_FriendlyLabel",fsfaMoreTableStyles:"STR@L_fsfaMoreTableStyles_FriendlyLabel",fsfaPageNumbers:"STR@L_fsfaPageNumbers_FriendlyLabel",fsfaTableStyleTheme:"STR@L_fsfaTableStyleTheme_FriendlyLabel",FullJustify:"STR@L_FullJustify_FriendlyLabel","grpPictureFormat.PictureStyleAnchor":"STR@L_grpPictureFormat_PictureStyleAnchor_FriendlyLabel",jbtnDownloadACopy:"STR@L_jbtnDownloadACopy_FriendlyLabel",jbtnFileEmbed:"STR@L_jbtnFileEmbed_FriendlyLabel",jbtnFileSharing:"STR@L_ShareViaEmail",jbtnRenameDialog:"STR@L_jbtnRenameDialog_FriendlyLabel",TextDirLTR:"STR@L_TextDirLTR_FriendlyLabel",TextDirRTL:"STR@L_TextDirRTL_FriendlyLabel"},Alt:{EditingFind:null}};Type.registerNamespace("WordEditor.TellMe");WordEditor.TellMe.$bt=function(a){this.$8a=a};WordEditor.TellMe.$bt.prototype={$8a:null,get_$5qF:function(){return 7},$1hd:function(b,c){var a=WordEditor.TellMe.$70.$T.get_$sl()[b.$Q];return WordEditor.TellMe.$7e.$8Q(a,true,this.$8a,c)}};WordEditor.TellMe.$W7=function(a){this.$8a=a};WordEditor.TellMe.$W7.prototype={$8a:null,get_$5qF:function(){return 8},$1hd:function(h,c){if(this.$8a.$1St()){for(var e=[],f=h.$Q.split("|"),d=f,i=d.length,b=0;b<i;++b){var g=d[b];if(!CommandUI.$I.$8R(g)){var m=WordEditor.TellMe.$70.$T.get_$sl()[g],n=WordEditor.TellMe.$7e.$8Q(m,false,this.$8a,c);e.push(n)}}var j=WordEditor.TellMe.$7e.$4uk("TellMeDropdownControlsForApps_SingleFlyoutLayout",e,"TellMeDropdownMenuSectionForApps_SingleFlyoutLayout",false,CommonUIStrings.l_TellMeAppsForOfficeMenuSectionTitle),k=String.format(CommonUIStrings.l_TellMeAppsForOfficeFlyoutAnchorTitle,f.length-1),l=WordEditor.TellMe.$7e.$3S1("TellMeFlyoutAnchorForApps_SingleFlyoutLayout",Common.$0.$9R,Common.$n.$6d("AppForOfficeLogo_16x16x32"),k,[j]);return l}else{var a=WordEditor.TellMe.$70.$T.get_$sl()[h.$Q];if(this.$8a.$3fw()){var o=WordEditor.TellMe.$7e.$8Q(a,false,this.$8a,c),p=[o],q=Common.$m.$sv("TellMeControlsForApps_StandardFlyoutLayout",p),r=Common.$m.$sw("TellMeMenuSectionForApps_StandardFlyoutLayout",q,"Menu32",null),s=String.format(CommonUIStrings.l_TellMeAppsForOfficeInsertAppHint,Common.$9.$3O(a.$KK));return WordEditor.TellMe.$7e.$3S1("TellMeFlyoutAnchorForApps_StandardFlyoutLayout"+a.$pu,a.$1Xd,"cui-img-16by16",s,[r])}else return WordEditor.TellMe.$7e.$8Q(a,true,this.$8a,c)}}};WordEditor.TellMe.$7e=function(){};WordEditor.TellMe.$7e.$8Q=function(a,d,l,b){var c=Common.$9.$3O(a.$KK),e=WordEditor.TellMe.$7e.$2qN(a,l),f=Common.$9.$3O(a.$VN),g=WordEditor.TellMe.$7e.$4ue(a.$x6),h=d?"Menu16":"Menu32",i=d?"cui-img-16by16":"cui-img-32by32",j=b?b.get_$35Q()+"|"+b.get_$3eH()+"|"+a.$KK:"",k="1708531416";return Common.$m.$1PA(e,g,c,a.$1Xd,i,null,j,c,h,null,k,f,null,true)};WordEditor.TellMe.$7e.$3S1=function(b,c,d,a,e){return Common.$m.$3He(b,null,null,null,false,true,null,null,"Image16by16",c,d,a,null,a,null,false,false,true,e)};WordEditor.TellMe.$7e.$4uk=function(d,e,f,g,h){var a=Common.$m.$sv(d,e),b=g?"Menu16":"Menu32",c=Common.$m.$sw(f,a,b,h);return c};WordEditor.TellMe.$7e.$2qN=function(a,c){var d=2,b="TellMe_OfficeAddin_Control";if(c.$1St())b="TellMe_OfficeAddin_SingleFlyoutLayout";else if(c.$3fw())b="TellMe_OfficeAddin_StandaloneFlyoutLayout";return a.$x6?String.format("{0}|{1}|{2}|{3}|{4}|{5}|{6}",a.$pu,a.$1rX,a.$1ta,a.$1rZ,a.$1ti,Common.$9.$3O(a.$KK),b):String.format("{0}|{1}||{2}",d,a.$pu,b)};WordEditor.TellMe.$7e.$4ue=function(a){return a?"3553159035":"1945259303"};WordEditor.TellMe.$W8=function(a){this.$8a=a;var b=this;this.$2hB=function(c,d){var a=c,b=d;return a.$19===b.$19?0:a.$19===8?1:b.$19===8?-1:0}};WordEditor.TellMe.$W8.prototype={$8a:null,$1e9:null,$2hB:null,$8F:function(){WordEditor.TellMe.$GB.$T.$5ig();if(this.$8a.$1St())this.$1e9=[]},$69A:function(f,a,e){if(a in WordEditor.TellMe.$70.$T.get_$sl()){var b=WordEditor.TellMe.$70.$T.get_$sl()[a];if(this.$8a.$1St()&&!b.$x6)this.$1e9.push(a);else{var c=b.$x6?7:8,d=new Common.App.TellMe.$Bf(a,c,null);e.$dX(d)}}},$4Pu:function(a){if(this.$8a.$1St()&&this.$1e9.length){for(var d="",c=this.$1e9,e=c.length,b=0;b<e;++b){var g=c[b];d+="|"+g}var f=new Common.App.TellMe.$Bf(d,8,null);a.$dX(f)}a.get_$1FZ().sort(this.$2hB);this.$8a.$1St()&&a.get_$1FZ().length===6&&Array.removeAt(a.get_$1FZ(),4)}};WordEditor.TellMe.$de=function(){};WordEditor.TellMe.$de.prototype={$KK:null,$pu:null,$VN:null,$1Xd:null,$x6:false,$1rX:null,$1rZ:null,$3BF:null,$1ta:null,$1ti:0};WordEditor.TellMe.$GB=function(){this.$$d_$5Ym=Function.createDelegate(this,this.$5Ym);this.$$d_$3k4=Function.createDelegate(this,this.$3k4);this.$$d_$5qT=Function.createDelegate(this,this.$5qT)};WordEditor.TellMe.$GB.prototype={$xy:0,$2UW:false,$5ig:function(){if(!this.$2UW){this.$3qM();this.$2UW=true}if(!this.$xy||this.$xy===4){var a=new Common.$1e(2,1,0,this.$$d_$5qT);Common.$0.get_$2e().$2f(a);this.$xy=1}},$3qM:function(){var a={};a.callback=this.$$d_$3k4;var b=Common.$0.get_$r().$4J(741381681,2,a)},$5qT:function(){var a={};a.callback=this.$$d_$5Ym;var b=Common.$0.get_$r().$4J(860152194,2,a)},$3k4:function(g,a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];WordEditor.TellMe.$70.$T.$4qn(b,c,d,e,f)},$5Ym:function(b){if(b){var a=b;!a.errorCode&&WordEditor.TellMe.$70.$T.$4LQ(a.value);if(!a.errorCode||a.errorCode===-1){this.$xy=2;return}if(a.errorCode===-2147208619){this.$xy=4;return}this.$xy=3;return}this.$xy=3}};WordEditor.TellMe.$70=function(){};WordEditor.TellMe.$70.prototype={$1Yz:null,get_$sl:function(){if(!this.$1Yz){this.$1Yz={};this.$5iJ()}return this.$1Yz},$4LQ:function(f){if(!f)return;for(var d=f,g=d.length,c=0;c<g;++c){var a=d[c],e=a[1];if(e in this.get_$sl()){var b=this.get_$sl()[e];b.$x6=true;b.$KK=a[0];b.$VN=a[2];b.$1ti=a[3];b.$1rX=a[4];b.$3BF=a[6];b.$1Xd=a[9];b.$1ta=a[11];b.$1rZ=a[12]}}},$4qn:function(b,c,d,e,f){if(CommandUI.$I.$8R(b))return;if(b in this.get_$sl()){var a=this.get_$sl()[b];a.$x6=true;a.$1rX=c;a.$1ta=d;a.$1rZ=e;a.$1ti=f}},$OO:function(c,b,d,e){var a=new WordEditor.TellMe.$de;a.$pu=b;a.$KK=c;a.$1Xd=d;a.$VN=e;a.$x6=false;this.$1Yz[b]=a},$5iJ:function(){this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_Translator,"WA104124372",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_Translator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_Translator);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_TextMaster,"WA104079622",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_TextMaster,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_TextMaster);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ConsistencyChecker,"WA104041485",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ConsistencyChecker,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ConsistencyChecker);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_EFax,"WA102919521",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_EFax,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_EFax);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ProWordCloud,"WA104038830",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ProWordCloud,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ProWordCloud);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_FontFinder,"WA104211266",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_FontFinder,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_FontFinder);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_PicHit,"WA104178141",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_PicHit,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_PicHit);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_IMGEffector,"WA104070070",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_IMGEffector,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_IMGEffector);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_LucidChart,"WA103633427",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_LucidChart,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_LucidChart);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_DocuSign,"WA104218065",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_DocuSign,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_DocuSign);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_GeoGebraTube,"WA104199813",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_GeoGebraTube,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_GeoGebraTube);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordCalc,"WA103699714",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordCalc,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordCalc);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_QR4Office,"WA104051163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_QR4Office,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_QR4Office);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_SymbolsCharacters,"WA104379279",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_SymbolsCharacters,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_SymbolsCharacters);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordToHTML,"WA104320163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordToHTML,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordToHTML);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_MapIt,"WA104374368",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_MapIt,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_MapIt);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_AbbreviationList,"WA104043061",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_AbbreviationList,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_AbbreviationList);this.$OO(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_HandyCalculator,"WA104379673",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_HandyCalculator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_HandyCalculator)}};WordEditor.TellMe.$GP=function(a){this.$$d_$5gD=Function.createDelegate(this,this.$5gD);this.$K=a};WordEditor.TellMe.$GP.$5EM=function(){return Common.$m.$OQ("btnwcWordCount","798637440",null,null,null,null,null,null,null,"4287426395",null,null,true)};WordEditor.TellMe.$GP.prototype={$K:null,$1v7:null,$5gD:function(g,h,e,i,f){if(e===1)return 32;Diag.$2.$9(7381469,1300,50,"Building word count flyout");if(!this.$1v7){var b=[WordEditor.TellMe.$GP.$5EM()],c=Common.$m.$sv("WordCountControls",b),d=Common.$m.$sw("WordCountMenuSection",c,"Menu",WordEditorIntl.WordEditorStrings.L_WordCountFlyoutTitle);this.$1v7=Common.$m.$1BL([d],null)}var a=f;a.PopulationXML=this.$1v7;return 32},$3F:function(){this.$K.$P(3902924380,1,this.$$d_$5gD)},$1T9:function(){var a={};this.$K.$4J(4287426395,2,a);return a[CommandUI.Controls.$3a.Visible]}};WordEditor.TellMe.$qL=function(){};WordEditor.TellMe.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.TellMe.$jS)};WordEditor.TellMe.$8l=function(f){WordEditor.TellMe.$8l.initializeBase(this,[window.TellMeControlMetadataOverrides,null,null,null]);this.$2Pa="Word";this.$2Wy=f;var d=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],a=new Common.App.TellMe.$qT.$4kf(Box4.$2R.$WW,WordEditorIntl.WordEditorStrings,d);this.$5ps(a);this.$5pq(window.TellMeAdditionalControls,a);this.$3BK=WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle;this.$1XF=Common.$0.$o.$1A("SearchOfficeAddinIsEnabled");var b=new WordEditor.TellMe.$YN,c=new WordEditor.TellMe.$hl;this.$1Y3[b.get_$28O()]=b;this.$1Y3[c.get_$28O()]=c;if(Common.$0.$o.$1A("TellMeTryQueriesIsEnabled")){var e=[new Common.App.TellMe.$Hi(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,WordEditorIntl.WordEditorStrings.L_TellMeTryQuery06,Common.$0.$o.$1A("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")&&Common.$0.$oQ),new Common.App.TellMe.$Hi(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",false),new Common.App.TellMe.$Hi(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",false),new Common.App.TellMe.$Hi(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",false),new Common.App.TellMe.$Hi(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",false)];this.$1to=this.$4mg(e)}};WordEditor.TellMe.$8l.prototype={$2Wy:null,get_$34Q:function(){return"ribbon"},$537:function(){return this.$1XF?new WordEditor.TellMe.$W8(this):null},$5lK:function(a){if(this.$1XF){a.$14Z(new WordEditor.TellMe.$bt(this));a.$14Z(new WordEditor.TellMe.$W7(this))}},$52Z:function(){return new CommandUI.$EY("TellMeRoot",Box4.App.get_$X().$4p.get_$62R())},$36k:function(d){var b=Common.$0.$o,a=d.get_$Rr().$RA.$FE;a.WordCountFlyout=!this.$2Wy.$1T9();a.SelectAllButton=!b.$1A("TellMeSelectAllResultIsEnabled");a.TextBoxUpSellButton=!b.$1A("TellMeDesktopUpSellIsEnabled");a.TableOfContentsUpSellButton=!b.$1A("TellMeDesktopUpSellIsEnabled");a.SmartArtUpSellButton=!b.$1A("TellMeDesktopUpSellIsEnabled");a.WordArtUpSellButton=!b.$1A("TellMeDesktopUpSellIsEnabled");a.MultiColumnLayoutUpSellButton=!b.$1A("TellMeDesktopUpSellIsEnabled");a.InsertEquationUpSellButton=!b.$1A("TellMeDesktopUpSellIsEnabled");var c=!b.$1A("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!Common.$0.$oQ;a.SynonymButton=c;a.DefinitionButton=c},$1St:function(){var a=Common.$0.$o.$5L("OfficeAddInSearchResultLayoutVariant",WordEditor.TellMe.$8l.$31A);return a===WordEditor.TellMe.$8l.$3jj},$3fw:function(){var a=Common.$0.$o.$5L("OfficeAddInSearchResultLayoutVariant",WordEditor.TellMe.$8l.$31A);return a===WordEditor.TellMe.$8l.$3jk}};WordEditor.TellMe.$jS=function(){this.$$d_$5s4=Function.createDelegate(this,this.$5s4);this.$$d_$1F5=Function.createDelegate(this,this.$1F5);WordEditor.TellMe.$jS.initializeBase(this)};WordEditor.TellMe.$jS.prototype={$U:null,get_$5j:function(){return"WordEditor.TellMe"},$t9:function(a){this.$U=a;var b=this;this.$U.$e(WordEditor.TellMe.$GP).$p().$n(function(){return new WordEditor.TellMe.$GP(Common.$0.get_$r())})},$7Y:function(){Common.$0.$o.$UQ(this.$$d_$1F5)},$1F5:function(){if(!Common.$0.$1qX)return;var a=Box4.App.get_$X().$gA.$3az(2652476189);a.add_$XF(this.$$d_$5s4);var b=Common.Utils.$8.get_$4().$J(WordEditor.TellMe.$GP),c=new WordEditor.TellMe.$8l(b);b.$3F();Common.App.TellMe.$9Y.get_$4().$8F(c,null,null,null,null,null);Common.App.TellMe.$9Y.get_$4().$5lD(a)},$5s4:function(){Box4.App.get_$X().$86(false);Box4.App.get_$X().$4p.$K1("sbTellMe")}};WordEditor.TellMe.$YN=function(){WordEditor.TellMe.$YN.initializeBase(this)};WordEditor.TellMe.$YN.prototype={get_$28O:function(){return"DefinitionButton"},get_$5ef:function(){return"Definition"},$4ea:function(a){var b=Common.$9.$3O(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,a.$1FG));return Common.$m.$OQ(Common.App.TellMe.$5I.$3LJ(a.$Q),"2114287254",b,Common.App.TellMe.$5I.get_$2x7(),null,Common.$9.$3O(Common.App.TellMe.$5I.$2nR(a.$1FG)),b,null,null)}};WordEditor.TellMe.$hl=function(){WordEditor.TellMe.$hl.initializeBase(this)};WordEditor.TellMe.$hl.prototype={get_$28O:function(){return"SynonymButton"},get_$5ef:function(){return"Synonym"},$4ea:function(a){var b=Common.$9.$3O(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,a.$1FG));return Common.$m.$OQ(Common.App.TellMe.$5I.$3LJ(a.$Q),"2114287254",b,Common.App.TellMe.$5I.get_$2x7(),null,Common.$9.$3O(Common.App.TellMe.$5I.$2nR(a.$1FG)),b,null,null)}};WordEditor.TellMe.$bt.registerClass("WordEditor.TellMe.$bt",null,Common.App.TellMe.$kb);WordEditor.TellMe.$W7.registerClass("WordEditor.TellMe.$W7",null,Common.App.TellMe.$kb);WordEditor.TellMe.$7e.registerClass("WordEditor.TellMe.$7e");WordEditor.TellMe.$W8.registerClass("WordEditor.TellMe.$W8",null,Common.App.TellMe.$lH);WordEditor.TellMe.$de.registerClass("WordEditor.TellMe.$de");WordEditor.TellMe.$GB.registerClass("WordEditor.TellMe.$GB");WordEditor.TellMe.$70.registerClass("WordEditor.TellMe.$70");WordEditor.TellMe.$GP.registerClass("WordEditor.TellMe.$GP");WordEditor.TellMe.$qL.registerClass("WordEditor.TellMe.$qL");WordEditor.TellMe.$8l.registerClass("WordEditor.TellMe.$8l",Common.App.TellMe.$qT);WordEditor.TellMe.$jS.registerClass("WordEditor.TellMe.$jS",Common.App.TellMe.$qS);WordEditor.TellMe.$YN.registerClass("WordEditor.TellMe.$YN",Common.App.TellMe.$qc);WordEditor.TellMe.$hl.registerClass("WordEditor.TellMe.$hl",Common.App.TellMe.$qc);WordEditor.TellMe.$GB.$T=new WordEditor.TellMe.$GB;WordEditor.TellMe.$70.$T=new WordEditor.TellMe.$70;WordEditor.TellMe.$8l.$31A=1;WordEditor.TellMe.$8l.$3jk=2;WordEditor.TellMe.$8l.$3jj=3;WordEditor.TellMe.$qL.$5Sr();Type.registerNamespace("WETF");WETF.$jT=function(){this.$$d_$64F=Function.createDelegate(this,this.$64F)};WETF.$jT.$5Sr=function(){Common.App.$f.get_$4().$3M(new WETF.$jT)};WETF.$jT.prototype={$U:null,get_$5j:function(){return"WordEditor.TestFeature"},$7Y:function(){var a=this;this.$U.$J(Box4.$2o).get_$SM().CW(function(){a.$ap()})},$d:function(){},$ap:function(){if(!this.$U.$J(Box4.$2o).$3S(46))return;Common.$0.get_$r().$1W(3898052220,2,this.$$d_$64F,96);var a=Common.$b.$4().$2w("editing");Common.$1R.$5t(a,Common.$G.$1F(70,5|Common.$G.get_$56()),3898052220)},$64F:function(c,d,b){if(b===2){var a=new CommonUI.$4j;a.set_$4T(0);a.$wL(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null)}return 32},$t9:function(a){this.$U=a}};WETF.$jT.registerClass("WETF.$jT",null,Common.App.$jx,Common.Utils.$l6);WETF.$jT.$5Sr();Type.registerNamespace("WEDOT");WEDOT.$gR=function(){};WEDOT.$gS=function(){};WEDOT.$qu=function(){};WEDOT.$KD=function(){};WEDOT.$KD.$1Gz=function(c,h){var a=new WordEditor.$KC(0),f=false,b=0,d=0;if(c.get_$2Y())while(b<c.get_$14h()&&d<h){var i=c.$3L0(b);f=false;var e=c.$2uo(b);e.$42a(a);if(e.$3dd()){if(d+i>h){a.$4e+=h-d;return a}if(e.$3Kx())f=true;a.$4e+=i}e.$42Z(a);b++;d=c.$1hU(b)}if(b<c.get_$14h()){var g=c.$2uo(b);if(g){a.$4e===c.$1hU(b)&&g.$69c(a);if(f)if(!g.$3Kx())a.$Y8++}}return a};WEDOT.$KD.$1hV=function(d,e){var b=0;if(d.get_$2Y()){var c=0,a=new WordEditor.$KC(0);while(c<d.get_$14h()&&!a.$ST(e,true)){var f=d.$3L0(c),g=d.$2uo(c);g.$42a(a);if(a.$ST(e,true))return b;if(g.$3dd()){if(a.$4e+f>e.$4e){b+=e.$4e-a.$4e;return b}a.$4e+=f}g.$42Z(a);b+=f;c++}}return b};WEDOT.$Bz=function(e,f,g,a,b,c,d,h){this.$Kr=h;this.$1V0=e;this.$ve=f;this.$wV=g;if(a)this.$142=a;if(b!=null)this.$p7=b;if(c!=null)this.$1WY=c;if(d)this.$1UA=d};WEDOT.$Bz.prototype={$Kr:0,$1V0:0,$ve:0,$wV:0,$142:null,$p7:null,$1WY:null,$1UA:null};WEDOT.$eP=function(b,c){var a=b;this.$1Mj=c;this.$1YT=a.length};WEDOT.$eP.prototype={$1Mj:null,$1YT:0,get_$2Y:function(){return this.$1YT},get_$14h:function(){return!this.$1Mj?0:this.$1Mj.get_$N()},$1hU:function(a){return a>=this.get_$14h()?this.$1YT:this.$1Mj.get_$5(a).$1K},$3L0:function(a){return a>=this.get_$14h()-1?this.$1YT-this.$1hU(this.get_$14h()-1):this.$1hU(a+1)-this.$1hU(a)},$2uo:function(a){if(a>=this.get_$14h())a=this.get_$14h()-1;return new WEDOT.$jg(this.$1Mj.get_$5(a))}};WEDOT.$AB=function(){};WEDOT.$AB.$4mL=function(a){return new WEDOT.$Bz(a.RK,a.PS,a.TS,WEDOT.$7w.$1r7(a.OS),a.PE,a.TE,WEDOT.$7w.$1r7(a.OE),a.DK)};WEDOT.$AB.$3tr=function(a){var b=new WEDOT.$gR;b.RK=a.$1V0;b.PS=a.$ve;b.TS=a.$wV;b.DK=a.$Kr;if(a.$142)b.OS=WEDOT.$AB.$3ts(a.$142);if(a.$p7)b.PE=a.$p7;if(a.$1WY)b.TE=a.$1WY;if(a.$1UA)b.OE=WEDOT.$AB.$3ts(a.$1UA);return b};WEDOT.$AB.$4mM=function(a){if(!a)return null;var b=new WordEditor.$KC(a.CP);b.$be=a.FB!=null?a.FB:0;b.$Y4=a.FE!=null?a.FE:0;b.$bS=a.CB!=null?a.CB:0;b.$bT=a.CE!=null?a.CE:0;b.$fu=a.HB!=null?a.HB:0;b.$Y8=a.HE!=null?a.HE:0;b.$br=a.R!=null?a.R:0;b.$bd=a.E!=null?a.E:0;b.$bv=a.TW!=null?a.TW:0;b.$bo=a.PB!=null?a.PB:0;b.$bu=a.SYM!=null?a.SYM:0;b.$bg=a.IE!=null?a.IE:0;b.$bm=a.OO!=null?a.OO:0;b.$bN=a.AX!=null?a.AX:0;return b};WEDOT.$AB.$3ts=function(a){if(!a)return null;var b=new WEDOT.$gS;b.CP=a.$4e;b.VS=1;if(a.$be>0)b.FB=a.$be;if(a.$Y4>0)b.FE=a.$Y4;if(a.$bS>0)b.CB=a.$bS;if(a.$bT>0)b.CE=a.$bT;if(a.$fu>0)b.HB=a.$fu;if(a.$Y8>0)b.HE=a.$Y8;if(a.$br>0)b.R=a.$br;if(a.$bd>0)b.E=a.$bd;if(a.$bv>0)b.TW=a.$bv;if(a.$bo>0)b.PB=a.$bo;if(a.$bu>0)b.SYM=a.$bu;if(a.$bg>0)b.IE=a.$bg;if(a.$bm>0)b.OO=a.$bm;if(a.$bN>0)b.AX=a.$bN;return b};WEDOT.$7w=function(){};WEDOT.$7w.$6A2=function(a){return typeof a.CP!=="number"?false:a.FB!=null&&typeof a.FB!=="number"?false:a.FE!=null&&typeof a.FE!=="number"?false:a.HB!=null&&typeof a.HB!=="number"?false:a.HE!=null&&typeof a.HE!=="number"?false:a.CB!=null&&typeof a.CB!=="number"?false:a.CE!=null&&typeof a.CE!=="number"?false:a.R!=null&&typeof a.R!=="number"?false:a.E!=null&&typeof a.E!=="number"?false:a.TW!=null&&typeof a.TW!=="number"?false:a.PB!=null&&typeof a.PB!=="number"?false:a.SYM!=null&&typeof a.SYM!=="number"?false:a.IE!=null&&typeof a.IE!=="number"?false:a.OO!=null&&typeof a.OO!=="number"?false:a.AX!=null&&typeof a.AX!=="number"?false:true};WEDOT.$7w.$5Ov=function(a){return a===1};WEDOT.$7w.$3bk=function(f,g){var a=f,b=0;if(typeof a.VS==="number")b=a.VS;var h=typeof a.VS!=="number"&&typeof a.CP!=="number";if(!h){g.val=b;return a}var d=f;a=null;for(var c=0;c<d.length;c++){var e=d[c];if(WEDOT.$7w.$5Ov(e.VS)&&e.VS>b){b=e.VS;a=d[c]}}g.val=b;return a};WEDOT.$7w.$433=function(e){var a,b,c,d=(c=WEDOT.$7w.$3bk(e,b={val:a}),a=b.val,c);if(!d)return false;switch(a){case 0:case 1:return WEDOT.$7w.$6A2(d);default:return false}};WEDOT.$7w.$1r7=function(e){if(!e)return null;var a,b,c,d=(c=WEDOT.$7w.$3bk(e,b={val:a}),a=b.val,c);if(!d)return null;switch(a){case 0:case 1:return WEDOT.$AB.$4mM(d);default:return null}};WEDOT.$PF=function(){};WEDOT.$PF.$69x=function(a){if(typeof a.RK!=="number")return false;if(typeof a.DK!=="number")return false;var b=false,d=false,c=false,e=false;switch(a.RK){case 0:b=true;c=true;break;case 1:b=true;c=true;d=true;e=true;break;case 2:if(a.PE!=null&&typeof a.PE!=="number")return false;b=true;break;case 4:b=true;break;case 3:b=true;c=true;break;case 5:b=true;d=true;break;default:return false}return b&&(typeof a.PS!=="number"||typeof a.TS!=="number")?false:c&&(typeof a.OS!=="object"||!a.OS||!WEDOT.$7w.$433(a.OS))?false:d&&(typeof a.PE!=="number"||typeof a.TE!=="number")?false:e&&(typeof a.OE!=="object"||!a.OE||!WEDOT.$7w.$433(a.OE))?false:true};WEDOT.$B3=function(){};WEDOT.$B3.$4=function(){if(!WEDOT.$B3.$T)WEDOT.$B3.$T=new WEDOT.$B3;return WEDOT.$B3.$T};WEDOT.$B3.prototype={$14F:function(a,b){return new WEDOT.$eP(a,b)},$1Gz:function(a,b){return WEDOT.$KD.$1Gz(a,b)},$1hV:function(a,b){return WEDOT.$KD.$1hV(a,b)}};WEDOT.$jW=function(){};WEDOT.$jW.$5Sr=function(){Common.App.$f.get_$4().$3M(new WEDOT.$jW)};WEDOT.$jW.prototype={$U:null,get_$5j:function(){return"WordEditor.WordTextOffsetTranslator"},$7Y:function(){},$d:function(){},$t9:function(a){this.$U=a;var b=this;this.$U.$e(WordEditor.$D5).$p().$n(function(){return WEDOT.$B3.$4()})}};WEDOT.$jg=function(a){this.$17B=a};WEDOT.$jg.prototype={$17B:null,$42a:function(b){var a=this.$17B.get_$8N();if(a){if(a.get_$82()===1)return;if(a.get_$82()===5)return}b.$3JR()},$42Z:function(c){var a=this.$17B.get_$8N();if(a){var b=$$as(Box4.$cO,a);if(b)c.$3F2(b.get_$5QD());else a.get_$82()===5&&c.$3F2(10)}},$69c:function(a){if(this.$17B.get_$Op())a.$Y4++;if(this.$17B.get_$BV())a.$Y8++},$3Kx:function(){return false},$3dd:function(){var a=this.$17B.get_$8N();if(a){if(a.get_$82()===1)return false;if(a.get_$82()===5)return false}return true}};WEDOT.$gR.registerClass("WEDOT.$gR");WEDOT.$gS.registerClass("WEDOT.$gS");WEDOT.$qu.registerClass("WEDOT.$qu");WEDOT.$KD.registerClass("WEDOT.$KD");WEDOT.$Bz.registerClass("WEDOT.$Bz");WEDOT.$eP.registerClass("WEDOT.$eP",null,WordEditor.$lu);WEDOT.$AB.registerClass("WEDOT.$AB");WEDOT.$7w.registerClass("WEDOT.$7w");WEDOT.$PF.registerClass("WEDOT.$PF");WEDOT.$B3.registerClass("WEDOT.$B3",null,WordEditor.$D5);WEDOT.$jW.registerClass("WEDOT.$jW",null,Common.App.$jx,Common.Utils.$l6);WEDOT.$jg.registerClass("WEDOT.$jg",null,WordEditor.$lh);WEDOT.$B3.$T=null;WEDOT.$jW.$5Sr();Type.registerNamespace("WordEditor.Zoom");WordEditor.Zoom.$V6=function(){};WordEditor.Zoom.$V6.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.Zoom.$V6)};WordEditor.Zoom.$V6.prototype={$U:null,get_$5j:function(){return"WordEditor.Zoom"},$7Y:function(){if(Common.$0.$o.$1A("ZoomPopupDialogIsEnabled")){var a=this.$U.$J(WordEditor.Zoom.$Os);a.$3F();Sys.UI.DomElement.overrideGetBounds=true}},$d:function(){},$t9:function(b){this.$U=b;if(Common.$0.$o.$1A("ZoomPopupDialogIsEnabled")){var c=this;this.$U.$e(WordEditor.Zoom.$Ot).$1p(Common.$8U).$n(function(){return new WordEditor.Zoom.$Ot(Common.$0.$o,Box4.$3G.get_$4())}).$p();var a=this;this.$U.$e(WordEditor.Zoom.$Os).$n(function(){return new WordEditor.Zoom.$Os(Common.$0.get_$r(),a.$U.$J(WordEditor.Zoom.$Ot),Common.$0.$o)}).$p()}}};WordEditor.Zoom.$Ot=function(a,b){this.$$d_$6BD=Function.createDelegate(this,this.$6BD);this.$$d_$3sO=Function.createDelegate(this,this.$3sO);this.$43R=[CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.$43S=["PageWidth","200","150","100","75","50"];WordEditor.Zoom.$Ot.initializeBase(this,[a]);this.$mr=b};WordEditor.Zoom.$Ot.prototype={$34A:false,$mr:null,get_appName:function(){return"WordEditor"},get_maximumZoom:function(){return 4},get_minimumZoom:function(){return.1},get_$6BC:function(){return CommandUI.Controls.$5A.LabelText},$IT:null,get_$b8:function(){return this.$IT||(this.$IT=Common.Utils.$8.get_$4().$2S(WordEditor.$BS))},updateZoom:function(a){if(this.$wx===a)return;if(a>this.get_maximumZoom())a=this.get_maximumZoom();else if(a<this.get_minimumZoom())a=this.get_minimumZoom();try{this.$wx=a;this.$5js();this.$69d();if(Box4.App.get_$X()&&Box4.$2N.isInstanceOfType(Box4.App.get_$X().$1L.$3o)){var b=Box4.App.get_$X().$1L.$3o;b.get_$GA()&&b.$Xw.$1Fk()}else Diag.$2.$9(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}catch(c){Diag.$2.$9(7185431,353,10,"UpdateZoom error:{0}",c)}},$6BD:function(b,c,a){if(a===2){Diag.$2.$9(7176730,353,50,"Zoom to 100%");this.$nJ=0;this.updateZoom(1)}return 32},$5vw:function(c,d,e,f,b){this.$nJ=0;var a=Number.parseInvariant(String.format("{0}",b))/100;Diag.$2.$9(7410915,353,50,"Word Editor - Zoom to custom value: {0}",a);this.updateZoom(a);return 32},$6BE:function(){return 32},$6BF:function(){Diag.$2.$9(7410944,353,50,"Word Editor - Zoom to fit page width");this.$nJ=2;this.$4qJ();return this.$3R4()},$5EP:function(){return this.$43R},$5EQ:function(){return this.$43S},$4qJ:function(){if(!this.$34A)if(Box4.App.get_$X()){Box4.App.get_$X().add_$Bx(this.$$d_$3sO);this.$34A=true}else Diag.$2.$9(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event")},$3R4:function(){var a=Box4.App.get_$X()?Box4.App.get_$X().$1L.$3o:null;if(a&&a.get_$41()&&a.get_$41().get_$Bf()&&Box4.App.get_$X().$Pu){var b=this.$mr.$f3(a.get_$41().get_$Bf());if(!b&&a.$f&&a.$f.get_$23().get_$1Z()&&a.$f.get_$23().get_$1Z().get_$11()&&a.$f.get_$23().get_$1Z().get_$11().$D)b=this.$mr.$f3(a.$f.get_$23().get_$1Z().get_$11().$D);if(null!==b){var c=Box4.$2F.get_$4().$MK(b),d=Common.$s.$DT(c,0,true),e=Box4.App.get_$X().$Pu.offsetWidth,f=e-20*2,g=f/d;this.updateZoom(g);return 32}else Diag.$2.$9(7185433,353,10,"Zoom to page width: cannot find word section node.")}else Diag.$2.$9(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8},$3sO:function(){this.$nJ===2&&this.$3R4()},$69d:function(){this.get_$b8()&&this.get_$b8().$14R("buttonShowZoomDialog")}};WordEditor.Zoom.$Os=function(b,a,c){WordEditor.Zoom.$Os.initializeBase(this,[b,a,c]);this.$2j0=a};WordEditor.Zoom.$Os.prototype={$2j0:null,$3F:function(){Common.App.Zoom.$qx.prototype.$3F.call(this);this.$3H.$1A("ZoomPopupDialogIsEnabled")&&this.$K.$P(2685241661,2147483648,this.$2j0.$$d_$6BD)}};WordEditor.Zoom.$V6.registerClass("WordEditor.Zoom.$V6",null,Common.App.$jx,Common.Utils.$l6);WordEditor.Zoom.$Ot.registerClass("WordEditor.Zoom.$Ot",Common.App.Zoom.$qw);WordEditor.Zoom.$Os.registerClass("WordEditor.Zoom.$Os",Common.App.Zoom.$qx);WordEditor.Zoom.$V6.$5Sr();Type.registerNamespace("WordEditor.Assistance");WordEditor.Assistance.$qL=function(){};WordEditor.Assistance.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.Assistance.$jE)};WordEditor.Assistance.$jE=function(){WordEditor.Assistance.$jE.initializeBase(this)};WordEditor.Assistance.$jE.prototype={get_$5j:function(){return"WordEditor.Assistance"},$7Y:function(){Common.App.Assistance.$qR.prototype.$7Y.call(this);if(!Common.$0.$1P6)return;var a=this;this.$5He(function(){return new Common.App.Assistance.$WE(new WordEditor.Assistance.$jR)},"WDWAEndUser")}};WordEditor.Assistance.$jR=function(){};WordEditor.Assistance.$jR.prototype={$3MM:function(){var a=new Common.$t(Box4.$2R.$WW,Box4Intl.Box4Strings,null,null,null);return Box4.TaskPaneManager.$3k.get_$4().$1Pr("AssistanceTaskPane",1,330,"AssistanceTaskPaneData",a)},$Xf:function(a){if(!a.$VQ){Box4.App.get_$X().$Rh.$37D(a.$y);a.$Bz();WordEditor.App.get_$7S().add_$1UC(a.$$d_$8T);WordEditor.App.get_$7S().$86(false)}},$133:function(a){Box4.TaskPaneManager.$3k.get_$4().$133(a)},$11Z:function(a,b){Box4.TaskPaneManager.$3k.get_$4().$11Z(a,b)}};WordEditor.Assistance.$qL.registerClass("WordEditor.Assistance.$qL");WordEditor.Assistance.$jE.registerClass("WordEditor.Assistance.$jE",Common.App.Assistance.$qR);WordEditor.Assistance.$jR.registerClass("WordEditor.Assistance.$jR",null,Common.App.Assistance.$pU);WordEditor.Assistance.$qL.$5Sr();var InteractivePerfTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InteractivePerfTaskPane",Title:"Interactive Perf TaskPane",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"TypingSpeedMeterGroup"}},{name:"Group",attrs:{Id:"CpuMeterGroup"}},{name:"Group",attrs:{Id:"RenderGroup"}}]}]}]};Type.registerNamespace("WordEditor.InteractivePerfTaskPane");WordEditor.InteractivePerfTaskPane.$bw=function(){};WordEditor.InteractivePerfTaskPane.$bw.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.InteractivePerfTaskPane.$bw)};WordEditor.InteractivePerfTaskPane.$bw.prototype={$2P:null,get_$5j:function(){return"WordEditor.InteractivePerfTaskPane"},$t9:function(a){if(Common.$0.$o.$1A("InteractivePerfTaskPaneIsEnabled")){var b=this;a.$e(WordEditor.InteractivePerfTaskPane.$9Q).$p().$n(function(){return new WordEditor.InteractivePerfTaskPane.$9Q(Common.$0.get_$r(),Box4.TaskPaneManager.$3k.get_$4(),Common.$0.get_$1Y().get_$PA(),a.$3j(Common.$J8),a.$3j(Common.$Gj))})}},$7Y:function(){this.$2P=Common.Utils.$8.get_$4().$2S(WordEditor.InteractivePerfTaskPane.$9Q);if(this.$2P){this.$2P.$3F();Common.$q.$uY(document.URL,"wdShowIPerfTaskPane")==="1"&&Common.$0.get_$r().$2u(156338938,2)}},$d:function(){if(this.$2P){this.$2P.$d();this.$2P=null}}};WordEditor.InteractivePerfTaskPane.$eS=function(a){this.$2P=a};WordEditor.InteractivePerfTaskPane.$eS.prototype={$196:0,$2P:null,$3Mo:function(a){this.$196=Math.max(0,--this.$196);this.$3rg(a);if(this.$196>0){var b=this;window.setTimeout(function(){b.$3Mo(a)},1e3)}},$3rg:function(b){var a=Math.min(1,this.$196/20);b.style.backgroundColor="rgba(255,0,0,"+a+")"},$5oN:function(a){if(this.$2P&&this.$2P.get_$5ed()){this.$196++;this.$3rg(a);this.$2P.set_$5WV(Common.$J.$1RW(a,false).length);if(this.$196===1){var b=this;window.setTimeout(function(){b.$3Mo(a)},1e3)}}}};WordEditor.InteractivePerfTaskPane.$9Q=function(a,b,c,d,e){this.$$d_$4nX=Function.createDelegate(this,this.$4nX);this.$$d_$145=Function.createDelegate(this,this.$145);this.$$d_$31l=Function.createDelegate(this,this.$31l);this.$$d_$Xf=Function.createDelegate(this,this.$Xf);this.$1wA=new($$sc.$F.$$(Number));this.$K=a;this.$IU=b;this.$3J=c;this.$25e=d;this.$1w9=e};WordEditor.InteractivePerfTaskPane.$9Q.prototype={$K:null,$2P:null,$IU:null,$1OJ:null,$1Zz:null,$25e:null,$1w9:null,$1Mr:null,$3J:null,get_$5ed:function(){return this.$1Mr?this.$1Mr.checked:false},$1Mq:null,$3DI:0,set_$5WV:function(a){if(this.$1Mq)this.$1Mq.innerText=String.format("Total number of child elements in last rendered paragraph: {0}",a);this.$3DI=a;return a},$3F:function(){this.$K.$P(156338938,1,this.$$d_$Xf)},$d:function(){if(null!==this.$2P){this.$IU.$11Z(WordEditor.InteractivePerfTaskPane.$9Q.$38f,this.$2P);this.$2P=null}var a=this;this.$25e.$46(function(b){a.$3PZ(b,function(b){b.remove_$31l(a.$$d_$31l)})});var b=this;this.$1w9.$46(function(a){b.$3PY(a,function(a){a.remove_$145(b.$$d_$145)})})},$31l:function(b,a){if(this.$1OJ)this.$1OJ.innerText=a.$2SE+" CPM"},$145:function(b,a){if(this.$1Zz){this.$1Zz.innerText=a.$16D.CP+"%";this.$1wA.$F(a.$16D.CP)}},$29B:function(){var a=new Common.$t(Box4.$2R.$WW,Box4Intl.Box4Strings,null,null,null);this.$2P=this.$IU.$1Pr(WordEditor.InteractivePerfTaskPane.$9Q.$38f,0,WordEditor.InteractivePerfTaskPane.$9Q.$At,"InteractivePerfTaskPaneData",a);this.$4Uz();this.$4Ux();this.$4Uy()},$Xf:function(){if(!Box4.App.get_$X().$Rh)return 16;!this.$2P&&this.$29B();this.$IU.$Xf(this.$2P);this.$2P.get_$1N().style.overflow="scroll";return 32},$2tu:function(c){var a=$get(c),b=Common.$J.$12Z(a,"cui-groupContainer");return Common.$J.$12Z(b,"cui-groupBody")},$3PY:function(b,c){var a=b.$3XX(),d=this;a.CW(function(){c(a.get_$5k())})},$3PZ:function(b,c){var a=b.$5Dg(),d=this;a.CW(function(){c(a.get_$5k())})},$4Uz:function(){var a=this.$2tu("TypingSpeedMeterGroup");a.style.margin="10px";a.style.fontSize="15px";var c=document.createElement("div");c.innerText="Typing Speed";this.$1OJ=document.createElement("div");this.$1OJ.innerText="0 CPM";var b=this;this.$25e.$46(function(a){b.$3PZ(a,function(a){a.add_$31l(b.$$d_$31l)})});a.appendChild(c);a.appendChild(this.$1OJ)},$4Ux:function(){var a=this.$2tu("CpuMeterGroup");a.style.margin="10px";a.style.fontSize="15px";var d=document.createElement("div");d.innerText="CPU Meter";this.$1Zz=document.createElement("div");var c=this;this.$1w9.$46(function(a){c.$3PY(a,function(a){a.add_$145(c.$$d_$145)})});var e=document.createElement("div"),b=document.createElement("button");b.innerText="View Cpu Percent";this.$3J.$z("click",b,this.$$d_$4nX);e.appendChild(b);a.appendChild(d);a.appendChild(this.$1Zz);a.appendChild(e)},$4Uy:function(){var a=this.$2tu("RenderGroup"),b=document.createElement("label");b.innerText="Enable render visualizations";this.$1Mr=document.createElement("input");this.$1Mr.setAttribute("type","checkbox");a.appendChild(this.$1Mr);a.appendChild(b);this.$1Mq=document.createElement("div");this.$1Mq.style.margin="10px";a.appendChild(this.$1Mq);var c=this;Common.Utils.$8.get_$4().$e(Box4.$SG).$n(function(){return new WordEditor.InteractivePerfTaskPane.$eS(c)})},$4nX:function(){var f=window.open("","LogFile","",false),a=f.document;a.writeln("<HEAD>");a.writeln('<STYLE type="text/css">');a.writeln("* { padding: 0px; margin: 0px; font-family: monospace; }");a.writeln("</STYLE>");a.writeln("</HEAD>");a.writeln("<BODY style='BACKGROUND-COLOR: #f3f8fd;'>");var c=document.createElement("div"),d=document.createElement("div");d.innerText=String.format("{0}, {1}","Frame","CpuPercent");c.appendChild(d);for(var b=0;b<this.$1wA.get_$14();b++){var e=this.$4Jr(b,this.$1wA.get_$5(b));e&&c.appendChild(e)}a.writeln(c.innerHTML);a.writeln("</BODY>");a.close();return true},$4Jr:function(d,e){var b=d.toString(),c=e.toString(),a=document.createElement("div");a.innerText=String.format("{0}, {1}",b,c);return a}};WordEditor.InteractivePerfTaskPane.$bw.registerClass("WordEditor.InteractivePerfTaskPane.$bw",null,Common.App.$jx,Common.Utils.$l6);WordEditor.InteractivePerfTaskPane.$eS.registerClass("WordEditor.InteractivePerfTaskPane.$eS",null,Box4.$SG);WordEditor.InteractivePerfTaskPane.$9Q.registerClass("WordEditor.InteractivePerfTaskPane.$9Q");WordEditor.InteractivePerfTaskPane.$9Q.$38f="InteractivePerfTaskPane";WordEditor.InteractivePerfTaskPane.$9Q.$At=400;WordEditor.InteractivePerfTaskPane.$bw.$5Sr();Type.registerNamespace("Box4.Presence");Box4.Presence.$jb=function(a,b){Box4.Presence.$jb.initializeBase(this);this.$IR=a;this.$26=b};Box4.Presence.$jb.prototype={$2dd:false,$26:null,$IR:null,$22f:false,$3F3:function(a){if(this.$26.$3S(43)&&this.$26.$3S(34)&&BPr.$CY.isInstanceOfType(a)){if(!this.$2dd){this.$2dd=true;Diag.$2.$9(7866380,302,15,"Presence packet received in old format")}return}if(BPr.$CY.isInstanceOfType(a))this.$22f=true;BPr.$Bb.prototype.$3F3.call(this,a)},$1ki:function(a){return this.$22f?BPr.$Bb.prototype.$1ki.call(this,a):a.get_$Eb().get_$3v().toString()},$3X5:function(b){if(this.$22f)return BPr.$Bb.prototype.$3X5.call(this,b);var a=this.$IR.$2C(Common.$C.$7r(b));if(!a)return null;var c=a.$R(Number,Box4.AppProperties.$1.$3v,0);return this.$1MQ[c.toString()]}};Type.registerNamespace("WordEditor.Presence");WordEditor.Presence.$gZ=function(a,b,c,d){this.LocalCobaltSessionId=a;this.SkypeChatThreadId=b;this.Capabilities=c;this.Email=d};WordEditor.Presence.$o7=function(){};WordEditor.Presence.$o7.registerInterface("WordEditor.Presence.$o7");WordEditor.Presence.$o8=function(){};WordEditor.Presence.$o8.registerInterface("WordEditor.Presence.$o8");WordEditor.Presence.$oJ=function(){};WordEditor.Presence.$oJ.registerInterface("WordEditor.Presence.$oJ");WordEditor.Presence.$gW=function(){};WordEditor.Presence.$gQ=function(a,b,c){if(a!=null)this.TFA=a;if(b!=null)this.PN=b;if(c!=null)this.TN=c};WordEditor.Presence.$gU=function(a,b){if(a!=null)this.PM=a;if(b!=null)this.TM=b};WordEditor.Presence.$gX=function(a,b,c,d){if(a!=null)this.PA=a;if(b!=null)this.TA=b;if(c!=null)this.PB=c;if(d!=null)this.TBS=d};WordEditor.Presence.$gY=function(a,b){if(a)this.SF=a;if(b!=null)this.SL=b};WordEditor.Presence.$DH=function(i,j,k,l,m,c,d,e,f,g,a,b,h){this.$ar=i;this.$1PM=k;this.$jZ=l;this.$Hi=j;this.$M3=m;this.$3An=h;if(c)this.$wj=c;if(d!=null)this.$15O=d;if(!isNullOrUndefined(e))this.$2b=e;if(f)this.$1Ay=f;if(g)this.$1nL=g;if(a)this.$15D=a;if(b)this.$1WQ=b};WordEditor.Presence.$DH.prototype={$ar:0,$3An:0,$1PM:0,$jZ:0,$Hi:null,$M3:null,$wj:null,$1Ay:null,$1nL:null,$15D:null,$15O:null,$2b:null,$1WQ:null};WordEditor.Presence.$PB=function(a,b,c){if(a!=null)this.$2Nv=a;if(b!=null)this.$2Jt=b;if(c!=null)this.$pc=c};WordEditor.Presence.$PB.prototype={$2Nv:null,$2Jt:null,$pc:null};WordEditor.Presence.$TH=function(a,b){if(a!=null)this.$323=a;if(b!=null)this.$1GR=b};WordEditor.Presence.$TH.prototype={$323:null,$1GR:null};WordEditor.Presence.$UF=function(a,b,c,d){if(a!=null)this.$2Jr=a;if(b!=null)this.$2Nt=b;if(c!=null)this.$2Js=c;if(d!=null)this.$2Nu=d};WordEditor.Presence.$UF.prototype={$2Jr:null,$2Nt:null,$2Js:null,$2Nu:null};WordEditor.Presence.$hj=function(a,b){if(a)this.$2NZ=a;if(b!=null)this.$2Na=b};WordEditor.Presence.$hj.prototype={$2NZ:null,$2Na:null};WordEditor.Presence.$DI=function(){};WordEditor.Presence.$DI.$SV=function(b){for(var a=0;a<WordEditor.Presence.$DI.$37t.length;a++)if(b===WordEditor.Presence.$DI.$37t[a])return true;return false};WordEditor.Presence.$qm=function(){};WordEditor.Presence.$qm.prototype={V:0};WordEditor.Presence.$qL=function(){};WordEditor.Presence.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.Presence.$Ov)};WordEditor.Presence.$E8=function(){this.$rs=0};WordEditor.Presence.$E8.prototype={$rs:0,$3Zd:function(){this.$rs++;if(this.$rs===4294967295)this.$rs=1;return this.$rs}};WordEditor.Presence.$87=function(){};WordEditor.Presence.$87.$280=function(b){var a;try{a=Common.$1s.$5B(b)}catch(c){a=String.format("Failed to JSON-serialize payload : {0}",c)}if(a.length>8e3)a=String.format("Payload exceeds maximum length: {0} > {1}, not logging",a.length,8e3);return a};WordEditor.Presence.$87.$6A5=function(a,b){b.val="";if(typeof a.I!=="number"){b.val="Invalid PacketId Type";return false}if(typeof a.O!=="number"){b.val="Invalid Operation Type";return false}if(typeof a.A!=="string"){b.val="Invalid ClientId Type";return false}if(typeof a.AN!=="object"){b.val="Invalid Anchor Object Type";return false}if(!a.AN){b.val="Null AnchorObject";return false}if(!WEDOT.$PF.$69x(a.AN)){b.val="Invalid AnchorObject: "+WordEditor.Presence.$87.$280(a.AN)+", Client: "+a.C;return false}if(!a.O&&a.AN.RK){b.val="Invalid RangeKind:"+a.AN.RK+" for Caret";return false}if(a.O===2&&!WordEditor.Presence.$87.$6AL(a)){b.val="Invalid TypingData";return false}if(a.O===3&&!WordEditor.Presence.$87.$69w(a)){b.val="Invalid AddParaData";return false}if(a.O===6&&!WordEditor.Presence.$87.$6A9(a)){b.val="Invalid RemoveParaData";return false}if(a.O===4&&!WordEditor.Presence.$87.$6AG(a)){b.val="Invalid SplitParaData";return false}if(a.O===7&&!WordEditor.Presence.$87.$6AK(a)){b.val="Invalid SymbolData";return false}return true};WordEditor.Presence.$87.$6AL=function(a){return typeof a.TF!=="number"?false:typeof a.TX!=="undefined"&&typeof a.TX!=="string"?false:a.AN.RK!==1&&a.AN.RK?false:true};WordEditor.Presence.$87.$69w=function(a){return typeof a.AP!=="object"||!a.AP?false:typeof a.AP.TFA!=="number"?false:typeof a.AP.PN!=="number"?false:typeof a.AP.TN!=="number"?false:a.AN.RK!==2?false:true};WordEditor.Presence.$87.$6A9=function(a){return typeof a.MP!=="object"||!a.MP?false:typeof a.MP.PM!=="number"?false:typeof a.MP.TM!=="number"?false:a.AN.RK!==5?false:true};WordEditor.Presence.$87.$6AG=function(a){return typeof a.SP!=="object"||!a.SP?false:typeof a.SP.PA!=="number"?false:typeof a.SP.TA!=="number"?false:typeof a.SP.PB!=="number"?false:typeof a.SP.TBS!=="number"?false:a.AN.RK!==3?false:a.AN.PS!==a.SP.PA&&a.AN.PS!==a.SP.PB?false:true};WordEditor.Presence.$87.$6AK=function(a){return typeof a.SPS!=="object"||!a.SPS?false:typeof a.SPS.SF!=="string"?false:typeof a.SPS.SL!=="boolean"?false:true};WordEditor.Presence.$87.$6AM=function(a){return typeof a.V!=="number"?false:true};WordEditor.Presence.$Bi=function(){};WordEditor.Presence.$Bi.$1r7=function(e){var a=e;if(WordEditor.Presence.$87.$6AM(a))return a.V===1?WordEditor.Presence.$DK.$QA(e):null;for(var c=e,d=0,f=null,b=0;b<c.length;b++){a=c[b];if(WordEditor.Presence.$DI.$SV(a.V)&&a.V>d){d=a.V;f=c[b]}}return d===1?WordEditor.Presence.$DK.$QA(f):null};WordEditor.Presence.$Bi.$438=function(a){if(!a)return null;var c=false;if(c){var b=[];Array.add(b,WordEditor.Presence.$DK.$5B(a));return b}else return WordEditor.Presence.$DK.$5B(a)};WordEditor.Presence.$DK=function(){};WordEditor.Presence.$DK.$QA=function(a){var d,b,c;if(!(c=WordEditor.Presence.$87.$6A5(a,b={val:d}),d=b.val,c))return null;var e=null,f=null,g=null,h=null,i=null,j=null,k=null;if(a.WD)e=a.WD;if(a.TF!=null)f=a.TF;if(!isNullOrUndefined(a.TX))g=a.TX;if(a.AP)h=new WordEditor.Presence.$PB(a.AP.TFA,a.AP.PN,a.AP.TN);if(a.MP)i=new WordEditor.Presence.$TH(a.MP.PM,a.MP.TM);if(a.SP)j=new WordEditor.Presence.$UF(a.SP.PA,a.SP.TA,a.SP.PB,a.SP.TBS);if(a.SPS)k=new WordEditor.Presence.$hj(a.SPS.SF,a.SPS.SL);return new WordEditor.Presence.$DH(a.I,a.A,a.C,a.O,WEDOT.$AB.$4mL(a.AN),e,f,g,h,i,j,k,1)};WordEditor.Presence.$DK.$5B=function(a){var b=new WordEditor.Presence.$gW;b.I=a.$ar;b.V=1;b.A=a.$Hi;b.C=a.$1PM;b.O=a.$jZ;b.AN=WEDOT.$AB.$3tr(a.$M3);if(a.$wj)b.WD=a.$wj;if(a.$15O!=null)b.TF=a.$15O;if(!isNullOrUndefined(a.$2b)&&a.$2b.length>0)b.TX=a.$2b;if(a.$1Ay)b.AP=new WordEditor.Presence.$gQ(a.$1Ay.$2Nv,a.$1Ay.$2Jt,a.$1Ay.$pc);if(a.$1nL)b.MP=new WordEditor.Presence.$gU(a.$1nL.$323,a.$1nL.$1GR);if(a.$15D)b.SP=new WordEditor.Presence.$gX(a.$15D.$2Jr,a.$15D.$2Nt,a.$15D.$2Js,a.$15D.$2Nu);if(a.$1WQ)b.SPS=new WordEditor.Presence.$gY(a.$1WQ.$2NZ,a.$1WQ.$2Na);return b};WordEditor.Presence.$5m=function(a,b,c,d,e,f,g){WordEditor.Presence.$5m.initializeBase(this,[a,b,c,d,e,f,g])};WordEditor.Presence.$5m.get_$1pB=function(){return WordEditor.Presence.$5m.$d8||(WordEditor.Presence.$5m.$d8=Common.Utils.$8.get_$4().$J(BPr.$D3))};WordEditor.Presence.$5m.$7Y=function(){if(!Box4.App.get_$X())return;var a=Box4.App.get_$X().$1L;if(!a)return;a.add_$mw(WordEditor.Presence.$5m.$1nu);var c=a.get_$2v();if(!c)return;var d=c.$3U;if(!d)return;var b=Box4.App.$20;if(!b||!b.$90)return;var e=WordEditor.Presence.$5m.get_$1pB().$T8();if(!e)return;var f=Common.$0.$o,g=f.$1A("Box4ThrottleInboundRequests"),h=f.$5L("Box4ThrottleInboundsAtUserCount",4),i=new Common.Utils.Aggregators.$TK(11,1);WordEditor.Presence.$5m.$1Zh=WordEditor.Presence.$5m.$1Zh||new WordEditor.Presence.$5m(e,d,b,function(){return Common.$0.$6B},g,h,i);WordEditor.Presence.$5m.$1Zh.$Ob()};WordEditor.Presence.$5m.$1nu=function(a){if(WordEditor.Presence.$5m.$1Zh)return;a.remove_$mw(WordEditor.Presence.$5m.$1nu);WordEditor.Presence.$5m.$7Y()};WordEditor.Presence.$B7=function(a,b,c){this.$rs=a;this.$kU=c;this.$g7=b};WordEditor.Presence.$B7.get_$3A=function(){return Common.Utils.$8.get_$4().$2S(Box4.$2o)};WordEditor.Presence.$B7.$2nD=function(a,c,d,e){if(!a)return null;if(!WordEditor.Presence.$B7.get_$3A().$3S(43))return null;if(!c)return null;if(a.$jZ){Diag.$2.$9(7685324,302,15,"Presence packet is of unexpected operationType {0}",a.$jZ);return null}var b;if(!isNullOrUndefined(a.$wj))b=BPr.$A6.$3LS(a.$Hi,null,null,a.$wj.Capabilities,a.$wj.LocalCobaltSessionId,a.$wj.SkypeChatThreadId,a.$wj.Email,a.$1PM);else b=BPr.$A6.$3LS(a.$Hi,null,null,0,null,null,null,a.$1PM);return new WordEditor.Presence.$B7(a.$ar,b,WordEditor.Presence.$Hp.$28y(a.$M3,c,d,e))};WordEditor.Presence.$B7.prototype={$rs:0,$20f:false,$kU:null,get_$Eb:function(){return this.$kU},get_$3iD:function(){return this.$20f},set_$3iD:function(a){this.$20f=a;if(this.$20f){var b=this.$kU;b.$3m9()}return a},$1Hc:false,get_$2Gi:function(){return this.$1Hc},set_$2Gi:function(a){this.$1Hc=a;return a},$1I7:false,get_$374:function(){return this.$1I7},set_$374:function(a){this.$1I7=a;return a},$g7:null,get_$9w:function(){return this.$g7},$3ax:function(){return new WordEditor.Presence.$DH(this.$rs,this.$g7.$6f,1,0,this.$kU?this.$kU.$12c():null,new WordEditor.Presence.$gZ(this.$g7.$KJ,this.$g7.$g3,this.$g7.$HI.$HI,this.$g7.$15r),null,null,null,null,null,null,0)},$57A:function(){return this.$g7.$6f+(!this.$kU?Common.$C.get_$1G().toString():this.$kU.get_$By().toString())},$5i:function(){var a=!!this.$g7&&this.$g7.$5i(),b=!this.$kU||this.$kU.$5i();return a&&b}};WordEditor.Presence.$ja=function(a,b,c,d){this.$2el=a;this.$2p=c;this.$IR=d;this.$1IV=b};WordEditor.Presence.$ja.prototype={$2el:null,$1K:null,$2p:null,$IR:null,$1IV:null,get_$2V:function(){if(this.$1K!=null)return this.$1K;var b=this.$2el.get_$By();if(b.$w(Common.$C.get_$1G()))return 0;var a=this.$IR.$2C(b);if(!a){Diag.$2.$9(7685326,302,15,"Paragraph Node is null so returning a CP with value 0");return 0}return this.$2p.$1hV(this.$2p.$14F(a.$55,a.$i),this.$1IV)},$3m9:function(){if(this.$1K!=null)return;this.$1K=this.get_$2V()},$w:function(b){var a=b;return!a?false:this.$1IV.$ST(a.$1IV,false)}};WordEditor.Presence.$Hp=function(b,c,d,e,f,a){this.$EF=b;this.$IR=a;this.$4a=c;this.$ke=d;this.$g1=new WordEditor.Presence.$ja(this,e,f,a)};WordEditor.Presence.$Hp.$28y=function(a,b,d,e){if(!b)return null;var c=parseInt(a.$ve);return new WordEditor.Presence.$Hp(b,c,a.$wV,a.$142,d,e)};WordEditor.Presence.$Hp.prototype={$IR:null,$EF:null,$1dZ:null,$4a:0,get_$3v:function(){return this.$4a},get_$By:function(){return this.$1dZ?this.$1dZ:this.$EF.$1DW(this.$4a)},$3m9:function(){if(this.$1dZ)return;this.$1dZ=this.get_$By();var a=this.$g1;a.$3m9()},$g1:null,get_$1Uu:function(){return this.$g1},$ke:0,get_$1oM:function(){return this.$ke},set_$1oM:function(a){this.$ke=a;return a},$5i:function(){return this.$g1.get_$2V()>=0},$12c:function(){var a=this.$g1.$1IV;return!a?null:new WEDOT.$Bz(0,this.$4a,this.$ke,a,null,null,null,0)}};WordEditor.Presence.$28=function(n,o,p,q,r,s,t,u,v,w,a,b,c,d,e,f,g,h,i,j,k,l,m){WordEditor.Presence.$28.initializeBase(this,[n,o,p,q,r,s,t,u,v,w,b,c,d,e,h,i,j,k,l,m]);a.$P(1177859183,1,WordEditor.Presence.$28.$4Ez);a.$P(3460066539,1,WordEditor.Presence.$28.$5nv);a.$1W(477883041,1,WordEditor.Presence.$28.$5jA,96);a.$P(761503246,1,WordEditor.Presence.$28.$3y3);this.$EF=f;this.$2p=g;Diag.$2.$9(4006600,302,50,"WordPresenceManager Initialized")};WordEditor.Presence.$28.get_$27B=function(){return Common.Utils.$8.get_$4().$J(Common.Utils.$Cv)};WordEditor.Presence.$28.$T8=function(){return WordEditor.Presence.$28.$T};WordEditor.Presence.$28.get_$4=function(){if(!WordEditor.Presence.$28.$AP)WordEditor.Presence.$28.$AP=new($$sc.$5l.$$(Common.$SI));return WordEditor.Presence.$28.$AP.get_$8z()};WordEditor.Presence.$28.get_$1pB=function(){return WordEditor.Presence.$28.$d8||(WordEditor.Presence.$28.$d8=Common.Utils.$8.get_$4().$J(BPr.$D3))};WordEditor.Presence.$28.$7Y=function(){if(!WordEditor.Presence.$28.$AP)WordEditor.Presence.$28.$AP=new($$sc.$5l.$$(Common.$SI));if(WordEditor.Presence.$28.$2Y6){Diag.$2.$9(4256585,302,50,"WordPresenceManager Init");WordEditor.Presence.$28.$2Y6=false}if(!Box4.App.get_$X()){Diag.$2.$9(4006596,302,15,"Can't initialize the WordPresenceManager because active AppFrame is not initialized");return}var b=Box4.App.get_$X().$1L;if(!b){Diag.$2.$9(4006597,302,15,"Can't initialize the WordPresenceManager because workspace is not initialized");return}b.add_$mw(WordEditor.Presence.$28.$1nu);var a=b.$3o;if(!a||!a.get_$BW()){Diag.$2.$9(4006598,302,50,"PageView doesn't seem to have been initialized yet. Will try again once we know it's initialized");return}var e=b.get_$2v().$3U;if(!e){Diag.$2.$9(4252228,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to the GraphSpaceReplicator object");return}WordEditor.Presence.$28.$IR=b.get_$2v().get_$3V();if(!WordEditor.Presence.$28.$IR){Diag.$2.$9(4006599,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to content ObjectSpace of the app");return}var i=Box4.App.$20;if(!i){Diag.$2.$9(4203467,302,15,"Can't initialize the WordPresenceManager because we CoAuthManager is null");return}var c=WordEditor.Presence.$28.get_$1pB().$T8();if(!c){Diag.$2.$9(4203468,302,15,"Can't initialize the WordPresenceManager because can't get a handle to RtcProxy");return}var f=WordEditor.Presence.$5z.$T8();if(!f){Diag.$2.$9(4203469,302,15,"Can't initialize the WordPresenceManager because it can't get handle of the WordPresenceUserInfoResolver instance");return}var d=new Array(0);Array.add(d,a.$rr);Array.add(d,a.get_$41().$rr);var g=Box4.$h.get_$4(),h=new Box4.Presence.$jb(WordEditor.Presence.$28.$IR,Common.Utils.$8.get_$4().$J(Box4.$2o)),j=new BPr.$ei(h,g,WordEditor.Presence.$28.get_$27B(),c),k=Common.Utils.$8.get_$4().$J(WordEditor.$7l),l=Common.Utils.$8.get_$4().$J(WordEditor.$D5),m=new Common.Utils.Aggregators.$TK(8,5);WordEditor.Presence.$28.$T=WordEditor.Presence.$28.$T||new WordEditor.Presence.$28(c,d,WordEditor.Presence.$28.$IR,g,f,h,j,a,a.get_$41().get_$2o(),Common.Utils.$8.get_$4().$J(BPr.$Na),Common.$0.get_$r(),e,Box4.$A.$2Y,Box4.$A.$1iD,Common.Utils.$8.get_$4().$J(BPr.$NC),k,l,Box4.App.$7j.get_$KA(),new Box4.$5X,Common.$1J.get_$4(),Common.$0.$o.$1A("Box4ThrottleAndBatchPresenceRendering"),Common.$0.$o.$1A("Box4DoNotRenderPresenceOutOfView"),m);WordEditor.Presence.$28.$AP.$9D(WordEditor.Presence.$28.$T)};WordEditor.Presence.$28.$1nu=function(b){if(WordEditor.Presence.$28.$T)return;Diag.$2.$9(4006601,302,50,"WordPresenceManager.OnAppIsInteractive: Trying to initialize again");var a=$$as(Box4.$cV,b);a&&a.remove_$mw(WordEditor.Presence.$28.$1nu);WordEditor.Presence.$28.$7Y()};WordEditor.Presence.$28.$4Ez=function(g,h,i,j,f){var a=f.split(",");if(!a||a.length!==3)return 8;var b=a[0].trim(),c=a[1].trim(),d=Number.parseInvariant(a[2].trim()),e=new BPr.$CY(new BPr.$A6(b),new BPr.$HF(c,d,-1));WordEditor.Presence.$28.$T8().$26a(e);WordEditor.Presence.$28.$T8().$1ou(false);return 32};WordEditor.Presence.$28.$5nv=function(b,c,d,e,a){WordEditor.Presence.$28.$T8().$2L0(a);WordEditor.Presence.$28.$T8().$1ou(false);return 32};WordEditor.Presence.$28.$3y3=function(c,d,e,f,b){var a=WordEditor.Presence.$28.$T8();if(a){a.$3y3(b);return 32}return 8};WordEditor.Presence.$28.$5jA=function(e,f,c,g,d){if(c===1)return 32;var a=d,b=WordEditor.Presence.$28.get_$1pB().$T8();if(!b){Diag.$2.$9(4301136,302,10,"rtcProxy is null when trying to display RTC connection status");return 8}if(b.get_$tA()===2)a.Value=WordEditorIntl.WordEditorStrings.L_RtcConnected;else if(b.get_$tA()===1)a.Value=WordEditorIntl.WordEditorStrings.L_RtcConnecting;else a.Value="";return 32};WordEditor.Presence.$28.prototype={get_$3A:function(){return Common.Utils.$8.get_$4().$J(Box4.$2o)},$EF:null,$2p:null,$3Hp:function(a){var b=null;if(this.get_$3A().$3S(43)&&this.get_$3A().$3S(34)){var f=a.get_$11().$j,g=this.$1bM(a.get_$11().$D),d=a.get_$11().$D.$R(Number,Box4.AppProperties.$1.$3v,0),e=this.$EF.$1DW(d),c=WordEditor.Presence.$28.$IR.$2C(e);if(!c)Diag.$2.$9(16791249,302,15,"Can't find pid "+e);else{var h=this.$2p.$1Gz(this.$2p.$14F(c.$55,c.$i),f);b=new WordEditor.Presence.$Hp(this.$EF,d,g,h,this.$2p,WordEditor.Presence.$28.$IR)}}else b=BPr.$el.prototype.$3Hp.call(this,a);return b}};WordEditor.Presence.$Ov=function(){};WordEditor.Presence.$Ov.$4jQ=function(){var a=new Common.App.CollabControls.$eo;a.$F(String,0,Common.$n.$Ik(Common.$0.$Yu,"MoreUsersGlyph16"));a.$F(String,5,Common.$0.$9R);a.$F(String,1,Common.$n.$Ik(Common.$0.$Yu,"SingleCollabUserGlyph16"));a.$F(String,4,Common.$0.$9R);a.$F(Number,12,1);a.$F(Boolean,8,Common.$0.$3z);return new Common.App.CollabControls.$em(a)};WordEditor.Presence.$Ov.prototype={$U:null,get_$5j:function(){return"WordEditor.Presence"},$7Y:function(){if(Box4.App.$1rE){WordEditor.Presence.$28.$7Y();this.$U.$J(WordEditor.Presence.$Ow)}Box4.App.$28g&&WordEditor.Presence.$5m.$7Y()},$d:function(){var a=WordEditor.Presence.$28.$T8();System.$39.$F9(a)},$t9:function(a){this.$U=a;var b=this;this.$U.$e(BPr.$NC).$1p(BPr.$It).$1p(Common.$Mr).$1p(Common.$Mq).$p().$n(function(){return new BPr.$NC});var c=this;a.$e(WordEditor.Presence.$Ow).$p().$n(function(){return new WordEditor.Presence.$Ow(new($$sc.$x.$$(Box4.$Cw))(function(){return Box4.App.$20}),Box4.$1Z.get_$4(),a.$J(WordEditor.Presence.$Eg).$2De(),a.$J(BPr.$It))});var d=this;a.$e(WordEditor.Presence.$Eg).$p().$1p(BPr.$D3).$1p(Common.Interface.$SW).$n(function(){return new WordEditor.Presence.$Eg(Common.$0.$Wb,Box4.App.get_$X().get_$CN(),Common.$1J.get_$4(),function(){return Common.$0.$6B},Common.Utils.$8.get_$4().$J(BPr.$It),Common.Utils.$8.get_$4().$2S(WordEditor.$7l),Common.Utils.$8.get_$4().$J(WordEditor.$D5),new($$sc.$x.$$(Box4.$Ag))(function(){return Box4.App.get_$X().$1L.get_$2v().get_$3V()}),WordEditor.Presence.$E8.$rt,function(){return Common.Utils.$8.get_$4().$2S(WordEditor.$BS)},Common.Utils.$8.get_$4().$3j(Common.$J4))});var e=this;a.$e(BPr.$Na).$p().$n(function(){return new BPr.$Na(WordEditor.Presence.$Ov.$4jQ(),Common.$v.get_$4(),Common.Utils.$8.get_$4().$3j(Common.$8U))})}};WordEditor.Presence.$Ow=function(b,c,a,d){this.$$d_$va=Function.createDelegate(this,this.$va);this.$$d_$5bt=Function.createDelegate(this,this.$5bt);this.$4L=b;this.$Pe=c;this.$IS=a;a.CW(this.$$d_$5bt);this.$2cz=d;this.$2cz.set_$5Rl(this.$Pe)};WordEditor.Presence.$Ow.prototype={$Pe:null,$IS:null,$FU:null,$2cz:null,$20a:false,$1xW:false,$4L:null,$2Qv:false,get_$3eo:function(){return!!this.$4L&&!!this.$4L.get_$Q()},$5bt:function(){if(this.$IS.get_$SQ()&&this.$IS.get_$5k()){this.$FU=this.$IS.get_$5k();this.$FU.add_$vh(this.$$d_$va);Diag.$2.$9(5604372,302,50,"Presence Update Monitor is ready.");return}Diag.$2.$9(5604373,302,15,"RtcTask did not complete successfully. No monitoring")},$va:function(f,e){var b=e.$1IO;for(var c in b){var d={key:c,value:b[c]},a=d.value;!this.$1xW&&this.get_$3eo()&&this.$5Ex(a.get_$9w().$2QA);if(!this.$20a&&a.get_$9w().$KJ&&a.get_$9w().$KJ!==this.$Pe.$KJ){Diag.$2.$9(5604375,302,15,"Presence received from different local cobalt session Mine:{0} Theirs:{1}",this.$Pe.$KJ,a.get_$9w().$KJ);this.$20a=true;break}}this.$20a&&this.$FU.remove_$vh(this.$$d_$va);if(!this.$1xW){Diag.$2.$9(5604374,302,50,"First presence received");this.$1xW=true;this.get_$3eo()&&this.$4L.get_$Q().get_$5h0().$3Ol(!this.$2Qv?0:1)}},$5Ex:function(a){if(!a||a!==1)this.$2Qv=true}};WordEditor.Presence.$5z=function(a,b,c,d,e){WordEditor.Presence.$5z.initializeBase(this,[a,b,c,d,e])};WordEditor.Presence.$5z.get_$1pB=function(){return WordEditor.Presence.$5z.$d8||(WordEditor.Presence.$5z.$d8=Common.Utils.$8.get_$4().$J(BPr.$D3))};WordEditor.Presence.$5z.$T8=function(){return WordEditor.Presence.$5z.$T||(WordEditor.Presence.$5z.$T=WordEditor.Presence.$5z.$7s())};WordEditor.Presence.$5z.$7s=function(){var a=Box4.App.$20;if(!a||!a.$TE){Diag.$2.$9(4203470,302,50,"Can't initialize the WordPresenceUserInfoResolver because app does not allow coauthoring");return null}var b=WordEditor.Presence.$5z.get_$1pB().$T8();if(!b){Diag.$2.$9(4203471,302,50,"Can't initialize the WordPresenceUserInfoResolver because rtcProxy could not be instantiated");return null}return new WordEditor.Presence.$5z(a,a.$TE,b,WordEditor.Presence.$5z.$43N,Common.Utils.$8.get_$4().$J(BPr.$It))};WordEditor.Presence.$jc=function(c,d,e,f,g,h,i,j,k,l,a,b){WordEditor.Presence.$jc.initializeBase(this,[c,d,e,f,g,h,i]);this.$EF=j;this.$2p=k;this.$RU=l;this.$rt=a;this.$1NZ=b};WordEditor.Presence.$jc.prototype={$IT:null,$EF:null,$2p:null,$RU:null,$rt:null,$1NZ:null,get_$b8:function(){return this.$IT||(this.$IT=this.$1NZ())},$144:function(b,a){a.$YC===2&&Diag.$2.$9(4315102,302,50,"RTC Connected");this.$69E();BPr.$s6.prototype.$144.call(this,b,a)},$69E:function(){this.get_$b8()&&this.get_$b8().$14R("RtcConnectionStatusLabel")},$4mQ:function(a){return WordEditor.Presence.$B7.$2nD(WordEditor.Presence.$Bi.$1r7(a),this.$EF,this.$2p,this.$RU.get_$Q())},$3tu:function(b,a){if(WordEditor.Presence.$Hp.isInstanceOfType(a)){var c=new WordEditor.Presence.$B7(this.$rt.$3Zd(),b,a);return WordEditor.Presence.$Bi.$438(c.$3ax())}else return BPr.$s6.prototype.$3tu.call(this,b,a)}};WordEditor.Presence.$Eg=function(b,c,d,e,f,g,h,i,j,k,a){this.$2Uz=b;this.$4A=c;this.$25=d;this.$gt=e;this.$HX=f;this.$EF=g;this.$WN=h;this.$8d=i;this.$rt=j;this.$1NZ=k;this.$1AC=a};WordEditor.Presence.$Eg.$4u9=function(){return false};WordEditor.Presence.$Eg.prototype={$2Uz:null,$4A:null,$25:null,$gt:null,$HX:null,$EF:null,$WN:null,$8d:null,$rt:null,$1NZ:null,$1AC:null,$T:null,$AP:null,$T8:function(){return this.$T||(this.$T=this.$7s())},$2Df:function(){this.$T8();return this.$AP.get_$8z()},$2De:function(){return new WordEditor.Presence.$Eg.$43a(this)},$7s:function(){if(!this.$AP)this.$AP=new($$sc.$5l.$$(BPr.$c6));if(!(WordEditor.App.$2yO()&&WordEditor.App.$2xh())){Diag.$2.$9(8206362,302,10,"Can't initialize the RtcProxy because dependent scripts are not loaded");return null}var a=Box4.App.$20;if(!a||!a.$TE){Diag.$2.$9(8206364,302,50,"Can't initialize the RtcProxy because coauthoring doesn't seem to be enabled");return null}var c=Common.$0.$7Q;if(!c){Diag.$2.$9(8206365,302,15,"Can't initialize the RtcProxy because ClientRequestManager is null");return null}var d=a.$kb,e=Common.$0.$Tq,f=Common.$0.$9g,g=Common.$0.$34b,h=AppRealtimeChannel.$5c.$7s(d,e,f,g,c,this.$2Uz,1,this.$4A,Common.$0.$o.$1A("RTCLogUpdateNotificationHintOnDeserializationFailure")),b=new WordEditor.Presence.$jc(h,a.$TE,a,this.$25,this.$gt,WordEditor.Presence.$Eg.$4u9,this.$HX,this.$EF,this.$WN,this.$8d,this.$rt,this.$1NZ);b.$7Y();WordEditor.App.$14g=b;var i=this;this.$1AC.$46(function(a){a.add_$1US(function(){b.$29l()})});this.$AP.$9D(b);return b}};WordEditor.Presence.$Eg.$43a=function(a){this.$$d_moveNext=Function.createDelegate(this,this.moveNext);this.dispose=this.$d;this.$9Q=a;WordEditor.Presence.$Eg.$43a.initializeBase(this);this.$EE=this.$16c;this.moveNext()};WordEditor.Presence.$Eg.$43a.prototype={$9Q:null,$2Tu:null,$1ZA:null,$EE:null,$1Q:0,$16c:function(){this.$1ZA=this.$9Q.$2Df().G();if(!this.$1ZA.get_$SQ()){this.$1Q=2;this.$1ZA.$31L(this.$$d_moveNext)}return this.$43Z},$43Z:function(){this.$2Tu=this.$1ZA.$1km();this.set_$5k(this.$2Tu);this.$d();this.$1Q=3;this.$K7(true);return},$d:function(){},moveNext:function(){try{this.$1Q=1;while(this.$1Q===1)this.$EE=this.$EE()}catch(a){this.$d();this.set_$2pX(a);this.$1Q=3}}};Box4.Presence.$jb.registerClass("Box4.Presence.$jb",BPr.$Bb);WordEditor.Presence.$gZ.registerClass("WordEditor.Presence.$gZ");WordEditor.Presence.$gW.registerClass("WordEditor.Presence.$gW");WordEditor.Presence.$gQ.registerClass("WordEditor.Presence.$gQ");WordEditor.Presence.$gU.registerClass("WordEditor.Presence.$gU");WordEditor.Presence.$gX.registerClass("WordEditor.Presence.$gX");WordEditor.Presence.$gY.registerClass("WordEditor.Presence.$gY");WordEditor.Presence.$DH.registerClass("WordEditor.Presence.$DH");WordEditor.Presence.$PB.registerClass("WordEditor.Presence.$PB");WordEditor.Presence.$TH.registerClass("WordEditor.Presence.$TH");WordEditor.Presence.$UF.registerClass("WordEditor.Presence.$UF");WordEditor.Presence.$hj.registerClass("WordEditor.Presence.$hj");WordEditor.Presence.$DI.registerClass("WordEditor.Presence.$DI");WordEditor.Presence.$qm.registerClass("WordEditor.Presence.$qm");WordEditor.Presence.$qL.registerClass("WordEditor.Presence.$qL");WordEditor.Presence.$E8.registerClass("WordEditor.Presence.$E8",null,WordEditor.Presence.$oJ);WordEditor.Presence.$87.registerClass("WordEditor.Presence.$87");WordEditor.Presence.$Bi.registerClass("WordEditor.Presence.$Bi");WordEditor.Presence.$DK.registerClass("WordEditor.Presence.$DK");WordEditor.Presence.$5m.registerClass("WordEditor.Presence.$5m",BPr.$qQ);WordEditor.Presence.$B7.registerClass("WordEditor.Presence.$B7",null,BPr.$li);WordEditor.Presence.$ja.registerClass("WordEditor.Presence.$ja",null,BPr.$lj,WordEditor.Presence.$o8);WordEditor.Presence.$Hp.registerClass("WordEditor.Presence.$Hp",null,BPr.$lk,WordEditor.Presence.$o7);WordEditor.Presence.$28.registerClass("WordEditor.Presence.$28",BPr.$el);WordEditor.Presence.$Ov.registerClass("WordEditor.Presence.$Ov",null,Common.App.$jx,Common.Utils.$l6);WordEditor.Presence.$Ow.registerClass("WordEditor.Presence.$Ow");WordEditor.Presence.$5z.registerClass("WordEditor.Presence.$5z",BPr.$Tc);WordEditor.Presence.$jc.registerClass("WordEditor.Presence.$jc",BPr.$s6);WordEditor.Presence.$Eg.registerClass("WordEditor.Presence.$Eg",null,BPr.$D3,Common.Interface.$SW);WordEditor.Presence.$Eg.$43a.registerClass("WordEditor.Presence.$Eg.$43a",$$sc.$OY.$$(Common.$oi),Sys.IDisposable);WordEditor.Presence.$DI.$37t=[1];WordEditor.Presence.$E8.$rt=new WordEditor.Presence.$E8;WordEditor.Presence.$5m.$1Zh=null;WordEditor.Presence.$5m.$d8=null;WordEditor.Presence.$28.$T=null;WordEditor.Presence.$28.$2Y6=true;WordEditor.Presence.$28.$AP=null;WordEditor.Presence.$28.$IR=null;WordEditor.Presence.$28.$d8=null;WordEditor.Presence.$5z.$d8=null;WordEditor.Presence.$5z.$43N=[13421772,3350485,4686620,10181747,3834860,8922326,5335694,3845359,10665286,5228193,10377133,13747054,5617751,10516312,8222440];WordEditor.Presence.$5z.$T=null;WordEditor.Presence.$qL.$5Sr();Type.registerNamespace("WERTT");WERTT.$J1=function(){};WERTT.$J1.registerInterface("WERTT.$J1");WERTT.$mw=function(){};WERTT.$mw.registerInterface("WERTT.$mw");WERTT.$SY=function(){};WERTT.$SY.registerInterface("WERTT.$SY");WERTT.$Bk=function(){};WERTT.$Bk.prototype={unknown:0,replaceTextRangeOp:1,addParagraphOp:2,deleteParagraphOp:3,splitParagraphOp:4,mergeParagraphOp:5,replaceSymbolRangeOp:6};WERTT.$Bk.registerEnum("WERTT.$Bk",false);WERTT.$mu=function(){};WERTT.$mu.registerInterface("WERTT.$mu");WERTT.$J3=function(){};WERTT.$J3.registerInterface("WERTT.$J3");WERTT.$kI=function(){};WERTT.$kI.registerInterface("WERTT.$kI");WERTT.$kG=function(){};WERTT.$kG.registerInterface("WERTT.$kG");WERTT.$kE=function(){};WERTT.$kE.registerInterface("WERTT.$kE");WERTT.$aR=function(b,a){this.$$d_$5Zb=Function.createDelegate(this,this.$5Zb);this.$$d_$2JA=Function.createDelegate(this,this.$2JA);this.$$d_$5ZY=Function.createDelegate(this,this.$5ZY);this.dispose=this.$d;this.$CV=b;this.$3q=a;if(a){a.$1op(12,this.$$d_$5ZY);a.$1oq(12,this.$$d_$2JA);a.$fD(12,this.$$d_$5Zb)}};WERTT.$aR.prototype={$CV:null,$3q:null,$d:function(){if(this.$3q){this.$3q.$67X(12,this.$$d_$5ZY);this.$3q.$67Y(12,this.$$d_$2JA);this.$3q.$67Z(12,this.$$d_$5Zb)}},$5ZY:function(a){if(this.$CV.get_$Se()===4){Diag.$2.$m(9204866,355,a.get_$19()===12||a.get_$19()===11,"Unexpected graph modification detected during RTT edit");return}Diag.$2.$m(9204867,355,false,"Unexpected graph modification detected during RTT edit")},$2JA:function(){Diag.$2.$m(9204868,355,false,"Unexpected graph modification detected during RTT edit")},$5Zb:function(){Diag.$2.$m(9204869,355,false,"Unexpected graph modification detected during RTT edit")}};WERTT.$qv=function(a,b){this.$1t2=a;this.$Qz=b};WERTT.$qv.prototype={$1t2:0,get_$Se:function(){return this.$1t2},$Qz:null,get_$2IF:function(){return this.$Qz},$1XD:null,get_$dU:function(){return this.$1XD},set_$dU:function(a){this.$1XD=a;return a},$2Tj:null,get_$1r6:function(){return this.$2Tj},$pt:null,get_$sk:function(){return this.$pt},set_$sk:function(a){this.$pt=a;return a},$5DN:function(){return""},$5B:function(){return null}};WERTT.$jN=function(){this.$$d_$58h=Function.createDelegate(this,this.$58h)};WERTT.$jN.$5Sr=function(){Common.App.$f.get_$4().$3M(new WERTT.$jN)};WERTT.$jN.prototype={$U:null,get_$5j:function(){return"WordEditor.RealTimeTyping"},$58h:function(){if(!Box4.App.$20||!Box4.App.$20.$8M){Diag.$2.$9(7866377,304,15,"Unable to get the lock manager");return null}return Box4.App.$20.$8M},$t9:function(a){this.$U=a;var b=new Box4.$5X,d=this;a.$e(WERTT.$SY).$p().$n(function(){return new WERTT.$fs(a.$J(Box4.$4r),a.$J(Box4.$5P),b,a.$J(WordEditor.$D5))});var c=this;a.$e(WERTT.$HP).$1p(WordEditor.$SZ).$p().$n(function(){return new WERTT.$HP(a.$J(WERTT.$SY),new WERTT.$fr(Common.$X.get_$4()),new($$sc.$x.$$(Box4.$G7))(c.$$d_$58h),new($$sc.$x.$$(Box4.$8V))(function(){return Box4.App.$Ql}),a.$J(Box4.$2o),a.$J(WordEditor.$7l),a.$J(BPr.$D3).$2Df(),new($$sc.$x.$$(Box4.$Ag))(function(){return Box4.App.get_$X().$1L.get_$2v().get_$3V()}),Common.$1J.get_$4(),function(){return Date.now()},a.$J(WordEditor.$D5),Common.$X.get_$4(),a.$3j(Common.$Dm),new($$sc.$x.$$(BPr.$el))(function(){return WordEditor.Presence.$28.$T8()}),b,Common.$0.$o.$1A("WordEditorThrottleAndBatchRTTRendering"),new WERTT.$fq)});var e=this;a.$e(WERTT.$Nw).$p().$n(function(){return new WERTT.$Nw(a.$J(BPr.$D3).$2Df(),new WERTT.$fu,new($$sc.$x.$$(Box4.$Cw))(function(){return Box4.App.$20}),Box4.App.get_$X().$1L,a.$J(WordEditor.$D5),a.$J(Box4.$2o))})},$7Y:function(){var a=this.$U.$J(WERTT.$HP);a.$7Y();var b=this.$U.$J(WERTT.$Nw);b.$7Y()},$d:function(){}};WERTT.$fp=function(){this.$1Ih=new($$sc.$F.$$(WERTT.$DG))};WERTT.$fp.prototype={$1Ih:null,$F:function(a){this.$1Ih.$F(a);return true},$2uS:function(d){var b=new($$sc.$F.$$(WERTT.$DG)),a=this.$1Ih.$$lge();while(a.$$mn()){var c=a.$$cu();d(c)&&b.$F(c)}return b},$3r4:function(a){a.$1XD.$31J(WERTT.$fr.$Us.toString(1));this.$1Ih.$73(a)},$3r7:function(a){a.$1XD.$31J(WERTT.$fr.$Us.toString(0));this.$1Ih.$73(a)}};WERTT.$DG=function(a,b,c,d,e,f,g,h){WERTT.$DG.initializeBase(this,[2,h]);this.$3v=a;this.$C1=b;this.$pc=c;this.$1rH=d;this.$1nh=e;this.$1ng=f;this.$Kr=g};WERTT.$DG.$x=function(a){var b=a.$M3,c=a.$1Ay,d=null;if(a.$M3.$p7!=null)d=a.$M3.$p7;return new WERTT.$DG(b.$ve,b.$wV,c.$2Nv,d,c.$2Jt,c.$pc,b.$Kr,WERTT.$Bj.$x(a))};WERTT.$DG.$5Bc=function(b,d){if(b.get_$19()!==3)return null;var a=b,c=new WERTT.$DG(a.$bk.get_$3v(),a.$bk.get_$C1(),a.$2SC.get_$C1(),!a.$bl?null:a.$bl.get_$3v(),a.$PJ.get_$3v(),a.$PJ.get_$C1(),a.$ba,d);return c};WERTT.$DG.prototype={$3v:0,$C1:0,$pc:0,$1rH:null,$1nh:0,$1ng:0,$Kr:0,$5B:function(){var a=new WEDOT.$Bz(2,this.$3v,this.$C1,null,this.$1rH,null,null,this.$Kr),b=new WordEditor.Presence.$PB(this.$pc,this.$1nh,this.$1ng);return new WordEditor.Presence.$DH(this.$Qz.$ar,this.$Qz.$Hi,1,3,a,null,null,null,b,null,null,null,0)}};WERTT.$Tw=function(a,b){this.$33i=a;this.$By=b};WERTT.$Tw.prototype={get_$Se:function(){return 1},get_$aq:function(){return this.$33i},$33i:null,$By:null};WERTT.$Tv=function(a,b){this.$33g=a;this.$By=b};WERTT.$Tv.prototype={get_$Se:function(){return 6},get_$aq:function(){return this.$33g},$33g:null,$By:null};WERTT.$Jd=function(a,b,c){this.$2ND=a;this.$1WH=b;this.$1Bh=c};WERTT.$Jd.prototype={get_$Se:function(){return 4},get_$aq:function(){return this.$2ND},$2ND:null,$1WH:null,$1Bh:null,get_$43q:function(){return this.$2ND.$1Pp()?this.$1Bh:this.$1WH}};WERTT.$Ns=function(a,b){this.$1g8=a;this.$By=b};WERTT.$Ns.prototype={get_$Se:function(){return 2},get_$aq:function(){return this.$1g8},$1g8:null,$By:null};WERTT.$fq=function(){this.$kw=new($$sc.$3j.$$($$sc.$F.$$(WERTT.$J3)))};WERTT.$fq.prototype={$kw:null,$2ys:function(a){return a.toString()},$1g1:function(b,c){var a=this.$2ys(b);!this.$kw.$30(a)&&this.$kw.set_$5(a,new($$sc.$F.$$(WERTT.$J3)));this.$kw.get_$5(a).$F(c)},$31Y:function(a){switch(a.get_$Se()){case 1:var c=$$as(WERTT.$Tw,a);this.$1g1(c.$By,a);break;case 6:var d=$$as(WERTT.$Tv,a);this.$1g1(d.$By,a);break;case 4:var b=$$as(WERTT.$Jd,a);this.$1g1(b.$1WH,a);this.$1g1(b.$1Bh,a);break;case 2:var e=$$as(WERTT.$Ns,a);this.$1g1(e.$By,a)}},$5ZZ:function(a){return this.$2JA(a)},$2JA:function(e){var a=this.$2ys(e);if(!this.$kw.$30(a))return new($$sc.$F.$$(WERTT.$J3));var c=this.$kw.get_$5(a);this.$kw.$73(a);var b=c.$$lge();while(b.$$mn()){var d=b.$$cu();d.get_$aq()&&d.get_$aq().set_$sk(null)}return c},$59o:function(d){var a,b,c;return!(c=this.$kw.$9F(this.$2ys(d),b={val:a}),a=b.val,c)?new($$sc.$F.$$(WERTT.$J3)):a},$52a:function(d){var b=this.$kw.get_$2Ov().$$ge();while(b.$$mn()){var a=b.$$cu();if(!a.get_$14())continue;if(a.get_$5(0).get_$Se()!==2)continue;var c=a.get_$5(0);if(c.$1g8.$1nh===d)return c}return null}};WERTT.$fr=function(a){this.$TL=new($$sc.$9P.$$($$sc.$9P.$$(WERTT.$J1)));this.$24=a};WERTT.$fr.prototype={$TL:null,$24:null,$45k:function(b){if(!b){Diag.$2.$9(7685333,355,15,"Cannot add a null change to RTTStore");return false}var a=b.get_$3v(),c=b.get_$C1();!this.$TL.$30(a)&&this.$TL.$F(a,new($$sc.$9P.$$(WERTT.$J1)));this.$TL.get_$5(a).set_$5(c,b);if(this.$4ky(a,c)){Diag.$2.$9(7619921,355,15,"Detected an infinite loop in paragraph {0}, dropping the last packet!",a);this.$TL.get_$5(a).$73(c);return false}return true},$2uG:function(b,c){if(!this.$TL.$30(b))return null;var a=this.$TL.get_$5(b);return!a.$30(c)?null:a.get_$5(c)},$2uS:function(h){var c=new($$sc.$F.$$(WERTT.$J1)),a=this.$TL.get_$UW().$$ge();while(a.$$mn()){var f=a.$$cu(),d=this.$TL.get_$5(f),b=d.get_$UW().$$ge();while(b.$$mn()){var g=b.$$cu(),e=d.get_$5(g);h(e)&&c.$F(e)}}return c},$3rJ:function(a,c){var b=this.$TL.get_$5(a.get_$3v());a.get_$dU().$31J(WERTT.$fr.$Us.toString(c));b.$73(a.get_$C1());!b.get_$14()&&this.$TL.$73(a.get_$3v())},$3r4:function(a){this.$3rJ(a,1)},$3r7:function(a){this.$3rJ(a,0)},$4ky:function(e,d){if(!this.$TL.$30(e))return false;var a=this.$TL.get_$5(e);if(!a.$30(d))return false;var b=a.get_$5(d);while(b){var c=b.get_$pc();if(c===d)return true;if(!a.$30(c))return false;b=a.get_$5(c)}return false}};WERTT.$fr.$Us=function(){};WERTT.$fr.$Us.prototype={expired:0,dried:1};WERTT.$fr.$Us.registerEnum("WERTT.$fr.$Us",false);WERTT.$Nt=function(a,b,c,d){WERTT.$Nt.initializeBase(this,[3,d]);this.$4a=a;this.$PL=b;this.$Kr=c};WERTT.$Nt.$5Bd=function(b,d){if(b.get_$19()!==4)return null;var a=b,c=new WERTT.$Nt(a.$wy.get_$3v(),a.$wy.get_$C1(),a.$ba,d);return c};WERTT.$Nt.prototype={$4a:0,get_$3v:function(){return this.$4a},$PL:0,get_$C1:function(){return this.$PL},get_$pc:function(){return 0},$Kr:0,$5B:function(){var a=new WEDOT.$Bz(4,this.$4a,this.$PL,null,null,null,null,this.$Kr);return new WordEditor.Presence.$DH(this.$Qz.$ar,this.$Qz.$Hi,1,5,a,null,null,null,null,null,null,null,0)}};WERTT.$fs=function(a,b,c,d){this.$YP=a;this.$21R=b;this.$lV=c;this.$mi=d};WERTT.$fs.prototype={$YP:null,$21R:null,$lV:null,$mi:null,$4HK:function(a,c,j,e){if(c.get_$Dr()){e&&e.get_$l().set_$5("ParagraphAlreadyDirty","1");return false}var f=new WERTT.$aR(a,c.$3q);try{if(a.get_$Se()===1||a.get_$Se()===6){var b=$$as(WERTT.$HR,a),g=this.$4Qw(b,c),k=WERTT.$Ty.$5Bg(g,b),h=b.$1t2===6,i="";if(h)i=b.$2Qr;if(!this.$5og(g,b.$kl,h,i,e))return false;var d;if(a.get_$Se()===1)d=new WERTT.$Tw(b,c.get_$E());else d=new WERTT.$Tv(b,c.get_$E());c.$17r=a.get_$pc();b.$2Tj=k;a.set_$sk(d);j.$31Y(d)}else return a.get_$Se()===4?this.$4HJ(a,c,j):false}finally{f&&f.$d()}return true},$4HJ:function(m,a,o){var d=$$as(WERTT.$EP,m),n=this.$mi.$14F(a.$55,a.$i),f=this.$mi.$1hV(n,d.$Jy),p=Box4.$P.$40(a,f);if(!this.$3gJ(Box4.$P.$34(a,0,Box4.$A.$2Y(a))))return false;var i=Box4.$E.$13(a);i.$1X(10);if(this.$3g7(i))return false;var b,e=this.$lV.$59(3,0);try{e.$1o(a);a.$Xk();var c=Box4.$E.$13(a);c.$1X(10);c.$3Z(11);var g=c.get_$A();if(d.$1Pp())if(c.get_$2GD())g=null;else{c.$L7();g=c.get_$A()}c.$1M();var k=this.$21R.$1hf();c.$Ip(k,g,59);c.$5C(k);b=a.$3l();b.$Xk();b.$M(Box4.AppProperties.$1.$3v,d.get_$6Ax());b.$M(Box4.AppProperties.$1.$C1,d.get_$3zu());b.set_$Dr(false);c.$3p(b,2);c.$5C(b);this.$4RO(a,b);var h=d.$1Pp()?b:a,l=d.$1Pp()?a:b;h.$Mn=true;l.$Mn=true;this.$YP.$33e(this.$28w(h,f,Box4.$A.$2Y(h)),"",false,"");this.$YP.$33e(this.$28w(l,0,f),"",false,"");a.$17r=d.get_$64P();b.$17r=d.get_$3zu();a.$XZ();b.$XZ();e.$wC()}finally{e&&e.dispose()}var j=new WERTT.$Jd(d,a.get_$E(),b.get_$E());m.set_$sk(j);o.$31Y(j);return true},$3g7:function(b){var a=new Box4.$E;a.$2H(b);a.$3Z(11);if(Box4.$c.$5Z(a)){Diag.$2.$9(16868566,355,50,"Blocked RTT para operation: in a list");return true}return false},$4sh:function(e,i,j){var f=i.$1DW(e.$3v);if(f.$w(Common.$C.get_$1G()))return null;var b=j.$2C(f);if(!b||!Box4.$A.$3D(b))return null;var g=b,c=Box4.$E.$13(g);if(!c.$1X(23))return null;if(e.$1rH){var h=i.$1DW(e.$1rH);if(h.$w(Common.$C.get_$1G()))return null;var d=j.$2C(h);if(!d||!Box4.$A.$3D(d))return null;var a=Box4.$E.$13(d);if(!a.$1X(23))return null;a.$3Z(11);a.$L7();a.$3u();if(a.get_$A()!==g)return null}return this.$3g7(c)?null:c},$65s:function(c,b,i,j){var g=b.get_$A(),d=this.$lV.$59(3,0);try{d.$1o(g);b.$3Z(11);var h=b.get_$A();b.$1M();var e=this.$21R.$1hf();b.$Ip(e,h,59);b.$5C(e);var a=Box4.$2g.$T.$7s(393230);a.$Xk();a.$M(Box4.AppProperties.$5.$9O,"");a.$eg=true;j.$1V8(a);var f=[0];a.$M(Box4.AppProperties.$1.$Dw,f);a.$M(Box4.AppProperties.$1.$Ei,f);a.$eg=false;a.$M(Box4.AppProperties.$1.$3v,c.$1nh);a.$M(Box4.AppProperties.$1.$C1,c.$1ng);a.set_$Dr(false);b.$3p(a,2);a.$Mn=true;a.$17r=c.$1ng;a.$XZ();d.$wC();c.$pt=new WERTT.$Ns(c,a.get_$E());i.$31Y(c.$pt)}finally{d&&d.dispose()}return true},$28w:function(b,a,c){return a===c?Box4.$P.$40(b,a):Box4.$P.$34(b,a,c)},$5og:function(a,e,f,g,d){var b=a.$D;if(a.$j!==a.$1i&&!this.$3gJ(a)){d&&d.get_$l().set_$5("UnsafeWetChange","1");return false}var c=this.$lV.$59(3,0);try{c.$1o(b);b.$Xk();b.$Mn=true;this.$YP.$33e(a,e,f,g);b.$XZ();c.$wC()}finally{c&&c.dispose()}return true},$4RO:function(b,a){a.$eg=true;a.set_$9X(b.$55);a.$17r=b.get_$1iD();a.$i.$Fk();for(var c=0;c<b.$i.get_$N();c++){var f=b.$i.get_$5(c).$1gz(a);a.$i.$F(f)}a.$HH();if(!a.$3a.get_$N())Diag.$2.$9(9204881,355,15,"Cannot update WordRunProperties after splitting paragraph");else for(var d=0;d<a.$i.get_$N();d++){var e=a.$i.get_$5(d).$1R;if(e&&e.$7F!==-1)while(a.$3a.get_$N()<=e.$7F)a.$3a.$j8(a.$3a.get_$N()-1,256,1)}a.$eg=false},$2yj:function(b,a){a.val=Box4.$E.$13(b);a.val.$1X(23);a.val.$1M();return a.val.get_$8m()===59},$33V:function(c){var a=new Box4.$E;a.$2H(c);a.$1M();var b=this.$lV.$59(3,0);try{b.$1o(a.get_$A());c.$4v()}finally{b&&b.dispose()}},$5n3:function(a){if(!a.get_$10o())return;var b,d,e;if(e=this.$2yj(a,d={val:b}),b=d.val,e){this.$33V(b);return}var f=a.get_$4R().get_$Aj(),c=this.$lV.$59(3,0);try{c.$1o(a);a.$Sa(f.$2C(a.get_$E()));a.get_$10o().$Iq(4)}finally{c&&c.dispose()}},$34M:function(a,o,q){for(var c=o.get_$14()-1;c>=0;c--){var d=o.get_$5(c);switch(d.get_$Se()){case 4:var e=$$as(WERTT.$Jd,d);if(!a.get_$E().$w(e.$1WH)){Diag.$2.$m(9204885,355,a.get_$E().$w(e.$1Bh),null);continue}var l=q.$2C(e.$1Bh);if(!l)break;var b=l;if(!b||!Box4.$A.$3D(b)){Diag.$2.$m(9204886,355,false,null);break}if(!b.get_$7C())continue;var f,h,i,m=(i=this.$2yj(b,h={val:f}),f=h.val,i);Diag.$2.$m(9204887,355,m,null);m&&this.$33V(f);break;case 2:var p=$$as(WERTT.$Ns,d);if(!a.get_$E().$w(p.$By)){Diag.$2.$m(16820001,355,false,null);continue}if(!a.get_$7C())continue;var g,j,k,n=(k=this.$2yj(a,j={val:g}),g=j.val,k);Diag.$2.$m(16820002,355,n,null);n&&this.$33V(g)}}},$4Qw:function(f,a){var d=this.$mi.$14F(a.$55,a.$i),b=this.$mi.$1hV(d,f.$qA),e=this.$mi.$1hV(d,f.$16E),c;if(b===e)c=Box4.$P.$40(a,b);else c=Box4.$P.$34(a,b,e);return c},$3X4:function(b,d){for(var a=0;a<b.get_$N();a++){var c=b.get_$5(a);if(c.$1K===d)return a;if(c.$1K>d)return a-1}return b.get_$N()-1},$3gJ:function(e){for(var b=e.$D,c="Rejected unsafe wet change: range contains ",f=this.$3X4(b.$i,e.$j),g=this.$3X4(b.$i,e.$1i-1),d=f;d<=g;d++){var a=b.$i.get_$5(d);if(a.$5O){Diag.$2.$9(8242647,355,15,c+"comment");return false}if(a.$2i){Diag.$2.$9(8242648,355,15,c+"blob");return false}if(a.get_$QS()||a.get_$Op()){Diag.$2.$9(8242649,355,15,c+"field");return false}}return true}};WERTT.$HP=function(h,i,j,k,l,m,n,o,p,q,a,b,c,d,e,f,g){this.$$d_$2JQ=Function.createDelegate(this,this.$2JQ);this.$$d_$3mI=Function.createDelegate(this,this.$3mI);this.$$d_$4rT=Function.createDelegate(this,this.$4rT);this.$s5=h;this.$qp=i;this.$18v=j;this.$18w=k;this.$26=l;this.$EF=m;this.$IS=n;this.$8d=o;this.$25=p;this.$Pc=q;this.$mi=a;this.$24=b;this.$1ds=d;this.$2g=e;this.$25H=f;this.$qS=g;this.$19O=new($$sc.$FA.$$(String))($$sc.$5H.get_$1oB());this.$16l=new WERTT.$fp;c.$46(WERTT.$HP.$3dm)};WERTT.$HP.$3dm=function(a){for(var f=[3959281607,1157520733],d=f,e=d.length,c=0;c<e;++c){var b=d[c];a.$V1(b,"WetChangeCount",Common.$5T.$dn);a.$V1(b,"NoChangesToApply",Common.$5T.$dn);a.$V1(b,"NodeNotConnected",Common.$5T.$dn);a.$V1(b,"CouldNotGetLock",Common.$5T.$dn);a.$V1(b,"WetChangeBlocked",Common.$5T.$dn);a.$V1(b,"ParagraphAlreadyDirty",Common.$5T.$dn);a.$V1(b,"UnsafeWetChange",Common.$5T.$dn)}WERTT.$HQ.$3dm(a)};WERTT.$HP.prototype={$s5:null,$qp:null,$16l:null,$18v:null,$18w:null,$26:null,$EF:null,$IS:null,$9U:null,$8d:null,$Pc:null,$25:null,$2iy:false,$mi:null,$24:null,$1ds:null,$2g:null,$qS:null,$19O:null,$1zc:false,$25H:false,$5IX:function(){var a=new Common.$1e(3,2,6e4,this.$$d_$4rT);this.$25.$2f(a);this.$2iy=true},$7Y:function(){return this.$IS?this.$IS.CW(this.$$d_$3mI):$$sc.$30.$iV(Boolean,false)},$2y8:function(){return this.$26.$3S(43)&&this.$26.$3S(28)},$3gH:function(){return this.$2y8()&&this.$26.$3S(26)},$3mI:function(){Diag.$2.$9(7685328,355,50,"All prerequisite ready for RttManager");this.$9U=this.$IS.get_$5k();Diag.$2.$9(7685330,355,50,"Subscribing to presence updates");this.$9U.add_$1Gp(this.$$d_$2JQ)},$4mR:function(b){var a=WordEditor.Presence.$Bi.$1r7(b);if(!a)return null;switch(a.$jZ){case 2:return WERTT.$Fl.$x(a);case 7:return WERTT.$Nv.$x(a);case 4:return!this.$3gH()?null:WERTT.$EP.$x(a);case 3:return!this.$3gH()?null:WERTT.$DG.$x(a);default:Diag.$2.$9(8459668,355,50,"RTT packet is of unexpected operationType {0}",a.$jZ);return null}},$2JQ:function(f,c){if(c.$6a!==3)return;if(!this.$2y8())return;if(this.$18w.get_$Q()&&!this.$18w.get_$Q().get_$2F2()){Diag.$2.$9(8454939,355,15,"RTT channel did not get disconnected on lock release");return}if(!c.$1fU){Diag.$2.$9(7685331,355,15,"RTT packet was empty");return}this.$5kf();var a=this.$4mR(c.$1fU);if(!a||a.get_$2IF().$28F===1)return;this.$5ke();!this.$2iy&&this.$5IX();switch(a.get_$Se()){case 1:case 6:case 4:var b,d,e;if(!(e=this.$45l(a,d={val:b}),b=d.val,e))return;if(this.$25H)this.$3tI(b);else this.$416(b);break;case 2:this.$16l.$F(a);this.$3e1(a);if(this.$25H)this.$3tI(Common.$C.get_$1G());else this.$415(a)}},$45l:function(a,c){c.val=Common.$C.get_$1G();if(!this.$qp.$45k(a))return false;this.$3e1(a);if(!this.$EF)return false;var b=this.$EF.$1DW(a.get_$3v());if(b.$w(Common.$C.get_$1G())){a.get_$dU().$3q2();return false}var d=this.$8d.get_$Q().$2C(b);if(!d){a.get_$dU().$3q2();return false}this.$3q5();c.val=b;return true},$3tI:function(b){!b.$w(Common.$C.get_$1G())&&this.$19O.$F(b.toString());if(this.$1zc)return;var a=this,c=new Common.$1e(1,1,200,function(){a.$66u();a.$1zc=false},71);this.$25.$2f(c);this.$1zc=true},$5ru:function(b){var a=new Common.$1e(1,1,0,b,71);this.$25.$2f(a)},$3e1:function(a){a.set_$dU(WERTT.$HQ.$x(this.$24));a.get_$dU().$5ka(a.get_$2IF().$31t);a.get_$dU().$5kZ(WERTT.$Bk.toString(a.get_$Se()))},$66u:function(){var k=this,f=this.$16l.$2uS(function(a){return!a.$pt}),b=f.$$lge();while(b.$$mn()){var g=b.$$cu();this.$415(g)}if(!this.$19O.get_$14())return;var e=null,c=this.$19O.$3f();while(c.$$mn()){var h=c.$$cu(),i=Common.$C.$7r(h);e=this.$8d.get_$Q().$2C(i);break}var a=this.$2g.$59(3,0);try{a.$1o(e);var d=this.$19O.$3f();while(d.$$mn()){var j=d.$$cu();this.$416(Common.$C.$7r(j))}}finally{a&&a.dispose()}this.$19O.$Fk()},$416:function(e){var a=this.$8d.get_$Q().$2C(e),b,c=this.$2g.$59(3,0);try{c.$1o(a);b=this.$24.$5E(3959281607,-1);var d=this.$3GW(a,b);b.$1P();d&&this.$4F0(a,d)}finally{c&&c.dispose()}},$415:function(a){var b=this.$s5.$4sh(a,this.$EF,this.$8d.get_$Q());if(!b)return;this.$3q5();if(this.$s5.$65s(a,b,this.$qS,Common.Utils.$8.get_$4().$J(Box4.$79))){var c=a.$pt.$By,d=this.$8d.get_$Q().$2C(c);this.$3Gg(d,a)}},$4F0:function(d,b){if(!this.$1ds.get_$Q())return;if(b.get_$Se()!==1)return;var c=b,a=this.$5AZ(d,c);if(!a)return;this.$1ds.get_$Q().$26a(a);this.$1ds.get_$Q().$1ou(true)},$5AZ:function(e,b){var a=b.$5B();if(a.$jZ!==2)return null;if(a.$M3.$p7&&a.$M3.$ve!==a.$M3.$p7)return null;var c=b.$qA.$3l();if(b.$kl.length>0){c.$3JR();c.$4e+=b.$kl.length}a.$jZ=0;a.$2b=null;a.$M3.$1V0=0;a.$M3.$142=c;a.$M3.$wV=a.$15O;a.$M3.$p7=null;a.$M3.$1WY=null;a.$M3.$1UA=null;a.$15O=null;var d=WordEditor.Presence.$B7.$2nD(a,this.$EF,this.$mi,this.$8d.get_$Q());return d},$4rT:function(){var h=this.$8d.get_$Q();if(!h){this.$8d.get_$3ck()&&Diag.$2.$9(7685332,355,10,"Failed to find the IObjectSpace! Wet changes will never expire");return}var i=this.$Pc()-18e4,o=this,k=function(a){return a.get_$2IF().$2O2<i},j=this.$qp.$2uS(k);j.get_$14()>0&&this.$5kG();var b=new $$sc.$Bo,e=j.$$lge();while(e.$$mn()){var a=e.$$cu();this.$qp.$3r7(a);if(!a.get_$sk())continue;switch(a.get_$sk().get_$Se()){case 1:b.$F(a.get_$sk().$By.toString());break;case 6:b.$F(a.get_$sk().$By.toString());break;case 4:b.$F(a.get_$sk().$1WH.toString());b.$F(a.get_$sk().$1Bh.toString())}}var p=this,l=this.$16l.$2uS(function(a){return a.$Qz.$2O2<i}),f=l.$$lge();while(f.$$mn()){var d=f.$$cu();this.$16l.$3r7(d);if(!d.$pt)continue;b.$F(d.$pt.$By.toString())}var g=b.$3f();while(g.$$mn()){var m=g.$$cu(),c=h.$2C(Common.$C.$7r(m));if(!c){Diag.$2.$9(8765828,355,15,"Expiring wet change with invalid object ID");continue}if(!c.$Mn){Diag.$2.$9(8765829,355,15,"Expiring wet change from paragraph with no applied changes");continue}this.$s5.$5n3(c);if(!c.$Mn){var n=c.$s(Number,Box4.AppProperties.$1.$3v);this.$18v.get_$Q().$3rY(n)}}},$3Gg:function(e,f){if(!this.$18v.get_$Q()){Diag.$2.$m(7866378,355,!!this.$18v.get_$Q(),"Unable to apply wet changes as LockManager unavailable");return false}var c,d=false,a,b;if(!(b=this.$18v.get_$Q().$43t(e,f.get_$2IF().$Hi,a={val:c},d),c=a.val,b)){Diag.$2.$9(7866379,355,15,"Unable to apply a wet change lock");return false}return true},$3GV:function(a,b){this.$3GW(a,b)},$3GW:function(b,a){if(!b)return null;if(!b.$21){a&&a.get_$l().set_$5("NodeNotConnected","1");return null}if(!b.$v(Box4.AppProperties.$1.$3v)){Diag.$2.$9(7619922,355,15,"Paragraph is missing the WordId property");return null}if(!b.$v(Box4.AppProperties.$1.$C1)){Diag.$2.$9(8197722,355,15,"Paragraph is missing the TextId property");return null}if(b.$v(Box4.AppProperties.$1.$2oA)&&b.$s(Boolean,Box4.AppProperties.$1.$2oA)){Diag.$2.$9(16815506,355,50,"RTT edit disabled in paragraph");return null}var e=b.$s(Number,Box4.AppProperties.$1.$3v),d=b.get_$1iD();if(a){a.get_$l().set_$5("NodeTextId",d.toString());a.get_$l().set_$5("NodeWordId",e.toString())}var c=this.$qp.$2uG(e,d);if(!c){a&&a.get_$l().set_$5("NoChangesToApply","1");return null}if(!this.$3Gg(b,c)){a&&a.get_$l().set_$5("CouldNotGetLock","1");return null}var f=0,g=null;while(c){if(!this.$s5.$4HK(c,b,this.$qS,a)){a&&a.get_$l().set_$5("WetChangeBlocked","1");break}f++;c.get_$dU().$5kF(this.$Pc());g=c;d=b.get_$1iD();c=this.$qp.$2uG(e,d)}f>0&&this.$3pw();a&&a.get_$l().$F("WetChangeCount",f.toString());return g},$3r5:function(a){if(!this.$2y8())return;if(!a.$v(Box4.AppProperties.$1.$3v))return;if(!a.$v(Box4.AppProperties.$1.$C1))return;var d=a.$s(Number,Box4.AppProperties.$1.$3v),f=a.$R(Number,Box4.AppProperties.$1.$C1,0),g=this.$24.$5E(1157520733,-1),e=this.$qS.$5ZZ(a.get_$E());if(e.get_$14()>0){this.$s5.$34M(a,e,this.$8d.get_$Q());this.$5nN(a,e,f)}var b=this.$qS.$52a(d);if(b&&!a.get_$E().$w(b.$By)){var h=this.$8d.get_$Q(),c=this,i=function(){var d=c.$qS.$2JA(b.$By),a=h.$2C(b.$By);Diag.$2.$m(16820032,355,!!a,"Could not find added graph node");if(a){c.$s5.$34M(a,d,h);c.$16l.$3r4(b.$1g8)}};this.$5ru(i)}!this.$qp.$2uG(d,f)&&this.$18v.get_$Q().$3rY(d);this.$3GV(a,g);g.$1P()},$5nN:function(e,f,h){for(var b=false,c=f.get_$14()-1;c>=0;c--){var d=f.get_$5(c),a=null;switch(d.get_$Se()){case 1:case 6:case 4:a=$$as(WERTT.$J1,d.get_$aq());break;default:continue}var g=a.get_$pc();if(g===h){b=true;a.get_$1r6()&&!a.get_$1r6().$6A3(e)&&Diag.$2.$9(8765831,355,15,"Validating wet change location failed. Type {0} OffsetInfo {1} NodeId {2} ValidatorNodeId {3} ValidatorNodeCpBegin {4} ValidatorNodeCpEnd {5}",a.get_$Se(),a.$5DN(),e.get_$E(),a.get_$1r6().get_$E(),a.get_$1r6().get_$A5(),a.get_$1r6().get_$A6())}b&&this.$qp.$3r4(a)}b&&this.$3pw()},$3lx:function(b){var a=this.$qS.$2JA(b.get_$E());if(a.get_$14()>0){a.get_$5(0).get_$Se()===2&&a.$Cq(0);this.$s5.$34M(b,a,this.$8d.get_$Q())}},$3x4:function(c){var d=this.$qS.$59o(c.get_$E()),a=d.$$lge();while(a.$$mn()){var b=a.$$cu();if(b.get_$Se()===4){var e=$$as(WERTT.$Jd,b);if(c.get_$E().$w(e.get_$43q()))return true}}return false},$2gY:false,$2gW:false,$2gZ:false,$248:false,$2gX:false,$5kf:function(){if(this.$2gY)return;Diag.$2.$9(8704354,355,50,"Received a wet change");this.$2gY=true},$5ke:function(){if(this.$2gW)return;Diag.$2.$9(8185606,355,50,"Received a wet change that we could deserialize");this.$2gW=true},$3q5:function(){if(this.$2gZ)return;Diag.$2.$9(17147533,355,50,"Received a usable wet change");this.$2gZ=true},$3pw:function(){if(this.$248)return;Diag.$2.$9(8185607,355,50,"Successfully applied a wet change");this.$248=true},$5kG:function(){if(this.$248||this.$2gX)return;Diag.$2.$9(8185608,355,15,"Failed to apply any wet changes so far");this.$2gX=true}};WERTT.$Nu=function(a,b,c,d,e,f,g,h){WERTT.$Nu.initializeBase(this,[5,h]);this.$1rG=a;this.$2Ns=b;this.$3B5=c;this.$38r=d;this.$Kr=e;this.$2PB=f;this.$1GR=g};WERTT.$Nu.$5Be=function(b,d){if(b.get_$19()!==2)return null;var a=b,c=new WERTT.$Nu(a.$bk.get_$3v(),a.$bk.get_$C1(),a.$bl.get_$3v(),a.$bl.get_$C1(),a.$ba,a.$1Hh.get_$3v(),a.$1Hh.get_$C1(),d);return c};WERTT.$Nu.prototype={$1rG:0,$2Ns:0,$3B5:0,$38r:0,$Kr:0,$2PB:0,$1GR:0,get_$3v:function(){return this.$1rG},get_$C1:function(){return this.$2Ns},get_$pc:function(){return this.$1rG===this.$2PB?this.$1GR:0},$5B:function(){var a=new WEDOT.$Bz(5,this.$1rG,this.$2Ns,null,this.$3B5,this.$38r,null,this.$Kr),b=new WordEditor.Presence.$TH(this.$2PB,this.$1GR);return new WordEditor.Presence.$DH(this.$Qz.$ar,this.$Qz.$Hi,1,6,a,null,null,null,null,b,null,null,0)}};WERTT.$HQ=function(a){this.$KQ=a};WERTT.$HQ.$3dm=function(a){a.$V1(1839802051,"FailedToFindInitialParaID",Common.$5T.$3z9);a.$V1(1839802051,"FailedToFindInitialTextID",Common.$5T.$3z9);a.$V1(1839802051,"MsecUntilApplied",Common.$5T.$4IL);a.$V1(1839802051,"RemovedBecause",Common.$5T.$dn);a.$V1(1839802051,"PacketVersions",Common.$5T.$dn);a.$V1(1839802051,"OperationType",Common.$5T.$dn)};WERTT.$HQ.$x=function(a){if(!a)return null;var b=a.$5E(1839802051,48e4);return new WERTT.$HQ(b)};WERTT.$HQ.prototype={$KQ:null,$3q2:function(){if(!this.$KQ)return;this.$KQ.get_$l().set_$5("FailedToFindInitialParaID","1")},$5kF:function(b){if(!this.$KQ)return;if(this.$KQ.get_$l().$30("MsecUntilApplied"))return;var a=b-this.$KQ.get_$V5();this.$KQ.get_$l().set_$5("MsecUntilApplied",a.toString())},$31J:function(a){if(!this.$KQ)return;this.$KQ.get_$l().set_$5("RemovedBecause",a);this.$KQ.$1P()},$5ka:function(a){if(!this.$KQ)return;this.$KQ.get_$l().set_$5("PacketVersions",a.toString())},$5kZ:function(a){if(!this.$KQ)return;this.$KQ.get_$l().set_$5("OperationType",a)}};WERTT.$ft=function(a,b,c,d){this.$3Q=a;this.$Lb=b;this.$PH=c;this.$2Q3=d};WERTT.$ft.prototype={$3Q:null,get_$E:function(){return this.$3Q},$Lb:0,get_$A5:function(){return this.$Lb},$PH:0,get_$A6:function(){return this.$PH},$2Q3:null,$6A3:function(b){var a=this.$3Q===b.get_$E();if(a){var c=this.$2Q3.replace("\u00a0"," "),d=b.$55.substr(this.$Lb,this.$PH-this.$Lb).replace("\u00a0"," ");a=c===d}return a}};WERTT.$Ty=function(){};WERTT.$Ty.$5Bg=function(a,e){var b=a.$D.$55,d=a.$j>=10?a.$j-10:0,c=a.$1i+10<=b.length?a.$1i+10:b.length,f=b.substr(d,a.$j-d),g=b.substr(a.$1i,c-a.$1i);c=c+e.$kl.length-(a.$1i-a.$j);var h=f+e.$kl+g,i=new WERTT.$ft(a.$D.get_$E(),d,c,h);return i};WERTT.$Bj=function(a,b,c,d,e){this.$ar=a;this.$Hi=b;this.$28F=c;this.$2O2=d;this.$31t=e};WERTT.$Bj.$x=function(a){return new WERTT.$Bj(a.$ar,a.$Hi,a.$1PM,Date.now(),a.$3An)};WERTT.$Bj.prototype={$ar:0,$Hi:null,$28F:0,$2O2:0,$31t:0};WERTT.$Fl=function(a,b,c,d,e,f,g,h){WERTT.$Fl.initializeBase(this,[a,b,c,d,e,f,g,h,1])};WERTT.$Fl.$x=function(a){var b,c,d,e,f,g,h,i,j;if(!(j=WERTT.$HR.$40j(a,f={val:b},g={val:c},h={val:d},i={val:e}),b=f.val,c=g.val,d=h.val,e=i.val,j))return null;var k="";if(a.$2b)k=a.$2b;var l=WERTT.$Bj.$x(a);return new WERTT.$Fl(d,e,b,c,a.$15O,k,a.$M3.$Kr,l)};WERTT.$Fl.$5BF=function(d,f,b){if(d.get_$19())return null;var a=d,c=b.$14F(a.$Lf.get_$9X(),a.$Lf.get_$i()),e=new WERTT.$Fl(a.$Lf.get_$3v(),a.$Lf.get_$C1(),b.$1Gz(c,a.$Lb),b.$1Gz(c,a.$PH),a.$PJ.get_$C1(),a.$YD,a.$ba,f);return e};WERTT.$Fl.prototype={$5DN:function(){return"OffsetStart: "+this.$qA+"OffsetEnd: "+this.$16E+"TextAddedLength: "+this.$kl.length},$5B:function(){var a=this.$3MD();return new WordEditor.Presence.$DH(this.$Qz.$ar,this.$Qz.$Hi,1,2,a,null,this.$g6,this.$kl,null,null,null,null,0)}};WERTT.$Nv=function(b,c,d,e,f,g,h,i,j,k,a){WERTT.$Nv.initializeBase(this,[e,f,g,h,i,j,k,a,6]);this.$2Qr=b;this.$3BO=c;this.$3Bd=d};WERTT.$Nv.$x=function(a){var b,c,d,e,h,i,j,k,l;if(!(l=WERTT.$HR.$40j(a,h={val:b},i={val:c},j={val:d},k={val:e}),b=h.val,c=i.val,d=j.val,e=k.val,l))return null;var f,g;if(a.$2b.length===1){f=false;g="\ufffc"}else if(a.$2b.length===2)if(Common.$9.$5Mh(a.$2b,0)&&Common.$9.$DL(a.$2b,1)){f=true;g=a.$2b}else{Diag.$2.$9(8914772,355,15,"RTT symbol packet has text length 2 but is not a valid surrogate pair",a.$jZ);return null}else{Diag.$2.$9(8914773,355,15,"RTT symbol packet text is of unsupported length (length must be 1 or 2)",a.$jZ);return null}var m=a.$1WQ,n=WERTT.$Bj.$x(a);return new WERTT.$Nv(m.$2NZ,m.$2Na,f,d,e,b,c,a.$15O,g,a.$M3.$Kr,n)};WERTT.$Nv.prototype={$2Qr:null,$3BO:false,$3Bd:false,$5DN:function(){return"OffsetStart: "+this.$qA+"OffsetEnd: "+this.$16E},$5B:function(){var a=this.$3MD();return new WordEditor.Presence.$DH(this.$Qz.$ar,this.$Qz.$Hi,1,7,a,null,this.$g6,this.$kl,null,null,null,null,0)}};WERTT.$HR=function(a,b,c,d,e,f,g,h,i){WERTT.$HR.initializeBase(this,[i,h]);this.$4a=a;this.$PL=b;this.$qA=c;this.$16E=d;this.$g6=e;this.$kl=f;this.$ba=g};WERTT.$HR.$40j=function(f,b,c,d,e){var a=f.$M3;if(a.$1V0===1&&(a.$ve!==a.$p7||a.$wV!==a.$1WY)){Diag.$2.$9(8914769,355,15,"We received a ReplaceRange operation spanning multiple paragraphs");b.val=c.val=null;d.val=e.val=-1;return false}if(a.$Kr){b.val=c.val=null;d.val=e.val=-1;return false}b.val=a.$142;c.val=b.val;if(a.$1V0===1)c.val=a.$1UA;d.val=a.$ve;e.val=a.$wV;return true};WERTT.$HR.prototype={$4a:0,get_$3v:function(){return this.$4a},$PL:0,get_$C1:function(){return this.$PL},$qA:null,$16E:null,$g6:0,get_$pc:function(){return this.$g6},$kl:null,$ba:0,$3MD:function(){var a;if(this.$qA.$ST(this.$16E,true))a=new WEDOT.$Bz(0,this.$4a,this.$PL,this.$qA,null,null,null,this.$ba);else a=new WEDOT.$Bz(1,this.$4a,this.$PL,this.$qA,this.$4a,this.$PL,this.$16E,this.$ba);return a}};WERTT.$fu=function(){this.$19z=new(Box3.$Jb.$$(Box4.$bP))};WERTT.$fu.prototype={$19z:null,$4FF:function(a,b){if(this.$19z.$3HB()&&b&&this.$19z.$3HB().$2ln(a))return;this.$19z.$2A7(a)},$59I:function(){return this.$19z.get_$7N()?null:this.$19z.$3NQ()}};WERTT.$Nw=function(a,b,c,d,e,f){this.$$d_$5bM=Function.createDelegate(this,this.$5bM);this.$$d_$3mI=Function.createDelegate(this,this.$3mI);this.$IS=a;this.$23j=b;this.$1LL=c;this.$Hd=d;this.$WN=e;this.$26=f};WERTT.$Nw.prototype={$IS:null,$FU:null,$23j:null,$1LL:null,$Hd:null,$WN:null,$26:null,$1NL:null,$yx:false,$2iG:0,$25V:0,$2ie:false,$1ex:false,$23i:0,get_$Ic:function(){return this.$1LL.get_$Q()},$7Y:function(){return this.$IS?this.$IS.CW(this.$$d_$3mI):$$sc.$30.$iV(Boolean,false)},$3mI:function(){Diag.$2.$9(8245954,355,50,"All prerequisites ready for RttSendManager");this.$FU=this.$IS.get_$5k();this.$FU.$335(this)},$2k:function(){if(this.$yx)return;this.$2yM()&&this.$Hd.get_$2v().$ft.add_$3o2(this.$$d_$5bM);this.$yx=true},$4x:function(){this.$yx=false;this.$2yM()&&this.$Hd.get_$2v().$ft.remove_$3o2(this.$$d_$5bM)},$2yM:function(){return this.$26.$3S(43)&&this.$26.$3S(33)},$5Oa:function(){return!this.$2yM()?false:this.$26.$3S(27)},$5bM:function(h,d){if(!this.get_$Ic().get_$wY().$4oB())return;var a=d.$ft;if(!a.length)return;if(d.$2Pu){if(this.$25V<100){this.$25V++;Diag.$2.$9(8270467,355,50,"Blocking send. Reason: {0} OverallSends: {1} OverallBlocked: {2}",d.$2Pv,this.$2iG,this.$25V)}return}for(var c=0;c<a.length;c++){var f=a[c];if(!this.$5PW(f))return}for(var b=0;b<a.length;b++){var e=a[b],g=!e.get_$19()&&!b;this.$23j.$4FF(e,g)}!this.$1NL&&this.$3lo(this.$1NL,this.$FU)},$5PW:function(a){return!a?false:a.get_$Kr()===-1?false:!a.get_$19()?true:this.$5Oa()&&(a.get_$19()===3||a.get_$19()===1)?true:false},$5SZ:function(){if(this.$1ex)return;if(!this.$2ie){Diag.$2.$9(8270468,355,50,"Preparing to send RTT change");this.$2ie=true}if(!this.$1ex&&this.$23i<=5)this.$23i++},$5Sb:function(){if(!this.$1ex&&this.$23i<=5){Diag.$2.$9(8270469,355,50,"Sent Rtt Message");this.$1ex=true}},$3lo:function(a,c){this.$5SZ();if(a)(a.get_$2GC()||a.get_$1lp())&&Diag.$2.$9(8245956,355,15,"Task is faulted or cancelled with exception {0}",a.$lJ);var b=this.$5Bf(this.$23j.$59I());if(!b){this.$1NL=null;return}this.$2iG++;this.$1NL=c.$1Fs(3,WordEditor.Presence.$Bi.$438(b.$5B()));this.$5Sb();var d=this;this.$1NL.CW(function(a){d.$3lo(a,c)})},$5Bf:function(a){if(!a)return null;if(!this.get_$Ic()){Diag.$2.$9(8245957,355,15,"GetParagraphAnchoredOpFromGraphTransactionOperation: CoAuth manager is null");return null}var c=new WERTT.$Bj(WordEditor.Presence.$E8.$rt.$3Zd(),this.get_$Ic().get_$8H(),1,0,0),b=null;switch(a.get_$19()){case 0:b=WERTT.$Fl.$5BF(a,c,this.$WN);break;case 4:b=WERTT.$Nt.$5Bd(a,c);break;case 3:b=WERTT.$DG.$5Bc(a,c);break;case 2:b=WERTT.$Nu.$5Be(a,c);break;case 1:b=WERTT.$EP.$5Bh(a,c,this.$WN)}return b}};WERTT.$EP=function(a,b,c,d,e,f,g,h,i){WERTT.$EP.initializeBase(this,[4,i]);this.$4a=a;this.$PL=b;this.$Jy=c;this.$Kr=d;this.$1rI=e;this.$1qa=f;this.$1X8=g;this.$1qb=h;if(this.$1rI===this.$4a)this.$g6=this.$1qa;else if(this.$1X8===this.$4a)this.$g6=this.$1qb;else{Diag.$2.$9(8397766,355,10,"Bad data passed to RttSplitParagraphOp");this.$g6=0}};WERTT.$EP.$x=function(c){var a=c.$M3,b=c.$15D;return new WERTT.$EP(a.$ve,a.$wV,a.$142,a.$Kr,b.$2Jr,b.$2Nt,b.$2Js,b.$2Nu,WERTT.$Bj.$x(c))};WERTT.$EP.$5Bh=function(b,f,c){if(b.get_$19()!==1)return null;var a=b,d=c.$14F(a.$Lf.get_$9X(),a.$Lf.get_$i()),e=new WERTT.$EP(a.$Lf.get_$3v(),a.$Lf.get_$C1(),c.$1Gz(d,a.$1tV),a.$ba,a.$kG.get_$3v(),a.$kG.get_$C1(),a.$kJ.get_$3v(),a.$kJ.get_$C1(),f);return e};WERTT.$EP.prototype={$4a:0,get_$3v:function(){return this.$4a},$PL:0,get_$C1:function(){return this.$PL},$g6:0,get_$pc:function(){return this.$g6},$Jy:null,$Kr:0,$1rI:0,$1qa:0,$1X8:0,$1qb:0,$1Pp:function(){return this.$4a===this.$1X8},get_$64P:function(){return this.$g6},get_$6Ax:function(){return this.$1Pp()?this.$1rI:this.$1X8},get_$3zu:function(){return this.$1Pp()?this.$1qa:this.$1qb},$5B:function(){var a=new WEDOT.$Bz(3,this.$4a,this.$PL,this.$Jy,null,null,null,this.$Kr),b=new WordEditor.Presence.$UF(this.$1rI,this.$1qa,this.$1X8,this.$1qb);return new WordEditor.Presence.$DH(this.$Qz.$ar,this.$Qz.$Hi,1,4,a,null,null,null,null,null,b,null,0)}};WERTT.$aR.registerClass("WERTT.$aR",null,Sys.IDisposable);WERTT.$qv.registerClass("WERTT.$qv",null,WERTT.$mu);WERTT.$jN.registerClass("WERTT.$jN",null,Common.App.$jx,Common.Utils.$l6);WERTT.$fp.registerClass("WERTT.$fp");WERTT.$DG.registerClass("WERTT.$DG",WERTT.$qv);WERTT.$Tw.registerClass("WERTT.$Tw",null,WERTT.$J3);WERTT.$Tv.registerClass("WERTT.$Tv",null,WERTT.$J3);WERTT.$Jd.registerClass("WERTT.$Jd",null,WERTT.$J3);WERTT.$Ns.registerClass("WERTT.$Ns",null,WERTT.$J3);WERTT.$fq.registerClass("WERTT.$fq",null,WERTT.$kI);WERTT.$fr.registerClass("WERTT.$fr",null,WERTT.$mw);WERTT.$Nt.registerClass("WERTT.$Nt",WERTT.$qv,WERTT.$J1,WERTT.$mu);WERTT.$fs.registerClass("WERTT.$fs",null,WERTT.$SY);WERTT.$HP.registerClass("WERTT.$HP",null,WordEditor.$SZ);WERTT.$Nu.registerClass("WERTT.$Nu",WERTT.$qv,WERTT.$J1,WERTT.$mu);WERTT.$HQ.registerClass("WERTT.$HQ");WERTT.$ft.registerClass("WERTT.$ft",null,WERTT.$kG);WERTT.$Ty.registerClass("WERTT.$Ty");WERTT.$Bj.registerClass("WERTT.$Bj");WERTT.$HR.registerClass("WERTT.$HR",WERTT.$qv);WERTT.$Fl.registerClass("WERTT.$Fl",WERTT.$HR,WERTT.$J1,WERTT.$mu);WERTT.$Nv.registerClass("WERTT.$Nv",WERTT.$HR,WERTT.$J1,WERTT.$mu);WERTT.$fu.registerClass("WERTT.$fu",null,WERTT.$kE);WERTT.$Nw.registerClass("WERTT.$Nw",null,BPr.$SX);WERTT.$EP.registerClass("WERTT.$EP",WERTT.$qv,WERTT.$J1,WERTT.$mu);WERTT.$jN.$5Sr();Type.registerNamespace("WordEditor.SkypeChat");WordEditor.SkypeChat.$qL=function(){};WordEditor.SkypeChat.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.SkypeChat.$jf)};WordEditor.SkypeChat.$On=function(a){this.$$d_$5ZA=Function.createDelegate(this,this.$5ZA);this.$1x9=new($$sc.$5l.$$(String));this.$24p=a};WordEditor.SkypeChat.$On.prototype={$24p:null,$4L:null,$cL:null,$Vp:0,$7Y:function(a){this.$Vp=a},get_$3Ad:function(){if(this.$Vp===1){this.$24p.get_$Q().$7Y(this.$Vp);return this.$24p.get_$Q().get_$3Ad()}var a=this;WordEditor.$6E.get_$28J().CW(function(){a.$4L=WordEditor.$6E.get_$28J().get_$5k();var b=a.$4L.get_$Ug().EmailAddress;if(!b){a.$cL=a.$4L.get_$nU();a.$cL.add_$jX(a.$$d_$5ZA)}else a.$1x9.$9D(b)});return this.$1x9.get_$8z()},$5ZA:function(){var a=this.$4L.get_$Ug();if(a.EmailAddress){this.$1x9.$9D(a.EmailAddress);this.$cL.remove_$jX(this.$$d_$5ZA)}}};WordEditor.SkypeChat.$jf=function(){this.$$d_$5q3=Function.createDelegate(this,this.$5q3)};WordEditor.SkypeChat.$jf.prototype={$U:null,get_$5j:function(){return"WordEditor.SkypeChat"},$7Y:function(){var a=this,b=this,c=new Common.App.SkypeChat.$Yb(new($$sc.$x.$$(Common.App.SkypeChat.$RY))(function(){return a.$U.$J(Common.App.SkypeChat.$UC)}),new($$sc.$x.$$(Common.App.SkypeChat.$ME))(function(){return b.$U.$J(Common.App.SkypeChat.$ME)}),this.$U.$3j(Common.App.BasicChat.$RB),this.$$d_$5q3);c.$7Y()},$5q3:function(){Box4.App.$1rE&&this.$U.$J(Common.App.SkypeChat.$Jt)},$d:function(){},$t9:function(a){this.$U=a;var d=Common.Utils.$5U.$V9(Common.$Mr,a.$3j(Common.$Mr)),e=Common.Utils.$5U.$V9(Common.$Mq,a.$3j(Common.$Mq)),j=this;a.$e(Common.$Ha).$p().$n(function(){return Common.$Ha.$H3(Box4.App.get_$X().get_$CN(),null)});var k=this;a.$e(WoSk.$KA).$p().$n(function(){return new WoSk.$KA(WordEditor.$6E.get_$28J())});var l=this;a.$e(WoSk.$Js).$p().$n(function(){return new WoSk.$Js(WordEditor.$6E.get_$28J())});var b,c,m=this;a.$e(WordEditor.SkypeChat.$On).$p().$n(function(){return new WordEditor.SkypeChat.$On(new($$sc.$x.$$(Common.App.SkypeChat.$b6))(function(){return a.$J(Common.App.SkypeChat.$L9)}))});if(Box4.App.$1rE){var n=this;a.$e(Common.App.SkypeChat.$Jt).$p().$n(function(){return new Common.App.SkypeChat.$Jt(a.$J(WordEditor.Presence.$Eg).$2De(),WordEditor.Presence.$28.get_$4(),d,e)});var o=this;a.$e(Common.App.SkypeChat.$Nr).$p().$n(function(){return new Common.App.SkypeChat.$Nr(a.$J(WordEditor.Presence.$Eg).$2De(),d,WordEditor.Presence.$28.get_$4(),a.$J(WordEditor.SkypeChat.$On),e)});var f=Common.Utils.$5U.$V9(Common.$J5,a.$3j(Common.App.SkypeChat.$Jt)),g=Common.Utils.$5U.$V9(Common.$J5,a.$3j(WoSk.$Js));b=$$sc.$30.$iV(Common.$J5,new Common.App.SkypeChat.$h3(f,g));var h=a.$J(WoSk.$KA),i=a.$J(Common.App.SkypeChat.$Nr);c=new Common.App.SkypeChat.$X6(h,i)}else{b=Common.Utils.$5U.$V9(Common.$J5,a.$3j(WoSk.$Js));c=a.$J(WoSk.$KA)}var p=this;a.$e(Common.App.SkypeChat.$K9).$p().$n(function(){return new Common.App.SkypeChat.$K9(Common.Utils.$5U.$V9(Common.$9N,a.$3j(Common.$9N)),Common.$0.$9g,Box4.App.get_$X().get_$CN())});var q=this;a.$e(WoSk.$Ut).$1p(Common.App.SkypeChat.$UC).$1p(Common.App.SkypeChat.$RY).$p().$n(function(){return new WoSk.$Ut(Common.$0.get_$r(),a.$J(Common.App.SkypeChat.$L8),b,a.$J(Common.$Ha),c,a.$J(WordEditor.$9M))});var r=this;a.$e(Common.App.SkypeChat.$ME).$p().$n(function(){return new WoSk.$j8(Box4.App.get_$X().$BM,Common.$b.$4(),a.$J(Common.App.SkypeChat.$RZ))})}};WordEditor.SkypeChat.$qL.registerClass("WordEditor.SkypeChat.$qL");WordEditor.SkypeChat.$On.registerClass("WordEditor.SkypeChat.$On",null,Common.App.SkypeChat.$b6);WordEditor.SkypeChat.$jf.registerClass("WordEditor.SkypeChat.$jf",null,Common.App.$jx,Common.Utils.$l6);WordEditor.SkypeChat.$qL.$5Sr();Type.registerNamespace("RealtimePresenceUI");RealtimePresenceUI.$Or=function(a,b,c,d,e,f,g,h,i){RealtimePresenceUI.$Or.initializeBase(this,[a,f]);this.$ZO=b;this.$2VH=c;this.$2gA=d;this.$2fH=e;this.$EF=g;this.$2p=h;this.$RU=i};RealtimePresenceUI.$Or.$7s=function(f,g,h,i,j){var a=Box4.App.get_$X().$1L,b=function(b,c){if(a.$3o.get_$BW()){var d=a.$3o;return d.$4N1(b,c,true)}else return false},c=function(b,c){if(a.$3o.get_$BW()){var d=a.$3o;d.$3tL(b,c,true,true)}},d=function(a){Box4.App.get_$X().$4p.$K1(a);Box4.App.$BH.get_$Ko().$3tE()},e=Common.$0.get_$r();return new RealtimePresenceUI.$Or(f,g,b,c,d,e,h,i,j)};RealtimePresenceUI.$Or.prototype={$ZO:null,$2VH:null,$2gA:null,$2fH:null,$EF:null,$2p:null,$RU:null,$5Q2:function(e,d){var a=this.$2ue(d);if(!a)return;this.$2gA(a.get_$Eb().get_$By(),a.get_$Eb().get_$1Uu().get_$2V());var b=this,c=new Common.$1e(2,1,0,function(){b.$K.$4J(761503246,2,a)});Common.$1J.get_$4().$2f(c)},$2ue:function(b){if(!b)return null;var a=WordEditor.Presence.$B7.$2nD(WordEditor.Presence.$Bi.$1r7(b),this.$EF,this.$2p,this.$RU.get_$Q());return!a||!a.$5i()||!a.get_$Eb()?null:a},$4Mp:function(b,a){return!this.$5O0(a)?false:!this.$4N0(a)?false:true},$5O0:function(a){return!!this.$2ue(a)},$4N0:function(b){var a=this.$2ue(b);return!a?false:this.$2VH(a.get_$Eb().get_$By(),a.get_$Eb().get_$1Uu().get_$2V())},$52s:function(){return this.$ZO.$5Ds()},$4RG:function(){return CommonUIStrings.l_PeoplesWellUserStatusIsEditingOnline},$5l3:function(){this.$2fH(this.$Au.get_$E())},$d:function(){if(this.$ZO){this.$ZO.dispose();this.$ZO=null}RealtimePresenceUI.$Oy.prototype.$d.call(this)}};Type.registerNamespace("WordEditor.PeoplesWellControl");WordEditor.PeoplesWellControl.$4I=function(){this.$$d_$1nu=Function.createDelegate(this,this.$1nu);this.$$d_$1F5=Function.createDelegate(this,this.$1F5)};WordEditor.PeoplesWellControl.$4I.get_$1pB=function(){return WordEditor.PeoplesWellControl.$4I.$d8||(WordEditor.PeoplesWellControl.$4I.$d8=Common.Utils.$8.get_$4().$J(BPr.$D3))};WordEditor.PeoplesWellControl.$4I.prototype={get_$5j:function(){return"WordEditor.PeoplesWellControl"},$t9:function(a){WordEditor.PeoplesWellControl.$4I.$U=a},$7Y:function(){Common.$0.$o.$UQ(this.$$d_$1F5)},$1F5:function(){if(!Common.$0.$2K3)return;if(WordEditor.PeoplesWellControl.$4I.$T)return;if(!Box4.App.get_$X())return;var a=Box4.App.get_$X().$1L;if(!a)return;a.add_$mw(this.$$d_$1nu);var b=WordEditor.PeoplesWellControl.$4I.get_$1pB().$T8();if(!b)return;var c=WordEditor.Presence.$5z.$T8();if(!c)return;var g=this;WordEditor.PeoplesWellControl.$4I.$RU=new($$sc.$x.$$(Box4.$Ag))(function(){return a.get_$2v().get_$3V()});if(!WordEditor.PeoplesWellControl.$4I.$RU)return;var d=Box4.App.$20.$kb,e=Common.$t.$3aL(Common.$0.$9R,"we_SingleCollabUserGlyph16",Common.$0.$9R,"we_SingleCollabUserGlyph32",Common.$0.$9R,"we_MoreUsersGlyph16"),f=RealtimePresenceUI.$JV.$7s(e,d,b.$9U);WordEditor.PeoplesWellControl.$4I.$T=RealtimePresenceUI.$Or.$7s(f,c,WordEditor.PeoplesWellControl.$4I.$U.$2S(WordEditor.$7l),WordEditor.PeoplesWellControl.$4I.$U.$2S(WordEditor.$D5),WordEditor.PeoplesWellControl.$4I.$RU);WordEditor.PeoplesWellControl.$4I.$T.$5m2()},$1nu:function(a){if(WordEditor.PeoplesWellControl.$4I.$T)return;a.remove_$mw(this.$$d_$1nu);this.$7Y()},$d:function(){if(WordEditor.PeoplesWellControl.$4I.$T){WordEditor.PeoplesWellControl.$4I.$T.dispose();WordEditor.PeoplesWellControl.$4I.$T=null}}};WordEditor.PeoplesWellControl.$qL=function(){};WordEditor.PeoplesWellControl.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.PeoplesWellControl.$4I)};RealtimePresenceUI.$Or.registerClass("RealtimePresenceUI.$Or",RealtimePresenceUI.$Oy);WordEditor.PeoplesWellControl.$4I.registerClass("WordEditor.PeoplesWellControl.$4I",null,Common.App.$jx,Common.Utils.$l6);WordEditor.PeoplesWellControl.$qL.registerClass("WordEditor.PeoplesWellControl.$qL");WordEditor.PeoplesWellControl.$4I.$T=null;WordEditor.PeoplesWellControl.$4I.$U=null;WordEditor.PeoplesWellControl.$4I.$RU=null;WordEditor.PeoplesWellControl.$4I.$d8=null;WordEditor.PeoplesWellControl.$qL.$5Sr()