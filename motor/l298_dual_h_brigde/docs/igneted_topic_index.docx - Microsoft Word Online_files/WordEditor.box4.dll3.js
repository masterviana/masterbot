/*! Version=16.0.6820.2201 */
Type.registerNamespace("Common.App.AddinCommands");Common.App.AddinCommands.$mx=function(){};Common.App.AddinCommands.$mx.registerInterface("Common.App.AddinCommands.$mx");Common.App.AddinCommands.$VO=function(a,b){this.$x5=2;this.$1HR=a;this.$fe=b};Common.App.AddinCommands.$VO.prototype={$fe:null,$x5:0,$1HR:null,$5qR:function(c){var d=Common.$0.get_$1Y().get_$Hf().get_$1Ty(),e=String.format(d+"AddinServiceHandler.ashx?action={0}&app={1}","GETLASTUPDATELIVEID",Common.$0.get_$1Y().get_$Hf().get_$oz()),f=Common.$0.$7Q,a=null;if(this.$fe)a=this.$fe.$8G("ComponentAttach",Common.$5n.toString(c)+Common.$4z.toString(this.$x5));var b=this,g=this;f.$DC(e,1,null,null,false,4,function(d){if(d.$1v.$7c&&d.$1v.$7c.length>0){var e=Number.parseInvariant(d.$1v.$7c);b.$1HR(c,b.$x5,{ak0:e})}a&&a.$4x()},function(){Diag.$2.$9(17438153,220,50,"GetLastUpdate request failed.");a&&a.$4x()},null,null,false,null,null,null)}};Common.App.AddinCommands.$VU=function(a,b){this.$x5=1;this.$1HR=a;this.$fe=b};Common.App.AddinCommands.$VU.prototype={$fe:null,$x5:0,$1HR:null,$5qR:function(b){var a=null;if(this.$fe)a=this.$fe.$8G("ComponentAttach",Common.$5n.toString(b)+Common.$4z.toString(this.$x5));try{var c=Common.$Hw.$3YG()+b;Boolean.parse(this.$53t(c)||"false")&&this.$1HR(b,this.$x5,{ak0:+new Date-2592e5});a&&a.$4x()}catch(d){Diag.$2.$9(17306844,220,50,"LocalStorage is not allowed, {0}.",d.toString());a&&a.$4x()}},$53t:function(b){var a=localStorage;return!isUndefined(a)&&null!==a?a.getItem(b):null}};Common.App.AddinCommands.$rB=function(a){this.$$d_$5qS=Function.createDelegate(this,this.$5qS);this.$fe=a};Common.App.AddinCommands.$rB.prototype={$fe:null,$5Hf:function(){var b=this.$3WW();if(b){var a=b.$$ge();while(a.$$mn()){var c=a.$$cu(),d=this.$4ui(c.get_$Q());d&&d.$5qR(c.get_$Ao())}}},$5qS:function(b,c,a){if(a&&a.ak0){a.ack1=b;a.ack0=c;this.$5hR(1782110672,a)}},$4ui:function(b){var a=null;switch(b){case 1:a=new Common.App.AddinCommands.$VU(this.$$d_$5qS,this.$fe);break;case 2:a=new Common.App.AddinCommands.$VO(this.$$d_$5qS,this.$fe)}return a}};Common.App.AddinCommands.$VO.registerClass("Common.App.AddinCommands.$VO",null,Common.App.AddinCommands.$mx);Common.App.AddinCommands.$VU.registerClass("Common.App.AddinCommands.$VU",null,Common.App.AddinCommands.$mx);Common.App.AddinCommands.$rB.registerClass("Common.App.AddinCommands.$rB");Type.registerNamespace("Common.App.AppLoadStateTracker");Common.App.AppLoadStateTracker.AppLoadStateTracker=function(){};Common.App.AppLoadStateTracker.AppLoadStateTracker.$H3=function(){return new($$sc.$x.$$(Common.App.AppLoadStateTracker.AppLoadStateTracker))(function(){return new Common.App.AppLoadStateTracker.AppLoadStateTracker})};Common.App.AppLoadStateTracker.AppLoadStateTracker.get_instance=function(){return Common.App.AppLoadStateTracker.AppLoadStateTracker.$T.get_$Q()};Common.App.AppLoadStateTracker.AppLoadStateTracker.prototype={$2a5:false,$5TM:function(){this.$2a5=true},isAppFullyLoaded:function(){return this.$2a5}};Common.App.AppLoadStateTracker.$Vu=function(){};Common.App.AppLoadStateTracker.$Vu.prototype={get_$5j:function(){return"AppLoadStateTracker"},$t9:function(){},$7Y:function(){Common.App.AppLoadStateTracker.AppLoadStateTracker.get_instance().$5TM()},$d:function(){}};Common.App.AppLoadStateTracker.$qL=function(){};Common.App.AppLoadStateTracker.$qL.$5Sr=function(){Common.App.$f.get_$4().$3M(new Common.App.AppLoadStateTracker.$Vu)};Common.App.AppLoadStateTracker.AppLoadStateTracker.registerClass("Common.App.AppLoadStateTracker.AppLoadStateTracker");Common.App.AppLoadStateTracker.$Vu.registerClass("Common.App.AppLoadStateTracker.$Vu",null,Common.App.$jx,Common.Utils.$l6);Common.App.AppLoadStateTracker.$qL.registerClass("Common.App.AppLoadStateTracker.$qL");Common.App.AppLoadStateTracker.AppLoadStateTracker.$T=Common.App.AppLoadStateTracker.AppLoadStateTracker.$H3();Common.App.AppLoadStateTracker.$qL.$5Sr();Type.registerNamespace("Common.App.AppsForOffice");Common.App.AppsForOffice.$n0=function(){};Common.App.AppsForOffice.$n0.registerInterface("Common.App.AppsForOffice.$n0");Common.App.AppsForOffice.$W5=function(){Common.App.AppsForOffice.$W5.initializeBase(this);this.set_$4T(5)};Common.App.AppsForOffice.$W5.prototype={$17e:null,$3CB:"WACDialogBodyPanel",$3CE:"100%",$3CA:"408px",$3CC:"15px",$3CD:"0",$3CT:"WACDialogPanel",$3CU:695,$3CS:438,$14T:function(){CommonUI.$4l.prototype.$14T.call(this);this.$17e=$get(this.$3CB);this.$17e.style.width=this.$3CE;this.$17e.style.height=this.$3CA;this.$17e.style.marginTop=this.$3CC;this.$17e.style.padding=this.$3CD},$15A:function(){CommonUI.$4l.prototype.$15A.call(this);var a=$get(this.$8H(this.$3CT));a.style.width=String.format("{0}px",this.$3CU);a.style.height=String.format("{0}px",this.$3CS)},get_$4mo:function(){return this.$17e}};Common.App.AppsForOffice.$W5.registerClass("Common.App.AppsForOffice.$W5",CommonUI.$4l,Common.App.AppsForOffice.$n0);Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.$nG=function(){};Common.App.AppsForOfficeCommon.$nG.registerInterface("Common.App.AppsForOfficeCommon.$nG");Common.App.AppsForOfficeCommon.$aq=function(){};Common.App.AppsForOfficeCommon.$aq.registerInterface("Common.App.AppsForOfficeCommon.$aq");Common.App.AppsForOfficeCommon.$Pk=function(){this.Ver=1};Common.App.AppsForOfficeCommon.$6g=function(){};Common.App.AppsForOfficeCommon.$6g.get_$4=function(){if(!Common.App.AppsForOfficeCommon.$6g.$T)Common.App.AppsForOfficeCommon.$6g.$T=new Common.App.AppsForOfficeCommon.$6g;return Common.App.AppsForOfficeCommon.$6g.$T};Common.App.AppsForOfficeCommon.$6g.prototype={$2u2:function(b){var a=this.$2u9();if(!a)return null;try{return a.getItem(b)}catch(c){return null}},$3vw:function(b,c){var a=this.$2u9();if(!a)return;try{a.setItem(b,c)}catch(d){}},$33O:function(b){var a=this.$2u9();if(!a)return;try{a.removeItem(b)}catch(c){}},$2cM:false,$2u9:function(){var a=null;if(!this.$2cM)try{if(localStorage)a=localStorage}catch(b){this.$2cM=true}return a}};Common.App.AppsForOfficeCommon.$I2=function(a){this.$18u=a};Common.App.AppsForOfficeCommon.$I2.prototype={$18u:null,$5FZ:function(a){var b=new Date;return Math.abs(b.getTime()-a.CreatedOn)<864e5*a.RR},$53s:function(b,d){var c=this.$18u.$2u2(b);if(c){var a=new Common.App.AppsForOfficeCommon.$Pk;try{a=Sys.Serialization.JavaScriptSerializer.deserialize(c,true)}catch(e){this.$18u.$33O(b);return null}if(!d)return a.Data;else if(this.$5FZ(a))return a.Data;else{this.$18u.$33O(b);return null}}return null},$5vf:function(b,c,d){var a=new Common.App.AppsForOfficeCommon.$Pk;a.Data=c;a.RR=d;a.CreatedOn=+new Date;this.$18u.$3vw(b,Sys.Serialization.JavaScriptSerializer.serialize(a))},$5n7:function(a){this.$18u.$33O(a)}};Common.App.AppsForOfficeCommon.$Pk.registerClass("Common.App.AppsForOfficeCommon.$Pk");Common.App.AppsForOfficeCommon.$6g.registerClass("Common.App.AppsForOfficeCommon.$6g",null,Common.App.AppsForOfficeCommon.$nG);Common.App.AppsForOfficeCommon.$I2.registerClass("Common.App.AppsForOfficeCommon.$I2",null,Common.App.AppsForOfficeCommon.$aq);Common.App.AppsForOfficeCommon.$6g.$T=null;Type.registerNamespace("CommandUI.AddInCommands");CommandUI.AddInCommands.$lp=function(){};CommandUI.AddInCommands.$lp.registerInterface("CommandUI.AddInCommands.$lp");CommandUI.AddInCommands.$lo=function(){};CommandUI.AddInCommands.$lo.registerInterface("CommandUI.AddInCommands.$lo");CommandUI.AddInCommands.$ln=function(){};CommandUI.AddInCommands.$ln.registerInterface("CommandUI.AddInCommands.$ln");CommandUI.AddInCommands.$R4=function(){};CommandUI.AddInCommands.$R4.registerInterface("CommandUI.AddInCommands.$R4");CommandUI.AddInCommands.$R5=function(){};CommandUI.AddInCommands.$R5.registerInterface("CommandUI.AddInCommands.$R5");CommandUI.AddInCommands.$S0=function(){};CommandUI.AddInCommands.$S0.registerInterface("CommandUI.AddInCommands.$S0");CommandUI.AddInCommands.$Mi=function(){};CommandUI.AddInCommands.$Mi.registerInterface("CommandUI.AddInCommands.$Mi");CommandUI.AddInCommands.$b1=function(){};CommandUI.AddInCommands.$b1.registerInterface("CommandUI.AddInCommands.$b1");CommandUI.AddInCommands.$nD=function(){};CommandUI.AddInCommands.$nD.registerInterface("CommandUI.AddInCommands.$nD");CommandUI.AddInCommands.$nA=function(){};CommandUI.AddInCommands.$nA.registerInterface("CommandUI.AddInCommands.$nA");CommandUI.AddInCommands.$n9=function(){};CommandUI.AddInCommands.$n9.registerInterface("CommandUI.AddInCommands.$n9");CommandUI.AddInCommands.$nO=function(){};CommandUI.AddInCommands.$nO.registerInterface("CommandUI.AddInCommands.$nO");CommandUI.AddInCommands.$nL=function(){};CommandUI.AddInCommands.$nL.registerInterface("CommandUI.AddInCommands.$nL");CommandUI.AddInCommands.$nK=function(){};CommandUI.AddInCommands.$nK.registerInterface("CommandUI.AddInCommands.$nK");CommandUI.AddInCommands.$nJ=function(){};CommandUI.AddInCommands.$nJ.registerInterface("CommandUI.AddInCommands.$nJ");CommandUI.AddInCommands.$n7=function(){};CommandUI.AddInCommands.$n7.registerInterface("CommandUI.AddInCommands.$n7");CommandUI.AddInCommands.$mq=function(){};CommandUI.AddInCommands.$mq.registerInterface("CommandUI.AddInCommands.$mq");CommandUI.AddInCommands.$VN=function(){};CommandUI.AddInCommands.$VN.prototype={$2U5:null,get_$43z:function(){return this.$2U5||(this.$2U5=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},$5Ep:function(e,f,g,h,b,d){Diag.$2.$9(17138449,220,50,"Control id: {0}.",e);var i=h,a=f.$3QY(b.ownerAddinInfo.storeType,b.ownerAddinInfo.assetId);if(a&&a.$R1)if(a.$R1.getStatus()===OSF.OsfControlStatus.Activated||a.$R1.getStatus()===OSF.OsfControlStatus.NotActivated)try{b.action(g);d&&d()}catch(j){Diag.$2.$9(17425949,220,10,String.format("HandleAddinCommandsAction error message : {0}.",j.message));CommandUI.AddInCommands.$2w.$3xb(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}else if(a.$R1.getNotificationParams()){var c=this.$4Ki(a.$R1.getNotificationParams());c.$1z=a.$R1.getErrorcode();CommandUI.AddInCommands.$2w.$60b(c)}},$4Ki:function(b){var a=new CommandUI.AddInCommands.$VW;a.$1sQ=b.infoType;a.$3Q=b.id;a.$PM=b.title;a.$VN=b.description;a.$2Py=b.buttonTxt;a.$1rd=b.buttonCallback;return a}};CommandUI.AddInCommands.$KL=function(){};CommandUI.AddInCommands.$KL.prototype={$5j0:function(b,a){if(!b.$qR)a[CommandUI.Controls.$3a.Visible]=false;else a[CommandUI.Controls.$3a.Visible]=true;a[CommandUI.Controls.$3a.LabelText]=b.$qR},$3xy:function(a,b,c,d){if(a.$qR===CommonUIStrings.l_ErrorLoadingAddInsTitle)CommandUI.AddInCommands.$2w.$60g(b,Common.$J.$EX($get(c)),d,CommonUIStrings.L_ButtonOfficeAddins);else if(a.$qR===CommonUIStrings.l_LoadingAddInsTitle)a.$2gy&&CommandUI.AddInCommands.$2w.$60h(b,Common.$J.$EX($get(c)))}};CommandUI.AddInCommands.$ck=function(a,b,c,d,e,f){this.$17=new Common.$2y;this.$xc=a;this.$2W3=b;this.$Eq=c;this.$25g=d;this.$104=e;this.$2UJ=f};CommandUI.AddInCommands.$ck.prototype={$xc:null,$2W3:null,$Eq:null,$25g:null,$104:null,$2UJ:null,add_$4BW:function(a){this.$17.$1O("ack7",a)},$3hB:function(d,i,c){var b=c.ack2,a=isUndefined(c.ack0)?0:c.ack0;if(!b||!a||b.get_$14()<=0&&a!==4){this.$3oU(new CommandUI.AddInCommands.$ck.$3oT(a,null,null,d,i,null,true));return}var g=b.get_$14(),h=new CommandUI.AddInCommands.$ck.$5qh(d),l=isUndefined(c.ack1)?-1:c.ack1,m=new CommandUI.AddInCommands.$VS(a,this.$Eq,this.$xc,h,this.$2W3,this.$104),j=this,n=function(a){return j.$25g.$4Kx(a.assetId)},k=this,o=function(a){return k.$25g.$4Jo(a.assetId)},e=this,p=function(f,b,k,j){g--;var c=new CommandUI.AddInCommands.$ck.$3oT(a,b,h,d,i,j,g<=0);if(f&&b)e.$5gN(c);else e.$3oU(c)},f=this,q=function(){f.$311();b.get_$14()<=0&&a===4&&f.$104.$368()};m.$3hB(b,n,o,l,p,q)},$3oU:function(a){this.$311();this.$3xz(false,a)},$5gN:function(b){this.$311();var a=b.$1Xg;CommandUI.AddInCommands.$8D.get_$4().$3v7(CommandUI.AddInCommands.$Eu.$634(a.currentStoreType.toLowerCase()),true);if(a.currentStoreType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog){var c=this.$2UJ.$3L1(a.currentStoreType.toLowerCase(),this.$Eq);c&&c.localCacheAddinCommands(this.$Eq.get_$31p(),a.id,a.appVersion,a.storeId)}this.$4NR(b.$1Y9.$1Xo,b.$kZ,b.$1sC);this.$3xz(true,b)},$3xz:function(c,a){if(c){if(a.$kZ!==3)a.$1sg&&this.$104.$368();else if(a.$1Y9.$1Xo){var b=$$as(CommandUI.$5d,a.$1sC);b&&CommandUI.AddInCommands.$2w.$60j(b,a.$2Qw,a.$Y3,a.$1Y9.$1Xo)}}else if(a.$kZ===3)if(a.$1Xg&&a.$1Xg.currentStoreType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog)CommandUI.AddInCommands.$2w.$3xb(this.$Eq.$58n());else this.$104.$3vY(true);else{this.$104.$3vY(false);a.$1sg&&this.$104.$368()}},$311:function(){this.$17.$27("ack7")},$4NR:function(c,e,f){var a=$$as(CommandUI.$5d,f);if(c&&a){var d=c.get_$38Y().get_$5(0),b=d.get_$1qR().Id;e===3&&a.$35E(b,false);a.$5OT(b)&&a.$5rp()}}};CommandUI.AddInCommands.$ck.$3oT=function(a,b,c,d,e,f,g){this.$kZ=a;this.$1Xg=b;this.$1Y9=c;this.$1sC=d;this.$2Qw=e;this.$Y3=f;this.$1sg=g};CommandUI.AddInCommands.$ck.$3oT.prototype={$kZ:0,$1Xg:null,$1Y9:null,$1sC:null,$2Qw:null,$Y3:null,$1sg:false};CommandUI.AddInCommands.$ck.$5qh=function(a){this.$2FX=new CommandUI.AddInCommands.$fi(a)};CommandUI.AddInCommands.$ck.$5qh.prototype={$2FX:null,$1Xo:null,$2jf:function(a){this.$2FX.$2jf(a);this.$1Xo=a},$33R:function(a){this.$2FX.$33R(a)}};CommandUI.AddInCommands.$VW=function(){};CommandUI.AddInCommands.$VW.prototype={$1sQ:0,$3Q:null,$PM:null,$VN:null,$2Py:null,$1rd:null,$1z:0};CommandUI.AddInCommands.$P9=function(){};CommandUI.AddInCommands.$P9.prototype={$R1:null,$1tJ:null,$1rl:null,$Y3:null,$3gK:function(a,b){return this.$R1.getStoreType()===a&&this.$R1.getMarketplaceID()===b}};CommandUI.AddInCommands.$PA=function(){};CommandUI.AddInCommands.$PA.$4BT=function(b){var a={};a.id=b.assetId;a.assetId=b.assetId;a.appVersion=b.appVersion;a.currentStoreType=b.storeType;a.storeId=b.storeId;a.assetStoreId=b.storeType;a.targetType=b.targetType;a.isAddinCommands=true;return a};CommandUI.AddInCommands.$Eu=function(){};CommandUI.AddInCommands.$Eu.$3Et=function(b){var a=null;switch(b){case 0:a=OSF.StoreType.OMEX;break;case 1:a=OSF.StoreType.SPCatalog;break;case 2:a=OSF.StoreType.SPApp;break;case 3:a=OSF.StoreType.FileSystem;break;case 4:a=OSF.StoreType.Exchange;break;case 6:a=OSF.StoreType.Registry;break;case 7:a=OSF.StoreType.InMemory;break;case 8:a=OSF.StoreType.UploadFileDevCatalog}return a};CommandUI.AddInCommands.$Eu.$634=function(b){var a=-1;switch(b.toLowerCase()){case"omex":a=0;break;case"spcatalog":a=1;break;case"spapp":a=2;break;case"filesystem":a=3;break;case"exchange":a=4;break;case"registry":a=6;break;case"inmemory":a=7;break;case"uploadfiledevcatalog":a=8}return a};CommandUI.AddInCommands.$6q=function(){};CommandUI.AddInCommands.$6q.$57K=function(k){var d=new($$sc.$F.$$(String));if(CommandUI.AddInCommands.$6q.$2m6)for(var e=CommandUI.AddInCommands.$6q.$2m6,g=e.length,b=0;b<g;++b){var i=e[b];d.$F(i)}var a=null;switch(k){case"Workbook":a=CommandUI.AddInCommands.$6q.$43V;break;case"Document":a=CommandUI.AddInCommands.$6q.$3Nv;break;case"Presentation":a=CommandUI.AddInCommands.$6q.$3od}if(a)for(var f=a,h=f.length,c=0;c<h;++c){var j=f[c];d.$F(j)}return d};CommandUI.AddInCommands.$UQ=function(a){this.$y=a;this.get_$1qR().Id=this.$y};CommandUI.AddInCommands.$UQ.prototype={$y:null,$2hY:null,$2Z0:null,$2g9:null,$1sa:false,$2Sy:null,$2R7:null,get_$1qR:function(){return this.$2hY||(this.$2hY={})},get_$2vd:function(){return this.$2Z0||(this.$2Z0=new($$sc.$F.$$(CommandUI.AddInCommands.$Qs)))},get_$34u:function(){return this.$2g9||(this.$2g9=new($$sc.$F.$$(CommandUI.AddInCommands.$O2)))},$1Ga:function(){var c=new($$sc.$F.$$(String)),d=new($$sc.$F.$$(String)),a=this.get_$34u().$$lge();while(a.$$mn()){var g=a.$$cu();c.$F(g.$1Ga())}var b=this.get_$2vd().$$lge();while(b.$$mn()){var h=b.$$cu();d.$F(h.$1Ga())}var e=this.$3I2("Groups",this.$2R7,d.$8V()),f=this.$3I2("Scaling",this.$2Sy,c.$8V());return Common.$m.$27b("Tab",this.get_$1qR(),f,e)},$3I2:function(b,c,d){var a={};a.Id=c;return Common.$m.$27b.apply(null,[b,a].concat(d))}};CommandUI.AddInCommands.$Qs=function(a){if(CommandUI.$I.$b(a)){Diag.$2.$9(9041811,220,10,"GroupDefinition id should not be null or undefined.");throw Error.create("GroupDefinition id should not be null or undefined");}this.$y=a;this.get_$12z().Id=this.$y};CommandUI.AddInCommands.$Qs.prototype={$y:null,$2hp:null,$2Yy:null,$2W6:null,set_$64A:function(a){this.$2hp=a;this.get_$12z().Template=this.$2hp;return a},get_$12z:function(){return this.$2Yy||(this.$2Yy={})},get_$1hJ:function(){return this.$2W6||(this.$2W6=new($$sc.$F.$$(CommandUI.AddInCommands.$R5)))},$1Ga:function(){var b=new($$sc.$F.$$(String)),a=this.get_$1hJ().$$lge();while(a.$$mn()){var d=a.$$cu();b.$F(d.$1Ga())}var c=Common.$m.$27b.apply(null,["Controls",null].concat(b.$8V()));return Common.$m.$27b("Group",this.get_$12z(),c)}};CommandUI.AddInCommands.$O2=function(a){if(CommandUI.$I.$b(a)){Diag.$2.$9(9041813,220,10,"ScalingDefinition type should not be null or undefined.");throw Error.create("ScalingDefinition type should not be null or undefined");}this.$2g8=a};CommandUI.AddInCommands.$O2.prototype={$2g8:null,$2g6:null,get_$fI:function(){return this.$2g6||(this.$2g6={})},$1Ga:function(){return Common.$m.$27f(this.$2g8,null,this.get_$fI())}};CommandUI.AddInCommands.$Kx=function(a,b){if(CommandUI.$I.$b(a)||CommandUI.$I.$b(b)){Diag.$2.$9(9175312,220,10,"ControlDefinition id or type should not be null or undefined.");throw Error.create("ControlDefinition id or type should not be null or undefined");}this.$2W9=b;this.$y=a;this.get_$dl().Id=this.$y};CommandUI.AddInCommands.$Kx.prototype={$y:null,$2W9:null,$2W5:null,$h2:null,get_$dl:function(){return this.$2W5||(this.$2W5={})},get_$1Tl:function(){return this.$h2||(this.$h2=new($$sc.$F.$$(CommandUI.AddInCommands.$S0)))},$1Ga:function(){return Common.$m.$27f(this.$2W9,this.$5Tt(),this.get_$dl())},$5Tt:function(){var a=null;if(this.$h2){a=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');var b=this.$h2.$$lge();while(b.$$mn()){var c=b.$$cu();a.append(c.$1Ga())}a.append("</Controls></MenuSection></Menu>")}return!a?"":a.toString()}};CommandUI.AddInCommands.$TC=function(a){if(CommandUI.$I.$b(a)){Diag.$2.$9(9175313,220,10,"MenuItemDefinition id should not be null or undefined.");throw Error.create("MenuItemDefinition id should not be null or undefined");}this.$y=a;this.get_$1Tk().Id=this.$y};CommandUI.AddInCommands.$TC.prototype={$y:null,$20m:null,get_$1Tk:function(){return this.$20m||(this.$20m={})},$1Ga:function(){return Common.$m.$27f("Button",null,this.$20m)}};CommandUI.AddInCommands.$dg=function(a){if(CommandUI.$I.$b(a)){Diag.$2.$9(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined.");throw Error.create("OfficeMenuDefinition id should not be null or undefined");}this.$y=a};CommandUI.AddInCommands.$dg.prototype={$y:null,$Vi:null,get_$E:function(){return this.$y},get_$1hL:function(){return this.$Vi||(this.$Vi=new($$sc.$F.$$(CommandUI.AddInCommands.$R5)))},$1Ga:function(){var a=null;if(this.$Vi){a=new Sys.StringBuilder;var b=this.$Vi.$$lge();while(b.$$mn()){var c=b.$$cu();a.append(c.$1Ga())}}return!a?"":a.toString()}};CommandUI.AddInCommands.$Xg=function(a){if(CommandUI.$I.$b(a)){Diag.$2.$9(9175315,220,10,"The agave key should not be null or undefined.");throw Error.create("The agave key should not be null or undefined");}this.$2UO=a};CommandUI.AddInCommands.$Xg.prototype={$2UO:null,$2dZ:null,get_$3jl:function(){return this.$2dZ||(this.$2dZ=new($$sc.$F.$$(CommandUI.AddInCommands.$Mi)))},get_$3Fg:function(){return this.$2UO}};CommandUI.AddInCommands.$ff=function(a){if(CommandUI.$I.$b(a)){Diag.$2.$9(9041814,220,10,"RibbonExtensibility tabs should not be null or undefined.");throw Error.create("RibbonExtensibility tabs should not be null or undefined");}this.$24z=a};CommandUI.AddInCommands.$ff.prototype={$24z:null,get_$38Y:function(){return this.$24z},$3S6:function(){var b=new Sys.StringBuilder,a=this.$24z.$$lge();while(a.$$mn()){var c=a.$$cu();b.append(c.$1Ga())}return this.$4FD(b.toString())},$4FD:function(b){var a=new Sys.StringBuilder;a.append("<Ribbon><Tabs>");a.append(b);a.append("</Tabs></Ribbon>");return a.toString()}};CommandUI.AddInCommands.$Kw=function(){this.$1H7=new($$sc.$F.$$(CommandUI.AddInCommands.$b1))};CommandUI.AddInCommands.$Kw.prototype={$1H7:null,$59m:function(e){Diag.$2.$9(17306645,220,50,"Context menu id: {0}",e);var c=new($$sc.$F.$$(CommandUI.AddInCommands.$Mi)),a=this.$1H7.$$lge();while(a.$$mn()){var f=a.$$cu(),b=f.get_$3jl().$$lge();while(b.$$mn()){var d=b.$$cu();d.get_$E()===e&&c.$F(d)}}return c},$4Jp:function(e){var a=this.$59m(e);if(a&&a.get_$14()>0){var b=new Sys.StringBuilder,c=a.$$lge();while(c.$$mn()){var d=c.$$cu();b.append(d.$1Ga())}if(!b.isEmpty())return Common.$m.$sw("msExtensibility",Common.$m.$sv("addInControls",[b.toString()]),"Menu16",null)}return null},$4B6:function(a){this.$1H7.$F(a)},$5nG:function(c){var a=this.$1H7.$$lge();while(a.$$mn()){var b=a.$$cu();if(b.get_$3Fg()===c.get_$3Fg()){this.$1H7.$73(b);break}}}};CommandUI.AddInCommands.$fi=function(a){this.$23c=new CommandUI.$fg(a)};CommandUI.AddInCommands.$fi.prototype={$23c:null,$2jf:function(b){var a=b.$3S6();this.$23c.$2jf(a)},$33R:function(b){var a=b.$3S6();this.$23c.$33R(a)}};CommandUI.AddInCommands.$8D=function(){this.$3Gh=new Common.App.AppsForOfficeCommon.$I2(Common.App.AppsForOfficeCommon.$6g.get_$4())};CommandUI.AddInCommands.$8D.get_$4=function(){if(!CommandUI.AddInCommands.$8D.$T)CommandUI.AddInCommands.$8D.$T=new CommandUI.AddInCommands.$8D;return CommandUI.AddInCommands.$8D.$T};CommandUI.AddInCommands.$8D.prototype={$3Gh:null,$667:function(b,a){a.val=null;return false},$3v7:function(b,c){var a=Common.$Hw.$3YG()+b;Common.App.AppsForOfficeCommon.$6g.get_$4().$3vw(a,c.toString())}};CommandUI.AddInCommands.$VT=function(a,b,c){this.$2pV=new Common.$2y;this.$De=new CommandUI.AddInCommands.$VT.$4BX;this.$1XM=a;this.$2PS=b;this.$1rS=c};CommandUI.AddInCommands.$VT.prototype={$1XM:null,$2PS:null,$1rS:null,add_$4BU:function(a){this.$2pV.$1O("ack4",a)},$66o:function(a){if(null!==a){this.$De.$1Ht=a.ack1;this.$De.$kZ=a.ack0;this.$De.$1YZ=this.$De.$1Y4=0;var e="ak0"in a?new Date(a.ak0):null;if(this.$De.$1Ht!==-1&&this.$De.$kZ&&e){var b=null,c,d;if(d=this.$1rS.$667(e,c={val:b}),b=c.val,d){this.$De.$ps=b;this.$De.$1YZ=this.$De.$1Y4=this.$De.$ps.$4s;this.$2It()}else{this.$De.$ps=new CommandUI.$JD;this.$De.$1rT=this.$2PS.$3L1(CommandUI.AddInCommands.$Eu.$3Et(this.$De.$1Ht),this.$1XM);if(this.$De.$1rT){var f=this;this.$De.$1rT.getEntitlementsAsync(this.$1XM.get_$31p(),true,function(a){f.$5aK(a)})}}}}},$5aK:function(f){var c=f;if(c&&c.length>0){this.$De.$1YZ=c.length;for(var d=0;d<c.length;d++){var a=c[d];if(a&&a.targetType===OSF.OsfControlTarget.TaskPane){var b={};b.marketplaceId=a.assetId;b.marketplaceVersion=a.appVersion;b.storeType=a.storeType;b.storeId=a.storeId;b.targetData=a;var e=this;this.$1XM.$5Km(b,function(a,b,c){if(a)b&&e.$De.$ps.$F(c.targetData);e.$2It()})}else this.$2It()}}else this.$2It()},$2It:function(){this.$De.$1Y4++;if(this.$De.$1Y4>=this.$De.$1YZ){this.$1rS.$3v7(this.$De.$1Ht,false);if(this.$De.$ps&&this.$De.$ps.$4s>0||this.$De.$kZ===4){var c=new($$sc.$F.$$(Object));if(this.$De.$ps){var b=this.$De.$ps.$3f();while(b.moveNext()){var d=b.get_current();c.$F(CommandUI.AddInCommands.$PA.$4BT(d))}}var a={ack2:c};a.ack1=this.$De.$1Ht;a.ack0=this.$De.$kZ;this.$2pV.$27("ack4",new CommandUI.AddInCommands.$VT.$4BV(a),this)}}}};CommandUI.AddInCommands.$VT.$4BV=function(a){CommandUI.AddInCommands.$VT.$4BV.initializeBase(this);this.$R3=a};CommandUI.AddInCommands.$VT.$4BV.prototype={$R3:null};CommandUI.AddInCommands.$VT.$4BX=function(){};CommandUI.AddInCommands.$VT.$4BX.prototype={$1Ht:0,$kZ:0,$1rT:null,$1YZ:0,$1Y4:0,$ps:null};CommandUI.AddInCommands.$VS=function(a,b,c,d,e,f){this.$2NM=new($$sc.$3j.$$(DiagUse.$cF));this.$1EX=a;this.$2mi=b;this.$1Ow=c;this.$2LK=d;this.$28k=e;this.$1VI=f;this.$2NK=Common.$0.get_$1Y().get_$CN()};CommandUI.AddInCommands.$VS.prototype={$2mi:null,$1Ow:null,$2LK:null,$28k:null,$1VI:null,$1EX:0,$2NK:null,$3hB:function(k,l,m,h,n,o){var c=this,d=function(e,b,f,g){n(e,b,f,g);var d=Common.$4z.toString(c.$1EX)+b.assetId,a=c.$2NM.get_$5(d);if(a){a.$4x();a=null;c.$2NM.$73(d)}},b=k;if(this.$1EX&&b){Diag.$2.$9(17326351,220,50,"Addin count {0}.",b.get_$14());if(this.$1EX===4){Diag.$2.$9(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",h));this.$4O3(b,h);o()}var e=b.$$lge();while(e.$$mn()){var i=e.$$cu(),a=i;if(this.$6AU(a))try{if(this.$2NK){var g=Common.$4z.toString(this.$1EX)+a.assetId,j=this.$2NK.$8G("ComponentAttach",g);this.$2NM.set_$5(g,j)}var f=this.$1VI.$3QY(a.currentStoreType,a.id);f&&this.$3J9(f);var p=this.$2mi.$5Jb(this.$5gk(a,l,m,d))}catch(q){Diag.$2.$9(17388185,220,10,String.format("AddinCommands AssetId={0} AppVersion={1} StoreType={2} StoreId={3} failed to install. Error message : {4}.",a.assetId,a.appVersion,a.currentStoreType,a.storeId,q.message));d(false,a,null,null)}else d(false,a,null,null)}}},$5Wo:function(a,e,f,c,g,b){if(b)if(b._isAddinCommandsManifest(this.$1Ow.get_$2wN())){var d=true;try{this.$4uz(a,e,f,g,b)}catch(h){d=false;Diag.$2.$9(17586257,220,10,String.format("AddinCommands AssetId={0} AppVersion={1} StoreType={2} StoreId={3} failed to generate ui extensibility. Error message : {4}.",a.assetId,a.appVersion,a.currentStoreType,a.storeId,h.message))}c(d,a,b,b.getDefaultDisplayName())}else{Diag.$2.$9(17586258,220,10,String.format("Regular content/taskpane addin AssetId={0} AppVersion={1} StoreType={2} StoreId={3} is not supported for addincommands.",a.assetId,a.appVersion,a.currentStoreType,a.storeId));c(false,a,null,null)}else{Diag.$2.$9(17586259,220,10,String.format("AddinCommands AssetId={0} AppVersion={1} StoreType={2} StoreId={3} failed to get manifest.",a.assetId,a.appVersion,a.currentStoreType,a.storeId));c(false,a,null,null)}},$5gk:function(b,f,g,h){var d=this,e=function(a,c){d.$5Wo(b,f,g,h,a,c)},a={},c=document.createElement("div");c.setAttribute("visible",false);a.div=c;a.id=b.id;a.marketplaceID=b.id;a.marketplaceVersion=b.appVersion;a.store=b.storeId;a.storeType=b.currentStoreType;a.osfControlType=b.targetType;a.isvirtualOsfControl=true;a.virtualOsfControlActivationCallback=e;a.reason=this.$1EX===3?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return a},$4uz:function(i,o,p,b,g){var a={};a.storeType=b.getStoreType();a.storeId=b.getStoreLocator();a.assetId=b.getMarketplaceID();a.appVersion=b.getMarketplaceVersion();a.targetType=b.getOsfControlType();var j=new OfficeExt.Parser.AddinCommandsManifestParser(this.$1Ow.get_$2wN(),this.$1Ow.get_$4uS()),k=j.parseExtensions(a,g),d=CommandUI.AddInCommands.$6q.$57K(this.$1Ow.get_$2wN());if(d&&d.get_$14()>0){var l=o(i),m=p(i),c=new CommandUI.AddInCommands.$VP(l,null,m),h=d.$$lge();while(h.$$mn()){var n=h.$$cu();c.commandSurface=n;k.apply(c)}var e=c.$4us(),f=c.$4ug(null);e&&this.$2LK.$2jf(e);f&&this.$28k.$4B6(f);this.$1VI.$4Bk(b,e,f,g.getDefaultDisplayName());Diag.$2.$9(17326353,220,100,"Add-in name: {0}.",g.getDefaultDisplayName())}},$3J9:function(a){a.$1tJ&&this.$2LK.$33R(a.$1tJ);a.$1rl&&this.$28k.$5nG(a.$1rl);a.$R1.purge(false);this.$1VI.$5mz(a.$R1.getStoreType(),a.$R1.getMarketplaceID())},$4O3:function(h,i){var f=CommandUI.AddInCommands.$Eu.$3Et(i),c=this.$1VI.$15w.$$lge();while(c.$$mn()){var a=c.$$cu();if(a.$R1.getStoreType()!==f)continue;var e=true,d=h.$$lge();while(d.$$mn()){var g=d.$$cu(),b=g;if(b&&a.$3gK(b.currentStoreType,b.id)){e=false;break}}e&&this.$3J9(a)}},$6AU:function(a){return!!a&&!!a.currentStoreType&&!!a.storeId&&!!a.id&&!!a.appVersion}};CommandUI.AddInCommands.$2w=function(){};CommandUI.AddInCommands.$2w.$2n0=function(a,b,e,c,f,g){CommandUI.AddInCommands.$2w.$IQ&&CommandUI.AddInCommands.$2w.$IQ.get_$ur()&&CommandUI.AddInCommands.$2w.$IQ.$CC();CommandUI.AddInCommands.$2w.$IQ=CommonUI.$JJ.$3Ln(b,a,a,f);CommandUI.AddInCommands.$2w.$IQ.set_$3KR(e);if(!CommandUI.$I.$8R(c)){CommandUI.AddInCommands.$2w.$IQ.set_$6L(c);CommandUI.AddInCommands.$2w.$IQ.set_$2F6(true)}var d=new Sys.UI.Bounds(0,0,CommandUI.$B.$1S5(),CommandUI.$B.$2EX());CommandUI.AddInCommands.$2w.$IQ.set_$3HE(CommandUI.AddInCommands.$2w.$3Wo(d,b,CommandUI.AddInCommands.$2w.$IQ.get_$6Ar(),g));CommandUI.AddInCommands.$2w.$IQ.$Bz()};CommandUI.AddInCommands.$2w.$3xb=function(b){CommandUI.AddInCommands.$2w.$IQ&&CommandUI.AddInCommands.$2w.$IQ.get_$ur()&&CommandUI.AddInCommands.$2w.$IQ.$CC();var a=new CommonUI.$4j;a.$16Q=false;a.set_$4T(0);a.$Ne(27,CommonUIStrings.l_DialogError,CommandUI.$I.$8R(b)?CommandUI.AddInCommands.$2w.$3Xh():b,null)};CommandUI.AddInCommands.$2w.$60b=function(a){CommandUI.AddInCommands.$2w.$IQ&&CommandUI.AddInCommands.$2w.$IQ.get_$ur()&&CommandUI.AddInCommands.$2w.$IQ.$CC();Diag.$2.$9(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",a.$1z));var d=CommandUI.$I.$8R(a.$VN)?CommandUI.AddInCommands.$2w.$3Xh():a.$VN,b=new CommonUI.$4j,c=null;if(a.$1rd){b.set_$4T(1);b.$5l(1,a.$2Py);b.$151(1);c=function(b){b===1&&a.$1rd()}}else b.set_$4T(0);b.$16Q=false;if(a.$1sQ===OSF.InfoType.Error)b.$Ne(a.$1z,a.$PM?a.$PM:CommonUIStrings.l_DialogError,d,c);else if(a.$1sQ===OSF.InfoType.Warning)b.$159(a.$PM?a.$PM:CommonUIStrings.l_DialogWarning,d,c);else b.$wL(a.$PM?a.$PM:CommonUIStrings.l_DialogInfo,d,c)};CommandUI.AddInCommands.$2w.$3Wo=function(c,a,e,d){var b=!d?0:4,f=a.x-c.x,g=c.x+c.width-a.x-a.width;if(f+a.width/2<=e/2)b=!d?2:5;else if(g+a.width/2<=e/2)b=!d?3:6;return b};CommandUI.AddInCommands.$2w.$60i=function(d,g,h,e,i){if(!e||!e.get_$38Y().get_$14()){Diag.$2.$9(17326355,220,50,"There is no tab or group added to ribbon !");return}var b=e.get_$38Y().get_$5(0),c=b.get_$1qR().Id,f=b.get_$2vd().get_$5(0).get_$12z().Id;if(d.$35E(c,false)){var a=b.$1sa?d.$575(c,f):d.$5D7(c);if(a){if(a.x+a.width/2>CommandUI.$B.$1S5())a=new Sys.UI.Bounds(CommandUI.$B.$1S5(),a.y+a.height,0,0);CommandUI.AddInCommands.$2w.$2n0(g,a,CommandUI.AddInCommands.$2w.$3Hx(h),i,1,0)}}};CommandUI.AddInCommands.$2w.$60j=function(b,c,a,d){CommandUI.AddInCommands.$2w.$60i(b,c,String.format(CommonUIStrings.l_NewAddInLoadedContent,a),d,String.format(CommonUIStrings.l_NewAddInLoadedTitle,a))};CommandUI.AddInCommands.$2w.$60g=function(f,g,h,i){var c=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),d=document.createElement("span");d.innerText=c[0];var b=document.createElement("span");b.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,h,i,CommonUIStrings.l_InsertionDialogRefresh);b.className="UIFontBold";var e=document.createElement("span");e.innerText=c[1];var a=document.createElement("div");Sys.UI.DomElement.addCssClass(a,"ModalCalloutControl");a.appendChild(d);a.appendChild(b);a.appendChild(e);CommandUI.AddInCommands.$2w.$2n0(f,g,a,CommonUIStrings.l_ErrorLoadingAddInsTitle,2,1)};CommandUI.AddInCommands.$2w.$60h=function(a,b){CommandUI.AddInCommands.$2w.$2n0(a,b,CommandUI.AddInCommands.$2w.$3Hx(CommonUIStrings.l_LoadingAddInsContent),CommonUIStrings.l_LoadingAddInsTitle,2,1)};CommandUI.AddInCommands.$2w.$3Hx=function(b){var a=document.createElement("div");Sys.UI.DomElement.addCssClass(a,"ModalCalloutControl");a.innerText=b;return a};CommandUI.AddInCommands.$2w.$3Xh=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};CommandUI.AddInCommands.$VP=function(a,b,c){this.ribbonBuilder=a;this.eventBuilder=b;this.contextMenuBuilder=c};CommandUI.AddInCommands.$VP.prototype={commandSurface:null,actionBuilder:null,ribbonBuilder:null,contextMenuBuilder:null,eventBuilder:null,$2PT:null,$4Xb:function(a){return new CommandUI.AddInCommands.$VQ(a)},$4Se:function(b,a){return OfficeExt.DefaultControlActionBinder.createActionBuilder(b,a.entitlement,a.manifest)},startApplyAddin:function(a){this.$2PT=a;var b=this.$4Xb(a);this.actionBuilder=this.$4Se(b,a)},endApplyAddin:function(){},$4us:function(){return this.ribbonBuilder.get_$38X()&&this.ribbonBuilder.get_$38X().get_$14()>0?new CommandUI.AddInCommands.$ff(this.ribbonBuilder.get_$38X()):null},$4ug:function(a){if(this.contextMenuBuilder.get_$30M()&&this.contextMenuBuilder.get_$30M().get_$14()>0){if(!a)a=this.$2PT.entitlement.assetId;var c=new CommandUI.AddInCommands.$Xg(a),b=this.contextMenuBuilder.get_$30M().$$lge();while(b.$$mn()){var d=b.$$cu();c.get_$3jl().$F(d)}return c}return null}};CommandUI.AddInCommands.$VQ=function(a){this.$2Qf=a.entitlement};CommandUI.AddInCommands.$VQ.prototype={$2Qf:null,createActionContext:function(c,b){var a={};a.ownerAddinInfo=this.$2Qf;a.action=b;return a}};CommandUI.AddInCommands.$rs=function(){};CommandUI.AddInCommands.$Xh=function(a,b,c){this.$xC=a;this.$1H9=b;this.$1H3=c;this.$1sr=new($$sc.$F.$$(CommandUI.AddInCommands.$Mi))};CommandUI.AddInCommands.$Xh.prototype={$17V:null,$RI:null,$xC:null,$1H9:null,$1H3:null,addButton:function(a){Diag.$2.$9(17085952,220,50,"ContextMenu button actiontype: {0}.",a.actionType);this.$RI=new CommandUI.AddInCommands.$Kx(this.$10x(a.id),"Button");this.$RI.get_$dl().LabelText=a.label;this.$RI.get_$dl().Alt=a.label;this.$RI.get_$dl().Image16by16=a.icon["16"];this.$27R(this.$RI.get_$dl().Id,a.action);this.$26P(this.$RI.get_$dl());this.$17V.get_$1hL().$F(this.$RI);this.$RI=null},startBuildMenu:function(a){if(CommandUI.$I.$b(this.$17V))this.$17V=new CommandUI.AddInCommands.$dg(a.id);else{var b=this.$10x(a.id);this.$RI=new CommandUI.AddInCommands.$Kx(b,"FlyoutAnchor");this.$27Z(this.$RI.get_$dl(),a);this.$RI.get_$dl().Command=798637440}},addMenuItem:function(a){Diag.$2.$9(17085953,220,50,"ContextMenu menu item actiontype: {0}.",a.actionType);var b=new CommandUI.AddInCommands.$TC(this.$10x(a.id));this.$27Z(b.get_$1Tk(),a);this.$27R(b.get_$1Tk().Id,a.action);this.$26P(b.get_$1Tk());this.$RI.get_$1Tl().$F(b)},endBuildMenu:function(){if(CommandUI.$I.$b(this.$RI)){this.$1sr.$F(this.$17V);this.$17V=null}else{this.$17V.get_$1hL().$F(this.$RI);this.$RI=null}},$1sr:null,get_$30M:function(){return this.$1sr},$27R:function(a,b){this.$1H3.bindAction(a,b)},$26P:function(a){this.$1H9.addCommandAttribute(a)},$10x:function(a){return this.$xC.getControlId(a)},$27Z:function(a,b){a.LabelText=b.label;a.Alt=b.label;a.Image16by16=b.icon["16"]}};CommandUI.AddInCommands.$YE=function(a){this.getControlId=this.$6Bd;this.$xB=a};CommandUI.AddInCommands.$YE.prototype={$xB:null,$6Bd:function(a){return this.$xB+a}};CommandUI.AddInCommands.$KK=function(){this.$17=new Common.$2y;this.$15w=new($$sc.$F.$$(CommandUI.AddInCommands.$P9))};CommandUI.AddInCommands.$KK.prototype={$qR:null,$1yI:0,$1zQ:false,$2gy:true,add_$4BY:function(a){this.$17.$1O("AddinCommandsLoadingMessageChanged",a)},set_$1Ov:function(b){var a=b;if(a!==this.$qR){this.$qR=a;this.$17.$27("AddinCommandsLoadingMessageChanged")}return b},$5vU:function(a){this.$2gy=a;this.$1yI++;!this.$qR&&this.set_$1Ov(CommonUIStrings.l_LoadingAddInsTitle)},$368:function(){this.$1yI--;if(this.$2zL())if(this.$1zQ)this.$qR!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.set_$1Ov(CommonUIStrings.l_ErrorLoadingAddInsTitle);else this.set_$1Ov(null)},$3vY:function(a){this.$1zQ=true;a&&this.set_$1Ov(CommonUIStrings.l_ErrorLoadingAddInsTitle)},$4Nv:function(){this.$1zQ=false;if(this.$2zL())this.set_$1Ov(null);else this.set_$1Ov(CommonUIStrings.l_LoadingAddInsTitle)},$2zL:function(){return this.$1yI<=0},$15w:null,$3QY:function(c,d){var a=this.$15w.$$lge();while(a.$$mn()){var b=a.$$cu();if(b.$3gK(c,d))return b}return null},$4Bk:function(b,c,d,e){var a=new CommandUI.AddInCommands.$P9;a.$R1=b;a.$1tJ=c;a.$1rl=d;a.$Y3=e;this.$15w.$F(a)},$5mz:function(d,e){var b=0,a=this.$15w.$$lge();while(a.$$mn()){var c=a.$$cu();if(c.$R1.getStoreType()===d&&c.$R1.getMarketplaceID()===e)this.$15w.$Cq(b);else b++}}};CommandUI.AddInCommands.$YI=function(a,b,c){this.getTabId=this.$6Be;this.getOfficeTabId=this.$6Bf;this.getControlId=this.$6Bd;this.$xB=a;this.$1tg=c;this.$pu=b};CommandUI.AddInCommands.$YI.prototype={$xB:null,$1tg:null,$pu:null,$6Bd:function(a){return this.$xB+this.$pu+a},$6Be:function(a){return this.$xB+this.$pu+a},$6Bf:function(a){if(a.toLowerCase()in this.$1tg){Diag.$2.$9(17306646,220,50,"Tab id: {0}.",a.toLowerCase());return this.$xB+this.$1tg[a.toLowerCase()]}return null}};CommandUI.AddInCommands.$YG=function(a,b){this.getGroupTemplate=this.$6Bc;this.getControlTemplateAlias=this.$6Bb;this.$2TR=a;this.$2QM=b};CommandUI.AddInCommands.$YG.prototype={$2TR:null,$2QM:null,$6Bb:function(b,a){return this.$2QM+a},$6Bc:function(){return this.$2TR}};CommandUI.AddInCommands.$YH=function(a,b){this.resolveTemplate=this.$6Ba;this.$2TQ=new CommandUI.AddInCommands.$YG(a,b)};CommandUI.AddInCommands.$YH.prototype={$2TQ:null,$6Ba:function(){return this.$2TQ}};CommandUI.AddInCommands.$YM=function(a){this.addCommandAttribute=this.$26P;this.$2QE=a};CommandUI.AddInCommands.$YM.prototype={$2QE:null,$26P:function(a){a.Command=this.$2QE}};CommandUI.AddInCommands.$YL=function(){this.bindAction=this.$1T};CommandUI.AddInCommands.$YL.prototype={$1T:function(a,b){OfficeExt.DefaultControlActionBinder.bindAction(a,b)}};CommandUI.AddInCommands.$8W=function(){};CommandUI.AddInCommands.$8W.get_$4=function(){if(!CommandUI.AddInCommands.$8W.$T)CommandUI.AddInCommands.$8W.$T=new CommandUI.AddInCommands.$8W;return CommandUI.AddInCommands.$8W.$T};CommandUI.AddInCommands.$8W.prototype={$3L1:function(a,b){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(a,b.get_$31p())}};CommandUI.AddInCommands.$Kv=function(a){this.$1Ho=a};CommandUI.AddInCommands.$Kv.prototype={$1Ho:null,get_$31p:function(){return this.$1Ho},$5Jb:function(a){return this.$1Ho.insertOsfControl(a)},$58n:function(){return this.$1Ho.getManifestInvaildErrorString()},$5Km:function(a,b){this.$1Ho.isAddinCommandsAsync(a,b)}};CommandUI.AddInCommands.$rr=function(a,b){this.$2hg=new($$sc.$F.$$(CommandUI.AddInCommands.$UQ));this.$xC=a;this.$1H3=b};CommandUI.AddInCommands.$rr.prototype={$Vl:null,$Vj:null,$xC:null,$1H3:null,get_$38X:function(){return this.$2hg},startBuildTab:function(a){var b=a.isOfficeTab?this.$xC.getOfficeTabId(a.id):this.$xC.getTabId(a.id);this.$Vl=new CommandUI.AddInCommands.$UQ(b)},startBuildGroup:function(a){var b=this.$10x(a.id);this.$Vj=new CommandUI.AddInCommands.$Qs(b)},addButton:function(a){var b=this.$10x(a.id);this.$27R(b,a.action)},startBuildMenu:function(){},addMenuItem:function(a){var b=this.$10x(a.id);this.$27R(b,a.action)},endBuildMenu:function(){},endBuildGroup:function(){this.$Vl.get_$2vd().$F(this.$Vj);this.$Vj=null},endBuildTab:function(){!CommandUI.$I.$b(this.$Vl.$y)&&this.$2hg.$F(this.$Vl);this.$Vl=null},$27R:function(a,b){this.$1H3.bindAction(a,b)},$10x:function(a){return this.$xC.getControlId(a)}};CommandUI.AddInCommands.$fh=function(a,b,c,d){CommandUI.AddInCommands.$fh.initializeBase(this,[a,b]);this.$1H9=c;this.$2R8=d};CommandUI.AddInCommands.$fh.prototype={$1a4:null,$lD:null,$lE:null,$2R8:null,$1H9:null,startBuildTab:function(a){CommandUI.AddInCommands.$rr.prototype.startBuildTab.call(this,a);this.$Vl.$1sa=a.isOfficeTab;if(!this.$Vl.$1sa)this.$Vl.get_$1qR().Title=a.label;var b=this.$Vl.$y;this.$Vl.$2Sy=b+".Scaling";this.$Vl.$2R7=b+".Groups"},startBuildGroup:function(a){CommandUI.AddInCommands.$rr.prototype.startBuildGroup.call(this,a);this.$Vj.get_$12z().Title=a.label},addButton:function(a){CommandUI.AddInCommands.$rr.prototype.addButton.call(this,a);Diag.$2.$9(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",a.actionType);var b=this.$WY(a,"Button");this.$26P(b.get_$dl());this.$Vj.get_$1hJ().$F(b)},startBuildMenu:function(a){this.$1a4=this.$WY(a,"FlyoutAnchor")},addMenuItem:function(a){CommandUI.AddInCommands.$rr.prototype.addMenuItem.call(this,a);Diag.$2.$9(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",a.actionType);var c=this.$10x(a.id),b=new CommandUI.AddInCommands.$TC(c);this.$27Z(b.get_$1Tk(),a);this.$26P(b.get_$1Tk());this.$1a4.get_$1Tl().$F(b)},endBuildMenu:function(){this.$Vj.get_$1hJ().$F(this.$1a4);this.$1a4=null},endBuildGroup:function(){this.$4Ky();this.$Vl.get_$34u().$F(this.$lD);if(this.$lE){this.$Vl.get_$34u().$F(this.$lE);this.$lE=null}this.$lD=null;CommandUI.AddInCommands.$rr.prototype.endBuildGroup.call(this)},$26P:function(a){this.$1H9.addCommandAttribute(a)},$WY:function(b,d){var c=this.$10x(b.id),a=new CommandUI.AddInCommands.$Kx(c,d);this.$27Z(a.get_$dl(),b);return a},$27Z:function(a,b){a.LabelText=b.label;a.Alt=b.label;a.Image16by16=b.icon["16"];a.Image32by32=b.icon["32"]},$4Ky:function(){var b=this.$2R8.resolveTemplate(this.$Vj);this.$Vj.set_$64A(b.getGroupTemplate());var a=this.$Vj.get_$1hJ().get_$14();Diag.$2.$9(17085956,220,50,"Control count: {0}.",a);var c=this.$Vj.get_$12z().Id;this.$lD=new CommandUI.AddInCommands.$O2("MaxSize");this.$lD.get_$fI().Id=c+".Scaling.MaxSize";this.$lD.get_$fI().GroupId=this.$Vj.get_$12z().Id;if(a>2){this.$lE=new CommandUI.AddInCommands.$O2("Scale");this.$lE.get_$fI().Id=c+".Scaling.Scale";this.$lE.get_$fI().GroupId=this.$Vj.get_$12z().Id}this.$5y9(a,b)},$5y9:function(a,e){var c=1;switch(a){case 1:case 2:this.$lD.get_$fI().Size="Large";break;case 3:this.$lD.get_$fI().Size="Large";this.$lE.get_$fI().Size="Medium";break;case 4:this.$lD.get_$fI().Size="MediumTwoRow";this.$lE.get_$fI().Size="SmallTwoRow";break;case 5:case 6:this.$lD.get_$fI().Size="Medium";this.$lE.get_$fI().Size="Small";break;default:Diag.$2.$9(9041819,220,10,"Addin commands does not support {0} controls.",a);throw Error.create(String.format("Addin commands does not support {0} controls",a));}var b=this.$Vj.get_$1hJ().$$lge();while(b.$$mn()){var d=b.$$cu();d.get_$dl().TemplateAlias=e.getControlTemplateAlias(d,c);c+=a!==3?1:2}}};CommandUI.AddInCommands.$iZ=function(a,b,c){this.$20z=a;this.$2ha=c;this.$1u5=new CommandUI.AddInCommands.$YL;this.$1vh=new CommandUI.AddInCommands.$YM(b)};CommandUI.AddInCommands.$iZ.prototype={$20z:null,$2ha:null,$1u5:null,$1vh:null,$4Jo:function(b){var a=new CommandUI.AddInCommands.$YE(b);return new CommandUI.AddInCommands.$Xh(a,this.$1vh,this.$1u5)},$4Kx:function(c){var a=new CommandUI.AddInCommands.$YI(this.$20z,c,this.$2ha),b=new CommandUI.AddInCommands.$YH(this.$20z+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new CommandUI.AddInCommands.$fh(a,this.$1u5,this.$1vh,b)}};CommandUI.AddInCommands.$VN.registerClass("CommandUI.AddInCommands.$VN",null,CommandUI.AddInCommands.$lp);CommandUI.AddInCommands.$KL.registerClass("CommandUI.AddInCommands.$KL",null,CommandUI.AddInCommands.$lo);CommandUI.AddInCommands.$ck.registerClass("CommandUI.AddInCommands.$ck",null,CommandUI.AddInCommands.$ln);CommandUI.AddInCommands.$ck.$3oT.registerClass("CommandUI.AddInCommands.$ck.$3oT");CommandUI.AddInCommands.$ck.$5qh.registerClass("CommandUI.AddInCommands.$ck.$5qh",null,CommandUI.AddInCommands.$n9);CommandUI.AddInCommands.$VW.registerClass("CommandUI.AddInCommands.$VW");CommandUI.AddInCommands.$P9.registerClass("CommandUI.AddInCommands.$P9");CommandUI.AddInCommands.$PA.registerClass("CommandUI.AddInCommands.$PA");CommandUI.AddInCommands.$Eu.registerClass("CommandUI.AddInCommands.$Eu");CommandUI.AddInCommands.$6q.registerClass("CommandUI.AddInCommands.$6q");CommandUI.AddInCommands.$UQ.registerClass("CommandUI.AddInCommands.$UQ");CommandUI.AddInCommands.$Qs.registerClass("CommandUI.AddInCommands.$Qs");CommandUI.AddInCommands.$O2.registerClass("CommandUI.AddInCommands.$O2");CommandUI.AddInCommands.$Kx.registerClass("CommandUI.AddInCommands.$Kx",null,CommandUI.AddInCommands.$R5);CommandUI.AddInCommands.$TC.registerClass("CommandUI.AddInCommands.$TC",null,CommandUI.AddInCommands.$S0);CommandUI.AddInCommands.$dg.registerClass("CommandUI.AddInCommands.$dg",null,CommandUI.AddInCommands.$Mi);CommandUI.AddInCommands.$Xg.registerClass("CommandUI.AddInCommands.$Xg",null,CommandUI.AddInCommands.$b1);CommandUI.AddInCommands.$ff.registerClass("CommandUI.AddInCommands.$ff",null,CommandUI.AddInCommands.$nD);CommandUI.AddInCommands.$Kw.registerClass("CommandUI.AddInCommands.$Kw",null,CommandUI.AddInCommands.$nA);CommandUI.AddInCommands.$fi.registerClass("CommandUI.AddInCommands.$fi",null,CommandUI.AddInCommands.$n9);CommandUI.AddInCommands.$8D.registerClass("CommandUI.AddInCommands.$8D",null,CommandUI.AddInCommands.$nO);CommandUI.AddInCommands.$VT.registerClass("CommandUI.AddInCommands.$VT");CommandUI.AddInCommands.$VT.$4BV.registerClass("CommandUI.AddInCommands.$VT.$4BV",Sys.EventArgs);CommandUI.AddInCommands.$VT.$4BX.registerClass("CommandUI.AddInCommands.$VT.$4BX");CommandUI.AddInCommands.$VS.registerClass("CommandUI.AddInCommands.$VS");CommandUI.AddInCommands.$2w.registerClass("CommandUI.AddInCommands.$2w");CommandUI.AddInCommands.$VP.registerClass("CommandUI.AddInCommands.$VP");CommandUI.AddInCommands.$VQ.registerClass("CommandUI.AddInCommands.$VQ");CommandUI.AddInCommands.$rs.registerClass("CommandUI.AddInCommands.$rs");CommandUI.AddInCommands.$Xh.registerClass("CommandUI.AddInCommands.$Xh",null,CommandUI.AddInCommands.$nJ);CommandUI.AddInCommands.$YE.registerClass("CommandUI.AddInCommands.$YE",null,CommandUI.AddInCommands.IContextMenuNamingProvider);CommandUI.AddInCommands.$KK.registerClass("CommandUI.AddInCommands.$KK");CommandUI.AddInCommands.$YI.registerClass("CommandUI.AddInCommands.$YI",null,CommandUI.AddInCommands.IRibbonNamingProvider);CommandUI.AddInCommands.$YG.registerClass("CommandUI.AddInCommands.$YG",null,CommandUI.AddInCommands.IRibbonGroupTemplate);CommandUI.AddInCommands.$YH.registerClass("CommandUI.AddInCommands.$YH",null,CommandUI.AddInCommands.IRibbonGroupTemplateResolver);CommandUI.AddInCommands.$YM.registerClass("CommandUI.AddInCommands.$YM",null,CommandUI.AddInCommands.IUIControlCommandBinder);CommandUI.AddInCommands.$YL.registerClass("CommandUI.AddInCommands.$YL",null,CommandUI.AddInCommands.IUIControlActionBinder);CommandUI.AddInCommands.$8W.registerClass("CommandUI.AddInCommands.$8W",null,CommandUI.AddInCommands.$nL);CommandUI.AddInCommands.$Kv.registerClass("CommandUI.AddInCommands.$Kv",null,CommandUI.AddInCommands.$nK);CommandUI.AddInCommands.$rr.registerClass("CommandUI.AddInCommands.$rr",null,CommandUI.AddInCommands.$n7);CommandUI.AddInCommands.$fh.registerClass("CommandUI.AddInCommands.$fh",CommandUI.AddInCommands.$rr);CommandUI.AddInCommands.$iZ.registerClass("CommandUI.AddInCommands.$iZ",null,CommandUI.AddInCommands.$mq);CommandUI.AddInCommands.$6q.$2m6=["PrimaryCommandSurface","ContextMenu"];CommandUI.AddInCommands.$6q.$43V=null;CommandUI.AddInCommands.$6q.$3Nv=null;CommandUI.AddInCommands.$6q.$3od=null;CommandUI.AddInCommands.$8D.$T=null;CommandUI.AddInCommands.$2w.$IQ=null;CommandUI.AddInCommands.$8W.$T=null;Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.$KU=function(){};Common.App.AppsForOfficeCommon.$ar=function(){};Common.App.AppsForOfficeCommon.$ar.registerInterface("Common.App.AppsForOfficeCommon.$ar");Common.App.AppsForOfficeCommon.$bU=function(){};Common.App.AppsForOfficeCommon.$bU.registerInterface("Common.App.AppsForOfficeCommon.$bU");Common.App.AppsForOfficeCommon.$I3=function(a,b,c,d){this.$$d_$5hL=Function.createDelegate(this,this.$5hL);this.$1ZV=a;this.$19j=b;this.$1dp=c;this.$1do=d};Common.App.AppsForOfficeCommon.$I3.prototype={$1dp:null,$1ZV:null,$19j:null,$R8:null,$WB:null,$1do:null,$5hL:function(o,a){if(o||!a){if(this.$WB){for(var d=0;d<this.$WB.get_$N();d++){var g=this.$WB.get_$5(d);g(null);g=null}this.$WB=null}return}if(a.$eW===200&&a.$29S){var c=a.$29S,k=c.lastChild,l=Common.App.AppsForOfficeCommon.$Ba.$5B6(k);this.$R8=new(Common.Collections.$1E.$$(Common.App.AppsForOfficeCommon.$KU))(null);var h=[],b=c.getElementsByTagName("app");if(!b||!b.length)b=c.getElementsByTagName("o:app");for(var e=0;b&&e<b.length;e++){var m=b[e],i=Common.App.AppsForOfficeCommon.$Ba.$3Rs(m);this.$R8.$F(i);Array.add(h,i)}if(!this.$R8.get_$N())Diag.$2.$9(6070471,344,50,"Response doesn't contain any preinstalled Apps: {0}",c.xml);else{this.$412(this.$R8);var n=Sys.Serialization.JavaScriptSerializer.serialize(h);this.$1ZV.$5vf(this.$1dp,n,l)}}else if(a.$A7)Diag.$2.$9(6070472,344,15,"Error when requesting Apps data: {0}",a.$A7);else Diag.$2.$9(6070473,344,15,"Error when requesting Apps data, status code: {0}",a.$eW);if(this.$WB){for(var f=0;f<this.$WB.get_$N();f++){var j=this.$WB.get_$5(f);j(this.$R8);j=null}this.$WB=null}},$5pL:function(a){if(!Common.$9j.get_$26n()){a&&a(null);return}if(this.$R8){a&&a(this.$R8);return}try{var d=this.$1ZV.$53s(this.$1dp,true),e=Sys.Serialization.JavaScriptSerializer.deserialize(d),b,c;!(c=Common.App.AppsForOfficeCommon.$Ba.$5Nz(e,b={val:this.$R8}),this.$R8=b.val,c)&&this.$1ZV.$5n7(this.$1dp)}catch(f){this.$R8=null}if(this.$R8){this.$412(this.$R8);a&&a(this.$R8);return}if(!this.$WB){this.$WB=new(Common.Collections.$1E.$$(Function))(null);a&&this.$WB.$F(a);this.$19j.$532(0,this.$$d_$5hL);return}if(this.$WB){a&&this.$WB.$F(a);return}},$5AX:function(){!this.$R8&&this.$5pL(null);return this.$R8},$3oX:function(b,e){var a,c;if(!e){var f=this;c=function(){b.iconLoaded16=true};a=this.$1do(b.icon16)}else{var g=this;c=function(){b.iconLoaded32=true};a=this.$1do(b.icon32)}if(a){var d=this;a.add_$XF(function(a,e){d.$5q4(a,e,b,c)})}return a},$5q4:function(d,a,b,c){if(a.$g5)b&&c()},$412:function(d){for(var c=d.$k6(),b=0;b<c.length;b++){var a=c[b];if(this.$1do){if(!a.iconLoaded16&&a.icon16){a.icon16=this.$40g(a.icon16);this.$3oX(a,0)}if(!a.iconLoaded32&&a.icon32){a.icon32=this.$40g(a.icon32);this.$3oX(a,1)}}}},$40g:function(a){if(!document.URL.toLowerCase().startsWith("https://"))if(a.toLowerCase().startsWith("https://"))a="http"+a.substring(5,a.length);return a}};Common.App.AppsForOfficeCommon.$KV=function(a,b,c){this.$$d_$4rh=Function.createDelegate(this,this.$4rh);this.$$d_$63L=Function.createDelegate(this,this.$63L);this.$3H=a;this.$60=b;this.$2Va=c};Common.App.AppsForOfficeCommon.$KV.prototype={$3H:null,$60:null,$2UY:null,$2Uk:0,$2Va:null,$532:function(a,b){if(!b)return;this.$2UY=b;this.$2Uk=a;this.$5t7(a,this.$2Va,this.$$d_$63L,this.$$d_$4rh)},$1SZ:function(a){this.$2UY(this.$2Uk,a)},$4rh:function(a){if(a&&a.$1v&&a.$1v.$7c){Diag.$2.$9(6070474,344,15,"Failure request.");this.$1SZ(new Common.App.AppsForOfficeCommon.$70(a.$1v.$eW,a.$1v.$7c,null))}else{Diag.$2.$9(6070475,344,15,"Failure request.");this.$1SZ(null)}},$63L:function(a){this.$1SZ(new Common.App.AppsForOfficeCommon.$70(a.$1v.$eW,a.$1v.$7c,a.$1v.$pM))},$5t7:function(a,b,d,e){if(!a)if(this.$3H&&this.$60&&b){var c=this.$3H.$5G.WebServiceBase;this.$60.$DC(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",c,Common.$0.$6J,b),1,"",null,true,2,d,e,null,null,false,null,null,null)}else Diag.$2.$9(6070476,344,10,"The request objects are not available");else Diag.$2.$9(6070477,344,15,"The request datatype is not supported.  {0}",{dataType:a})}};Common.App.AppsForOfficeCommon.$70=function(a,b,c){this.$eW=a;this.$A7=b;this.$29S=c};Common.App.AppsForOfficeCommon.$70.prototype={$eW:0,$A7:null,$29S:null};Common.App.AppsForOfficeCommon.$Ba=function(){};Common.App.AppsForOfficeCommon.$Ba.$59A=function(b,d){var c=b.prefix+":",a=b.attributes.getNamedItem(c+d);return a?a.nodeValue:""};Common.App.AppsForOfficeCommon.$Ba.$5DD=function(b){var a="0";switch(b){case"1":a="1";break;case"2":a="0";break;case"4":a="1";break;default:Diag.$2.$9(6850688,344,15,"Omex App SubType is invalid: {0}.",b)}return a};Common.App.AppsForOfficeCommon.$Ba.$5B6=function(b){var a=0;try{a=Number.parseInvariant(Common.App.AppsForOfficeCommon.$Ba.$59A(b,"rr"))}catch(c){Diag.$2.$9(6070478,344,15,"Error parsing server response for a preinstalled apps node: {0}.",c.message);a=0}return a===Number.NaN?0:a};Common.App.AppsForOfficeCommon.$Ba.$3Rs=function(c){var b=new Common.App.AppsForOfficeCommon.$KU;try{if(c.attributes&&c.attributes.length>0){for(var d=0;d<c.attributes.length;d++){var a=c.attributes.item(d),f=a.localName,e=a.baseName?a.baseName:f;if(a&&e)switch(e){case"title":b.title=a.nodeValue;break;case"assetid":b.assetId=a.nodeValue;break;case"cm":b.cm=a.nodeValue;break;case"ver":b.ver=a.nodeValue;break;case"appst":b.appst=Common.App.AppsForOfficeCommon.$Ba.$5DD(a.nodeValue);break;case"defhei":b.defhei=a.nodeValue;break;case"defwid":b.defwid=a.nodeValue;break;case"smallicon":b.icon16=a.nodeValue;break;case"medicon":b.icon32=a.nodeValue;break;case"largeicon":b.icon64=a.nodeValue;break;case"desc":b.desc=a.nodeValue;break;case"ldesc":b.lDesc=a.nodeValue}}b.iconLoaded16=false;b.iconLoaded32=false}}catch(g){Diag.$2.$9(6070479,344,15,"Error parsing server response for a preinstalled app node: {0}.",g.message)}return b};Common.App.AppsForOfficeCommon.$Ba.$5Nz=function(d,b){b.val=null;if(!d)return false;b.val=new(Common.Collections.$1E.$$(Common.App.AppsForOfficeCommon.$KU))(null);for(var c=0;c<d.length;c++){var a=d[c];if(!a.assetId||!a.ver||!a.cm||!a.appst){b.val=null;return false}b.val.$F(a)}return true};Common.App.AppsForOfficeCommon.$KU.registerClass("Common.App.AppsForOfficeCommon.$KU");Common.App.AppsForOfficeCommon.$I3.registerClass("Common.App.AppsForOfficeCommon.$I3",null,Common.App.AppsForOfficeCommon.$ar);Common.App.AppsForOfficeCommon.$KV.registerClass("Common.App.AppsForOfficeCommon.$KV",null,Common.App.AppsForOfficeCommon.$bU);Common.App.AppsForOfficeCommon.$70.registerClass("Common.App.AppsForOfficeCommon.$70");Common.App.AppsForOfficeCommon.$Ba.registerClass("Common.App.AppsForOfficeCommon.$Ba");Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.$M6=function(){};Common.App.AppsForOfficeCommon.$M6.registerInterface("Common.App.AppsForOfficeCommon.$M6");Common.App.AppsForOfficeCommon.$KS=function(a,b,c,d,e,f){this.id=a;this.marketplaceID=b;this.marketplaceVersion=c;this.store=d;this.storeType=e;this.settings=f;this.ownerAddinStoreType=null;this.ownerAddinAssetId=null;this.isAddinCommands=false;this.addinCommandsActionType=0};Common.App.AppsForOfficeCommon.$rS=function(){};Common.App.AppsForOfficeCommon.$W4=function(){};Common.App.AppsForOfficeCommon.$R8=function(){};Common.App.AppsForOfficeCommon.$R8.registerInterface("Common.App.AppsForOfficeCommon.$R8");Common.App.AppsForOfficeCommon.$MC=function(){};Common.App.AppsForOfficeCommon.$MC.registerInterface("Common.App.AppsForOfficeCommon.$MC");Common.App.AppsForOfficeCommon.$R9=function(){};Common.App.AppsForOfficeCommon.$R9.registerInterface("Common.App.AppsForOfficeCommon.$R9");Common.App.AppsForOfficeCommon.$ag=function(a,b,c,d){this.appName=a;this.appVersion=b;this.clientMode=c;this.formFactor=d||OSF.FormFactor.Default};Common.App.AppsForOfficeCommon.$cv=function(a,b,c){this.appUILocale=a;this.dataLocale=b;this.lcid=c};Common.App.AppsForOfficeCommon.$im=function(a,b,c,d,e,f,g,h,i,j){this.osfOmexBaseUrl=a;this.devCatalogUrl=b;this.oneDriveCatalogBaseApiUrl=c;this.spBaseUrl=d;this.docUrl=e;this.pageBaseUrl=f;this.localizedScriptsUrl=g;this.localizedImagesUrl=h;this.localizedStylesUrl=i;this.localizedResourcesUrl=j};Common.App.AppsForOfficeCommon.$M0=function(b,a){this.hostControl=b;this.controlStatusChanged=a.$533();this.notifyHost=a.$534()};Common.App.AppsForOfficeCommon.$ip=function(a){this.userNameHashCode=a};Common.App.AppsForOfficeCommon.$RS=function(){};Common.App.AppsForOfficeCommon.$RS.registerInterface("Common.App.AppsForOfficeCommon.$RS");Common.App.AppsForOfficeCommon.$RT=function(){};Common.App.AppsForOfficeCommon.$RT.registerInterface("Common.App.AppsForOfficeCommon.$RT");Common.App.AppsForOfficeCommon.$ak=function(){};Common.App.AppsForOfficeCommon.$ak.registerInterface("Common.App.AppsForOfficeCommon.$ak");Common.App.AppsForOfficeCommon.$an=function(){};Common.App.AppsForOfficeCommon.$an.registerInterface("Common.App.AppsForOfficeCommon.$an");Common.App.AppsForOfficeCommon.$ao=function(){};Common.App.AppsForOfficeCommon.$ao.registerInterface("Common.App.AppsForOfficeCommon.$ao");Common.App.AppsForOfficeCommon.$am=function(){};Common.App.AppsForOfficeCommon.$am.registerInterface("Common.App.AppsForOfficeCommon.$am");Common.App.AppsForOfficeCommon.$ap=function(){};Common.App.AppsForOfficeCommon.$ap.registerInterface("Common.App.AppsForOfficeCommon.$ap");Common.App.AppsForOfficeCommon.$Ii=function(){};Common.App.AppsForOfficeCommon.$Ii.registerInterface("Common.App.AppsForOfficeCommon.$Ii");Common.App.AppsForOfficeCommon.$bT=function(){};Common.App.AppsForOfficeCommon.$bT.registerInterface("Common.App.AppsForOfficeCommon.$bT");Common.App.AppsForOfficeCommon.$MI=function(){};Common.App.AppsForOfficeCommon.$MI.registerInterface("Common.App.AppsForOfficeCommon.$MI");Common.App.AppsForOfficeCommon.$P1=function(){this.$xV=new($$sc.$3j.$$(Common.App.AppsForOfficeCommon.$P0))};Common.App.AppsForOfficeCommon.$P1.prototype={$xV:null,$F:function(a,c){this.$xV.$30(a.id)&&Diag.$2.$9(7143680,344,15,"instance Id {0} already exists when adding new activated apps for office info",a.id);var b=new Common.App.AppsForOfficeCommon.$P0(a,c);this.$xV.set_$5(a.id,b)},$535:function(a){!this.$xV.$30(a)&&Diag.$2.$9(7143681,344,15,"instance Id {0} not exists when trying to get App Id",a);return this.$xV.get_$5(a).$271},$3Yz:function(c){var a=this.$xV.$3f();while(a.$$mn()){var b=a.$$cu();if(c===b.get_$Q().$271)return b.get_$Ao()}Diag.$2.$9(7143682,344,15,"AppId not found when calling GetInstanceId with {0}",c);return null},$55A:function(c){var a=this.$xV.get_$5(c).$2jC,b=new Common.App.AppsForOfficeCommon.$El(null,a.id,a.marketplaceID,a.marketplaceVersion,a.store,a.storeType,true);if(a.ownerAddinAssetId)b.$PK=new Common.App.AppsForOfficeCommon.$El(a.ownerAddinAssetId,a.ownerAddinAssetId,a.ownerAddinAssetId,a.marketplaceVersion,a.store,a.ownerAddinStoreType,false);return b}};Common.App.AppsForOfficeCommon.$P0=function(a,b){this.$2jC=a;this.$271=b};Common.App.AppsForOfficeCommon.$P0.prototype={$2jC:null,$271:null};Common.App.AppsForOfficeCommon.$AL=function(a,b,c){this.$VI=a;this.$PD=b;this.$Qt=c};Common.App.AppsForOfficeCommon.$AL.prototype={$VI:null,$PD:null,$Qt:null};Common.App.AppsForOfficeCommon.$Vo=function(){this.$Bh=new($$sc.$3j.$$(Function))};Common.App.AppsForOfficeCommon.$Vo.prototype={$Bh:null,$1gd:function(a){this.$111(a,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},$111:function(b,c){if(!b)return;var a={};a[OSF.DDA.Marshaling.ApiResponseKeys.Error]=c;b(a)}};Common.App.AppsForOfficeCommon.$rN=function(a,b){this.$$d_$4OG=Function.createDelegate(this,this.$4OG);this.$No=a;this.$No.add_$31F(this.$$d_$4OG);this.$1at=b};Common.App.AppsForOfficeCommon.$rN.prototype={$No:null,$1at:null,$2sp:function(d){Diag.$2.$m(5902748,341,!!this.$1at,null);var a,b,c;return(c=this.$1at.$9F(d,b={val:a}),a=b.val,c)?a:null},$4OG:function(d,c){var a=this.$1at.$$ge();while(a.$$mn()){var b=a.$$cu();b.get_$Q()&&b.get_$Q().$2X(c,null,null)}}};Common.App.AppsForOfficeCommon.$I0=function(a,b,c){this.$2PY=a;this.$2PX=b;this.$2PZ=c};Common.App.AppsForOfficeCommon.$I0.prototype={$2PY:null,get_$4GY:function(){return this.$2PY},$2PX:null,get_$4GX:function(){return this.$2PX},$2PZ:null,get_$4GZ:function(){return this.$2PZ}};Common.App.AppsForOfficeCommon.$rO=function(a,b,c){this.$$d_$5ET=Function.createDelegate(this,this.$5ET);this.$91=a;this.$pw=b;this.$2PU=c;this.$AJ={};this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError};Common.App.AppsForOfficeCommon.$rO.prototype={$91:null,$2PU:null,$pw:null,$py:null,$1z:0,$AJ:null,$6e:null,$5ET:function(){this.$46();this.$Ar()},$46:function(){},$Ar:function(){if(this.$pw){this.$AJ[OSF.DDA.Marshaling.ApiResponseKeys.Error]=this.$1z;this.$pw(this.$AJ)}}};Common.App.AppsForOfficeCommon.$rP=function(){var a=this;this.$2cm=new($$sc.$x.$$($$sc.$9P.$$(Function)))(function(){return a.$5g1()})};Common.App.AppsForOfficeCommon.$rP.prototype={$2cm:null,get_$3ie:function(){return this.$2cm.get_$Q()},$3WP:function(d){Diag.$2.$m(5902749,341,!!this.get_$3ie(),null);var a,b,c;return(c=this.get_$3ie().$9F(d,b={val:a}),a=b.val,c)?a():null}};Common.App.AppsForOfficeCommon.$I4=function(a,b,c){this.$$d_$67T=Function.createDelegate(this,this.$67T);this.$$d_$5lb=Function.createDelegate(this,this.$5lb);this.$25=a;this.$16q=b;this.$2UN=c};Common.App.AppsForOfficeCommon.$I4.prototype={$25:null,$16q:null,$2UN:null,invokeDdaMethod:function(b,c,e){var d=b.DdaMethod.DispatchId,a=this.$16q.get_$4GY().$3WP(d);if(a){a.$91=b;a.$pw=c;a.$2PU=e;a.$py=b.DdaMethod.ControlId;a.$6e=this.$2UN.$55A(a.$py);this.$2jh(a.$$d_$5ET,null)}else{Diag.$2.$9(5902750,341,10,"API Call for method ID {0} does not exist.",d);this.$111(c,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},registerDdaEventAsync:function(a,b,d,e,c){this.$2jh(this.$$d_$5lb,new Common.App.AppsForOfficeCommon.$QW(a,b,d,e,c))},unregisterDdaEventAsync:function(a,b,d,e,c){this.$2jh(this.$$d_$67T,new Common.App.AppsForOfficeCommon.$QW(a,b,d,e,c))},getThrottleForCall:function(a){return this.$16q.get_$4GZ().$5DR(a)},$2jh:function(b,c){var a=new Common.$1e(2,1,0,b);a.$Bp=c;this.$25.$2f(a)},$5lb:function(a){var b=this;this.$3op(a.$Bp,function(b,a){b.$1O(a.$1hK,a.$Bt,a.$n2,a.$2Nm)})},$67T:function(a){var b=this;this.$3op(a.$Bp,function(b,a){b.$2X(a.$1hK,a.$n2,a.$2Nm)})},$3op:function(a,c){var b=this.$16q.get_$4GX().$2sp(a.$2AJ);if(b)c(b,a);else{Diag.$2.$9(5902751,341,10,"Event for dispatch ID {0} does not exist.",a.$2AJ);this.$111(a.$n2,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},$111:function(b,c){if(!b)return;var a={};a[OSF.DDA.Marshaling.ApiResponseKeys.Error]=c;b(a)}};Common.App.AppsForOfficeCommon.$QW=function(a,b,c,d,e){this.$2AJ=a;this.$1hK=b;this.$2Nm=c;this.$Bt=d;this.$n2=e};Common.App.AppsForOfficeCommon.$QW.prototype={$2AJ:0,$1hK:null,$2Nm:null,$Bt:null,$n2:null};Common.App.AppsForOfficeCommon.$rT=function(){};Common.App.AppsForOfficeCommon.$rT.prototype={$U:null,$16s:null,$t9:function(a){this.$U=a;var b=this;a.$e(Common.App.AppsForOfficeCommon.$KV).$1p(Common.App.AppsForOfficeCommon.$bU).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$KV(Common.$0.$o,Common.$0.$7Q,b.get_$28F())});var d=this;a.$e(Common.App.AppsForOfficeCommon.$I2).$1p(Common.App.AppsForOfficeCommon.$aq).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$I2(Common.App.AppsForOfficeCommon.$6g.get_$4())});var c=this;a.$e(Common.App.AppsForOfficeCommon.$I3).$1p(Common.App.AppsForOfficeCommon.$ar).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$I3(a.$J(Common.App.AppsForOfficeCommon.$I2),a.$J(Common.App.AppsForOfficeCommon.$KV),c.get_$5gU(),Common.$31.$2p2)});var e=this;a.$e(Common.App.AppsForOfficeCommon.$P1).$1p(Common.App.AppsForOfficeCommon.$M6).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$P1});var f=this;a.$e(Common.App.AppsForOfficeCommon.$I4).$1p(Common.App.AppsForOfficeCommon.$bT).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$I4(Common.$0.get_$2e(),a.$J(Common.App.AppsForOfficeCommon.$I0),a.$J(Common.App.AppsForOfficeCommon.$M6))})},$7Y:function(){},$d:function(){if(this.$16s){this.$16s.$d();this.$16s=null}}};Common.App.AppsForOfficeCommon.$Cm=function(){};Common.App.AppsForOfficeCommon.$Cm.$2OH=function(e,a){for(var d=[],b=2;b<arguments.length;++b)d[b-2]=arguments[b];a.val=e;for(var c=0;c<d.length;c++){if(!a.val||!a.val.hasOwnProperty(d[c])){a.val=null;return false}a.val=a.val[d[c]]}return true};Common.App.AppsForOfficeCommon.$I5=function(a,b){this.dispose=this.$d;this.$10Q=a;this.$VX=b};Common.App.AppsForOfficeCommon.$I5.prototype={$10Q:null,$VX:null,$8F:function(){if(!this.$VX)return;this.$VX.$8F();this.$60c()},$60c:function(){if(!this.$VX)return;var a=this.$VX.$2sl();if(!a)return;for(var b=0;b<a.get_$14();b++)if(a.get_$5(b).$1H4||a.get_$5(b).$xN==="registry"){var c=new Common.App.AppsForOfficeCommon.$KS(a.get_$5(b).$1HS,a.get_$5(b).$80,a.get_$5(b).$1IT,a.get_$5(b).$1ID,a.get_$5(b).$xN,a.get_$5(b).$Au);c.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;c.osfControlType=1;if(!Common.$0.$o.$1A("AddInCommandsIsEnabled"))this.$10Q.$Xf(a.get_$5(b).$80,null,c);else{var d={};d.marketplaceId=c.marketplaceID;d.marketplaceVersion=c.marketplaceVersion;d.storeType=c.storeType;d.storeId=c.store;d.targetData=c;var e=this;this.$10Q.$3gc(d,function(b,c,a){!c&&e.$10Q.$Xf(a.targetData.marketplaceID,null,a.targetData);!b&&Diag.$2.$9(17384923,220,10,"Checking AddinCommands fails for {0} from {1}",a.targetData.marketplaceID,a.targetData.storeType)})}}return},$2Fb:function(a){if(!this.$VX)return;var b=new Common.App.AppsForOfficeCommon.$El(a.id,a.id,a.marketplaceID,a.marketplaceVersion,a.store,a.storeType,true);if(a.ownerAddinAssetId)b.$PK=new Common.App.AppsForOfficeCommon.$El(a.ownerAddinAssetId,a.ownerAddinAssetId,a.ownerAddinAssetId,a.marketplaceVersion,a.store,a.ownerAddinStoreType,false);this.$VX.$2Fb(b)},$4nF:function(b){if(!this.$VX)return;var a=this.$VX.$2ss(b);if(a){a.$1H4=false;this.$VX.$5vP(a)}},$d:function(){if(this.$10Q){this.$10Q.$d();this.$10Q=null}if(this.$VX){this.$VX.dispose();this.$VX=null}}};Common.App.AppsForOfficeCommon.$El=function(a,b,c,d,e,f,g){this.$2Pc=a;this.$1HS=b;this.$80=c;this.$1IT=d;this.$1ID=e;this.$xN=f;this.$1H4=g;this.$PK=null};Common.App.AppsForOfficeCommon.$El.prototype={$2Pc:null,$1HS:null,$80:null,$1IT:null,$1ID:null,$xN:null,$1H4:false,$PK:null,get_$oY:function(){return this.$xN===OSF.StoreType.InMemory||this.$PK&&!this.$PK.get_$oY()?false:true},$4Hi:function(a){return a.$80===this.$80&&a.$1IT===this.$1IT&&a.$1ID===this.$1ID&&a.$xN===this.$xN},$Au:null};Common.App.AppsForOfficeCommon.$rR=function(a,b,c,d,e){this.dispose=this.$d;this.$PP=a;this.$1Z1=b;this.$16q=c;this.$3Cn=d;this.$16t=e};Common.App.AppsForOfficeCommon.$rR.prototype={$PP:null,$1Z1:null,$3Cn:null,$16q:null,$16t:null,$8F:function(){this.$PP.$8F();this.$16t.$3F()},$d:function(){if(this.$PP){this.$PP.dispose();this.$PP=null}if(this.$16t){this.$16t.$d();this.$16t=null}}};Common.App.AppsForOfficeCommon.$9i=function(b,c,d,e,f,g,h,a){this.$$d_$3qM=Function.createDelegate(this,this.$3qM);this.$$d_$5Sc=Function.createDelegate(this,this.$5Sc);this.$$d_$5JF=Function.createDelegate(this,this.$5JF);this.$$d_$5if=Function.createDelegate(this,this.$5if);this.$$d_$5iQ=Function.createDelegate(this,this.$5iQ);this.$$d_$5QK=Function.createDelegate(this,this.$5QK);this.$$d_$44L=Function.createDelegate(this,this.$44L);this.$$d_$44C=Function.createDelegate(this,this.$44C);this.$$d_$4Gm=Function.createDelegate(this,this.$4Gm);this.$$d_$69o=Function.createDelegate(this,this.$69o);this.dispose=this.$d;this.$PP=b;this.$K=g;this.$3H=h;this.$1Z1=c;this.$Eq=d;this.$lB=null;this.$2I=e;this.$4m=f;this.$2Ud=this.$$d_$69o;this.$2Uc=this.$$d_$4Gm;this.$18U=a;this.$2dF=!a;this.$17=new Common.$2y};Common.App.AppsForOfficeCommon.$9i.$2qN=function(a){return a.assetId+"_"+a.ver+"_"+a.cm+"_OMEX_"+a.appst};Common.App.AppsForOfficeCommon.$9i.$4uc=function(b){if(!b)return null;var a=b.split("_");if(a.length<5)return null;var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4];return Common.App.AppsForOfficeCommon.$9i.$3Rx(c,d,e,f,g)};Common.App.AppsForOfficeCommon.$9i.$4ud=function(a){return!a?null:Common.App.AppsForOfficeCommon.$9i.$3Rx(a.assetId,a.ver,a.cm,"OMEX",a.appst)};Common.App.AppsForOfficeCommon.$9i.$3Rx=function(f,g,h,i,c){var a=Number.parseInvariant(c);(isNaN(a)||!isFinite(a))&&Diag.$2.$9(6850659,344,10,"appControlType value is invalid. AppSubType is {0}.",c);var d=String.format("{{{0}}}",Common.$1O.$x()),e={},b=new Common.App.AppsForOfficeCommon.$KS(d,f,g,h,i,e);b.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;b.osfControlType=a;return b};Common.App.AppsForOfficeCommon.$9i.prototype={$K:null,$Eq:null,$1Z1:null,$18U:null,$2dF:false,$PP:null,$lB:null,$2I:null,$4m:null,$2Ud:null,$2Uc:null,$3H:null,$17:null,$3F:function(){this.$K.$P(1099072191,2147483648,this.$$d_$44C);this.$K.$P(1743607468,2147483648,this.$$d_$44L);this.$K.$P(1945259303,2147483648,this.$$d_$5QK);this.$K.$P(3511208508,2147483648,this.$$d_$5iQ);this.$K.$P(860152194,2147483648,this.$$d_$5if);this.$K.$P(3553159035,2147483648,this.$$d_$5JF);this.$K.$P(1708531416,2147483648,this.$$d_$5Sc);this.$K.$P(741381681,2147483648,this.$$d_$3qM)},$44L:function(b,c,a){return this.$44B("WA104124372",a)},$5iQ:function(b,c,d,e,a){return this.$5iP("WA104124372",a)},$44B:function(c,b){var a=this.$3QL(c);if(b===1)return a?32:8;else if(b===2)if(a)this.$44D(Common.App.AppsForOfficeCommon.$9i.$4ud(a),Common.App.AppsForOfficeCommon.$9i.$2qN(a),a.title);else Diag.$2.$m(7673932,341,false,"ActivateTranslatorApp should not be enabled if the app can't be found");return 32},$5iP:function(c,d){var a=this.$3QL(c);if(!a)return 8;var b=d;b[CommandUI.Controls.$3a.LabelText]=a.title;return 32},$44C:function(g,h,e,i,f){if(2===e){var b=f,c=b.SourceControlId,d=b.LabelText,a=Common.App.AppsForOfficeCommon.$9i.$4uc(c);if(a)a.osfControlType===OSF.OsfControlType.ContainerLevel&&this.$3eD(a,d);else Diag.$2.$m(17384924,341,false,"Data unavailable for preinstalled app activation: {0}",{AppId:c})}return 32},$3eD:function(a,d){var g=this,f=function(b){var a={};a.id=b.marketplaceID;a.targetType=OSF.OsfControlType.ContainerLevel;a.currentStoreType=b.storeType;a.assetId=b.marketplaceID;a.appVersion=b.marketplaceVersion;a.storeId=b.store;a.assetStoreId=b.storeType;var d=new($$sc.$F.$$(Object));d.$F(a);var c={};c.ack2=d;c.ack0=3;g.$K.$4J(407117407,2,c)},c=this,e=function(a,b){c.$Xf(a.marketplaceID,b,a);c.$PP&&c.$PP.get_$Q()&&c.$PP.get_$Q().$2Fb(a)};if(!Common.$0.$o.$1A("AddInCommandsIsEnabled"))e(a,d);else if(a.isAddinCommands){if(!a.addinCommandsActionType)f(a);else if(a.addinCommandsActionType===2)e(a,d);else if(a.addinCommandsActionType===3){this.$4jc(a.marketplaceID,d,a);this.$PP&&this.$PP.get_$Q()&&this.$PP.get_$Q().$2Fb(a)}}else{var b={};b.marketplaceId=a.marketplaceID;b.marketplaceVersion=a.marketplaceVersion;b.storeType=a.storeType;b.storeId=a.store;b.targetData=a;var h=this;this.$3gc(b,function(b,c,a){if(c)f(a.targetData);else e(a.targetData,d);!b&&Diag.$2.$9(17384925,220,10,"Checking AddinCommands fails for {0} from {1}",a.targetData.marketplaceID,a.targetData.storeType)})}},$44D:function(a,b,c){!a&&Diag.$2.$m(6850658,341,false,"Data unavailable for preinstalled app activation: {0}",{AppId:b});a.osfControlType===OSF.OsfControlType.ContainerLevel&&this.$Xf(a.marketplaceID,c,a)},$5QK:function(f,g,d,h,e){if(d===2){this.$17.$27("OnInsertionDialogOpened");var a=e,b=a.SourceControlId,c=this.$5ej(b);this.$619(null,c)}return 32},$5if:function(e,f,c,g,d){if(c===2){var b=d,a=b.callback;if(!a)return 16;this.$5ie(a)}return 32},$5JF:function(f,g,d,h,e){if(d===2){var b=e,c=b.SourceControlId,a=this.$5ek(c);if(!a)return 16;this.$2Fa(a)}return 32},$5Sc:function(h,i,f,j,g){if(f===2){var a=g,b=a.LabelText,c=Common.$0.$9g,d=Common.$0.$6J,e="[TellMeForOfficeAddIn-FlyoutRendered]: AppName:{0} | SessionId:{1} | Lcid:{2}";Diag.$2.$9(16847762,341,50,String.format(e,b,c,d))}return 32},$3qM:function(e,f,c,g,d){if(c===2){var b=d,a=b.callback;a&&this.add_$3k4(a)}return 32},$Xf:function(){return true},$4jc:function(){},$2px:function(){return null},$4Jd:function(b){if(!b)return false;var f=false,d="AppForOfficeLogo_16x16x32";if(Common.$9j.get_$26n()){var c=this.$3WR();if(c&&c.get_$N()>0){b.append('<MenuSection Id="msApps" DisplayMode="Menu16"><Controls>');for(var e=0;e<c.get_$N();e++){var a=c.get_$5(e),g=Common.App.AppsForOfficeCommon.$9i.$2qN(a);if(a.iconLoaded16){d=a.icon16;b.append(this.$8Q(g,1099072191,d,"",a.title));f=true}else b.append(this.$8Q(g,1099072191,Common.$0.$9R,Common.$n.$6d(d),a.title))}b.append("</Controls></MenuSection>")}}return f},$d:function(){},$3gc:function(a,b){this.$Eq.get_$Q().isAddinCommandsAsync(a,b)},$534:function(){return this.$2Ud},$533:function(){return this.$2Uc},$44A:function(a){!this.$Eq.get_$Q()&&Diag.$2.$m(6068437,341,false,"ContextActivationManager unavailable while trying to activate app: {0}",a.marketplaceID);this.$Eq.get_$Q().insertOsfControl(a)},$5jy:function(a){if(!this.$Eq.get_$Q()){Diag.$2.$m(6431491,341,false,"ContextActivationManager unavailable while trying to reactivate app: {0}",a);return}this.$Eq.get_$Q().activateOsfControl(a)},$4l2:function(a){if(!this.$Eq.get_$Q()){Diag.$2.$m(6431492,341,false,"ContextActivationManager unavailable while trying to deactivate app: {0}",a);return}this.$Eq.get_$Q().deActivateOsfControl(a)},$5Ku:function(a){if(!this.$Eq.get_$Q()){Diag.$2.$m(0,341,false,"ContextActivationManager unavailable while trying to firgure out if app is active: {0}",a);return false}return this.$Eq.get_$Q().getOsfControlStatus(a)===OSF.OsfControlStatus.Activated},$69o:function(c,a,b){if(a===OSF.AgaveHostAction.CtrlF6Exit)this.$3qt(false);else if(a===OSF.AgaveHostAction.CtrlF6ExitShift)this.$3qt(true);else if(a===OSF.AgaveHostAction.Select)this.$3Im(c,false);else if(a===OSF.AgaveHostAction.SelectWithError)this.$3Im(c,true);else if(a===OSF.AgaveHostAction.UnSelect)this.$4Gl();else if(a===OSF.AgaveHostAction.CancelDialog)this.$4MP();else if(a===OSF.AgaveHostAction.InsertAgave){this.$18U.$9M();if(b)this.$2Fa(this.$4KJ(b));else Diag.$2.$9(17113349,344,10,"InsertAgave: should have valid insert agave parameters")}else if(a===OSF.AgaveHostAction.RefreshAddinCommands)Common.$0.$o.$1A("AddInCommandsIsEnabled")&&Common.$0.$o.$1A("AddInCommandsLoadedInBootingIsEnabled")&&this.$K.$4J(543799107,2,b)},$4Gm:function(){},$5vL:function(a,b){if(a!==this.$lB){b&&this.$4Iy();if(this.$Eq.get_$Q()){this.$Eq.get_$Q().notifyAgave(a,OSF.AgaveHostAction.CtrlF6In);this.$lB=a}}},$5vN:function(a){if(this.$Eq.get_$Q().appHasNotifications(a))this.$lB=null},$3QL:function(d){var a=this.$3WR();if(a)for(var b=0;b<a.get_$N();b++){var c=a.get_$5(b);if(c.assetId===d)return c}return null},$3qt:function(a){if(!a){document.activeElement.blur();this.$4m.$1l3(0,null,2,null,null)}else{document.activeElement.blur();this.$4m.$2Es(0,null,2,null,null)}this.$lB=null},$4Gl:function(){this.$lB=null},$3Im:function(d,f){this.$lB=d;var b=this.$5DC(d);if(f){var e=$get(d),g=this,a=new Common.$2q(function(){return e});a.$vq=true;a.$Fd(3);a.$Fd(2);a.$Fd(1);var c=this.$2I.$sx(e,this.$2I.$2w(b),a);c.$vO=true;c.$1V5();c.$3ij()}b&&this.$2I.$8x(b);return},$4Iy:function(){document.activeElement.blur()},add_$31F:function(a){this.$17.$1O("OnAppForOfficeClose",a)},add_$5a0:function(a){this.$17.$1O("OnInsertionDialogOpened",a)},$3k3:function(a){this.$4l2(a);this.$17.$27("OnAppForOfficeClose",a);this.$PP&&this.$PP.get_$Q()&&this.$PP.get_$Q().$4nF(a);this.$lB=null},$5DC:function(){return null},$619:function(a,b){if(this.$2dF)this.$18U=new Common.App.AppsForOffice.$W5;this.$18U.$LB("",null,null);this.$Eq.get_$Q().launchInsertDialog(this.$18U.get_$4mo(),a,b)},$4MP:function(){this.$18U.$9M()},$2Fa:function(a){var d=Common.$C.$x().toString(),e=a.assetId,f=a.appVersion,g=a.storeId,h=a.assetStoreId,k=Microsoft.Office.WebExtension.InitializationReason.Inserted,c=a.targetType,i=a.displayName,j={},b=new Common.App.AppsForOfficeCommon.$KS(d,e,f,g,h,j);b.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;b.osfControlType=c;if(!isUndefined(a.isAddinCommands))b.isAddinCommands=a.isAddinCommands;if(!isUndefined(a.addinCommandsActionType))b.addinCommandsActionType=a.addinCommandsActionType;if(b.isAddinCommands){b.ownerAddinStoreType=a.currentStoreType;b.ownerAddinAssetId=a.ownerAddinAssetId}c===OSF.OsfControlType.ContainerLevel&&this.$3eD(b,i);this.$17.$27("OnAppForOfficeActivated",this.$4R8(b))},$8Q:function(b,c,d,e,f){var a='<Button Id="{0}" Command="{1}" Image16by16="{2}" Image16by16Class="{3}" LabelText="{4}"/>';return String.format(a,b,c,d,e,Common.$9.$3O(f))},$3WR:function(){return this.$1Z1.$5AX()},$5ie:function(b){var a=new Common.App.AppsForOfficeCommon.$W4;a.callbackFunc=b;a.storeType=OSF.StoreTypeEnum.MarketPlace;a.fromInsertDialog=false;a.refresh=Common.App.AppsForOfficeCommon.$6g.get_$4().$2u2("refreshRequired")==="true";this.$Eq.get_$Q().queryEntitlementDetails(a)},$5ej:function(c){var b={};b.navigationMode=OSF.OsfNavigationMode.DefaultMode;b.assetId=null;b.category=null;if(!c)return b;var a=c.split("|");Diag.$2.$9(16847763,344,50,"LaunchInsertionDialog with parameters: {0}",JSON.stringify(a));if(a.length<3)return b;if(a[0]&&a[0].length===1)b.navigationMode=parseInt(a[0]);if(a[1]&&a[1].length>0)b.assetId=a[1];if(a[2]&&a[2].length>0)b.category=a[2];return b},$5ek:function(c){if(!c||!c.length)return null;var a=c.split("|");Diag.$2.$9(16847764,344,50,"Insert Agave with parameters: {0}",JSON.stringify(a));if(a.length<6)return null;var b={};b.assetId=a[0];b.appVersion=a[1];b.storeId=a[2];b.assetStoreId=a[3];b.targetType=a[4]?parseInt(a[4]):0;b.displayName=a[5];return b},$4KJ:function(b){var a={};a.assetId=b.assetId;a.id=b.id;a.appVersion=b.appVersion;a.currentStoreType=b.currentStoreType;a.storeId=b.storeId;a.assetStoreId=b.assetStoreId;a.targetType=b.targetType?b.targetType:0;a.displayName=b.displayName;a.isAddinCommands=b.isAddinCommands;return a},$4R8:function(a){return[a.marketplaceID,a.marketplaceVersion,a.store,a.storeType,a.osfControlType]},add_$3k4:function(a){this.$17.$1O("OnAppForOfficeActivated",a)}};Common.App.AppsForOfficeCommon.$Xe=function(a){this.$hR=a};Common.App.AppsForOfficeCommon.$Xe.prototype={$hR:null,$x:function(){return new OSF.ContextActivationManagerBuilder(this.$hR.$3Yd(),this.$hR.$3ZM())}};Common.App.AppsForOfficeCommon.$Xf=function(a,b,c){this.$qb=a;this.$hR=b;this.$2ZP=c};Common.App.AppsForOfficeCommon.$Xf.prototype={$qb:null,$hR:null,$2ZP:null,$x:function(){return this.$qb.setHostInfo(this.$hR.$3Yd()).setLocaleInfo(this.$hR.$3ZM()).setUrlInfo(this.$hR.$5Dl()).setMiscellaneousActivationParameters(this.$hR.$58z()).setHostControlInfo(this.$2ZP).setUserInfo(this.$hR.$5Dp()).construct()}};Common.App.AppsForOfficeCommon.$KS.registerClass("Common.App.AppsForOfficeCommon.$KS");Common.App.AppsForOfficeCommon.$rS.registerClass("Common.App.AppsForOfficeCommon.$rS");Common.App.AppsForOfficeCommon.$W4.registerClass("Common.App.AppsForOfficeCommon.$W4");Common.App.AppsForOfficeCommon.$ag.registerClass("Common.App.AppsForOfficeCommon.$ag");Common.App.AppsForOfficeCommon.$cv.registerClass("Common.App.AppsForOfficeCommon.$cv");Common.App.AppsForOfficeCommon.$im.registerClass("Common.App.AppsForOfficeCommon.$im");Common.App.AppsForOfficeCommon.$M0.registerClass("Common.App.AppsForOfficeCommon.$M0");Common.App.AppsForOfficeCommon.$ip.registerClass("Common.App.AppsForOfficeCommon.$ip");Common.App.AppsForOfficeCommon.$P1.registerClass("Common.App.AppsForOfficeCommon.$P1",null,Common.App.AppsForOfficeCommon.$M6);Common.App.AppsForOfficeCommon.$P0.registerClass("Common.App.AppsForOfficeCommon.$P0");Common.App.AppsForOfficeCommon.$AL.registerClass("Common.App.AppsForOfficeCommon.$AL");Common.App.AppsForOfficeCommon.$Vo.registerClass("Common.App.AppsForOfficeCommon.$Vo");Common.App.AppsForOfficeCommon.$rN.registerClass("Common.App.AppsForOfficeCommon.$rN",null,Common.App.AppsForOfficeCommon.$am);Common.App.AppsForOfficeCommon.$I0.registerClass("Common.App.AppsForOfficeCommon.$I0",null,Common.App.AppsForOfficeCommon.$an);Common.App.AppsForOfficeCommon.$rO.registerClass("Common.App.AppsForOfficeCommon.$rO");Common.App.AppsForOfficeCommon.$rP.registerClass("Common.App.AppsForOfficeCommon.$rP",null,Common.App.AppsForOfficeCommon.$ao);Common.App.AppsForOfficeCommon.$I4.registerClass("Common.App.AppsForOfficeCommon.$I4",null,Common.App.AppsForOfficeCommon.$bT);Common.App.AppsForOfficeCommon.$QW.registerClass("Common.App.AppsForOfficeCommon.$QW");Common.App.AppsForOfficeCommon.$rT.registerClass("Common.App.AppsForOfficeCommon.$rT",null,Common.App.$jx,Common.Utils.$l6);Common.App.AppsForOfficeCommon.$Cm.registerClass("Common.App.AppsForOfficeCommon.$Cm");Common.App.AppsForOfficeCommon.$I5.registerClass("Common.App.AppsForOfficeCommon.$I5",null,Common.App.AppsForOfficeCommon.$R8,Sys.IDisposable);Common.App.AppsForOfficeCommon.$El.registerClass("Common.App.AppsForOfficeCommon.$El");Common.App.AppsForOfficeCommon.$rR.registerClass("Common.App.AppsForOfficeCommon.$rR",null,Sys.IDisposable);Common.App.AppsForOfficeCommon.$9i.registerClass("Common.App.AppsForOfficeCommon.$9i",null,Sys.IDisposable,Common.App.AppsForOfficeCommon.$Ii);Common.App.AppsForOfficeCommon.$Xe.registerClass("Common.App.AppsForOfficeCommon.$Xe",null,Common.App.AppsForOfficeCommon.$RS);Common.App.AppsForOfficeCommon.$Xf.registerClass("Common.App.AppsForOfficeCommon.$Xf",null,Common.App.AppsForOfficeCommon.$RT);Type.registerNamespace("B4Apps");B4Apps.$k1=function(){};B4Apps.$k1.registerInterface("B4Apps.$k1");B4Apps.$qt=function(a,b,c){this.$$d_$3mQ=Function.createDelegate(this,this.$3mQ);this.$8r=new Common.$2y;this.$Dx=a;this.$mt=b;this.$Tn=c};B4Apps.$qt.prototype={$1bY:0,$8r:null,$Dx:null,$mt:null,$Tn:null,add_$1pQ:function(a){!this.$1bY&&this.$Dx.add_$Sg(this.$$d_$3mQ);this.$8r.$1O("SelectionChangedEventKey",a);this.$1bY++},remove_$1pQ:function(a){this.$8r.$2X("SelectionChangedEventKey",a);this.$1bY--;!this.$1bY&&this.$Dx.remove_$Sg(this.$$d_$3mQ)},$2us:function(a){a.val="";var b=this.$Dx.get_$23().$3f();while(b.$$mn()){var c=b.$$cu();a.val+=this.$2EG(c)}if(a.val==="\ufffc")return OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType;a.val=Box4.$y.$pI(a.val,"");return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$2EG:function(g){var b="";if(g){var d=g.$3f();while(d.$$mn()){var a=d.$$cu(),e=a.$j,h=a.$1i,f=h-e,c="";if(Box4.$A.$3D(a.$D)){var i=a.$D;c=i.$55}switch(a.$1t){case 17:b+=c+"\r";break;case 3:if(f>0)b+=c.substr(e,f);break;case 19:b+="\r"}}}return b},$5yO:function(a,b){this.$2KP(3587754593,a,b)},$2KP:function(b,d,c){var a=new Common.$3L;a.$M(Box4.AppProperties.$K.$fA,d);a.$M(Box4.AppProperties.$K.$pR,true);if(this.$mt.$2u(b,1)===32){var e=this;this.$mt.$vj(null,b,2,a,function(a){c(a.$8Y===32?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},null)}else c(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)},$3mQ:function(){this.$8r.$27("SelectionChangedEventKey")}};B4Apps.$qt.registerClass("B4Apps.$qt",null,B4Apps.$k1);Type.registerNamespace("WECX");WECX.$Ah=function(){};WECX.$Ah.registerInterface("WECX.$Ah");WECX.$IN=function(b,c,d,e){this.$y=b;this.$1Ap=c;this.$1v1=d;this.$zI=e;var a=this;this.$hE=new($$sc.$x.$$(OSF.XmlProcessor))(function(){var b=new OSF.XmlProcessor(a.$1Ap,""),d=b.getDocumentElement(),c=null;if(a.$zI===b.getNodeNamespaceURI(d))c=b.getNodePrefix(d);if(!isNullOrUndefined(c))b=new OSF.XmlProcessor(a.$1Ap,"xmlns:"+c+'="'+a.$zI+'"');return b})};WECX.$IN.$4c5=function(a){var b=a.get_$E().$AC.toString(),c=a.$s(String,Box4.AppProperties.$1.$2nj),d=a.$s(Boolean,Box4.AppProperties.$1.$3Me),e=a.$s(String,Box4.AppProperties.$1.$3Mf);return new WECX.$IN(b,c,d,e)};WECX.$IN.prototype={$hE:null,$1Ap:null,$1v1:false,$zI:null,$y:null,$3ti:function(a,b){return this.$hE.get_$Q().selectNodes(a,b)},$59f:function(a){return this.$hE.get_$Q().getNodeXml(a)},$59e:function(a){return this.$hE.get_$Q().getNodeValue(a)},$59Z:function(a){return this.$hE.get_$Q().getNodeBaseName(a)},$59c:function(a){return this.$hE.get_$Q().getNodeNamespaceURI(a)},$59d:function(a){return this.$hE.get_$Q().getNodeType(a)},$3Zb:function(b){var a=this.$hE.get_$Q().getDocumentElement();return b===this.$hE.get_$Q().getNodeNamespaceURI(a)?this.$hE.get_$Q().getNodePrefix(a):null}};WECX.$Y8=function(){};WECX.$Y8.$5Sr=function(){Common.App.$f.get_$4().$3M(new WECX.$Y8)};WECX.$Y8.prototype={get_$5j:function(){return"WordEditor.CustomXml"},$7Y:function(){},$d:function(){},$t9:function(a){var b=this;a.$e(WECX.$Uy).$1p(WECX.$Ah).$p().$n(function(){return new WECX.$Uy(new($$sc.$x.$$(Box4.$CM))(function(){return Box4.App.get_$X().$1L.get_$2v()}))})}};WECX.$Uy=function(a){this.$264=new(Common.Collections.$2d.$$(String,WECX.$IN));this.$IN=a};WECX.$Uy.prototype={$264:null,$IN:null,$3Xd:function(){var a=new Box4.$E;a.$h(this.$IN.get_$Q());Box4.$1P.get_$4().$XM(a);a.$1J(23);isNullOrUndefined(a)&&Common.$0.$o.$1A("WordEditorAppsForOfficeCustomXmlIsEnabled")&&Diag.$2.$9(9187597,366,10,"Custom xml root node doesn't exist");return a},$56z:function(d){var c=null,b=this.$3Xd();if(b){var a=b.$1J(24);while(a){if(a.get_$E().$AC.toString()===d){c=a;break}a=b.$4h(24)}}return c},$3Xc:function(c){var d=c.get_$E().$AC.toString(),e=c.$s(String,Box4.AppProperties.$1.$2nj),a=this.$264.get_$5(d),b;if(!isNullOrUndefined(a)&&a.$1Ap===e)b=a;else{b=WECX.$IN.$4c5(c);this.$264.$F(b.$y,b);!isNullOrUndefined(a)&&a.$1Ap!==e&&Diag.$2.$9(9187598,366,50,"Custom xml id: {0} is out of date",d)}return b},$52k:function(){var c=[],a=this.$3Xd();if(a){var b=a.$1J(24);while(b){var d=this.$3Xc(b);c.push(d);b=a.$4h(24)}}return c},$uP:function(b){var a=this.$56z(b);return a?this.$3Xc(a):null}};WECX.$IN.registerClass("WECX.$IN");WECX.$Y8.registerClass("WECX.$Y8",null,Common.App.$jx,Common.Utils.$l6);WECX.$Uy.registerClass("WECX.$Uy",null,WECX.$Ah);WECX.$Y8.$5Sr();typeof OfficeExtension=="undefined"&&Type.registerNamespace("OfficeExtension");typeof OfficeExtension.WacRuntime=="undefined"&&Type.registerNamespace("OfficeExtension.WacRuntime");if(typeof OfficeExtension.WacRuntime.IAsyncEnumerator=="undefined"){OfficeExtension.WacRuntime.IAsyncEnumerator=function(){};OfficeExtension.WacRuntime.IAsyncEnumerator.prototype={get_current:null,moveNext:null};OfficeExtension.WacRuntime.IAsyncEnumerator.registerInterface("OfficeExtension.WacRuntime.IAsyncEnumerator")}Type.registerNamespace("WordEditor.Extension");WordEditor.Extension.Alignment=function(){};WordEditor.Extension.Alignment.prototype={};WordEditor.Extension.Alignment.registerEnum("WordEditor.Extension.Alignment",false);WordEditor.Extension.$qH=function(){};WordEditor.Extension.$qH.registerInterface("WordEditor.Extension.$qH");WordEditor.Extension.BreakType=function(){};WordEditor.Extension.BreakType.prototype={page:0,column:1,next:2,sectionContinuous:3,sectionEven:4,sectionOdd:5,line:6,lineClearLeft:9,lineClearRight:10,textWrapping:11};WordEditor.Extension.BreakType.registerEnum("WordEditor.Extension.BreakType",false);WordEditor.Extension.ContentControlAppearance=function(){};WordEditor.Extension.ContentControlAppearance.prototype={};WordEditor.Extension.ContentControlAppearance.registerEnum("WordEditor.Extension.ContentControlAppearance",false);WordEditor.Extension.$az=function(){};WordEditor.Extension.$az.registerInterface("WordEditor.Extension.$az");WordEditor.Extension.ContentControlType=function(){};WordEditor.Extension.ContentControlType.prototype={};WordEditor.Extension.ContentControlType.registerEnum("WordEditor.Extension.ContentControlType",false);WordEditor.Extension.$av=function(){};WordEditor.Extension.$av.$$=function(c){var a="$av$"+c.getName().replace(/\./g,"_");if(!WordEditor.Extension[a]){var b=WordEditor.Extension[a]=function(){};b.registerInterface("WordEditor.Extension."+a)}return WordEditor.Extension[a]};WordEditor.Extension.$Io=function(){};WordEditor.Extension.$Io.registerInterface("WordEditor.Extension.$Io");WordEditor.Extension.HeaderFooterType=function(){};WordEditor.Extension.HeaderFooterType.prototype={primary:0,firstPage:1,evenPages:2};WordEditor.Extension.HeaderFooterType.registerEnum("WordEditor.Extension.HeaderFooterType",false);WordEditor.Extension.$FI=function(){};WordEditor.Extension.$FI.registerInterface("WordEditor.Extension.$FI");WordEditor.Extension.$Dp=function(){};WordEditor.Extension.$Dp.registerInterface("WordEditor.Extension.$Dp");WordEditor.Extension.InsertLocation=function(){};WordEditor.Extension.InsertLocation.prototype={before:0,after:1,start:2,end:3,replace:4};WordEditor.Extension.InsertLocation.registerEnum("WordEditor.Extension.InsertLocation",false);WordEditor.Extension.$Cx=function(){};WordEditor.Extension.$Cx.$$=function(c,b){var a="$Cx$"+c.getName().replace(/\./g,"_")+"$"+b.getName().replace(/\./g,"_");if(!WordEditor.Extension[a]){var d=WordEditor.Extension[a]=function(){};d.registerInterface("WordEditor.Extension."+a)}return WordEditor.Extension[a]};WordEditor.Extension.$bQ=function(){};WordEditor.Extension.$bQ.registerInterface("WordEditor.Extension.$bQ");WordEditor.Extension.$c9=function(){};WordEditor.Extension.$c9.registerInterface("WordEditor.Extension.$c9");WordEditor.Extension.$FO=function(){};WordEditor.Extension.$FO.registerInterface("WordEditor.Extension.$FO");WordEditor.Extension.SelectionMode=function(){};WordEditor.Extension.SelectionMode.prototype={};WordEditor.Extension.SelectionMode.registerEnum("WordEditor.Extension.SelectionMode",false);WordEditor.Extension.$Gt=function(){};WordEditor.Extension.$Gt.registerInterface("WordEditor.Extension.$Gt");WordEditor.Extension.UnderlineType=function(){};WordEditor.Extension.UnderlineType.prototype={};WordEditor.Extension.UnderlineType.registerEnum("WordEditor.Extension.UnderlineType",false);WordEditor.Extension.$ql=function(){this.$Rb=false};WordEditor.Extension.$ql.prototype={$Rb:false,$Tc:null,$ab:function(){if(!this.$Rb){this.$Rb=true;this.$Tc=WordEditor.Extension.$63.get_$4().$5B5();WordEditor.Extension.$63.get_$4().$ab(this.$Tc,this)}}};WordEditor.Extension.Body=function(a,j,k,l,m,n,o,p,q,r,b,c,d,e,f,g,h,i){this.$5Df=this.getTypeName;WordEditor.Extension.Body.initializeBase(this);WordEditor.Extension.$B.$1r4(a,"Body");this.$TK=a;this.$1b=j;this.$CX=k;this.$Af=l;this.$HU=m;this.$76=n;this.$D4=o;this.$YP=p;this.$7J=q;this.$K=r;this.$D8=b;this.$Gp=c;this.$64=d;this.$AM=e;this.$8p=f;this.$HY=g;this.$9i=h;this.$BJ=i};WordEditor.Extension.Body.$2th=function(a,c){var b=null;if(a&&a.$3u()){do if(a.get_$A().get_$19()===c){b=a.get_$A();break}while(a.$8j());a.$1M()}return b};WordEditor.Extension.Body.$2u3=function(a,c){var b=null;if(a&&a.$UM()){do if(a.get_$A().get_$19()===c){b=a.get_$A();break}while(a.$L7());a.$1M()}return b};WordEditor.Extension.Body.prototype={$TK:null,$1b:null,$CX:null,$Af:null,$HU:null,$76:null,$D4:null,$YP:null,$7J:null,$K:null,$D8:null,$Gp:null,$64:null,$AM:null,$8p:null,$HY:null,$9i:null,$BJ:null,get_contentControls:function(){var a=this.$X6(true,false);return a.get_$14()<=0?null:this.$8p.$2v4(a.get_$5(0),a.get_$5(a.get_$14()-1),this.$76,this.$1b)},get_font:function(){var a=this.$X6(true,false);return this.$HU.$x(a,this.$1b,0)},get_inlinePictures:function(){var c=new($$sc.$F.$$(Box4.$1r)),d=new($$sc.$F.$$(WordEditor.Extension.InlinePicture)),e=new Box4.$E;e.$h(this.$TK);this.$7J.$eS(e,true,false,c);var g=0,a=c.$$lge();while(a.$$mn()){var h=a.$$cu(),f=new($$sc.$F.$$(Box4.$P));this.$AM.$3Yw(f,h);var b=f.$$lge();while(b.$$mn()){var i=b.$$cu();d.$F(this.$D4.$x(i,this.$1b,g++))}}return new WordEditor.Extension.InlinePictureCollection(d)},get_paragraphs:function(){var b=new($$sc.$F.$$(Box4.$1r)),c=new Box4.$E;c.$h(this.$TK);this.$7J.$eS(c,false,false,b);var e=0,d=new($$sc.$F.$$(WordEditor.Extension.Paragraph)),a=b.$$lge();while(a.$$mn()){var f=a.$$cu();d.$F(this.$CX.$x(f,this.$1b,e++))}return new WordEditor.Extension.ParagraphCollection(d)},get_parentContentControl:function(){var a=this.$X6(true,false);return a.get_$14()<=0?null:this.$8p.$2EN(a.get_$5(0),a.get_$5(a.get_$14()-1),this.$76,this.$1b)},get_style:function(){var a=this.$X6(true,false);return this.$Gp.$2tr(a)},set_style:function(a){var b=this.$X6(true,false);this.$Gp.$2MJ(b,a);return a},get_text:function(){var c="";switch(this.$TK.get_$19()){case 8:case 10:case 36:var a=new($$sc.$F.$$(Box4.$1r)),d=new Box4.$E;d.$h(this.$TK);this.$7J.$eS(d,true,false,a);for(var e=a.get_$14(),b=0;b<e;b++)c+=this.$7J.$1Ur(a.get_$5(b))+WordEditor.Extension.$B.$1mn;break;default:Diag.$2.$9(16814427,369,10,"AppId:{0}, in function Body.Text, Body root graph node must be from one of Document/Section/Headfooter.",this.$1b.$4k);WordEditor.Extension.$B.$Cu()}return c},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},clear:function(){var b=this.$X6(true,false);if(!this.$9i.$1BR(b,3)){Diag.$2.$9(17356294,369,15,"AppId:{0}, Body.Clear is not allowed due to conflict with non-deletable content control.",this.$1b.$4k);WordEditor.Extension.$B.$Cu()}this.$K.$5D(new Box4.$Ch(null),239509079,2,true,null,b.$8V());if(this.$TK.get_$19()===8){var a=Box4.$E.$13(this.$TK),c=new Common.$6N;if(a&&a.$1J(1))while(a.$4h(1))c.$ho(Box4.$P.$x(a.get_$A()));this.$K.$32a(c,239509079,2,true,null,null)}},getHtml:function(){Diag.$2.$9(17433732,369,15,"AppId:{0}, GetHtml in Body class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},getOoxml:function(){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var b=+new Date;this.$1b.$KN.$nW();var a=this,c=function(c,d){var e=a.$X6(true,false);a.$BJ.$1Rs(e,a.$TK,a.$1b,c,d,b)};return OfficeExtension.WacRuntime.Utility.createPromise(c)},insertBreak:function(b,a){if(a!==2&&a!==3){Diag.$2.$9(17179034,369,15,"AppId:{0}, insertLocation of Body.InsertBreak must be Start or End.",this.$1b.$4k);WordEditor.Extension.$B.$8U()}var c=this.$X6(true,false);this.$64.$1lP(c,b,a)},insertContentControl:function(){var a=this.$X6(true,false);if(a.get_$14()<=0){Diag.$2.$9(17148099,369,10,"AppId:{0}, Body should at least contain one paragraph.",this.$1b.$4k);WordEditor.Extension.$B.$Cu();return null}return this.$8p.$1Op(a.get_$5(0),a.get_$5(a.get_$14()-1),this.$76,this.$1b)},insertFileFromBase64:function(){Diag.$2.$9(17389514,369,15,"AppId:{0}, InsertFileFromBase64 in Body class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertHtml:function(){Diag.$2.$9(17389515,369,15,"AppId:{0}, InsertHtml in Body class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertInlinePictureFromBase64:function(g,c){var h=+new Date,b=this.$X6(true,false);if(c!==2&&c!==3){Diag.$2.$9(17433734,369,50,"AppId:{0}, insert inline picture with none supported location in Body class",this.$1b.$4k);WordEditor.Extension.$B.$8U()}if(!b.get_$14()){Diag.$2.$9(17433735,369,10,"AppId:{0}, no paragraph node found in Body",this.$1b.$4k);WordEditor.Extension.$B.$Cu()}this.$64.$t1(b,c,false);var d=null,i=b.get_$5(0),j=b.get_$5(b.get_$14()-1),k=this.$64.$2ES(j.$D),e,f;f=this.$64.$iq(i,k,c,e={val:d}),d=e.val,f;var l=this.$AM.$2Fc(g,d,this.$1b),a=this;return l.then(function(b){WordEditor.Extension.$B.$vM("Body.InsertInlinePictureFromBase64",WordEditor.Extension.$B.$Qn(h),0);a.$1b.$KN.$WU(a.$TK);if(!b){Diag.$2.$9(17433736,369,10,"AppId:{0}, something went wrong when insert iamge into Body.",a.$1b.$4k);WordEditor.Extension.$B.$Cu();return null}else return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(a.$D4.$x(a.$AM.$2Af(b),a.$1b,0))})},insertOoxml:function(e,c){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var f=+new Date,a=new($$sc.$F.$$(Box4.$P));switch(c){case 2:var g=this.$1Ro(true);a.$F(Box4.$P.$40(g,0));break;case 3:var d=this.$1Ro(false);a.$F(Box4.$P.$40(d,this.$7J.$2Y(d)));break;case 4:a=this.$X6(true,false);break;default:Diag.$2.$9(17585563,369,15,"AppId:{0}, invalid insert location for body's insert Ooxml method",this.$1b.$4k);WordEditor.Extension.$B.$8U()}var b=this,h=function(d,g){b.$BJ.$1lY(a,e,c,b.$TK,b.$1b,d,g,f)};return OfficeExtension.WacRuntime.Utility.createPromise(h)},insertParagraph:function(c,a){var b=new($$sc.$F.$$(Box4.$P));switch(a){case 2:a=0;b.$F(Box4.$P.$x(this.$1Ro(true)));break;case 3:a=1;b.$F(Box4.$P.$x(this.$1Ro(false)));break;default:Diag.$2.$9(17319647,369,15,"AppId:{0}, Invalid insert location for Body.InsertPparagraph method.",this.$1b.$4k);WordEditor.Extension.$B.$8U()}return this.$CX.$x(this.$64.$1la(b,c,a),this.$1b,0)},insertText:function(c,a){var b=this.$X6(true,false);this.$64.$t1(b,a,false);return this.$5K0(WordEditor.Extension.$B.$28o(c),a)},search:function(c,b){var a=this,d=function(d){var e=a.$X6(true,false);a.$HY.$iQ(e,c,b,d,a.$1b)};return OfficeExtension.WacRuntime.Utility.createPromise(d)},select:function(a){var b=this.$X6(true,false);this.$D8.$fK(b,a)},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},_OnAccess:function(){WordEditor.Extension.$B.$1X0(this.$TK,"Body");return},getTypeName:function(){return"Microsoft.WordServices.Body"},invokePropertyGet:function(a){switch(a){case 3:return this.get_contentControls();case 5:return this.get_font();case 7:return this.get_inlinePictures();case 2:return this.get_paragraphs();case 4:return this.get_parentContentControl();case 6:return this.get_style();case 8:return this.get_text();case 1:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a,b){switch(a){case 6:this.set_style(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"string"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(b,a){switch(b){case 1011:return this.$28A(a);case 1013:return this.$2DX(a);case 1009:return this.$1lQ(a);case 1007:return this.$2Fd(a);case 1008:return this.$1lV(a);case 1004:return this.$1lW(a);case 1006:return this.$1lb(a);case 1003:return this.$1lc(a);case 1015:return this.$1pO(a);case 1002:return this.$cf(a);case 1001:return this.$19A(a)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokeMethodAsync:function(b,a){switch(b){case 1014:return this.$2Dv(a);case 1010:return this.$1lX(a);case 1005:return this.$1lZ(a);case 1012:return this.$2LS(a)}var c=this.invokeMethod(b,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(c)},$28A:function(){this.clear();return null},$2DX:function(){return this.getHtml()},$2Dv:function(){return this.getOoxml()},$1lQ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");this.insertBreak(b,c);return null},$2Fd:function(){return this.insertContentControl()},$1lV:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertFileFromBase64(b,c)},$1lW:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertHtml(b,c)},$1lX:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertInlinePictureFromBase64(b,c)},$1lZ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertOoxml(b,c)},$1lb:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertParagraph(b,c)},$1lc:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertText(b,c)},$2LS:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"WordEditor.Extension.SearchOptions");return this.search(b,c)},$1pO:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"int");this.select(a);return null},$cf:function(){this._KeepReference();return null},$19A:function(){this._OnAccess();return null},$1Ro:function(d){var a=Box4.$E.$13(this.$TK),b=null;switch(this.$TK.get_$19()){case 8:var c=null;if(d){c=WordEditor.Extension.Body.$2th(a,10);a.$5C(c);b=WordEditor.Extension.Body.$2th(a,23)}else{c=WordEditor.Extension.Body.$2u3(a,10);a.$5C(c);b=WordEditor.Extension.Body.$2u3(a,23)}break;case 10:if(d)b=WordEditor.Extension.Body.$2th(a,23);else b=WordEditor.Extension.Body.$2u3(a,23);break;case 36:b=a.get_$A();break;default:Diag.$2.$9(16814430,369,10,"AppId:{0}, In function Body.GetLowestLayerOffSpringParagraphNode(). Body root graph node must be from one of Document/Section/Headfooter.",this.$1b.$4k);WordEditor.Extension.$B.$Cu()}var e=this.$58l(b,d);return e},$58l:function(c,f){var e=null;if(c&&(c.get_$19()===23||c.get_$19()===36)){var a=Box4.$E.$13(c),d=null,b=null;do{d=a.get_$A();if(f)b=a.$3u();else b=a.$UM();if(d&&b&&d.get_$19()===11&&b.get_$19()===12){e=b;break}}while(a.get_$A()&&a.$UN())}return e},$5K0:function(c,e){var f=false;if(e===2||e===4)f=true;else if(e===3)f=false;var a=this.$1Ro(f);if(a){var d=new($$sc.$F.$$(Box4.$P)),b=null;switch(e){case 2:this.$YP.$6u(Box4.$P.$40(a,0),c);b=Box4.$P.$34(a,0,c.length);d.$F(b);break;case 3:this.$YP.$6u(Box4.$P.$OV(a),c);b=Box4.$P.$34(a,Box4.$A.$2Y(a)-c.length,Box4.$A.$2Y(a));d.$F(b);break;case 4:var i=a.$i,j=i.get_$Cc();this.clear();var g=this.$1Ro(true),h=g.$i;h.get_$5(0).set_$67(j.$1R.$6i(h.get_$5(0)));this.$YP.$6u(Box4.$P.$40(g,0),c);b=Box4.$P.$34(g,0,c.length);d.$F(b);break;default:WordEditor.Extension.$B.$Cu()}return this.$Af.$x(d,this.$1b,0)}return null},$X6:function(e,f){var a=new($$sc.$F.$$(Box4.$1r)),c=new Box4.$E;c.$h(this.$TK);this.$7J.$eS(c,e,f,a);for(var d=new($$sc.$F.$$(Box4.$P)),b=0;b<a.get_$14();b++)d.$F(Box4.$P.$x(a.get_$5(b)));return d}};WordEditor.Extension.$IC=function(g,h,i,j,k,l,m,n,o,p,a,b,c,d,e,f){this.create=this.$x;this.$CX=g;this.$Af=h;this.$HU=i;this.$76=j;this.$D4=k;this.$YP=l;this.$7J=m;this.$K=n;this.$D8=o;this.$Gp=p;this.$64=a;this.$AM=b;this.$8p=c;this.$HY=d;this.$9i=e;this.$BJ=f};WordEditor.Extension.$IC.prototype={$CX:null,$Af:null,$HU:null,$76:null,$D4:null,$YP:null,$7J:null,$K:null,$D8:null,$Gp:null,$64:null,$AM:null,$8p:null,$HY:null,$9i:null,$BJ:null,$x:function(a,b){return new WordEditor.Extension.Body(a,b,this.$CX,this.$Af,this.$HU,this.$76,this.$D4,this.$YP,this.$7J,this.$K,this.$D8,this.$Gp,this.$64,this.$AM,this.$8p,this.$HY,this.$9i,this.$BJ)}};WordEditor.Extension.ContentControl=function(a,g,h,i,j,k,l,m,n,o,b,c,d,e,f){this.$5Df=this.getTypeName;WordEditor.Extension.ContentControl.initializeBase(this);WordEditor.Extension.$B.$bJ(WordEditor.$8O,a,"wacContentControl");this.$B2=a;this.$1b=g;this.$AL=h;this.$76=i;this.$CX=j;this.$Af=k;this.$HU=l;this.$D4=m;this.$D8=n;this.$Gp=o;this.$64=b;this.$8p=c;this.$AM=d;this.$HY=e;this.$BJ=f};WordEditor.Extension.ContentControl.prototype={$B2:null,$1b:null,$AL:null,$76:null,$CX:null,$Af:null,$HU:null,$D4:null,$D8:null,$Gp:null,$64:null,$8p:null,$AM:null,$HY:null,$BJ:null,get_appearance:function(){return this.$B2.get_$4Gb()},set_appearance:function(a){WordEditor.Extension.$B.$FD(this.$1b.$4k,"ContentControl.Appearance","Setter","");return a},get_cannotDelete:function(){return!this.$B2.get_$13H()},set_cannotDelete:function(a){var b=a;b&&this.get_removeWhenEdited()&&WordEditor.Extension.$B.$8U();this.$B2.set_$13H(!a);return a},get_cannotEdit:function(){return!this.$B2.get_$13J()},set_cannotEdit:function(a){this.$B2.set_$13J(!a);return a},get_color:function(){WordEditor.Extension.$B.$FD(this.$1b.$4k,"ContentControl.Color","Getter","");return""},set_color:function(a){WordEditor.Extension.$B.$FD(this.$1b.$4k,"ContentControl.Color","Setter","");return a},get_contentControls:function(){var a=this.$AL.$Ol(this.$B2.get_$2k(),this.$B2.get_$1P(),1,false),b=a.$$lge();while(b.$$mn()){var c=b.$$cu();if(c.get_$E()===this.$B2.get_$E()){a.$73(c);break}}return this.$8p.$2v3(a,this.$76,this.$1b)},get_font:function(){var a=this.$B2.$im(true);return this.$HU.$x(a,this.$1b,0)},get_id:function(){return this.$B2.get_$E()},get_inlinePictures:function(){var c=this.$B2.$im(false),b=new($$sc.$F.$$(WordEditor.Extension.InlinePicture)),a=c.$$lge();while(a.$$mn()){var d=a.$$cu();this.$4cx(b,d)}return new WordEditor.Extension.InlinePictureCollection(b)},get_paragraphs:function(){var b=this.$B2.$im(false),c=new($$sc.$F.$$(WordEditor.Extension.Paragraph));if(b.get_$14()<=0)return null;var d=0,a=b.$$lge();while(a.$$mn()){var e=a.$$cu();c.$F(this.$CX.$x(e.$D,this.$1b,d++))}return new WordEditor.Extension.ParagraphCollection(c)},get_parentContentControl:function(){var a=null,b=this.$B2.get_$1oN();while(a=this.$AL.$SJ(b)){if(this.$8p.$2Fy(a))break;b=a.get_$1oN()}if(!a){WordEditor.Extension.$B.$Cu();return null}return this.$76.$x(a,this.$1b,0)},get_placeholderText:function(){WordEditor.Extension.$B.$FD(this.$1b.$4k,"ContentControl.PlaceholderText","Getter","");return""},set_placeholderText:function(a){WordEditor.Extension.$B.$FD(this.$1b.$4k,"ContentControl.PlaceholderText","Setter","");return a},get_removeWhenEdited:function(){return this.$B2.get_$33W()},set_removeWhenEdited:function(a){var b=a;b&&this.get_cannotDelete()&&WordEditor.Extension.$B.$8U();this.$B2.set_$33W(a);return a},get_style:function(){var a=this.$B2.$im(true);return this.$Gp.$2tr(a)},set_style:function(a){var b=this.$B2.$im(true);this.$Gp.$2MJ(b,a);return a},get_tag:function(){return this.$B2.get_$fg()},set_tag:function(a){WordEditor.Extension.$B.$bJ(String,a,"Tag");this.$B2.set_$fg(a);return a},get_text:function(){return this.$B2.$3bS()},get_title:function(){return this.$B2.get_$6L()},set_title:function(a){WordEditor.Extension.$B.$bJ(String,a,"Title");this.$B2.set_$6L(a);return a},get_type:function(){return 0},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},clear:function(){var a=this.$B2.$Fk();a&&WordEditor.Extension.$B.$Cu()},deleteContentControl:function(b){var a=0;if(b)a=this.$AL.$3qa(this.get_id());else a=this.$AL.$4lh(this.get_id());a&&WordEditor.Extension.$B.$Cu()},getHtml:function(){Diag.$2.$9(17389517,369,15,"AppId:{0}, GetHtml method not implemented in Contentcontrol class",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},getOoxml:function(){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var c=+new Date;this.$1b.$KN.$nW();var b=this.$B2.$im(true),a=this,d=function(d,e){a.$BJ.$1Rs(b,b.get_$5(0).$D,a.$1b,d,e,c)};return OfficeExtension.WacRuntime.Utility.createPromise(d)},insertBreak:function(b,a){if(a===2||a===3)WordEditor.Extension.$B.$FD(this.$1b.$4k,"ContentControl.InsertBreak","",WordEditor.Extension.InsertLocation.toString(a));else if(a===4){Diag.$2.$9(17389518,369,15,"AppId:{0}, insertLocation of ContentControl.InsertBreak shouldn't be Replace, this is not valid argument.",this.$1b.$4k);WordEditor.Extension.$B.$8U()}var c=this.$B2.$im(true);this.$64.$1lP(c,b,a)},insertFileFromBase64:function(){Diag.$2.$9(17389519,369,15,"AppId:{0}, InsertFileFromBase64 in ContentControl class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertHtml:function(){Diag.$2.$9(17389520,369,15,"AppId:{0}, InsertHtml in ContentControl class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertInlinePictureFromBase64:function(){WordEditor.Extension.$B.$FD(this.$1b.$4k,"ContentControl.InsertInlinePictureFromBase64","","");return null},insertOoxml:function(d,a){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var e=+new Date;if(a===2||a===3||a===4){var c=this.$B2.$im(true),b=this,f=function(f,g){b.$BJ.$1lY(c,d,a,c.get_$5(0).$D,b.$1b,f,g,e)};return OfficeExtension.WacRuntime.Utility.createPromise(f)}else{Diag.$2.$9(17585564,369,15,"AppId:{0}, ContentControl.InsertOoxml: undefined location!",this.$1b.$4k);WordEditor.Extension.$B.$8U();return null}},insertParagraph:function(b,a){(a===2||a===3)&&WordEditor.Extension.$B.$FD(this.$1b.$4k,"InsertParagraph","",WordEditor.Extension.InsertLocation.toString(a));var c=this.$B2.$im(true);return this.$CX.$x(this.$64.$1la(c,b,a),this.$1b,0)},insertText:function(a,b){var c=new($$sc.$F.$$(Box4.$P));a=WordEditor.Extension.$B.$28o(a);switch(b){case 2:case 3:WordEditor.Extension.$B.$FD(this.$1b.$4k,"ContentControl.InsertText","",WordEditor.Extension.InsertLocation.toString(b));break;case 4:var d=this.$B2.$3wi(a);d&&WordEditor.Extension.$B.$Cu();var e=Box4.$P.$34(this.$B2.get_$2k().$D,0,a.length);c.$F(e);break;default:WordEditor.Extension.$B.$8U()}return this.$Af.$x(c,this.$1b,0)},search:function(c,b){var a=this,d=function(d){var e=a.$B2.$im(true);a.$HY.$iQ(e,c,b,d,a.$1b)};return OfficeExtension.WacRuntime.Utility.createPromise(d)},select:function(a){var b=this.$B2.$im(true);this.$D8.$fK(b,a)},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},_OnAccess:function(){if(!this.$B2.$5i()){Diag.$2.$9(17155413,369,15,"Should not access invalid contentcontrol object.");WordEditor.Extension.$B.$8U()}return},getTypeName:function(){return"Microsoft.WordServices.ContentControl"},invokePropertyGet:function(a){switch(a){case 7:return this.get_appearance();case 10:return this.get_cannotDelete();case 11:return this.get_cannotEdit();case 8:return this.get_color();case 15:return this.get_contentControls();case 12:return this.get_font();case 1:return this.get_id();case 17:return this.get_inlinePictures();case 14:return this.get_paragraphs();case 16:return this.get_parentContentControl();case 5:return this.get_placeholderText();case 9:return this.get_removeWhenEdited();case 13:return this.get_style();case 4:return this.get_tag();case 18:return this.get_text();case 3:return this.get_title();case 6:return this.get_type();case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(b,a){switch(b){case 7:this.set_appearance(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"));return;case 10:this.set_cannotDelete(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 11:this.set_cannotEdit(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 8:this.set_color(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 5:this.set_placeholderText(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 9:this.set_removeWhenEdited(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 13:this.set_style(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 4:this.set_tag(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 3:this.set_title(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(b,a){switch(b){case 1010:return this.$28A(a);case 1011:return this.$29a(a);case 1013:return this.$2DX(a);case 1008:return this.$1lQ(a);case 1006:return this.$1lV(a);case 1004:return this.$1lW(a);case 1007:return this.$1lb(a);case 1003:return this.$1lc(a);case 1012:return this.$1pO(a);case 1002:return this.$cf(a);case 1001:return this.$19A(a)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokeMethodAsync:function(b,a){switch(b){case 1014:return this.$2Dv(a);case 1009:return this.$1lX(a);case 1005:return this.$1lZ(a);case 1015:return this.$2LS(a)}var c=this.invokeMethod(b,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(c)},$28A:function(){this.clear();return null},$29a:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"boolean");this.deleteContentControl(a);return null},$2DX:function(){return this.getHtml()},$2Dv:function(){return this.getOoxml()},$1lQ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");this.insertBreak(b,c);return null},$1lV:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertFileFromBase64(b,c)},$1lW:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertHtml(b,c)},$1lX:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertInlinePictureFromBase64(b,c)},$1lZ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertOoxml(b,c)},$1lb:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertParagraph(b,c)},$1lc:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertText(b,c)},$2LS:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"WordEditor.Extension.SearchOptions");return this.search(b,c)},$1pO:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"int");this.select(a);return null},$cf:function(){this._KeepReference();return null},$19A:function(){this._OnAccess();return null},$5i:function(){return this.$B2.$5i()},$4cx:function(d,e){var a=new($$sc.$F.$$(Box4.$P));this.$AM.$3Yx(a,e);if(a.get_$14()<=0)return;var b=a.$$lge();while(b.$$mn()){var c=b.$$cu();d.$F(this.$D4.$x(c,this.$1b,0))}}};WordEditor.Extension.ContentControlCollection=function(a){this.$5Df=this.getTypeName;WordEditor.Extension.ContentControlCollection.initializeBase(this);WordEditor.Extension.$B.$1Gv(a,"ContentCollection");this.$qi=a};WordEditor.Extension.ContentControlCollection.prototype={$qi:null,$N:function(){return this.$qi.get_$14()},$43f:function(b){var a=WordEditor.Extension.$B.$1Wz(b);if(a>=0&&a<this.$N())return this.$qi.get_$5(a);else{Diag.$2.$9(17093347,369,10,"The index is out of the ContentControlCollection range.");WordEditor.Extension.$B.$8U();return null}},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},getById:function(c){for(var b=null,a=0;a<this.$qi.get_$14();a++)if(this.$qi.get_$5(a).get_id()===c&&this.$qi.get_$5(a).$5i()){b=this.$qi.get_$5(a);break}return b},getByTag:function(a){var b=this;return this.$3Wl(function(b){return b.get_tag()===a})},getByTitle:function(a){var b=this;return this.$3Wl(function(b){return b.get_title()===a})},getItem:function(a){var b=WordEditor.Extension.$B.$1Wz(a);return this.getById(b)},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},getAsyncEnumerator:function(a,b){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new(WordEditor.Extension.$Dd.$$(WordEditor.Extension.ContentControl))(a,b,this))},getTypeName:function(){return"Microsoft.WordServices.ContentControlCollection"},invokePropertyGet:function(a){switch(a){case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(b,a){switch(b){case 1002:return this.$53l(a);case 1004:return this.$53m(a);case 1003:return this.$53p(a);case 1:return this.$581(a);case 1001:return this.$cf(a)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},$53l:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"int");return this.getById(a)},$53m:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"string");return this.getByTag(a)},$53p:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"string");return this.getByTitle(a)},$581:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"any");return this.getItem(a)},$cf:function(){this._KeepReference();return null},$3Wl:function(d){if(!d)return null;var c=new($$sc.$F.$$(WordEditor.Extension.ContentControl)),b=this.$qi.$$lge();while(b.$$mn()){var a=b.$$cu();d(a)&&a.$5i()&&c.$F(a)}return new WordEditor.Extension.ContentControlCollection(c)}};WordEditor.Extension.$BE=function(a,b,c,d,e,f,g,h,i){this.create=this.$x;this.$HU=a;this.$AL=b;this.$D8=c;this.$Gp=d;this.$64=e;this.$8p=f;this.$AM=g;this.$HY=h;this.$BJ=i};WordEditor.Extension.$BE.prototype={$HU:null,$AL:null,$D8:null,$Gp:null,$64:null,$8p:null,$AM:null,$HY:null,$CX:null,$Af:null,$D4:null,$BJ:null,$27S:function(a,b,c){this.$CX=a;this.$Af=b;this.$D4=c},$x:function(a,b){return new WordEditor.Extension.ContentControl(a,b,this.$AL,this,this.$CX,this.$Af,this.$HU,this.$D4,this.$D8,this.$Gp,this.$64,this.$8p,this.$AM,this.$HY,this.$BJ)}};WordEditor.Extension.$Cs=function(a){this.$AL=a};WordEditor.Extension.$Cs.prototype={$AL:null,$2Fy:function(c){var b=c.get_$19(),a=false;switch(b){case 0:a=true}return a},$52q:function(b,c){var a=this.$AL.$52j();return this.$2v3(a,b,c)},$2v4:function(b,c,d,e){var a=this.$AL.$Ol(b,c,1,false);return this.$2v3(a,d,e)},$2v3:function(d,e,f){if(!d||!e)return null;var b=new($$sc.$F.$$(WordEditor.Extension.ContentControl)),a=d.$$lge();while(a.$$mn()){var c=a.$$cu();this.$2Fy(c)&&b.$F(e.$x(c,f,0))}return new WordEditor.Extension.ContentControlCollection(b)},$2EN:function(e,f,g,h){var b=this.$AL.$Ol(e,f,3,true),c=null;if(b.get_$14()>0)if(this.$2Fy(b.get_$5(0)))c=b.get_$5(0);else{var a=b.get_$5(0),d=a.get_$1oN();while(a=this.$AL.$SJ(d)){if(this.$2Fy(a)){c=a;break}d=a.get_$1oN()}}if(!c){WordEditor.Extension.$B.$Cu();return null}return g.$x(c,h,0)},$1Op:function(g,h,i,e){var a=0,b,c,f=(c=this.$AL.$1Op(g.$D.get_$E(),h.$D.get_$E(),b={val:a}),a=b.val,c);if(!f){var d=this.$AL.$SJ(a);d.set_$19(0);return i.$x(d,e,0)}else{Diag.$2.$9(17148101,369,15,"AppId:{0}, failed to create a new block content control.",e.$4k);WordEditor.Extension.$B.$Cu();return null}},$26V:function(g,h,e){var a=0,b,c,f=(c=this.$AL.$26V(g,b={val:a}),a=b.val,c);if(!f){var d=this.$AL.$SJ(a);d.set_$19(0);return h.$x(d,e,0)}else{Diag.$2.$9(17148102,369,15,"AppId:{0}, failed to create a new inline content control.",e.$4k);WordEditor.Extension.$B.$Cu();return null}}};WordEditor.Extension.Document=function(a,f,g,h,i,j,k,l,m,n,b,c,d,e){this.$$d_$4Hr=Function.createDelegate(this,this.$4Hr);this.$$d_$5mQ=Function.createDelegate(this,this.$5mQ);WordEditor.Extension.$B.$bJ($$sc.$x.$$(Box4.$CM),a,"Document");this.$TX=a;this.$1b=f;this.$gE=g;this.$2gH=h;this.$Af=i;this.$76=j;this.$1y=k;this.$K=l;this.$f=m;this.$h9=n;this.$5q=b;c.add_$31F(this.$$d_$5mQ);this.$2ZC=d;this.$8p=e};WordEditor.Extension.Document.prototype={$TX:null,$1b:null,$gE:null,$2gH:null,$Af:null,$76:null,$1y:null,$K:null,$f:null,$h9:null,$5q:null,$2ZC:null,$8p:null,get_context:function(){return this.$1b},get_body:function(){return this.$gE.$x(this.$2uU(),this.$1b,0)},get_contentControls:function(){return this.$8p.$52q(this.$76,this.$1b)},get_saved:function(){return!this.$2ZC()},get_sections:function(){var c=Box4.$E.$13(this.$2uU()),b=new($$sc.$F.$$(WordEditor.Extension.Section)),d=0,a=this,e=function(c){b.$F(a.$2gH.$x(c,a.$1b,d++));return true};this.$5q.$nh(c,e);return new WordEditor.Extension.SectionCollection(b)},getSelection:function(){var c=new($$sc.$F.$$(Box4.$P)),b=this.$f.get_$23().$3f();while(b.$$mn())for(var e=b.$$cu(),d=e.$8V(),a=0;a<d.length;a++)c.$F(d[a]);return this.$Af.$x(c,this.$1b,0)},save:function(){this.$1b.$KN.$nW();this.$K.$5hJ(null,418644390,2,this.$$d_$4Hr,null)},_GetObjectByReferenceId:function(a){return WordEditor.Extension.$63.get_$4().$3QS(a)},_GetObjectTypeNameByReferenceId:function(a){var b=WordEditor.Extension.$63.get_$4().$3QS(a);return b.$5Df()},_RemoveAllReferences:function(){WordEditor.Extension.$63.get_$4().$4OO();return},_RemoveReference:function(a){WordEditor.Extension.$63.get_$4().$5nT(a);return},getTypeName:function(){return"Microsoft.WordServices.Document"},invokePropertyGet:function(a){switch(a){case 3:return this.get_body();case 4:return this.get_contentControls();case 1:return this.get_saved();case 2:return this.get_sections()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(b,a){switch(b){case 1006:return this.$5C5(a);case 1005:return this.$5rT(a);case 1001:return this.$43g(a);case 1002:return this.$43h(a);case 1004:return this.$43j(a);case 1003:return this.$43k(a)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},$5C5:function(){return this.getSelection()},$5rT:function(){this.save();return null},$43g:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"string");return this._GetObjectByReferenceId(a)},$43h:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"string");return this._GetObjectTypeNameByReferenceId(a)},$43j:function(){this._RemoveAllReferences();return null},$43k:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"string");this._RemoveReference(a);return null},$5mQ:function(){this._RemoveAllReferences()},$4Hr:function(){this.$1b.$KN.$WU(this.$2uU())},$2uU:function(){var a=this.$1y.$7f();a.$h(this.$TX.get_$Q());this.$h9.$XM(a);var b=this.$h9.$3aA(a.get_$A());return b}};WordEditor.Extension.$Dd=function(a,b,c){this.$7d=-1;this.$1Yj=-1;this.get_current=this.get_$Ie;this.moveNext=this.$2j;this.$Ka=c;if(a>0)this.$7d+=a;if(b>0)this.$1Yj=a+b<this.$Ka.$N()?a+b:this.$Ka.$N();else this.$1Yj=this.$Ka.$N()};WordEditor.Extension.$Dd.$$=function(f){var a="$Dd$"+f.getName().replace(/\./g,"_");if(!WordEditor.Extension[a]){var c=WordEditor.Extension[a]=function(){for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];WordEditor.Extension.$Dd.apply(this,b)};c.registerClass("WordEditor.Extension."+a,null,OfficeExtension.WacRuntime.IAsyncEnumerator);var g={"WordEditor.Extension.$Dd":{T:f}};c.prototype.$$gta=g;var d=WordEditor.Extension.$Dd.prototype;for(var e in d){var b={key:e,value:d[e]};if("constructor"!==b.key)c.prototype[b.key]=b.value}}return WordEditor.Extension[a]};WordEditor.Extension.$Dd.prototype={$Ka:null,get_$Ie:function(){return this.$7d<this.$1Yj?this.$Ka.$43f(this.$7d):null},$2j:function(){var a=this.$66g();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(a)},$66g:function(){this.$7d++;return this.$7d<this.$1Yj?true:false}};WordEditor.Extension.$ZC=function(a,b,c,d,e,f,g){WordEditor.Extension.$ZC.initializeBase(this,[e,a,null,b,c,null,null,d,f]);this.$1KA=g};WordEditor.Extension.$ZC.prototype={$1KA:null,$5Xa:function(){this.$1Q=0;this.$ZP=this.$hH.$32S(this.$RV.get_$2b())},$4MV:function(){if(!this.$1KA.get_$5(this.$Gm)){this.$1PH(true);this.$1Q=2;this.set_$tb(true);return true}return false},$5dB:function(){this.$2vb(this.$1KA.get_$5(this.$Gm).$D,0);this.$Gm++},$1PH:function(){this.$Gm=0;this.$ZP=""},$3F8:function(b,a){this.$5V.$3FO(a)},$4QE:function(){return this.$Gm<this.$1KA.get_$14()},$5XG:function(){if(this.$Gm>=this.$1KA.get_$14()){this.$Gm=0;this.$1Q=2;this.set_$tb(true)}},$5q7:function(){var a=this.$hH.$1oP(this.$ZP);try{this.$kN=this.$185.$2E7(a.join("|"),this.$RV)}catch(b){Diag.$2.$9(17339148,313,10,"ExtensionFindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.$RV.get_$Ow(),this.$RV.get_$Uf());this.$kN=null;this.$1Q=2;this.set_$tb(true)}return false}};WordEditor.Extension.$LP=function(a,b,c,d){this.$hH=a;this.$6N=b;this.$185=c;this.$1LO=d};WordEditor.Extension.$LP.prototype={$hH:null,$6N:null,$185:null,$1LO:null,$x:function(a,b,c){return new WordEditor.Extension.$ZC(this.$hH,this.$6N,this.$1LO,this.$185,a,b,c)}};WordEditor.Extension.$ZD=function(a){WordEditor.Extension.$ZD.initializeBase(this);this.$gd=a};WordEditor.Extension.$ZD.prototype={$gd:null,$3FO:function(a){this.$gd&&this.$gd.$1CM(0,a)}};WordEditor.Extension.$ZE=function(b,a,c,d){WordEditor.Extension.$ZE.initializeBase(this);if(a&&a.get_$14()>0){this.$1d5=this.$59b(a);this.$mJ=c;this.$Po=new($$sc.$F.$$(WordEditor.Extension.Range))}this.$Af=b;this.$2fY=d};WordEditor.Extension.$ZE.prototype={$Af:null,$1d5:null,$mJ:null,$Po:null,$2fY:null,$1CM:function(f,b){if(!f&&b.length>0)for(var a=0;a<b.length;a++){var e=new($$sc.$F.$$(Box4.$P)),d=b[a].get_$7g();if(this.$1d5.$30(d)){var c=this.$1d5.get_$5(d);(c.$1t===17||c.$1t===3&&b[a].get_$5g()>=c.$j&&b[a].get_$1P()<=c.$1i)&&this.$4gP(e,d,b[a])}}},$4gP:function(a,c,b){a.$F(Box4.$P.$34(this.$1d5.get_$5(c).$D,b.get_$5g(),b.get_$1P()));this.$Po.$F(this.$Af.$x(a,this.$2fY,this.$Po.get_$14()))},$2pq:function(){this.$mJ(this.$4Lb())},$4Lb:function(){return new WordEditor.Extension.SearchResultCollection(this.$Po)},$59b:function(d){var b=new(Common.Collections.$2d.$$(Common.$C,Box4.$P)),a=d.$$lge();while(a.$$mn()){var c=a.$$cu();b.$F(c.$D.get_$E(),c)}return b}};WordEditor.Extension.$IV=function(){};WordEditor.Extension.$IV.prototype={$Af:null,$27S:function(a){this.$Af=a},$x:function(a,b,c){return new WordEditor.Extension.$ZE(this.$Af,a,b,c)}};WordEditor.Extension.$ZG=function(){};WordEditor.Extension.$ZG.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.Extension.$ZG)};WordEditor.Extension.$ZG.prototype={get_$5j:function(){return"WordEditor.Extension"},$7Y:function(){var a=Common.Utils.$8.get_$4(),e=a.$J(WordEditor.Extension.$BE),f=a.$J(WordEditor.Extension.$IV),d=a.$J(WordEditor.Extension.$FM),c=a.$J(WordEditor.Extension.$HD),b=a.$J(WordEditor.Extension.$HI);e.$27S(c,b,d);d.$27S(c,b);f.$27S(b);c.$27S(b)},$d:function(){},$t9:function(a){var b=this;a.$e(WordEditor.Extension.$LP).$p().$n(function(){return new WordEditor.Extension.$LP(Common.Search.$9e.get_$4(),new B4S.$WO,Common.Search.$50.get_$4(),new($$sc.$x.$$(Common.$E0))(function(){return Common.$0.get_$2e()}))});var c=this;a.$e(WordEditor.Extension.$IV).$p().$n(function(){return new WordEditor.Extension.$IV});var d=this;a.$e(WordEditor.Extension.$Fm).$p().$1p(WordEditor.Extension.$c9).$n(function(){return new WordEditor.Extension.$Fm(Common.Search.$EI.$2nK,a.$J(WordEditor.Extension.$LP),a.$J(WordEditor.Extension.$IV))});var e=this;a.$e(WordEditor.Extension.$Cs).$p().$1p(WordEditor.Extension.$az).$n(function(){return new WordEditor.Extension.$Cs(a.$J(WordEditor.$Gh))});var f=this;a.$e(WordEditor.Extension.$LQ).$p().$n(function(){return new WordEditor.Extension.$LQ(Common.Utils.$8.get_$4().$J(WordEditor.$8Q),Common.$0.get_$2e())});var g=this;a.$e(WordEditor.Extension.$Rx).$1p(WordEditor.Extension.$FI).$p().$n(function(){return new WordEditor.Extension.$Rx(a.$J(Box4.$Ke),a.$J(Box4.$Mb),a.$J(Box4.$Dz),new($$sc.$x.$$(Box4.$CM))(function(){return Box4.App.get_$X().$1L.get_$2v()}),Box4.$1P.get_$4(),a.$J(WordEditor.Extension.$LQ))});var h=this;a.$e(WordEditor.Extension.$U3).$p().$1p(WordEditor.Extension.$FO).$n(function(){return new WordEditor.Extension.$U3(Box4.$h.get_$4(),Box4.App.get_$X())});var i=this;a.$e(WordEditor.Extension.$UL).$p().$1p(WordEditor.Extension.$Gt).$n(function(){return new WordEditor.Extension.$UL(a.$J(Box4.$So),Common.$0.get_$r(),a.$J(Box4.$Dz),a.$J(WordEditor.$CJ))});var j=this;a.$e(WordEditor.Extension.$S2).$p().$1p(WordEditor.Extension.$Dp).$n(function(){return new WordEditor.Extension.$S2(Common.$0.get_$r(),a.$J(Box4.$4r),a.$J(Box4.$5P),a.$J(Box4.$Dz),a.$J(WordEditor.$CJ))});var k=this;a.$e(WordEditor.Extension.$IX).$p().$1p(WordEditor.Extension.$Io).$n(function(){return new WordEditor.Extension.$IX(a.$J(WordEditor.$Mj),a.$J(WordEditor.Extension.$Dp))});var l=this;a.$e(WordEditor.Extension.$FM).$1p(WordEditor.Extension.$Cx.$$(WordEditor.Extension.InlinePicture,Box4.$P)).$p().$n(function(){return new WordEditor.Extension.$FM(a.$J(WordEditor.Extension.$BE),a.$J(Box4.$Rr),a.$J(Box4.$RD),Common.$1S.$32L,Common.$1S.$5V4,a.$J(WordEditor.Extension.$FI),a.$J(WordEditor.Extension.$Cs),a.$J(WordEditor.Extension.$FO),a.$J(WordEditor.Extension.$Dp),a.$J(WordEditor.$CJ),a.$J(WordEditor.Extension.$Io))});var m=this;a.$e(WordEditor.Extension.$F6).$1p(WordEditor.Extension.$Cx.$$(WordEditor.Extension.Font,$$sc.$F.$$(Box4.$P))).$p().$n(function(){return new WordEditor.Extension.$F6(Common.$0.get_$r(),a.$J(WordEditor.$CJ),Box4.$h.get_$4(),Box4.$54.get_$4(),new($$sc.$x.$$(Box4.$cQ))(function(){return Box4.App.get_$X().$1L.$3o}))});var n=this;a.$e(WordEditor.Extension.$HD).$1p(WordEditor.Extension.$Cx.$$(WordEditor.Extension.Paragraph,Box4.$1r)).$p().$n(function(){return new WordEditor.Extension.$HD(a.$J(WordEditor.Extension.$F6),a.$J(WordEditor.Extension.$FM),a.$J(WordEditor.Extension.$BE),a.$J(Box4.$Dz),a.$J(Box4.$79),Common.$0.get_$r(),Box4.$h.get_$4(),a.$J(WordEditor.Extension.$FO),a.$J(WordEditor.Extension.$Gt),a.$J(WordEditor.Extension.$Dp),a.$J(WordEditor.Extension.$FI),a.$J(WordEditor.Extension.$Cs),a.$J(WordEditor.Extension.$Fm),a.$J(WordEditor.$CJ),a.$J(WordEditor.Extension.$IX))});var o=this;a.$e(WordEditor.Extension.$BE).$1p(WordEditor.Extension.$Cx.$$(WordEditor.Extension.ContentControl,WordEditor.$8O)).$p().$n(function(){return new WordEditor.Extension.$BE(a.$J(WordEditor.Extension.$F6),a.$J(WordEditor.$Gh),a.$J(WordEditor.Extension.$FO),a.$J(WordEditor.Extension.$Gt),a.$J(WordEditor.Extension.$Dp),a.$J(WordEditor.Extension.$Cs),a.$J(WordEditor.Extension.$FI),a.$J(WordEditor.Extension.$Fm),a.$J(WordEditor.Extension.$Io))});var p=this;a.$e(WordEditor.Extension.$HI).$1p(WordEditor.Extension.$Cx.$$(WordEditor.Extension.Range,$$sc.$F.$$(Box4.$P))).$p().$n(function(){return new WordEditor.Extension.$HI(a.$J(WordEditor.Extension.$HD),a.$J(WordEditor.Extension.$FM),a.$J(WordEditor.Extension.$BE),a.$J(WordEditor.Extension.$F6),a.$J(Box4.$Dz),Common.$0.get_$r(),a.$J(WordEditor.Extension.$FO),a.$J(WordEditor.Extension.$Gt),a.$J(WordEditor.Extension.$Dp),a.$J(WordEditor.Extension.$FI),a.$J(WordEditor.Extension.$Cs),a.$J(WordEditor.Extension.$Fm),a.$J(WordEditor.$CJ),a.$J(WordEditor.Extension.$IX))});var q=this;a.$e(WordEditor.Extension.$IC).$1p(WordEditor.Extension.$Cx.$$(WordEditor.Extension.Body,Box4.$1r)).$p().$n(function(){return new WordEditor.Extension.$IC(a.$J(WordEditor.Extension.$HD),a.$J(WordEditor.Extension.$HI),a.$J(WordEditor.Extension.$F6),a.$J(WordEditor.Extension.$BE),a.$J(WordEditor.Extension.$FM),a.$J(Box4.$4r),a.$J(Box4.$Dz),Common.$0.get_$r(),a.$J(WordEditor.Extension.$FO),a.$J(WordEditor.Extension.$Gt),a.$J(WordEditor.Extension.$Dp),a.$J(WordEditor.Extension.$FI),a.$J(WordEditor.Extension.$Cs),a.$J(WordEditor.Extension.$Fm),a.$J(WordEditor.$CJ),a.$J(WordEditor.Extension.$Io))});var r=this;a.$e(WordEditor.Extension.$O4).$1p(WordEditor.Extension.$Cx.$$(WordEditor.Extension.Section,Box4.$1r)).$p().$n(function(){return new WordEditor.Extension.$O4(a.$J(WordEditor.Extension.$IC),a.$J(WordEditor.HeaderFooter.$FC),a.$J(WordEditor.HeaderFooter.$8w))});var s=this;a.$e(WordEditor.Extension.$Ls).$1p(WordEditor.Extension.$bQ).$n(function(){return new WordEditor.Extension.$Ls(new Box4.$5X)});var t=this;a.$e(WordEditor.Extension.$Nl).$p().$n(function(){return new WordEditor.Extension.$Nl(a.$J(WordEditor.Extension.$Ls))});var u=this;a.$e(WordEditor.Extension.Document).$p().$n(function(){return new WordEditor.Extension.Document(new($$sc.$x.$$(Box4.$CM))(function(){return Box4.App.get_$X().$1L.get_$2v()}),a.$J(WordEditor.Extension.$Nl),a.$J(WordEditor.Extension.$IC),a.$J(WordEditor.Extension.$O4),a.$J(WordEditor.Extension.$HI),a.$J(WordEditor.Extension.$BE),new Box4.$4A,Common.$0.get_$r(),Box4.$h.get_$4(),Box4.$1P.get_$4(),Box4.$2F.get_$4(),a.$J(Common.App.AppsForOfficeCommon.$Ii),Box4.App.$j2,a.$J(WordEditor.Extension.$Cs))})}};WordEditor.Extension.$IX=function(a,b){this.$zR=a;this.$64=b};WordEditor.Extension.$IX.prototype={$zR:null,$64:null,$170:null,$1b:null,$mJ:null,$zz:null,$PQ:0,$1Rs:function(c,d,e,f,g,h){this.$3dw(d,e,f,g,h);var b=this,a=this;this.$zR.$1Rs(c.$8V(),function(a){b.$mJ(a);b.$1b.$KN.$WU(b.$170);WordEditor.Extension.$B.$vM("Succeeded in FileApiOperations.GetOoxml",WordEditor.Extension.$B.$Qn(b.$PQ),0)},function(b){Diag.$2.$9(17568003,369,10,"AppId:{0}, {1}",a.$1b.$4k,WordEditor.$3d.toString(b));a.$zz(WordEditor.$3d.toString(b));a.$1b.$KN.$WU(a.$170);WordEditor.Extension.$B.$vM("Failed in FileApiOperations.GetOoxml",WordEditor.Extension.$B.$Qn(a.$PQ),0)})},$1lY:function(a,i,j,k,l,m,n,o){if(!a.get_$14()){Diag.$2.$9(17585565,369,10,"AppId:{0}, the gncList is empty when try to insert ooxml.",this.$1b.$4k);WordEditor.Extension.$B.$Cu()}this.$3dw(k,l,m,n,o);this.$1b.$KN.$nW();var b=new($$sc.$F.$$(Box4.$P)),f=a.get_$5(0),g=a.get_$5(a.get_$14()-1),c=null,d,e,h=(e=this.$64.$iq(f,g,j,d={val:c}),c=d.val,e);if(h===12)b=a;else b.$F(c);this.$36T(b,i)},$3dw:function(a,b,c,d,e){if(a.get_$19()===8||a.get_$19()===10)this.$170=a;else this.$170=this.$59r(a);this.$1b=b;this.$mJ=c;this.$zz=d;this.$PQ=e},$36T:function(d,c){var b=this,a=this;this.$zR.$36T(d.$8V(),c,function(){b.$mJ(null);b.$1b.$KN.$WU(b.$170);WordEditor.Extension.$B.$vM("Succeeded in FileApiOperations.SetOoxml",WordEditor.Extension.$B.$Qn(b.$PQ),c.length)},function(b){Diag.$2.$9(17585566,369,10,"AppId:{0}, {1}",a.$1b.$4k,WordEditor.$3d.toString(b));a.$zz(WordEditor.$3d.toString(b));a.$1b.$KN.$WU(a.$170);WordEditor.Extension.$B.$vM("Failed in FileApiOperations.SetOoxml",WordEditor.Extension.$B.$Qn(a.$PQ),c.length)})},$59r:function(c){var a=new Box4.$E;a.$h(c);var b=null;if(a.$1X(10))b=a.$Gc(10);return b}};WordEditor.Extension.Font=function(a,b,c,d,e,f,g){this.$5Df=this.getTypeName;WordEditor.Extension.Font.initializeBase(this);WordEditor.Extension.$B.$1Gv(a,"Font");this.$6F=a;this.$1b=b;this.$K=c;this.$9i=d;this.$f=e;this.$sH=f;this.$51=g;this.$1KH=null};WordEditor.Extension.Font.prototype={$6F:null,$1b:null,$K:null,$9i:null,$f:null,$sH:null,$51:null,$1KH:null,get_bold:function(){return this.$o7().$EK===1},set_bold:function(a){this.$1pm(4143129361,a);return a},get_color:function(){var a=this.$o7().$8i;if(a===4278190080||a===4294967295)a=0;return Box4.$2B.$Gs(a).toUpperCase()},set_color:function(a){var b=this.$42v(a,"Font.Color");this.$36D(3335712742,b);return a},get_doubleStrikeThrough:function(){WordEditor.Extension.$B.$FD(this.$1b.$4k,"Font.DoubleStrikeThrough","Getter","");return false},set_doubleStrikeThrough:function(a){WordEditor.Extension.$B.$FD(this.$1b.$4k,"Font.DoubleStrikeThrough","Setter","");return a},get_highlightColor:function(){var a=this.$o7().$G8;if(a===4294967295)a=0;return Box4.$2B.$Gs(a).toUpperCase()},set_highlightColor:function(a){var b=this.$42v(a,"Font.HighlightColor");this.$36D(501764938,b);return a},get_italic:function(){return this.$o7().$Ee===1},set_italic:function(a){this.$1pm(1765151450,a);return a},get_name:function(){var a=this.$o7().$8t;if(!a)a="";return a},set_name:function(a){WordEditor.Extension.$B.$42z(a,"Font.Name");this.$36D(3430668515,a);return a},get_size:function(){var a=this.$o7().$5u;if(a===-1)a=0;return a/2},set_size:function(a){WordEditor.Extension.$B.$15e(a,"Font.Size");this.$5wT(2240119678,a*2);return a},get_strikeThrough:function(){return this.$o7().$FB===1},set_strikeThrough:function(a){this.$1pm(4169095173,a);return a},get_subscript:function(){return this.$o7().$CM===1},set_subscript:function(a){this.$1pm(1455408143,a);return a},get_superscript:function(){return this.$o7().$Cs===1},set_superscript:function(a){this.$1pm(1107614,a);return a},get_underline:function(){return this.$o7().$KD===1?1:0},set_underline:function(a){this.$5wU(1863297734,a);return a},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},_OnAccess:function(){var a=this.$6F.$$lge();while(a.$$mn()){var b=a.$$cu();WordEditor.Extension.$B.$1X0(b.$D,"Font")}return},getTypeName:function(){return"Microsoft.WordServices.Font"},invokePropertyGet:function(a){switch(a){case 4:return this.get_bold();case 6:return this.get_color();case 11:return this.get_doubleStrikeThrough();case 12:return this.get_highlightColor();case 5:return this.get_italic();case 2:return this.get_name();case 3:return this.get_size();case 10:return this.get_strikeThrough();case 8:return this.get_subscript();case 9:return this.get_superscript();case 7:return this.get_underline();case 1:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(b,a){switch(b){case 4:this.set_bold(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 6:this.set_color(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 11:this.set_doubleStrikeThrough(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 12:this.set_highlightColor(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 5:this.set_italic(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 2:this.set_name(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 3:this.set_size(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 10:this.set_strikeThrough(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 8:this.set_subscript(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 9:this.set_superscript(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 7:this.set_underline(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(a,b){switch(a){case 1002:return this.$cf(b);case 1001:return this.$19A(b)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},$cf:function(){this._KeepReference();return null},$19A:function(){this._OnAccess();return null},$5wU:function(b,c){var a=c===1?new Box4.$DD(1):new Box4.$DD(0);this.$2MI(b,a)},$1pm:function(b,c){var a=c?new Box4.$DD(1):new Box4.$DD(0);this.$2MI(b,a)},$5wT:function(b,c){var a=c;this.$2MI(b,a)},$36D:function(b,c){var a=c;this.$2MI(b,a)},$2MI:function(c,d){if(!this.$9i.$1BR(this.$6F,0))return;for(var b=new Common.$6N,a=0;a<this.$6F.get_$14();a++)b.$ho(this.$6F.get_$5(a));var e=this.$K.$32a(b,c,2,true,new Common.$EN,d)},$o7:function(){if(!this.$1KH){var a=this.$sH.$11R(),b=new Box4.$4S(this.$6F.$8V(),true);this.$f.$2s(b,null,false,false);if(!this.$51.get_$Q()){Diag.$2.$9(17580932,369,10,"In function Font.GetFormattingData. The view is null since it fails to be resolved.");WordEditor.Extension.$B.$Cu()}var c=new Box4.$Ch(this.$51.get_$Q());this.$1KH=new Box4.$F7;this.$K.$5D(c,1163290417,2,true,new Common.$EN,this.$1KH);a.$ax(false,null,null)}return this.$1KH},$42v:function(c,g){WordEditor.Extension.$B.$42z(c,g);var f=Box3.$3p.$1hM(c),a=f!==""?f:c;if(a.charAt(0)!=="#")a="#"+a;var d=false;if(a.length<7)d=true;else for(var e=1;e<7;e++){var b=a.charAt(e);if(!(b>="0"&&b<="9"||b>="A"&&b<="F"||b>="a"&&b<="f")){d=true;break}}if(d){Diag.$2.$9(17401760,369,15,"AppId:{0}, Set {1} with not supported argument: {2}.",this.$1b.$4k,g,c);throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);}return this.$5gw(a)},$5gw:function(a){return a.substring(5,7)+a.substring(3,5)+a.substring(1,3)}};WordEditor.Extension.$F6=function(a,b,c,d,e){this.create=this.$x;this.$K=a;this.$9i=b;this.$f=c;this.$sH=d;this.$51=e};WordEditor.Extension.$F6.prototype={$K:null,$9i:null,$f:null,$sH:null,$51:null,$x:function(a,b){return new WordEditor.Extension.Font(a,b,this.$K,this.$9i,this.$f,this.$sH,this.$51)}};WordEditor.Extension.$Rx=function(a,b,c,d,e,f){this.$YN=a;this.$Yw=b;this.$7J=c;this.$TX=d;this.$h9=e;this.$2XX=f};WordEditor.Extension.$Rx.prototype={$YN:null,$Yw:null,$7J:null,$TX:null,$h9:null,$2XX:null,$3Yw:function(c,a){WordEditor.Extension.$B.$1r4(a,"GraphNode");var b=this.$YN.$2t0(a,5);if(b.length<=0)return;this.$3Yv(b,a,c)},$3Yx:function(c,a){WordEditor.Extension.$B.$bJ(Box4.$P,a,"GraphNodeContext");var b=this.$YN.$2sz(a,5);if(b.length<=0)return;this.$3Yv(b,a.$D,c)},$3Yv:function(b,c,g){for(var a=0;a<b.length;a++){var d=this.$YN.$EW(c,b[a]),e=d.$l.$R(String,Box4.AppProperties.$K.$136,"");if(this.$Yw.$1E9(e)){var f=Box4.$P.$34(c,b[a],b[a]+1);g.$F(f)}}},$2Fc:function(a,c,d){WordEditor.Extension.$B.$bJ(String,a,"imgBase64Str");a=a.trim();var b=this,e=function(j,f){var k=c.$D,g=new Box4.$E;g.$h(k);var h=b.$2XX.$x(g,j,f),e=document.createElement("img"),l=function(){var a=new Box3.$Is(e.src,e.alt,e.width,e.height,null,0,0,null,null);b.$3Pi(h,a,c,d)},m=function(){f("")},i=false;i=e.onload!==undefined&&e.onerror!==undefined;if(i){e.onload=l;e.onerror=m;e.src=String.format("data:image/png;base64,{0}",a)}else b.$3Pi(h,b.$57e(a),c,d)};return OfficeExtension.WacRuntime.Utility.createPromise(e)},$57e:function(b){var a=document.createElement("img");a.src=String.format("data:image/{0};base64,{1}","png",b);return new Box3.$Is(a.src,a.alt,a.width,a.height,null,0,0,null,null)},$3QO:function(c,d){if(!d)return-1;var a=this.$YN.$2sz(Box4.$P.$x(c),5);if(a.length>0)for(var b=0;b<a.length;b++){var e=this.$YN.$EW(c,a[b]);if(d.$E===e.$E)return a[b]}return-1},$4sN:function(b,c,d){var a=this.$3QO(b,c);if(a<0){a=this.$4sO(c,d);if(a<0)return-1}else d.val=b;return a},$4sO:function(f,d){var e=this.$570(),a=-1,b=e.$$lge();while(b.$$mn()){var c=b.$$cu();a=this.$3QO(c,f);if(a!==-1){d.val=c;return a}}d.val=null;return-1},$2Af:function(g){var f=+new Date,e=g,a=null,c,d,b=(d=this.$4sN(e.$3L,e.$8N,c={val:a}),a=c.val,d);WordEditor.Extension.$B.$vM("ImageApiOperations.FindImageContextFromResult",WordEditor.Extension.$B.$Qn(f),0);if(b<0){Diag.$2.$9(17433739,369,10,"the inserted inline picture can't be found");WordEditor.Extension.$B.$Cu();return null}return Box4.$P.$34(a,b,b+1)},$570:function(){var a=new Box4.$E;a.$h(this.$TX.get_$Q());this.$h9.$XM(a);var d=this.$h9.$3aA(a.get_$A()),b=new($$sc.$F.$$(Box4.$1r)),c=new Box4.$E;c.$h(d);this.$7J.$eS(c,true,true,b);return b},$3Pi:function(a,b,c,d){a.$5Zz(b,c);d.$KN.$nW();a.$3m1()}};WordEditor.Extension.$ZF=function(a,b,c,d,e){WordEditor.Extension.$ZF.initializeBase(this,[a,b,c]);this.$mJ=d;this.$zz=e};WordEditor.Extension.$ZF.prototype={$mJ:null,$zz:null,$4M7:function(){this.$zz(null)},$4M8:function(){this.$mJ(this.$D7.get_$5(0))},$4M9:function(){this.$zz(null)}};WordEditor.Extension.$LQ=function(a,b){this.$63=a;this.$25=b};WordEditor.Extension.$LQ.prototype={$63:null,$25:null,$x:function(a,b,c){return new WordEditor.Extension.$ZF(a,this.$63,this.$25,b,c)}};WordEditor.Extension.InlinePicture=function(a,i,j,k,l,m,n,o,p,q,b,c,d,e,f,g,h){this.$5Df=this.getTypeName;WordEditor.Extension.InlinePicture.initializeBase(this);WordEditor.Extension.$B.$bJ(Box4.$P,a,"GraphNodeContext");this.$IK=a;this.$1b=i;this.$y=j;this.$CX=k;this.$Af=l;this.$76=m;this.$D4=n;this.$Yw=o;this.$YN=p;this.$Yt=this.$57X(this.$IK);this.$19W=q;this.$190=b;this.$AM=c;this.$8p=d;this.$D8=e;this.$64=f;this.$9i=g;this.$BJ=h};WordEditor.Extension.InlinePicture.prototype={$IK:null,$1b:null,$y:0,$CX:null,$Af:null,$76:null,$D4:null,$Yw:null,$YN:null,$Yt:null,$19W:null,$190:null,$AM:null,$8p:null,$D8:null,$64:null,$9i:null,$BJ:null,get_altTextDescription:function(){return this.$Yw.$1kZ(this.$Yt.$l)},set_altTextDescription:function(a){WordEditor.Extension.$B.$bJ(String,a,"altTextDescription");this.$Yt.$l.$M(Box4.AppProperties.$1.$135,a);return a},get_altTextTitle:function(){return this.$Yw.$1DN(this.$Yt.$l)},set_altTextTitle:function(a){WordEditor.Extension.$B.$bJ(String,a,"altTextTitle");this.$Yt.$l.$M(Box4.AppProperties.$5.$oM,a);return a},get_height:function(){var a=this.$Yw.$1DO(this.$Yt.$l);return this.$190(a)},set_height:function(a){WordEditor.Extension.$B.$bJ(Number,a,"height");WordEditor.Extension.$B.$15e(a,"InlinePicture.Height");var b=this.$19W(a);this.$Yt.$l.$M(Box4.AppProperties.$5.$vF,b);return a},get_hyperlink:function(){return this.$Yw.$1kX(this.$Yt.$l)},set_hyperlink:function(a){WordEditor.Extension.$B.$bJ(String,a,"hyperLink");this.$Yt.$l.$M(Box4.AppProperties.$5.$2wU,a);return a},get_lockAspectRatio:function(){WordEditor.Extension.$B.$FD(this.$1b.$4k,"InlinePicture.LockAspectRatio","Getter","");return false},set_lockAspectRatio:function(a){WordEditor.Extension.$B.$FD(this.$1b.$4k,"InlinePicture.LockAspectRatio","Setter","");return a},get_paragraph:function(){return this.$CX.$x(this.$IK.$D,this.$1b,0)},get_parentContentControl:function(){return this.$8p.$2EN(this.$IK,this.$IK,this.$76,this.$1b)},get_width:function(){var a=this.$Yw.$12j(this.$Yt.$l);return this.$190(a)},set_width:function(a){WordEditor.Extension.$B.$bJ(Number,a,"width");WordEditor.Extension.$B.$15e(a,"InlinePicture.Width");var b=this.$19W(a);this.$Yt.$l.$M(Box4.AppProperties.$5.$ac,b);return a},get__Id:function(){return this.$y},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},deleteInlinePicture:function(){var c=new($$sc.$F.$$(Box4.$P));c.$F(this.$IK);if(!this.$9i.$1BR(c,3)){Diag.$2.$9(17356295,369,15,"AppId:{0}, InlinePicture.DeleteInlinePicture is not allowed due to conflict with non-deletable content control.",this.$1b.$4k);WordEditor.Extension.$B.$Cu()}for(var b=this.$IK.$D,a=0;a<b.$i.get_$N();a++){var d=b.$i.get_$5(a);if(d.$1K===this.$IK.$j){b.$i.$Cq(a);return}}},getBase64ImageSrc:function(){var a=this.$Yt.$l.$R(String,Box4.AppProperties.$K.$136,"");WordEditor.Extension.$B.$bJ(String,a,"imageDataUrl");if(Box4.$Y.$1E9(a))return a.substr(a.indexOf(";base64,")+8);else{Diag.$2.$9(16847770,369,10,"AppId:{0}, the image should have an dataurl.",this.$1b.$4k);return null}},insertBreak:function(c,a){if(a&&a!==1){Diag.$2.$9(17339015,369,15,"AppId:{0}, insertLocation of InlinePicture.InsertBreak must be Before or After.",this.$1b.$4k);WordEditor.Extension.$B.$8U()}var b=new($$sc.$F.$$(Box4.$P));b.$F(this.$IK);this.$64.$1lP(b,c,a);return},insertContentControl:function(){return this.$8p.$26V(this.$IK,this.$76,this.$1b)},insertFileFromBase64:function(){Diag.$2.$9(17389523,369,15,"AppId:{0}, InsertFileFromBase64 in InlinePicture class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertHtml:function(){Diag.$2.$9(17389524,369,15,"AppId:{0}, InsertHtml in InlinePicture class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertInlinePictureFromBase64:function(g,b){var h=+new Date,f=new($$sc.$F.$$(Box4.$P));f.$F(this.$IK);this.$64.$t1(f,b,false);var c=null;if(b===4){c=Box4.$P.$40(this.$IK.$D,this.$IK.$j);this.deleteInlinePicture()}else if(b===2||b===3){Diag.$2.$9(17319648,369,50,"AppId:{0}, insert inline picture with none supported location in InlinePicture class.",this.$1b.$4k);WordEditor.Extension.$B.$8U();return null}else{var d,e;e=this.$64.$iq(this.$IK,this.$IK,b,d={val:c}),c=d.val,e}var i=this.$AM.$2Fc(g,c,this.$1b),a=this;return i.then(function(b){WordEditor.Extension.$B.$vM("InlinePicture.InsertInlinePictureFromBase64",WordEditor.Extension.$B.$Qn(h),0);a.$1b.$KN.$WU(a.$IK.$D);if(!b){Diag.$2.$9(17433740,369,10,"AppId:{0}, something went wrong when insert iamge into InlinePicture.",a.$1b.$4k);WordEditor.Extension.$B.$Cu();return null}else return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(a.$D4.$x(a.$AM.$2Af(b),a.$1b,0))})},insertOoxml:function(d,a){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var e=+new Date;if(!a||a===1){var c=new($$sc.$F.$$(Box4.$P));c.$F(this.$IK);var b=this,f=function(f,g){b.$BJ.$1lY(c,d,a,b.$IK.$D,b.$1b,f,g,e)};return OfficeExtension.WacRuntime.Utility.createPromise(f)}else{Diag.$2.$9(17585567,369,15,"AppId:{0}, InlinePicture.InsertOoxml: undefined location!",this.$1b.$4k);WordEditor.Extension.$B.$8U();return null}},insertParagraph:function(c,b){var a=new($$sc.$F.$$(Box4.$P));a.$F(this.$IK);return this.$CX.$x(this.$64.$1la(a,c,b),this.$1b,0)},insertText:function(c,a){var b=new($$sc.$F.$$(Box4.$P));b.$F(this.$IK);if(!a||a===1)return this.$Af.$x(this.$64.$2Fg(b,c,a),this.$1b,0);else{Diag.$2.$9(17339328,369,15,"AppId:{0}, undefined location for InlinePicture.InsertText:{1}.",this.$1b.$4k,WordEditor.Extension.InsertLocation.toString(a));WordEditor.Extension.$B.$8U();return null}},select:function(b){var a=new($$sc.$F.$$(Box4.$P));a.$F(this.$IK);this.$D8.$fK(a,b)},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},_OnAccess:function(){WordEditor.Extension.$B.$1X0(this.$IK.$D,"InlinePicture");return},getTypeName:function(){return"Microsoft.WordServices.InlinePicture"},invokePropertyGet:function(a){switch(a){case 3:return this.get_altTextDescription();case 4:return this.get_altTextTitle();case 5:return this.get_height();case 6:return this.get_hyperlink();case 7:return this.get_lockAspectRatio();case 10:return this.get_paragraph();case 9:return this.get_parentContentControl();case 8:return this.get_width();case 1:return this.$y;case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(b,a){switch(b){case 3:this.set_altTextDescription(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 4:this.set_altTextTitle(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 5:this.set_height(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 6:this.set_hyperlink(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return;case 7:this.set_lockAspectRatio(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 8:this.set_width(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(b,a){switch(b){case 1012:return this.$29a(a);case 1003:return this.$53C(a);case 1006:return this.$1lQ(a);case 1004:return this.$2Fd(a);case 1011:return this.$1lV(a);case 1008:return this.$1lW(a);case 1010:return this.$1lb(a);case 1007:return this.$1lc(a);case 1013:return this.$1pO(a);case 1002:return this.$cf(a);case 1001:return this.$19A(a)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokeMethodAsync:function(b,a){switch(b){case 1005:return this.$1lX(a);case 1009:return this.$1lZ(a)}var c=this.invokeMethod(b,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(c)},$29a:function(){this.deleteInlinePicture();return null},$53C:function(){return this.getBase64ImageSrc()},$1lQ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");this.insertBreak(b,c);return null},$2Fd:function(){return this.insertContentControl()},$1lV:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertFileFromBase64(b,c)},$1lW:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertHtml(b,c)},$1lX:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertInlinePictureFromBase64(b,c)},$1lZ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertOoxml(b,c)},$1lb:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertParagraph(b,c)},$1lc:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertText(b,c)},$1pO:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"int");this.select(a);return null},$cf:function(){this._KeepReference();return null},$19A:function(){this._OnAccess();return null},$57X:function(a){return this.$YN.$EW(a.$D,a.$j)}};WordEditor.Extension.InlinePictureCollection=function(a){this.$5Df=this.getTypeName;this.$N=this.length;this.$43f=this._GetItem;WordEditor.Extension.InlinePictureCollection.initializeBase(this);WordEditor.Extension.$B.$1Gv(a,"InlinePictureCollection");this.$1yz=a};WordEditor.Extension.InlinePictureCollection.prototype={$1yz:null,length:function(){return this.$1yz.get_$14()},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},_GetItem:function(b){var a=WordEditor.Extension.$B.$1Wz(b);if(a<this.length())return this.$1yz.get_$5(a);else{Diag.$2.$9(16847771,369,10,"The index is out of the paragraph range.");WordEditor.Extension.$B.$8U();return null}},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},getAsyncEnumerator:function(a,b){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new(WordEditor.Extension.$Dd.$$(WordEditor.Extension.InlinePicture))(a,b,this))},getTypeName:function(){return"Microsoft.WordServices.InlinePictureCollection"},invokePropertyGet:function(a){switch(a){case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(a,b){switch(a){case 1:return this.$1xv(b);case 1001:return this.$cf(b)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},$1xv:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"any");return this._GetItem(a)},$cf:function(){this._KeepReference();return null}};WordEditor.Extension.$FM=function(b,c,d,e,f,g,h,i,j,k,a){this.create=this.$x;this.$76=b;this.$YN=d;this.$Yw=c;this.$19W=e;this.$190=f;this.$AM=g;this.$8p=h;this.$D8=i;this.$64=j;this.$9i=k;this.$BJ=a};WordEditor.Extension.$FM.prototype={$CX:null,$Af:null,$76:null,$YN:null,$Yw:null,$19W:null,$190:null,$AM:null,$8p:null,$D8:null,$64:null,$9i:null,$BJ:null,$27S:function(a,b){this.$CX=a;this.$Af=b},$x:function(a,b,c){return new WordEditor.Extension.InlinePicture(a,b,c,this.$CX,this.$Af,this.$76,this,this.$Yw,this.$YN,this.$19W,this.$190,this.$AM,this.$8p,this.$D8,this.$64,this.$9i,this.$BJ)}};WordEditor.Extension.$S2=function(a,b,c,d,e){this.$K=a;this.$2N=b;this.$31=c;this.$7J=d;this.$9i=e};WordEditor.Extension.$S2.prototype={$K:null,$2N:null,$31:null,$7J:null,$9i:null,$iq:function(a,d,f,i){var e=0,c=0,b=null;switch(f){case 2:if(a.$1t===17){b=Box4.$P.$40(a.$D,0);c=0}else if(a.$1t===19){e=this.$7J.$2Y(a.$D);b=Box4.$P.$OV(a.$D);c=!e?1:2}else if(a.$1t===3||a.$1t===4){b=Box4.$P.$40(a.$D,a.$j);c=3}break;case 0:if(a.$1t===17){b=Box4.$P.$40(a.$D,0);c=4}else if(a.$1t===19){e=this.$7J.$2Y(a.$D);b=Box4.$P.$OV(a.$D);c=!e?5:6}else if(a.$1t===3||a.$1t===4){b=Box4.$P.$40(a.$D,a.$j);c=7}break;case 3:case 1:if(d.$1t===17||d.$1t===19){b=this.$54g(d.$D);c=f===3?8:10}else if(d.$1t===3||d.$1t===4){b=Box4.$P.$40(d.$D,d.$1i);c=f===3?9:11}break;case 4:var g,h;h=this.$iq(a,d,0,g={val:b}),b=g.val,h;c=12;break;default:Diag.$2.$9(17339329,369,15,"Undefined insert location: {0}",WordEditor.Extension.InsertLocation.toString(f));WordEditor.Extension.$B.$8U()}i.val=b;return c},$3A3:function(b,a,h,c,f){var d=null,e=b.get_$5(0),g=b.get_$5(b.get_$14()-1);switch(h){case 0:d=Box4.$P.$34(a.$D,0,c);b.set_$5(0,Box4.$P.$x(a.$D));break;case 2:d=Box4.$P.$34(a.$D,f,f+c);b.$B8(0,d);break;case 1:d=Box4.$P.$34(a.$D,0,c);b.set_$5(0,Box4.$P.$x(a.$D));break;case 3:d=Box4.$P.$34(a.$D,e.$j,e.$j+c);b.set_$5(0,Box4.$P.$34(a.$D,e.$j,e.$1i+c));break;case 4:d=Box4.$P.$34(a.$D,0,c);b.set_$5(0,Box4.$P.$34(a.$D,c,c+f));b.$B8(1,Box4.$P.$Zh(a.$D));break;case 5:d=Box4.$P.$34(a.$D,0,c);break;case 6:this.$2As(a.$D,f,true);d=Box4.$P.$34(a.$D,f,f+c);break;case 7:e.$j&&this.$2As(a.$D,e.$j,true);d=Box4.$P.$34(a.$D,e.$j,e.$j+c);b.set_$5(0,e.$1t===3?Box4.$P.$34(a.$D,e.$j+c,e.$1i+c):Box4.$P.$40(a.$D,e.$j+c));break;case 8:case 10:d=!f?Box4.$P.$x(a.$D):Box4.$P.$34(a.$D,0,c);h===8&&b.$F(d);break;case 9:case 11:if(h===9){g.$1i&&this.$2As(a.$D,g.$1i,true);b.set_$5(b.get_$14()-1,Box4.$P.$34(a.$D,g.$j,g.$1i+c))}d=Box4.$P.$34(a.$D,g.$1i,g.$1i+c);break;case 12:this.$3J5(b);d=Box4.$P.$34(b.get_$5(0).$D,b.get_$5(0).$j-c,b.get_$5(0).$j);b.set_$5(0,d)}return d},$54g:function(c){var f=new Box4.$E,a=new Box4.$E,b=this.$59O(c);if(!b){var d,e;this.$2x0(c,this.$7J.$2Y(c),d={val:f},e={val:a},false),f=d.val,a=e.val;b=a.$1J(2)}return Box4.$P.$40(b,0)},$59O:function(c){var a=Box4.$4h.$13(c);a.$2l();Box4.$S.$32(a);var b=Box4.$S.$Um(a,true,false);return!b?null:a.$1J(2)},$1lP:function(a,d,h){if(!a||!a.get_$14()){Diag.$2.$9(17179036,369,10,"The gncList is empty when try to insert the break.");WordEditor.Extension.$B.$8U()}if(d===6)this.$t1(a,h,false);else this.$t1(a,h,true);var e=a.get_$5(0),f=a.get_$5(a.get_$14()-1),g=null,b=null,c=-1;switch(h){case 2:b=e.$D;c=0;break;case 3:b=f.$D;c=this.$7J.$2Y(f.$D);break;case 0:case 4:b=e.$D;switch(e.$1t){case 19:c=this.$7J.$2Y(e.$D);break;case 17:c=0;break;default:c=e.$j}break;case 1:b=f.$D;switch(f.$1t){case 19:case 17:g=Box4.$P.$OV(b);break;default:c=f.$1i}}var i=new Box4.$E;i.$h(b);var j=i.$1X(23);if(!j&&d!==6){Diag.$2.$9(17577860,369,15,"Inserting Break (excpect LineBreak) is only allowed in the main document.");WordEditor.Extension.$B.$Cu()}h===4&&(!d||d===6)&&this.$K.$5D(new Box4.$Ch(null),239509079,2,true,null,a.$8V());g=g||Box4.$P.$40(b,c);switch(d){case 0:this.$K.$5D(g,3457315319,2,false,null,{});break;case 6:this.$5JT(g);break;default:Diag.$2.$9(17179037,369,15,"The breakType parameter is not supported: {1}.",WordEditor.Extension.BreakType.toString(d));WordEditor.Extension.$B.$8U()}},$5JT:function(c){var a=this.$2N;this.$2N.$oP(c,a.$$d_$292||(a.$$d_$292=Function.createDelegate(a,a.$292)),"\ufffc",null);var d=c.$D,b=c.$1i+1;if(this.$7J.$2b(d).charAt(b)===" "){var e=Box4.$P.$34(d,b,b+1);this.$2N.$6u(e,"\u00a0")}},$1la:function(f,b,i){if(!f.get_$14()){Diag.$2.$9(17182913,369,10,"The gncList is empty when try to insert paragraph.");WordEditor.Extension.$B.$8U()}this.$t1(f,i,true);var g=false;switch(i){case 0:g=true;break;case 1:g=false;break;default:Diag.$2.$9(17182914,369,15,"The type of insert location is undefined: {0}.",WordEditor.Extension.InsertLocation.toString(i));WordEditor.Extension.$B.$8U()}b=WordEditor.Extension.$B.$28o(b);var e=-1,h=g?f.get_$5(0):f.get_$5(f.get_$14()-1),c=h.$D,d=this.$7J.$2Y(c),a=null;switch(h.$1t){case 17:a=this.$13C(c,d,b,g);break;case 19:if(g){e=d;if(!e)a=this.$13C(c,d,b,true);else{a=this.$13C(c,d,b,false);f.set_$5(0,Box4.$P.$Zh(a))}}else a=this.$13C(c,d,b,false);break;default:if(g){e=h.$j;if(!e)a=this.$13C(c,d,b,true);else if(e===d){a=this.$13C(c,d,b,false);f.set_$5(0,Box4.$P.$40(a,a.$55.length))}else a=this.$3e9(c,e,b,g,f)}else{e=h.$1i;if(e===d)a=this.$13C(c,d,b,false);else if(!e){a=this.$13C(c,d,b,true);f.set_$5(0,Box4.$P.$40(a,0))}else a=this.$3e9(c,e,b,g,null)}}return a},$3e9:function(j,k,l,m,b){var c=new Box4.$E,d=new Box4.$E,f,g;this.$2x0(j,k,f={val:c},g={val:d},false),c=f.val,d=g.val;var e=this.$31.$13B(c,false),a=null;if(m){a=d.$1J(2);if(b.get_$5(0).$1t===3){var i=b.get_$5(0).$1i-b.get_$5(0).$j;b.set_$5(0,Box4.$P.$34(a,0,i))}else b.set_$5(0,Box4.$P.$40(a,0));b.get_$14()>1&&b.get_$5(1).$1t===19&&b.set_$5(1,Box4.$P.$OV(a));d.$1M();this.$31.$jy(d,e,Box4.$P.$40(a,0),true,true,false)}else{a=c.$1J(2);c.$1M();this.$31.$jy(c,e,Box4.$P.$40(a,this.$7J.$2Y(a)),true,true,true)}var h=e.$1J(2);this.$2N.$6u(Box4.$P.$40(h,0),l);return h},$13C:function(f,g,h,i){var d=new Box4.$E,a=new Box4.$E,b,c;this.$2x0(f,g,b={val:d},c={val:a},i),d=b.val,a=c.val;var e=a.$1J(2);this.$2N.$6u(Box4.$P.$40(e,0),h);return e},$2x0:function(g,i,j,k,h){var e=null,b=new Box4.$E;b.$h(g);if(b.$1X(11))e=b.$Gc(11);var a=Box4.$E.$13(e);a.$2l();Box4.$S.$32(a);var f=h?this.$31.$5Jc(a,false):this.$31.$13B(a,false),c=-1,d=false;if(h){c=0;d=false}else{c=i;d=true}this.$31.$jy(a,f,Box4.$P.$40(g,c),true,true,d);j.val=a;k.val=f},$t1:function(d,i,f){var g=d.get_$5(0),h=d.get_$5(d.get_$14()-1),a=null,b=new($$sc.$F.$$(Box4.$P)),c=1;switch(i){case 2:case 0:a=this.$3Wt(g,true);b.$F(a);if(f)c=2;break;case 3:case 1:a=this.$3Wt(h,false);b.$F(a);if(f)c=2;break;case 4:b=d;c=4}var e=this.$9i.$1BR(b,c);if(!e){Diag.$2.$9(17356296,369,15,"The inserting operation here is not allowed due to conflict with non-deletable or non-editable content control.");WordEditor.Extension.$B.$Cu()}return e},$2Fg:function(a,b,j){if(!a.get_$14()){Diag.$2.$9(17339330,369,10,"The gncList is empty when try to insert text.");WordEditor.Extension.$B.$8U()}b=WordEditor.Extension.$B.$28o(b);if(!b.length){Diag.$2.$9(17581889,369,15,"Inserted text can not be null");WordEditor.Extension.$B.$8U()}var k=b.length;this.$t1(a,j,false);var c=null,e=null,d=new($$sc.$F.$$(Box4.$P)),h=a.get_$5(0),l=a.get_$5(a.get_$14()-1),f,g,i=(g=this.$iq(h,l,j,f={val:c}),c=f.val,g),m=$$as(Box4.$y,c.$D).$55.length;if(i===12){this.$2Fg(a,b,0);a.get_$5(0).$1t!==19&&a.get_$5(0).$j!==this.$7J.$2Y(a.get_$5(0).$D)&&this.$2As(h.$D,a.get_$5(0).$j-b.length,false);this.$3J5(a);e=Box4.$P.$34(a.get_$5(0).$D,a.get_$5(0).$j-b.length,a.get_$5(0).$j);a.set_$5(0,e);d.$F(e);return d}this.$2N.$6u(c,b);d.$F(this.$3A3(a,c,i,k,m));return d},$2ES:function(a){var b=this.$7J.$2Y(a);return!b?Box4.$P.$40(a,0):Box4.$P.$34(a,0,b)},$3J5:function(a){var b=null,c,d;d=this.$iq(a.get_$5(0),a.get_$5(a.get_$14()-1),2,c={val:b}),b=c.val,d;this.$K.$5D(new Box4.$Ch(null),239509079,2,true,null,a.$8V());a.$Fk();a.$F(b)},$2As:function(d,e,f){for(var b=d.$i,a=0;a<b.get_$N();a++){var c=b.get_$5(a);if(c.$1K===e){if(f)b.get_$5(a).set_$67(b.get_$5(a-1).$1R.$6i(b.get_$5(a)));else b.get_$5(a).set_$67(b.get_$5(a+1).$1R.$6i(b.get_$5(a)));return}}},$3Wt:function(a,c){if(!a)return null;var b=null;switch(a.$1t){case 17:if(c)b=Box4.$P.$40(a.$D,0);else b=Box4.$P.$OV(a.$D);break;case 19:b=Box4.$P.$OV(a.$D);break;case 3:if(c)b=Box4.$P.$40(a.$D,a.$j);else b=Box4.$P.$40(a.$D,a.$1i);break;case 4:b=a}return b}};WordEditor.Extension.$63=function(){this.$1Ly=new($$sc.$C7.$$(String,Object))($$sc.$5H.get_$1oB())};WordEditor.Extension.$63.get_$4=function(){return WordEditor.Extension.$63.$T||(WordEditor.Extension.$63.$T=new WordEditor.Extension.$63)};WordEditor.Extension.$63.prototype={$1Ly:null,$5B5:function(){return Common.$C.$x().toString()},$ab:function(a,b){if(!a||!b){Diag.$2.$9(17168157,369,10,"Cannot keep reference for null object.");WordEditor.Extension.$B.$Cu()}this.$4Fi(a,b)},$4Fi:function(a,b){try{this.$1Ly.$F(a,b);return true}catch(c){Diag.$2.$9(17168158,369,10,"Failed to add object into the cache with exception message {0}.",c.message);return false}},$3QS:function(d){var a=null,b,c;c=this.$1Ly.$9F(d,b={val:a}),a=b.val,c;!a&&Diag.$2.$9(17168159,369,15,"This object with reference Id {0} hasn't been added to the cache yet.",d);return a},$5nT:function(a){try{this.$1Ly.$73(a);return true}catch(b){Diag.$2.$9(17168160,369,10,"Failed to remove the object from the cache with exception message {0}.",b.message);return false}},$4OO:function(){this.$1Ly=new($$sc.$C7.$$(String,Object))($$sc.$5H.get_$1oB());return true}};WordEditor.Extension.Paragraph=function(a,l,m,n,o,p,q,r,s,t,b,c,d,e,f,g,h,i,j,k){this.$5Df=this.getTypeName;WordEditor.Extension.Paragraph.initializeBase(this);WordEditor.Extension.$B.$1r4(a,"Paragraph");this.$2z=a;this.$1b=l;this.$y=m;this.$HU=n;this.$D4=o;this.$76=p;this.$CX=q;this.$Af=r;this.$7J=s;this.$5n=t;this.$K=b;this.$f=c;this.$D8=d;this.$Gp=e;this.$64=f;this.$AM=g;this.$8p=h;this.$HY=i;this.$9i=j;this.$BJ=k};WordEditor.Extension.Paragraph.prototype={$2z:null,$1b:null,$y:0,$CX:null,$HU:null,$D4:null,$76:null,$Af:null,$7J:null,$5n:null,$K:null,$f:null,$D8:null,$Gp:null,$64:null,$AM:null,$8p:null,$HY:null,$9i:null,$BJ:null,get_alignment:function(){var a=this.$7J.$MI(this.$2z);switch(a){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}},set_alignment:function(b){var a=0;switch(b){case 0:a=1;break;case 2:a=3;break;case 1:a=2;break;case 3:a=6;break;default:Diag.$2.$9(16871628,369,15,"AppId:{0}, set Paragraph.Alignment with not supported value: {1}.",this.$1b.$4k,b);WordEditor.Extension.$B.$8U()}this.$5n.$J2(this.$2z,a);return b},get_contentControls:function(){var a=Box4.$P.$x(this.$2z),b=a;return this.$8p.$2v4(a,b,this.$76,this.$1b)},get_firstLineIndent:function(){return this.$2uX(2)},set_firstLineIndent:function(b){var c=this.$5n.$UI(),a=Common.$1S.$vf(b);if(a>=0)c.$b1(this.$2z,a);else{var d=0-a;c.$1G5(this.$2z,d)}return b},get_font:function(){var a=new($$sc.$F.$$(Box4.$P)),b=Box4.$P.$x(this.$2z);a.$F(b);return this.$HU.$x(a,this.$1b,0)},get_inlinePictures:function(){var b=new($$sc.$F.$$(WordEditor.Extension.InlinePicture)),c=new($$sc.$F.$$(Box4.$P)),d=0;this.$AM.$3Yw(c,this.$2z);var a=c.$$lge();while(a.$$mn()){var e=a.$$cu();b.$F(this.$D4.$x(e,this.$1b,d++))}return new WordEditor.Extension.InlinePictureCollection(b)},get_leftIndent:function(){return this.$2uX(0)},set_leftIndent:function(a){var b=this.$5n.$UI(),c=Common.$1S.$vf(a);b.$1Vw(this.$2z,1,c);return a},get_lineSpacing:function(){return this.$1kh(0)},set_lineSpacing:function(a){WordEditor.Extension.$B.$15e(a,"Paragraph.LineSpacing");this.$5n.$2MM(this.$2z,2,a/12);return a},get_lineUnitAfter:function(){return this.$1kh(4)},set_lineUnitAfter:function(a){WordEditor.Extension.$B.$15e(a,"Paragraph.LineUnitAfter");this.$5n.$2M5(this.$2z,2,a);return a},get_lineUnitBefore:function(){return this.$1kh(3)},set_lineUnitBefore:function(a){WordEditor.Extension.$B.$15e(a,"Paragraph.LineUnitBefore");this.$5n.$2M8(this.$2z,2,a);return a},get_outlineLevel:function(){WordEditor.Extension.$B.$FD(this.$1b.$4k,"Paragraph.OutlineLevel","Getter","");return 0},set_outlineLevel:function(a){WordEditor.Extension.$B.$FD(this.$1b.$4k,"Paragraph.OutlineLevel","Setter","");return a},get_parentContentControl:function(){var a=Box4.$P.$x(this.$2z),b=a;return this.$8p.$2EN(a,b,this.$76,this.$1b)},get_rightIndent:function(){return this.$2uX(1)},set_rightIndent:function(a){var b=this.$5n.$UI(),c=Common.$1S.$vf(a);b.$2MK(this.$2z,1,c);return a},get_spaceAfter:function(){return this.$1kh(2)},set_spaceAfter:function(a){WordEditor.Extension.$B.$15e(a,"Paragraph.SpaceAfter");this.$5n.$2M5(this.$2z,4,a);return a},get_spaceBefore:function(){return this.$1kh(1)},set_spaceBefore:function(a){WordEditor.Extension.$B.$15e(a,"Paragraph.SpaceBefore");this.$5n.$2M8(this.$2z,4,a);return a},get_style:function(){return this.$Gp.$2ts(Box4.$P.$x(this.$2z))},set_style:function(a){var b=new($$sc.$F.$$(Box4.$P));b.$F(Box4.$P.$x(this.$2z));this.$Gp.$2MJ(b,a);return a},get_text:function(){return this.$7J.$1Ur(this.$2z)},get__Id:function(){return this.$y},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},clear:function(){var a=Box4.$P.$x(this.$2z);this.$3In(a);var b=this.$f.get_$23().get_$1Z().get_$11();if(b.$D.get_$E()===this.$2z.get_$E()&&b.$1t===4){var c=Box4.$P.$40(this.$2z,0),d=new Box4.$4S([c],true);this.$f.$2s(d,null,false,false)}this.$K.$5D(a,2887293604,2,true,null,null)},deleteParagraph:function(){var a=new Array(1);a[0]=Box4.$P.$x(this.$2z);this.$3In(a[0]);this.$K.$5D(new Box4.$Ch(null),239509079,2,true,null,a)},getHtml:function(){Diag.$2.$9(17433741,369,15,"AppId:{0}, GetHtml in Paragraph class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},getOoxml:function(){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var b=+new Date;this.$1b.$KN.$nW();var a=this,c=function(d,e){var c=new($$sc.$F.$$(Box4.$P));c.$F(Box4.$P.$x(a.$2z));a.$BJ.$1Rs(c,a.$2z,a.$1b,d,e,b)};return OfficeExtension.WacRuntime.Utility.createPromise(c)},insertBreak:function(c,a){if(a&&a!==1){Diag.$2.$9(17179038,369,15,"AppId:{0}, insertLocation of Paragraph.InsertBreak must be Before or After.",this.$1b.$4k);WordEditor.Extension.$B.$8U()}var b=new($$sc.$F.$$(Box4.$P));b.$F(Box4.$P.$x(this.$2z));this.$64.$1lP(b,c,a)},insertContentControl:function(){var a=Box4.$P.$x(this.$2z),b=a;return this.$8p.$1Op(a,b,this.$76,this.$1b)},insertFileFromBase64:function(){Diag.$2.$9(17389526,369,15,"AppId:{0}, InsertFileFromBase64 in Paragraph class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertHtml:function(){Diag.$2.$9(17389527,369,15,"AppId:{0}, InsertHtml in Paragraph class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertInlinePictureFromBase64:function(h,b){var i=+new Date,g=new($$sc.$F.$$(Box4.$P)),d=this.$64.$2ES(this.$2z);g.$F(d);this.$64.$t1(g,b,false);var c=null;if(b===4){c=Box4.$P.$40(this.$2z,0);this.clear()}else if(!b||b===1){Diag.$2.$9(17433743,369,50,"AppId:{0}, insert inline picture with none supported location in InlinePicture class.",this.$1b.$4k);WordEditor.Extension.$B.$8U();return null}else{var e,f;f=this.$64.$iq(d,d,b,e={val:c}),c=e.val,f}var j=this.$AM.$2Fc(h,c,this.$1b),a=this;return j.then(function(b){WordEditor.Extension.$B.$vM("Paragraph.InsertInlinePictureFromBase64",WordEditor.Extension.$B.$Qn(i),0);a.$1b.$KN.$WU(a.$2z);if(!b){Diag.$2.$9(17433744,369,10,"AppId:{0}, something went wrong when insert iamge into Paragraph.",a.$1b.$4k);WordEditor.Extension.$B.$Cu();return null}else return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(a.$D4.$x(a.$AM.$2Af(b),a.$1b,0))})},insertOoxml:function(d,a){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var e=+new Date;if(a===2||a===3||a===4){var c=new($$sc.$F.$$(Box4.$P)),h=this.$7J.$2Y(this.$2z),f=this.$64.$2ES(this.$2z);c.$F(f);var b=this,g=function(f,g){b.$BJ.$1lY(c,d,a,b.$2z,b.$1b,f,g,e)};return OfficeExtension.WacRuntime.Utility.createPromise(g)}else{Diag.$2.$9(17585568,369,15,"AppId:{0}, Paragraph.InsertOoxml: undefined location!",this.$1b.$4k);WordEditor.Extension.$B.$8U();return null}},insertParagraph:function(c,b){var a=new($$sc.$F.$$(Box4.$P));a.$F(Box4.$P.$x(this.$2z));return this.$CX.$x(this.$64.$1la(a,c,b),this.$1b,0)},insertText:function(d,a){var b=new($$sc.$F.$$(Box4.$P)),c=this.$64.$2ES(this.$2z);b.$F(c);if(a===2||a===3||a===4)return this.$Af.$x(this.$64.$2Fg(b,d,a),this.$1b,0);Diag.$2.$9(17339331,369,15,"AppId:{0}, undefied location for Paragraph.InsertText: {1}.",this.$1b.$4k,WordEditor.Extension.InsertLocation.toString(a));WordEditor.Extension.$B.$8U();return null},search:function(c,b){var a=this,d=function(e){var d=new($$sc.$F.$$(Box4.$P));d.$F(Box4.$P.$x(a.$2z));a.$HY.$iQ(d,c,b,e,a.$1b)};return OfficeExtension.WacRuntime.Utility.createPromise(d)},select:function(b){var a=new($$sc.$F.$$(Box4.$P));a.$F(Box4.$P.$x(this.$2z));this.$D8.$fK(a,b)},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},_OnAccess:function(){WordEditor.Extension.$B.$1X0(this.$2z,"Paragraph");return},getTypeName:function(){return"Microsoft.WordServices.Paragraph"},invokePropertyGet:function(a){switch(a){case 7:return this.get_alignment();case 5:return this.get_contentControls();case 8:return this.get_firstLineIndent();case 3:return this.get_font();case 17:return this.get_inlinePictures();case 9:return this.get_leftIndent();case 11:return this.get_lineSpacing();case 16:return this.get_lineUnitAfter();case 15:return this.get_lineUnitBefore();case 12:return this.get_outlineLevel();case 6:return this.get_parentContentControl();case 10:return this.get_rightIndent();case 14:return this.get_spaceAfter();case 13:return this.get_spaceBefore();case 4:return this.get_style();case 18:return this.get_text();case 1:return this.$y;case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(b,a){switch(b){case 7:this.set_alignment(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"));return;case 8:this.set_firstLineIndent(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 9:this.set_leftIndent(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 11:this.set_lineSpacing(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 16:this.set_lineUnitAfter(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 15:this.set_lineUnitBefore(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 12:this.set_outlineLevel(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"));return;case 10:this.set_rightIndent(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 14:this.set_spaceAfter(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 13:this.set_spaceBefore(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"number"));return;case 4:this.set_style(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(b,a){switch(b){case 1011:return this.$28A(a);case 1012:return this.$29a(a);case 1014:return this.$2DX(a);case 1010:return this.$1lQ(a);case 1004:return this.$2Fd(a);case 1008:return this.$1lV(a);case 1006:return this.$1lW(a);case 1009:return this.$1lb(a);case 1005:return this.$1lc(a);case 1013:return this.$1pO(a);case 1002:return this.$cf(a);case 1001:return this.$19A(a)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokeMethodAsync:function(b,a){switch(b){case 1015:return this.$2Dv(a);case 1003:return this.$1lX(a);case 1007:return this.$1lZ(a);case 1016:return this.$2LS(a)}var c=this.invokeMethod(b,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(c)},$28A:function(){this.clear();return null},$29a:function(){this.deleteParagraph();return null},$2DX:function(){return this.getHtml()},$2Dv:function(){return this.getOoxml()},$1lQ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");this.insertBreak(b,c);return null},$2Fd:function(){return this.insertContentControl()},$1lV:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertFileFromBase64(b,c)},$1lW:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertHtml(b,c)},$1lX:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertInlinePictureFromBase64(b,c)},$1lZ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertOoxml(b,c)},$1lb:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertParagraph(b,c)},$1lc:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertText(b,c)},$2LS:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"WordEditor.Extension.SearchOptions");return this.search(b,c)},$1pO:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"int");this.select(a);return null},$cf:function(){this._KeepReference();return null},$19A:function(){this._OnAccess();return null},$2uX:function(d){var b=this.$7J.$1Rt(this.$2z);if(b){var a=b.$Ck;if(a)switch(d){case 2:var c=this.$2uc(1,a.$1GK);switch(a.$pX){case 1:return c;case 2:return-c;default:return 0}case 0:return this.$2uc(a.$1Dq,a.$ug);case 1:return this.$2uc(a.$1Dr,a.$uh);default:return 0}}Diag.$2.$9(16832386,369,10,"AppId:{0}, error happened when reading paragraph {1} indent.",this.$1b.$4k,WordEditor.Extension.Paragraph.$1QR.toString(d));WordEditor.Extension.$B.$Cu();return 0},$1kh:function(c){var b=this.$7J.$1Rt(this.$2z);if(b){var a=b.$GW;if(a)switch(c){case 0:return this.$2ud(a.$Jw,a.$F6);case 1:return this.$2ud(a.$db,a.$NH);case 2:return this.$2ud(a.$dY,a.$NF);case 3:return this.$3ZB(a.$db,a.$NH);case 4:return this.$3ZB(a.$dY,a.$NF);default:return 0}}Diag.$2.$9(16832387,369,10,"AppId:{0}, error happened when reading paragraph {1} spacing.",this.$1b.$4k,WordEditor.Extension.Paragraph.$11i.toString(c));WordEditor.Extension.$B.$Cu();return 0},$2uc:function(c,a){switch(c){case 2:var b=Common.$s.$2lP(a);return Common.$1S.$1Gg(b);case 1:return Common.$1S.$1Gg(a);default:return 0}},$2ud:function(b,a){switch(b){case 2:return a*12;case 3:return Common.$1S.$1Gg(a);case 4:return a;default:return 0}},$3ZB:function(b,a){switch(b){case 4:return a/12;case 3:return Common.$1S.$1Gg(a)/12;case 2:return a;default:return 0}},$3In:function(b){var a=new($$sc.$F.$$(Box4.$P));a.$F(b);if(!this.$9i.$1BR(a,3)){Diag.$2.$9(17356297,369,15,"AppId:{0}, Paragraph.Clear is not allowed.",this.$1b.$4k);WordEditor.Extension.$B.$Cu()}return true}};WordEditor.Extension.Paragraph.$1QR=function(){};WordEditor.Extension.Paragraph.$1QR.prototype={left:0,right:1,firstLine:2};WordEditor.Extension.Paragraph.$1QR.registerEnum("WordEditor.Extension.Paragraph.$1QR",false);WordEditor.Extension.Paragraph.$11i=function(){};WordEditor.Extension.Paragraph.$11i.prototype={lineSpacing:0,before:1,after:2,lineBefore:3,lineAfter:4};WordEditor.Extension.Paragraph.$11i.registerEnum("WordEditor.Extension.Paragraph.$11i",false);WordEditor.Extension.ParagraphCollection=function(a){this.$5Df=this.getTypeName;this.$43f=this._GetItem;WordEditor.Extension.ParagraphCollection.initializeBase(this);WordEditor.Extension.$B.$1Gv(a,"ParagraphCollection");this.$TY=a};WordEditor.Extension.ParagraphCollection.prototype={$TY:null,$N:function(){return this.$TY.get_$14()},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},_GetItem:function(b){var a=WordEditor.Extension.$B.$1Wz(b);if(a<this.$N())return this.$TY.get_$5(a);else{Diag.$2.$9(16795330,369,10,"The index is out of the paragraph range.");WordEditor.Extension.$B.$8U();return null}},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},getAsyncEnumerator:function(a,b){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new(WordEditor.Extension.$Dd.$$(WordEditor.Extension.Paragraph))(a,b,this))},getTypeName:function(){return"Microsoft.WordServices.ParagraphCollection"},invokePropertyGet:function(a){switch(a){case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(a,b){switch(a){case 1:return this.$1xv(b);case 1001:return this.$cf(b)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},$1xv:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"any");return this._GetItem(a)},$cf:function(){this._KeepReference();return null}};WordEditor.Extension.$HD=function(f,g,h,i,j,k,l,m,n,o,a,b,c,d,e){this.create=this.$x;this.$HU=f;this.$D4=g;this.$76=h;this.$7J=i;this.$5n=j;this.$K=k;this.$f=l;this.$D8=m;this.$2hO=n;this.$64=o;this.$AM=a;this.$8p=b;this.$HY=c;this.$9i=d;this.$BJ=e};WordEditor.Extension.$HD.prototype={$HU:null,$D4:null,$76:null,$Af:null,$7J:null,$5n:null,$K:null,$f:null,$D8:null,$2hO:null,$64:null,$AM:null,$8p:null,$HY:null,$9i:null,$BJ:null,$27S:function(a){this.$Af=a},$x:function(a,b,c){return new WordEditor.Extension.Paragraph(a,b,c,this.$HU,this.$D4,this.$76,this,this.$Af,this.$7J,this.$5n,this.$K,this.$f,this.$D8,this.$2hO,this.$64,this.$AM,this.$8p,this.$HY,this.$9i,this.$BJ)}};WordEditor.Extension.Range=function(a,j,k,l,m,n,o,p,q,r,b,c,d,e,f,g,h,i){this.$5Df=this.getTypeName;WordEditor.Extension.Range.initializeBase(this);WordEditor.Extension.$B.$1Gv(a,"Range");this.$6F=a;this.$1b=j;this.$y=k;this.$CX=l;this.$D4=m;this.$76=n;this.$HU=o;this.$Af=p;this.$7J=q;this.$K=r;this.$D8=b;this.$Gp=c;this.$64=d;this.$AM=e;this.$8p=f;this.$HY=g;this.$9i=h;this.$BJ=i};WordEditor.Extension.Range.prototype={$6F:null,$1b:null,$y:0,$CX:null,$D4:null,$76:null,$HU:null,$Af:null,$7J:null,$K:null,$D8:null,$Gp:null,$64:null,$AM:null,$8p:null,$HY:null,$9i:null,$BJ:null,get_contentControls:function(){if(this.$6F.get_$14()<=0)return null;var a=this.$6F.get_$5(0),b=this.$6F.get_$5(this.$6F.get_$14()-1);return this.$8p.$2v4(a,b,this.$76,this.$1b)},get_font:function(){return this.$HU.$x(this.$6F,this.$1b,0)},get_inlinePictures:function(){var c=new($$sc.$F.$$(WordEditor.Extension.InlinePicture)),e=0,a=this.$6F.$$lge();while(a.$$mn()){var f=a.$$cu(),d=new($$sc.$F.$$(Box4.$P));this.$AM.$3Yx(d,f);var b=d.$$lge();while(b.$$mn()){var g=b.$$cu();c.$F(this.$D4.$x(g,this.$1b,e++))}}return new WordEditor.Extension.InlinePictureCollection(c)},get_paragraphs:function(){var e=0,c=new($$sc.$F.$$(WordEditor.Extension.Paragraph)),d=new($$sc.$FA.$$(String))($$sc.$5H.get_$5da()),b=this.$6F.$$lge();while(b.$$mn()){var a=b.$$cu();if(!d.$4V(a.$D.get_$E().toString())){d.$F(a.$D.get_$E().toString());c.$F(this.$CX.$x(a.$D,this.$1b,e++))}}return new WordEditor.Extension.ParagraphCollection(c)},get_parentContentControl:function(){if(this.$6F.get_$14()<=0)return null;var a=this.$6F.get_$5(0),b=this.$6F.get_$5(this.$6F.get_$14()-1);return this.$8p.$2EN(a,b,this.$76,this.$1b)},get_style:function(){return this.$Gp.$2tr(this.$6F)},set_style:function(a){this.$Gp.$2MJ(this.$6F,a);return a},get_text:function(){return this.$5AT()},get__Id:function(){return this.$y},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},clear:function(){if(this.$6F.get_$14()<=0){Diag.$2.$9(17339016,369,10,"AppId:{0}, the Range should contain at least one graph node context.",this.$1b.$4k);return}if(!this.$9i.$1BR(this.$6F,3)){Diag.$2.$9(17356298,369,15,"AppId:{0}, Range.Clear is not allowed due to conflict with non-deletable content control.",this.$1b.$4k);WordEditor.Extension.$B.$Cu()}var a=null;if(this.$6F.get_$5(0).$1t===17){var b,c;c=this.$64.$iq(this.$6F.get_$5(0),this.$6F.get_$5(this.$6F.get_$14()-1),3,b={val:a}),a=b.val,c;a=Box4.$P.$40(a.$D,0)}else{var d,e;e=this.$64.$iq(this.$6F.get_$5(0),this.$6F.get_$5(this.$6F.get_$14()-1),2,d={val:a}),a=d.val,e}this.$K.$5D(new Box4.$Ch(null),239509079,2,true,null,this.$6F.$8V());this.$6F.$Fk();this.$6F.$F(a)},deleteRange:function(){this.clear()},getHtml:function(){Diag.$2.$9(17433745,369,15,"AppId:{0}, GetHtml in Range class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},getOoxml:function(){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var b=+new Date;this.$1b.$KN.$nW();var a=this,c=function(c,d){a.$BJ.$1Rs(a.$6F,a.$6F.get_$5(0).$D,a.$1b,c,d,b)};return OfficeExtension.WacRuntime.Utility.createPromise(c)},insertBreak:function(b,a){if(a&&a!==1&&a!==4){Diag.$2.$9(17179039,369,15,"AppId:{0}, insertLocation of Range.InsertBreak must be Before, After or Replace.",this.$1b.$4k);WordEditor.Extension.$B.$8U()}this.$64.$1lP(this.$6F,b,a)},insertContentControl:function(){if(this.$6F.get_$14()<=0){Diag.$2.$9(17148104,369,10,"AppId:{0}, the Range should contain at least one graph node context.",this.$1b.$4k);return null}var a=this.$6F.get_$5(0),b=this.$6F.get_$5(this.$6F.get_$14()-1);return this.$3fP(a)?this.$8p.$26V(a,this.$76,this.$1b):this.$3fP(b)?this.$8p.$1Op(a,this.$6F.get_$5(this.$6F.get_$14()-2),this.$76,this.$1b):this.$8p.$1Op(a,b,this.$76,this.$1b)},insertFileFromBase64:function(){Diag.$2.$9(17389529,369,15,"AppId:{0}, InsertFileFromBase64 in Range class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertHtml:function(){Diag.$2.$9(17389530,369,15,"AppId:{0}, InsertHtml in Range class haven't been impelemented yet.",this.$1b.$4k);WordEditor.Extension.$B.$J3();return null},insertInlinePictureFromBase64:function(j,c){var k=+new Date;if(this.$6F.get_$14()<=0){Diag.$2.$9(17433747,369,10,"AppId:{0}, gnc list count is 0 in range class, so can't insert image.",this.$1b.$4k);WordEditor.Extension.$B.$Cu();return null}this.$64.$t1(this.$6F,c,false);var b=null,d=this.$6F.get_$5(0),i=this.$6F.get_$5(this.$6F.get_$14()-1),e,f,l=c===4?(f=this.$64.$iq(d,i,0,e={val:b}),b=e.val,f):0,g,h,m=(h=this.$64.$iq(d,i,c,g={val:b}),b=g.val,h),n=this.$AM.$2Fc(j,b,this.$1b),a=this;return n.then(function(e){WordEditor.Extension.$B.$vM("Range.InsertInlinePictureFromBase64",WordEditor.Extension.$B.$Qn(k),0);a.$1b.$KN.$WU(d.$D);if(!e){Diag.$2.$9(17433748,369,10,"AppId:{0}, something went wrong when insert iamge into Range.",a.$1b.$4k);WordEditor.Extension.$B.$Cu();return null}else{var g=a.$AM.$2Af(e),f=$$as(Box4.$y,b.$D).$55.length;c===4&&a.$64.$3A3(a.$6F,b,l,1,f);a.$64.$3A3(a.$6F,b,m,1,f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(a.$D4.$x(g,a.$1b,0))}})},insertOoxml:function(c,b){!WordEditor.Extension.$B.$t2()&&WordEditor.Extension.$B.$J3();var d=+new Date,a=this,e=function(e,f){a.$BJ.$1lY(a.$6F,c,b,a.$6F.get_$5(0).$D,a.$1b,e,f,d)};return OfficeExtension.WacRuntime.Utility.createPromise(e)},insertParagraph:function(b,a){return this.$CX.$x(this.$64.$1la(this.$6F,b,a),this.$1b,0)},insertText:function(b,a){return this.$Af.$x(this.$64.$2Fg(this.$6F,b,a),this.$1b,0)},search:function(c,b){var a=this,d=function(d){a.$HY.$iQ(a.$6F,c,b,d,a.$1b)};return OfficeExtension.WacRuntime.Utility.createPromise(d)},select:function(a){this.$D8.$fK(this.$6F,a)},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},_OnAccess:function(){var a=this.$6F.$$lge();while(a.$$mn()){var b=a.$$cu();WordEditor.Extension.$B.$1X0(b.$D,"Range")}return},getTypeName:function(){return"Microsoft.WordServices.Range"},invokePropertyGet:function(a){switch(a){case 6:return this.get_contentControls();case 3:return this.get_font();case 8:return this.get_inlinePictures();case 5:return this.get_paragraphs();case 7:return this.get_parentContentControl();case 4:return this.get_style();case 9:return this.get_text();case 1:return this.$y;case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a,b){switch(a){case 4:this.set_style(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"string"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(b,a){switch(b){case 1011:return this.$28A(a);case 1012:return this.$29a(a);case 1014:return this.$2DX(a);case 1009:return this.$1lQ(a);case 1003:return this.$2Fd(a);case 1007:return this.$1lV(a);case 1005:return this.$1lW(a);case 1008:return this.$1lb(a);case 1004:return this.$1lc(a);case 1013:return this.$1pO(a);case 1002:return this.$cf(a);case 1001:return this.$19A(a)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokeMethodAsync:function(b,a){switch(b){case 1015:return this.$2Dv(a);case 1010:return this.$1lX(a);case 1006:return this.$1lZ(a);case 1016:return this.$2LS(a)}var c=this.invokeMethod(b,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(c)},$28A:function(){this.clear();return null},$29a:function(){this.deleteRange();return null},$2DX:function(){return this.getHtml()},$2Dv:function(){return this.getOoxml()},$1lQ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"int"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");this.insertBreak(b,c);return null},$2Fd:function(){return this.insertContentControl()},$1lV:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertFileFromBase64(b,c)},$1lW:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertHtml(b,c)},$1lX:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertInlinePictureFromBase64(b,c)},$1lZ:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertOoxml(b,c)},$1lb:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertParagraph(b,c)},$1lc:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"int");return this.insertText(b,c)},$2LS:function(a){var b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"string"),c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,1,"WordEditor.Extension.SearchOptions");return this.search(b,c)},$1pO:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"int");this.select(a);return null},$cf:function(){this._KeepReference();return null},$19A:function(){this._OnAccess();return null},$5AT:function(){var b="",c=this.$6F.$$lge();while(c.$$mn()){var a=c.$$cu();switch(a.$1t){case 17:b+=this.$7J.$1Ur(a.$D)+WordEditor.Extension.$B.$1mn;break;case 3:var d=this.$7J.$2b(a.$D).substring(a.$j,a.$1i);b+=Box4.$y.$pI(d,"")+WordEditor.Extension.$B.$1mn;break;case 19:b+=WordEditor.Extension.$B.$1mn;break;case 4:break;default:Diag.$2.$9(17040522,369,10,"AppId:{0}, the contextId {1} is not supported to get the text.",this.$1b.$4k,a.$1t);WordEditor.Extension.$B.$Cu()}}return b},$3fP:function(a){return a.$j===-1&&a.$1i===-1&&a.$1t===17?false:a.$j>0||a.$1i<this.$7J.$2Y(a.$D)}};WordEditor.Extension.$HI=function(e,f,g,h,i,j,k,l,m,n,a,b,c,d){this.create=this.$x;this.$CX=e;this.$D4=f;this.$76=g;this.$HU=h;this.$7J=i;this.$K=j;this.$D8=k;this.$Gp=l;this.$64=m;this.$AM=n;this.$8p=a;this.$HY=b;this.$9i=c;this.$BJ=d};WordEditor.Extension.$HI.prototype={$CX:null,$D4:null,$76:null,$HU:null,$7J:null,$K:null,$D8:null,$Gp:null,$64:null,$AM:null,$8p:null,$HY:null,$9i:null,$BJ:null,$x:function(a,b,c){return new WordEditor.Extension.Range(a,b,c,this.$CX,this.$D4,this.$76,this.$HU,this,this.$7J,this.$K,this.$D8,this.$Gp,this.$64,this.$AM,this.$8p,this.$HY,this.$9i,this.$BJ)}};WordEditor.Extension.$Nl=function(a){this.$KN=a};WordEditor.Extension.$Nl.prototype={$KN:null,$4k:null};WordEditor.Extension.$Ls=function(a){this.$2iK=a;this.$25Z=new Array(0)};WordEditor.Extension.$Ls.prototype={$25Z:null,$2iK:null,$WU:function(b){var a=this.$2iK.$59(15,0);a.$1o(b);this.$25Z.push(a)},$nW:function(){var a=this.$25Z.pop();a.dispose();a=null}};WordEditor.Extension.$fj=function(a){this.$2Ue=a};WordEditor.Extension.$fj.prototype={$2Ue:null,hostName:function(){return"WordOnline"},appId:function(){return this.$2Ue},createInstance:function(a){switch(a){case"Microsoft.WordServices.SearchOptions":return new WordEditor.Extension.SearchOptions}Diag.$2.$9(17359129,369,10,"Typename: {0} should not call into here other than SearchOptions.",a);WordEditor.Extension.$B.$Cu();return null}};WordEditor.Extension.$Fm=function(a,b,c){this.$1wE=a;this.$2Xv=b;this.$2Y0=c};WordEditor.Extension.$Fm.prototype={$1wE:null,$2Xv:null,$2Y0:null,$iQ:function(f,g,h,c,i){var a=this.$56G(f);if(a.get_$14()<=0){c(new WordEditor.Extension.SearchResultCollection(new($$sc.$F.$$(WordEditor.Extension.Range))));return}var b=this.$2Y0.$x(a,c,i),d=new WordEditor.Extension.$ZD(b),e=this.$2Xv.$x(b,d,a);e.$iQ(this.$5Aw(g,h))},$5Aw:function(c,b){var a=0;if(!b)return this.$1wE(c,a);if(b.$cg)a=a|1;if(b.$ch)a=a|2;return this.$1wE(c,a)},$56G:function(d){var c=new($$sc.$F.$$(Box4.$P)),b=d.$$lge();while(b.$$mn()){var a=b.$$cu();(a.$1t===17||a.$1t===3)&&c.$F(a)}return c}};WordEditor.Extension.SearchOptions=function(){};WordEditor.Extension.SearchOptions.prototype={$ch:false,$cg:false,get_ignorePunct:function(){WordEditor.Extension.$B.$FD("","SearchOptions.IgnorePunct","Getter","");return false},set_ignorePunct:function(a){WordEditor.Extension.$B.$FD("","SearchOptions.IgnorePunct","Setter","");return a},get_ignoreSpace:function(){WordEditor.Extension.$B.$FD("","SearchOptions.IgnoreSpace","Getter","");return false},set_ignoreSpace:function(a){WordEditor.Extension.$B.$FD("","SearchOptions.IgnoreSpace","Setter","");return a},get_matchCase:function(){return this.$cg},set_matchCase:function(a){this.$cg=a;return a},get_matchPrefix:function(){WordEditor.Extension.$B.$FD("","SearchOptions.MatchPrefix","Getter","");return false},set_matchPrefix:function(a){WordEditor.Extension.$B.$FD("","SearchOptions.MatchPrefix","Setter","");return a},get_matchSoundsLike:function(){WordEditor.Extension.$B.$FD("","SearchOptions.MatchSoundsLike","Getter","");return false},set_matchSoundsLike:function(a){WordEditor.Extension.$B.$FD("","SearchOptions.MatchSoundsLike","Setter","");return a},get_matchSuffix:function(){WordEditor.Extension.$B.$FD("","SearchOptions.MatchSuffix","Getter","");return false},set_matchSuffix:function(a){WordEditor.Extension.$B.$FD("","SearchOptions.MatchSuffix","Setter","");return a},get_matchWholeWord:function(){return this.$ch},set_matchWholeWord:function(a){this.$ch=a;return a},get_matchWildcards:function(){WordEditor.Extension.$B.$FD("","SearchOptions.MatchWildcards","Getter","");return false},set_matchWildcards:function(a){WordEditor.Extension.$B.$FD("","SearchOptions.MatchWildcards","Setter","");return a},getTypeName:function(){return"Microsoft.WordServices.SearchOptions"},invokePropertyGet:function(a){switch(a){case 1:return this.get_ignorePunct();case 2:return this.get_ignoreSpace();case 3:return this.$cg;case 4:return this.get_matchPrefix();case 5:return this.get_matchSoundsLike();case 6:return this.get_matchSuffix();case 8:return this.$ch;case 7:return this.get_matchWildcards()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(b,a){switch(b){case 1:this.set_ignorePunct(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 2:this.set_ignoreSpace(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 3:this.$cg=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 4:this.set_matchPrefix(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 5:this.set_matchSoundsLike(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 6:this.set_matchSuffix(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return;case 8:this.$ch=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 7:this.set_matchWildcards(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(a){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)}};WordEditor.Extension.SearchResultCollection=function(a){this.$5Df=this.getTypeName;this.$43f=this._GetItem;WordEditor.Extension.SearchResultCollection.initializeBase(this);WordEditor.Extension.$B.$1Gv(a,"SearchResultCollection");this.$23x=a};WordEditor.Extension.SearchResultCollection.prototype={$23x:null,$N:function(){return this.$23x.get_$14()},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},_GetItem:function(b){var a=WordEditor.Extension.$B.$1Wz(b);if(a<this.$N())return this.$23x.get_$5(a);else{Diag.$2.$9(17389532,369,10,"user request an item in result which is exseed the result list length.");WordEditor.Extension.$B.$8U();return null}},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},getAsyncEnumerator:function(a,b){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new(WordEditor.Extension.$Dd.$$(WordEditor.Extension.Range))(a,b,this))},getTypeName:function(){return"Microsoft.WordServices.SearchResultCollection"},invokePropertyGet:function(a){switch(a){case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(a,b){switch(a){case 1:return this.$1xv(b);case 1002:return this.$cf(b)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},$1xv:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"any");return this._GetItem(a)},$cf:function(){this._KeepReference();return null}};WordEditor.Extension.Section=function(a,b,c,d,e,f){this.$5Df=this.getTypeName;WordEditor.Extension.Section.initializeBase(this);WordEditor.Extension.$B.$1r4(a,"Section");this.$1Zx=a;this.$1b=b;this.$y=c;this.$gE=d;this.$O5=e;this.$5b=f};WordEditor.Extension.Section.prototype={$1Zx:null,$1b:null,$y:0,$gE:null,$O5:null,$5b:null,get_body:function(){return this.$gE.$x(this.$1Zx,this.$1b,0)},get__Id:function(){return this.$y},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},getFooter:function(a){return this.$gE.$x(this.$1kV(false,a),this.$1b,0)},getHeader:function(a){return this.$gE.$x(this.$1kV(true,a),this.$1b,0)},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},_OnAccess:function(){WordEditor.Extension.$B.$1X0(this.$1Zx,"Section");return},getTypeName:function(){return"Microsoft.WordServices.Section"},invokePropertyGet:function(a){switch(a){case 3:return this.get_body();case 1:return this.$y;case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(b,a){switch(b){case 1004:return this.$56c(a);case 1003:return this.$57G(a);case 1002:return this.$cf(a);case 1001:return this.$19A(a)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(b);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},$56c:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"int");return this.getFooter(a)},$57G:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"int");return this.getHeader(a)},$cf:function(){this._KeepReference();return null},$19A:function(){this._OnAccess();return null},$1kV:function(e,g){var b=new Box4.$E;b.$h(this.$1Zx);var c=1,a=-1;switch(g){case 0:a=e?0:3;break;case 1:a=e?2:5;c=2;break;case 2:a=e?1:4;c=3;break;default:Diag.$2.$9(16831117,369,15,"AppId:{0}, the type of header footer is undefined: {1}.",this.$1b.$4k,WordEditor.Extension.HeaderFooterType.toString(g));WordEditor.Extension.$B.$8U()}var h=this.$O5.$3P1(b,c),d=null;d=this.$5b.$1Es(b);var f=null;if(d)f=this.$5b.$1kV(d,a);return f}};WordEditor.Extension.SectionCollection=function(a){this.$5Df=this.getTypeName;this.$43f=this._GetItem;WordEditor.Extension.SectionCollection.initializeBase(this);WordEditor.Extension.$B.$1Gv(a,"SectionCollection");this.$23z=a};WordEditor.Extension.SectionCollection.prototype={$23z:null,$N:function(){return this.$23z.get_$14()},get__ReferenceId:function(){return this.$Rb?this.$Tc:null},_GetItem:function(b){var a=WordEditor.Extension.$B.$1Wz(b);if(a>=0&&a<this.$N())return this.$23z.get_$5(a);else{Diag.$2.$9(16814432,369,10,"The index is out of the section range.");WordEditor.Extension.$B.$8U();return null}},_KeepReference:function(){WordEditor.Extension.$ql.prototype.$ab.call(this)},getAsyncEnumerator:function(a,b){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new(WordEditor.Extension.$Dd.$$(WordEditor.Extension.Section))(a,b,this))},getTypeName:function(){return"Microsoft.WordServices.SectionCollection"},invokePropertyGet:function(a){switch(a){case 2:return this.get__ReferenceId()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertyGetAsync:function(a){var b=this.invokePropertyGet(a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},invokePropertySet:function(a){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokePropertySetAsync:function(a,b){this.invokePropertySet(a,b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(a,b){switch(a){case 1:return this.$1xv(b);case 1001:return this.$cf(b)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(a);},invokeMethodAsync:function(a,c){var b=this.invokeMethod(a,c);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(b)},$1xv:function(b){var a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(b,0,"any");return this._GetItem(a)},$cf:function(){this._KeepReference();return null}};WordEditor.Extension.$O4=function(a,b,c){this.create=this.$x;this.$gE=a;this.$O5=b;this.$5b=c};WordEditor.Extension.$O4.prototype={$gE:null,$O5:null,$5b:null,$x:function(a,b,c){return new WordEditor.Extension.Section(a,b,c,this.$gE,this.$O5,this.$5b)}};WordEditor.Extension.$U3=function(a,b){this.$f=a;this.$4C=b};WordEditor.Extension.$U3.prototype={$f:null,$4C:null,$fK:function(d,j){var e=-1,f=-1,a=null,b=null,c=null;if(!d.get_$14()){Diag.$2.$9(17094667,369,10,"The gncList is empty when try to select the list.");WordEditor.Extension.$B.$8U()}else{a=d.get_$5(0);b=d.get_$5(d.get_$14()-1);switch(a.$1t){case 17:e=0;break;case 19:if(!Box4.$y.isInstanceOfType(a.$D)){Diag.$2.$9(17094668,369,10,"The first gnc can't be null when converted to paragraph node.");WordEditor.Extension.$B.$8U()}e=$$as(Box4.$y,a.$D).$55.length;break;default:e=a.$j}switch(b.$1t){case 17:case 19:if(!Box4.$y.isInstanceOfType(b.$D)){Diag.$2.$9(17094669,369,10,"The last gnc can't be null when converted to paragraph node.");WordEditor.Extension.$B.$8U()}f=$$as(Box4.$y,b.$D).$55.length;break;default:f=b.$1i}}switch(j){case 0:for(var h=[],g=0;g<d.get_$14();g++){c=new Box4.$4S([d.get_$5(g)],true);h.push(c)}var i=new Box4.$4i(h,0,-1);this.$f.$b2(i);break;case 1:c=new Box4.$4S([Box4.$P.$40(a.$D,e)],true);this.$f.$2s(c,null,false,false);break;case 2:c=new Box4.$4S([Box4.$P.$40(b.$D,f)],true);this.$f.$2s(c,null,false,false);break;default:Diag.$2.$9(17094670,369,10,"The type of selectionMode is undefined!");WordEditor.Extension.$B.$8U()}this.$4C.$2MH()}};WordEditor.Extension.$UL=function(a,b,c,d){this.$1ev=a;this.$K=b;this.$7J=c;this.$9i=d};WordEditor.Extension.$UL.prototype={$1ev:null,$K:null,$7J:null,$9i:null,$2tr:function(d){for(var a="",b=0;b<d.get_$14();b++){if(!this.$2yT(d.get_$5(b).$1t))continue;var c=this.$2ts(d.get_$5(b));if(a===""&&c!=="")a=c;if(c!==a)return""}return a},$2ts:function(a){if(!this.$2yT(a.$1t))return"";var b=new Common.$3L,c=this.$K.$5D(a,3123760305,2,false,new Common.$EN,b);return c===2?this.$2ts(Box4.$P.$x(a.$D)):b.$s(String,Box4.AppProperties.$N.$14G)},$2MJ:function(d,a){if(!this.$9i.$1BR(d,0))return;a=this.$5gz(a);var e=this.$1ev.$eU(),c=e.$1S1(a);if(!c){Diag.$2.$9(17334858,369,15,"The {0} style is not supported on word wac.",a);WordEditor.Extension.$B.$8U()}var b=d.$$lge();while(b.$$mn()){var f=b.$$cu();this.$36F(f,c)}},$36F:function(a,b){if(!this.$2yT(a.$1t))return;var c=this.$1ev.$X8(b);if(c===2){if(a.$1t===4||a.$1t===3){this.$36F(Box4.$P.$x(a.$D),b);return}}else if(c===1){if(a.$1t===17){this.$36F(Box4.$P.$34(a.$D,0,this.$7J.$2Y(a.$D)),b);return}}else{Diag.$2.$9(17334859,369,10,"Table or other style: {0} is not supported on word wac.",b.toString());return}var d=this.$1ev.$Bs(b);this.$K.$5D(a,1040747875,2,false,new Common.$EN,d)},$5gz:function(h){for(var a="",g=h.trim().toLowerCase().split(" "),e=g,f=e.length,c=0;c<f;++c){for(var d=e[c],b=0;b<d.length;b++){if(!b){a+=d.charAt(0).toUpperCase();continue}a+=d.charAt(b)}a+=" "}return a.trimEnd()},$2yT:function(a){switch(a){case 17:case 3:case 4:case 2:return true;default:return false}}};WordEditor.Extension.$B=function(){};WordEditor.Extension.$B.$1r4=function(a,b){if(!a){Diag.$2.$9(16795331,369,10,"The {0} root node should not be null.",b);WordEditor.Extension.$B.$8U()}};WordEditor.Extension.$B.$1Gv=function(a,b){if(!a){Diag.$2.$9(16795332,369,10,"The list of {0} objects should not be null.",b);WordEditor.Extension.$B.$8U()}};WordEditor.Extension.$B.$1X0=function(a,b){WordEditor.Extension.$B.$1r4(a,b);if(!a.get_$7C()){Diag.$2.$9(16795333,369,15,"The accessed node is already not connected to the graph in class: {0}.",b);WordEditor.Extension.$B.$8U()}};WordEditor.Extension.$B.$bJ=function(c,a,b){if(!a){Diag.$2.$9(16847773,369,10,"The {0} should not be null.",b);WordEditor.Extension.$B.$8U()}};WordEditor.Extension.$B.$42z=function(a){if(!a||a===""){Diag.$2.$9(17056035,369,10,"The {0} should not be null or empty.",a);WordEditor.Extension.$B.$8U()}};WordEditor.Extension.$B.$15e=function(a,b){if(a<=0){Diag.$2.$9(17040545,369,10,"Set {0} with not supported value: {0}.",b,a);WordEditor.Extension.$B.$8U()}};WordEditor.Extension.$B.$1Wz=function(a){if(typeof a==="number")return a;else{WordEditor.Extension.$B.$8U();return 0}};WordEditor.Extension.$B.$FD=function(d,e,b,c){var a="AppId:"+d+",";if(b!=="")a+="Property"+b;else a+="Method";a+=":"+e+", currently is not supported on Word Wac";if(c!=="")a+=" for Parameter:"+c;Diag.$2.$9(17138123,369,15,a);if(b==="Getter")return;WordEditor.Extension.$B.$64g()};WordEditor.Extension.$B.$vM=function(b,c,d){var a={MethodName:b,BlobSize:d,Latency:c};Diag.$2.$9(17576160,369,50,"{0}",a)};WordEditor.Extension.$B.$Qn=function(a){return+new Date-a};WordEditor.Extension.$B.$Cu=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException);};WordEditor.Extension.$B.$8U=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);};WordEditor.Extension.$B.$J3=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException("NotImplemented",WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotImplemented);};WordEditor.Extension.$B.$64g=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException("NotSupported",WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotSupported);};WordEditor.Extension.$B.$t2=function(){return Common.$0.$o.$1A("WordEditorExtensionWave2RichAPIIsEnabled")};WordEditor.Extension.$B.$28o=function(b){var a=b||"";a=a.replace(new RegExp("\\r","g"),"\\r");a=a.replace(new RegExp("\\n","g"),"\\n");a=a.replace(new RegExp("\\v","g"),"\\v");return a};WordEditor.Extension.TypeRegister=function(){};WordEditor.Extension.TypeRegister.registerTypes=function(d){var a,b,c;a=d.addType("Microsoft.WordServices.Body","{5516bb1d-cf31-4aa9-97cd-ccebc2ee9e6d}","");c=a.addProperty("ContentControls",3,"Microsoft.WordServices.ContentControlCollection",3,true);c=a.addProperty("Font",5,"Microsoft.WordServices.Font",3,true);c=a.addProperty("InlinePictures",7,"Microsoft.WordServices.InlinePictureCollection",3,true);c=a.addProperty("Paragraphs",2,"Microsoft.WordServices.ParagraphCollection",3,true);c=a.addProperty("ParentContentControl",4,"Microsoft.WordServices.ContentControl",3,true);c=a.addProperty("Style",6,"String",1,false);c=a.addProperty("Text",8,"String",1,true);c=a.addProperty("_ReferenceId",1,"String",1,true);b=a.addMethod("Clear",1011,"Void",0,0,"Clear");b=a.addMethod("GetHtml",1013,"String",1,1,"Html");b=a.addMethod("GetOoxml",1014,"String",1,1,"Ooxml");b=a.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak");b.addParameter("breakType","Microsoft.WordServices.BreakType",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertContentControl",1007,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl");b=a.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64");b.addParameter("base64File","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",3,0,"InsertHtml");b.addParameter("html","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertInlinePictureFromBase64",1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64");b.addParameter("base64EncodedImage","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml");b.addParameter("ooxml","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertParagraph",1006,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph");b.addParameter("paragraphText","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText");b.addParameter("text","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("Search",1012,"Microsoft.WordServices.SearchResultCollection",3,1,"Search");b.addParameter("searchText","String",1);b.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3);b=a.addMethod("Select",1015,"Void",0,1,"Select");b.addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1);b=a.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference");b=a.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess");a=d.addType("Microsoft.WordServices.ContentControl","{b86e5ae1-476e-4e56-825d-885468e549f3}","");c=a.addProperty("Appearance",7,"Microsoft.WordServices.ContentControlAppearance",1,false);c=a.addProperty("CannotDelete",10,"Boolean",1,false);c=a.addProperty("CannotEdit",11,"Boolean",1,false);c=a.addProperty("Color",8,"String",1,false);c=a.addProperty("ContentControls",15,"Microsoft.WordServices.ContentControlCollection",3,true);c=a.addProperty("Font",12,"Microsoft.WordServices.Font",3,true);c=a.addProperty("Id",1,"UInt32",1,true);c=a.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",3,true);c=a.addProperty("Paragraphs",14,"Microsoft.WordServices.ParagraphCollection",3,true);c=a.addProperty("ParentContentControl",16,"Microsoft.WordServices.ContentControl",3,true);c=a.addProperty("PlaceholderText",5,"String",1,false);c=a.addProperty("RemoveWhenEdited",9,"Boolean",1,false);c=a.addProperty("Style",13,"String",1,false);c=a.addProperty("Tag",4,"String",1,false);c=a.addProperty("Text",18,"String",1,true);c=a.addProperty("Title",3,"String",1,false);c=a.addProperty("Type",6,"Microsoft.WordServices.ContentControlType",1,true);c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addMethod("Clear",1010,"Void",0,0,"Clear");b=a.addMethod("Delete",1011,"Void",0,0,"Delete");b.addParameter("keepContent","Boolean",1);b=a.addMethod("GetHtml",1013,"String",1,1,"Html");b=a.addMethod("GetOoxml",1014,"String",1,1,"Ooxml");b=a.addMethod("InsertBreak",1008,"Void",0,0,"InsertBreak");b.addParameter("breakType","Microsoft.WordServices.BreakType",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertFileFromBase64",1006,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64");b.addParameter("base64File","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",3,0,"InsertHtml");b.addParameter("html","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertInlinePictureFromBase64",1009,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64");b.addParameter("base64EncodedImage","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml");b.addParameter("ooxml","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertParagraph",1007,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph");b.addParameter("paragraphText","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText");b.addParameter("text","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("Search",1015,"Microsoft.WordServices.SearchResultCollection",3,1,"Search");b.addParameter("searchText","String",1);b.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3);b=a.addMethod("Select",1012,"Void",0,1,"Select");b.addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1);b=a.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference");b=a.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess");a=d.addType("Microsoft.WordServices.ContentControlCollection","{a6a87ba8-6037-4625-ba4b-ece14e708219}","");c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addMethod("GetById",1002,"Microsoft.WordServices.ContentControl",3,1,"ById");b.addParameter("id","Int32",1);b=a.addMethod("GetByTag",1004,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTag");b.addParameter("tag","String",1);b=a.addMethod("GetByTitle",1003,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTitle");b.addParameter("title","String",1);b=a.addIndexerMethod(1,"Microsoft.WordServices.ContentControl",3);b.addParameter("index","Object",1);b=a.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference");a.setCollectionInfo("Microsoft.WordServices.ContentControl",true);a=d.addType("Microsoft.WordServices.Document","{1fd33ae5-86f2-4770-95f1-8bba5b1dce15}","");c=a.addProperty("Body",3,"Microsoft.WordServices.Body",3,true);c=a.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,true);c=a.addProperty("Saved",1,"Boolean",1,true);c=a.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,true);b=a.addMethod("GetSelection",1006,"Microsoft.WordServices.Range",3,1,"Selection");b=a.addMethod("Save",1005,"Void",0,0,"Save");b=a.addMethod("_GetObjectByReferenceId",1001,"Object",1,1,"_GetObjectByReferenceId");b.addParameter("referenceId","String",1);b=a.addMethod("_GetObjectTypeNameByReferenceId",1002,"String",1,1,"_GetObjectTypeNameByReferenceId");b.addParameter("referenceId","String",1);b=a.addMethod("_RemoveAllReferences",1004,"Void",0,1,"_RemoveAllReferences");b=a.addMethod("_RemoveReference",1003,"Void",0,1,"_RemoveReference");b.addParameter("referenceId","String",1);a=d.addType("Microsoft.WordServices.Font","{896a961f-e647-4b59-82da-5f1143b5afc1}","");c=a.addProperty("Bold",4,"Boolean",1,false);c=a.addProperty("Color",6,"String",1,false);c=a.addProperty("DoubleStrikeThrough",11,"Boolean",1,false);c=a.addProperty("HighlightColor",12,"String",1,false);c=a.addProperty("Italic",5,"Boolean",1,false);c=a.addProperty("Name",2,"String",1,false);c=a.addProperty("Size",3,"Single",1,false);c=a.addProperty("StrikeThrough",10,"Boolean",1,false);c=a.addProperty("Subscript",8,"Boolean",1,false);c=a.addProperty("Superscript",9,"Boolean",1,false);c=a.addProperty("Underline",7,"Microsoft.WordServices.UnderlineType",1,false);c=a.addProperty("_ReferenceId",1,"String",1,true);b=a.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference");b=a.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess");a=d.addType("Microsoft.WordServices.InlinePicture","{ef524552-be9e-413b-8030-e5eb3db24f19}","");c=a.addProperty("AltTextDescription",3,"String",1,false);c=a.addProperty("AltTextTitle",4,"String",1,false);c=a.addProperty("Height",5,"Single",1,false);c=a.addProperty("Hyperlink",6,"String",1,false);c=a.addProperty("LockAspectRatio",7,"Boolean",1,false);c=a.addProperty("Paragraph",10,"Microsoft.WordServices.Paragraph",3,true);c=a.addProperty("ParentContentControl",9,"Microsoft.WordServices.ContentControl",3,true);c=a.addProperty("Width",8,"Single",1,false);c=a.addProperty("_Id",1,"Int32",1,true);c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addMethod("Delete",1012,"Void",0,0,"Delete");b=a.addMethod("GetBase64ImageSrc",1003,"String",1,1,"Base64ImageSrc");b=a.addMethod("InsertBreak",1006,"Void",0,0,"InsertBreak");b.addParameter("breakType","Microsoft.WordServices.BreakType",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl");b=a.addMethod("InsertFileFromBase64",1011,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64");b.addParameter("base64File","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertHtml",1008,"Microsoft.WordServices.Range",3,0,"InsertHtml");b.addParameter("html","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertInlinePictureFromBase64",1005,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64");b.addParameter("base64EncodedImage","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertOoxml",1009,"Microsoft.WordServices.Range",3,0,"InsertOoxml");b.addParameter("ooxml","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertParagraph",1010,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph");b.addParameter("paragraphText","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertText",1007,"Microsoft.WordServices.Range",3,0,"InsertText");b.addParameter("text","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("Select",1013,"Void",0,1,"Select");b.addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1);b=a.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference");b=a.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess");a=d.addType("Microsoft.WordServices.InlinePictureCollection","{ea74232b-e74b-4a8b-9d30-04d181c29cfa}","");c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addIndexerMethod(1,"Microsoft.WordServices.InlinePicture",3);b.addParameter("index","Object",1);b=a.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference");a.setCollectionInfo("Microsoft.WordServices.InlinePicture",true);a=d.addType("Microsoft.WordServices.Paragraph","{d0c9772c-becf-4961-a582-8024ebdc614c}","");c=a.addProperty("Alignment",7,"Microsoft.WordServices.Alignment",1,false);c=a.addProperty("ContentControls",5,"Microsoft.WordServices.ContentControlCollection",3,true);c=a.addProperty("FirstLineIndent",8,"Single",1,false);c=a.addProperty("Font",3,"Microsoft.WordServices.Font",3,true);c=a.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",3,true);c=a.addProperty("LeftIndent",9,"Single",1,false);c=a.addProperty("LineSpacing",11,"Single",1,false);c=a.addProperty("LineUnitAfter",16,"Single",1,false);c=a.addProperty("LineUnitBefore",15,"Single",1,false);c=a.addProperty("OutlineLevel",12,"Int32",1,false);c=a.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,true);c=a.addProperty("RightIndent",10,"Single",1,false);c=a.addProperty("SpaceAfter",14,"Single",1,false);c=a.addProperty("SpaceBefore",13,"Single",1,false);c=a.addProperty("Style",4,"String",1,false);c=a.addProperty("Text",18,"String",1,true);c=a.addProperty("_Id",1,"Int32",1,true);c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addMethod("Clear",1011,"Void",0,0,"Clear");b=a.addMethod("Delete",1012,"Void",0,0,"Delete");b=a.addMethod("GetHtml",1014,"String",1,1,"Html");b=a.addMethod("GetOoxml",1015,"String",1,1,"Ooxml");b=a.addMethod("InsertBreak",1010,"Void",0,0,"InsertBreak");b.addParameter("breakType","Microsoft.WordServices.BreakType",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl");b=a.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64");b.addParameter("base64File","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertHtml",1006,"Microsoft.WordServices.Range",3,0,"InsertHtml");b.addParameter("html","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertInlinePictureFromBase64",1003,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64");b.addParameter("base64EncodedImage","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertOoxml",1007,"Microsoft.WordServices.Range",3,0,"InsertOoxml");b.addParameter("ooxml","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertParagraph",1009,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph");b.addParameter("paragraphText","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertText",1005,"Microsoft.WordServices.Range",3,0,"InsertText");b.addParameter("text","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("Search",1016,"Microsoft.WordServices.SearchResultCollection",3,1,"Search");b.addParameter("searchText","String",1);b.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3);b=a.addMethod("Select",1013,"Void",0,1,"Select");b.addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1);b=a.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference");b=a.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess");a=d.addType("Microsoft.WordServices.ParagraphCollection","{20a0d5b4-fb08-460c-96aa-6af4afe8f1ba}","");c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addIndexerMethod(1,"Microsoft.WordServices.Paragraph",3);b.addParameter("index","Object",1);b=a.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference");a.setCollectionInfo("Microsoft.WordServices.Paragraph",true);a=d.addType("Microsoft.WordServices.Range","{4869fd78-c024-4e18-9405-ffa60e9bfd50}","");c=a.addProperty("ContentControls",6,"Microsoft.WordServices.ContentControlCollection",3,true);c=a.addProperty("Font",3,"Microsoft.WordServices.Font",3,true);c=a.addProperty("InlinePictures",8,"Microsoft.WordServices.InlinePictureCollection",3,true);c=a.addProperty("Paragraphs",5,"Microsoft.WordServices.ParagraphCollection",3,true);c=a.addProperty("ParentContentControl",7,"Microsoft.WordServices.ContentControl",3,true);c=a.addProperty("Style",4,"String",1,false);c=a.addProperty("Text",9,"String",1,true);c=a.addProperty("_Id",1,"Int32",1,true);c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addMethod("Clear",1011,"Void",0,0,"Clear");b=a.addMethod("Delete",1012,"Void",0,0,"Delete");b=a.addMethod("GetHtml",1014,"String",1,1,"Html");b=a.addMethod("GetOoxml",1015,"String",1,1,"Ooxml");b=a.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak");b.addParameter("breakType","Microsoft.WordServices.BreakType",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertContentControl",1003,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl");b=a.addMethod("InsertFileFromBase64",1007,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64");b.addParameter("base64File","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertHtml",1005,"Microsoft.WordServices.Range",3,0,"InsertHtml");b.addParameter("html","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertInlinePictureFromBase64",1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64");b.addParameter("base64EncodedImage","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertOoxml",1006,"Microsoft.WordServices.Range",3,0,"InsertOoxml");b.addParameter("ooxml","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertParagraph",1008,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph");b.addParameter("paragraphText","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("InsertText",1004,"Microsoft.WordServices.Range",3,0,"InsertText");b.addParameter("text","String",1);b.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1);b=a.addMethod("Search",1016,"Microsoft.WordServices.SearchResultCollection",3,1,"Search");b.addParameter("searchText","String",1);b.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3);b=a.addMethod("Select",1013,"Void",0,1,"Select");b.addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1);b=a.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference");b=a.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess");a=d.addType("Microsoft.WordServices.SearchOptions","{957e194f-14af-462d-bd95-e29a55de3b4a}","{88b0a400-950b-42b1-b183-258f504bf71f}");c=a.addProperty("IgnorePunct",1,"Boolean",1,false);c=a.addProperty("IgnoreSpace",2,"Boolean",1,false);c=a.addProperty("MatchCase",3,"Boolean",1,false);c=a.addProperty("MatchPrefix",4,"Boolean",1,false);c=a.addProperty("MatchSoundsLike",5,"Boolean",1,false);c=a.addProperty("MatchSuffix",6,"Boolean",1,false);c=a.addProperty("MatchWholeWord",8,"Boolean",1,false);c=a.addProperty("MatchWildcards",7,"Boolean",1,false);a=d.addType("Microsoft.WordServices.SearchResultCollection","{c6bb20f6-7430-4d8e-b18b-49cf772f53a8}","");c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addIndexerMethod(1,"Microsoft.WordServices.Range",3);b.addParameter("index","Object",1);b=a.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference");a.setCollectionInfo("Microsoft.WordServices.Range",true);a=d.addType("Microsoft.WordServices.Section","{a9d1403c-908b-4178-aa45-6b406aeb8cbf}","");c=a.addProperty("Body",3,"Microsoft.WordServices.Body",3,true);c=a.addProperty("_Id",1,"Int32",1,true);c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addMethod("GetFooter",1004,"Microsoft.WordServices.Body",3,1,"Footer");b.addParameter("type","Microsoft.WordServices.HeaderFooterType",1);b=a.addMethod("GetHeader",1003,"Microsoft.WordServices.Body",3,1,"Header");b.addParameter("type","Microsoft.WordServices.HeaderFooterType",1);b=a.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference");b=a.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess");a=d.addType("Microsoft.WordServices.SectionCollection","{23ef4423-1c46-48ee-951a-cec1d21d3a5b}","");c=a.addProperty("_ReferenceId",2,"String",1,true);b=a.addIndexerMethod(1,"Microsoft.WordServices.Section",3);b.addParameter("index","Object",1);b=a.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference");a.setCollectionInfo("Microsoft.WordServices.Section",true);a=d.addEnumType("Microsoft.WordServices.ContentControlType");a.addEnumField("RichText",0);a=d.addEnumType("Microsoft.WordServices.ContentControlAppearance");a.addEnumField("BoundingBox",0);a.addEnumField("Tags",1);a.addEnumField("Hidden",2);a=d.addEnumType("Microsoft.WordServices.UnderlineType");a.addEnumField("None",0);a.addEnumField("Single",1);a.addEnumField("Word",2);a.addEnumField("Double",3);a.addEnumField("Dotted",4);a.addEnumField("Hidden",5);a.addEnumField("Thick",6);a.addEnumField("DashLine",7);a.addEnumField("DotLine",8);a.addEnumField("DotDashLine",9);a.addEnumField("TwoDotDashLine",10);a.addEnumField("Wave",11);a=d.addEnumType("Microsoft.WordServices.BreakType");a.addEnumField("Page",0);a.addEnumField("Column",1);a.addEnumField("Next",2);a.addEnumField("SectionContinuous",3);a.addEnumField("SectionEven",4);a.addEnumField("SectionOdd",5);a.addEnumField("Line",6);a.addEnumField("LineClearLeft",9);a.addEnumField("LineClearRight",10);a.addEnumField("TextWrapping",11);a=d.addEnumType("Microsoft.WordServices.InsertLocation");a.addEnumField("Before",0);a.addEnumField("After",1);a.addEnumField("Start",2);a.addEnumField("End",3);a.addEnumField("Replace",4);a=d.addEnumType("Microsoft.WordServices.Alignment");a.addEnumField("Unknown",-1);a.addEnumField("Left",0);a.addEnumField("Centered",1);a.addEnumField("Right",2);a.addEnumField("Justified",3);a=d.addEnumType("Microsoft.WordServices.HeaderFooterType");a.addEnumField("Primary",0);a.addEnumField("FirstPage",1);a.addEnumField("EvenPages",2);a=d.addEnumType("Microsoft.WordServices.SelectionMode");a.addEnumField("Select",0);a.addEnumField("Start",1);a.addEnumField("End",2)};WordEditor.Extension.$ql.registerClass("WordEditor.Extension.$ql");WordEditor.Extension.Body.registerClass("WordEditor.Extension.Body",WordEditor.Extension.$ql,WordEditor.Extension.$qH);WordEditor.Extension.$IC.registerClass("WordEditor.Extension.$IC",null,WordEditor.Extension.$Cx.$$(WordEditor.Extension.Body,Box4.$1r));WordEditor.Extension.ContentControl.registerClass("WordEditor.Extension.ContentControl",WordEditor.Extension.$ql,WordEditor.Extension.$qH);WordEditor.Extension.ContentControlCollection.registerClass("WordEditor.Extension.ContentControlCollection",WordEditor.Extension.$ql,WordEditor.Extension.$qH,WordEditor.Extension.$av.$$(WordEditor.Extension.ContentControl));WordEditor.Extension.$BE.registerClass("WordEditor.Extension.$BE",null,WordEditor.Extension.$Cx.$$(WordEditor.Extension.ContentControl,WordEditor.$8O));WordEditor.Extension.$Cs.registerClass("WordEditor.Extension.$Cs",null,WordEditor.Extension.$az);WordEditor.Extension.Document.registerClass("WordEditor.Extension.Document");WordEditor.Extension.$ZC.registerClass("WordEditor.Extension.$ZC",B4S.$qo);WordEditor.Extension.$LP.registerClass("WordEditor.Extension.$LP");WordEditor.Extension.$ZD.registerClass("WordEditor.Extension.$ZD",B4S.$qp);WordEditor.Extension.$ZE.registerClass("WordEditor.Extension.$ZE",B4S.$qq);WordEditor.Extension.$IV.registerClass("WordEditor.Extension.$IV");WordEditor.Extension.$ZG.registerClass("WordEditor.Extension.$ZG",null,Common.App.$jx,Common.Utils.$l6);WordEditor.Extension.$IX.registerClass("WordEditor.Extension.$IX",null,WordEditor.Extension.$Io);WordEditor.Extension.Font.registerClass("WordEditor.Extension.Font",WordEditor.Extension.$ql,WordEditor.Extension.$qH);WordEditor.Extension.$F6.registerClass("WordEditor.Extension.$F6",null,WordEditor.Extension.$Cx.$$(WordEditor.Extension.Font,$$sc.$F.$$(Box4.$P)));WordEditor.Extension.$Rx.registerClass("WordEditor.Extension.$Rx",null,WordEditor.Extension.$FI);WordEditor.Extension.$ZF.registerClass("WordEditor.Extension.$ZF",B4Ac.$71);WordEditor.Extension.$LQ.registerClass("WordEditor.Extension.$LQ");WordEditor.Extension.InlinePicture.registerClass("WordEditor.Extension.InlinePicture",WordEditor.Extension.$ql,WordEditor.Extension.$qH);WordEditor.Extension.InlinePictureCollection.registerClass("WordEditor.Extension.InlinePictureCollection",WordEditor.Extension.$ql,WordEditor.Extension.$qH,WordEditor.Extension.$av.$$(WordEditor.Extension.InlinePicture));WordEditor.Extension.$FM.registerClass("WordEditor.Extension.$FM",null,WordEditor.Extension.$Cx.$$(WordEditor.Extension.InlinePicture,Box4.$P));WordEditor.Extension.$S2.registerClass("WordEditor.Extension.$S2",null,WordEditor.Extension.$Dp);WordEditor.Extension.$63.registerClass("WordEditor.Extension.$63");WordEditor.Extension.Paragraph.registerClass("WordEditor.Extension.Paragraph",WordEditor.Extension.$ql,WordEditor.Extension.$qH);WordEditor.Extension.ParagraphCollection.registerClass("WordEditor.Extension.ParagraphCollection",WordEditor.Extension.$ql,WordEditor.Extension.$qH,WordEditor.Extension.$av.$$(WordEditor.Extension.Paragraph));WordEditor.Extension.$HD.registerClass("WordEditor.Extension.$HD",null,WordEditor.Extension.$Cx.$$(WordEditor.Extension.Paragraph,Box4.$1r));WordEditor.Extension.Range.registerClass("WordEditor.Extension.Range",WordEditor.Extension.$ql,WordEditor.Extension.$qH);WordEditor.Extension.$HI.registerClass("WordEditor.Extension.$HI",null,WordEditor.Extension.$Cx.$$(WordEditor.Extension.Range,$$sc.$F.$$(Box4.$P)));WordEditor.Extension.$Nl.registerClass("WordEditor.Extension.$Nl");WordEditor.Extension.$Ls.registerClass("WordEditor.Extension.$Ls",null,WordEditor.Extension.$bQ);WordEditor.Extension.$fj.registerClass("WordEditor.Extension.$fj",null,OfficeExtension.WacRuntime.IRichApiHost);WordEditor.Extension.$Fm.registerClass("WordEditor.Extension.$Fm",null,WordEditor.Extension.$c9);WordEditor.Extension.SearchOptions.registerClass("WordEditor.Extension.SearchOptions");WordEditor.Extension.SearchResultCollection.registerClass("WordEditor.Extension.SearchResultCollection",WordEditor.Extension.$ql,WordEditor.Extension.$qH,WordEditor.Extension.$av.$$(WordEditor.Extension.Range));WordEditor.Extension.Section.registerClass("WordEditor.Extension.Section",WordEditor.Extension.$ql,WordEditor.Extension.$qH);WordEditor.Extension.SectionCollection.registerClass("WordEditor.Extension.SectionCollection",WordEditor.Extension.$ql,WordEditor.Extension.$qH,WordEditor.Extension.$av.$$(WordEditor.Extension.Section));WordEditor.Extension.$O4.registerClass("WordEditor.Extension.$O4",null,WordEditor.Extension.$Cx.$$(WordEditor.Extension.Section,Box4.$1r));WordEditor.Extension.$U3.registerClass("WordEditor.Extension.$U3",null,WordEditor.Extension.$FO);WordEditor.Extension.$UL.registerClass("WordEditor.Extension.$UL",null,WordEditor.Extension.$Gt);WordEditor.Extension.$B.registerClass("WordEditor.Extension.$B");WordEditor.Extension.TypeRegister.registerClass("WordEditor.Extension.TypeRegister");WordEditor.Extension.$63.$T=null;WordEditor.Extension.$B.$1mn="\r";WordEditor.Extension.$ZG.$5Sr();var __extends=this.__extends||function(b,a){for(var c in a)if(a.hasOwnProperty(c))b[c]=a[c];function d(){this.constructor=b}d.prototype=a.prototype;b.prototype=new d},definePropertySave,isDefinePropertySupported=false;try{Object.defineProperty({},"myTestProperty",{"get":function(){return this.desc},"set":function(a){this.desc=a}});isDefinePropertySupported=true}catch(e){definePropertySave=Object.defineProperty;Object.defineProperty=function(){}}var OfficeExt;(function(b){var a=function(){var c=null,a=true;function b(){}b.prototype.isMsAjaxLoaded=function(){var b="function",c="undefined";return typeof Sys!==c&&typeof Type!==c&&Sys.StringBuilder&&typeof Sys.StringBuilder===b&&Type.registerNamespace&&typeof Type.registerNamespace===b&&Type.registerClass&&typeof Type.registerClass===b&&typeof Function._validateParams===b?a:false};b.prototype.loadMsAjaxFull=function(b){var a=(window.location.protocol.toLowerCase()==="https:"?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";OSF.OUtil.loadScript(a,b)};Object.defineProperty(b.prototype,"msAjaxError",{"get":function(){var a=this;if(a._msAjaxError==c&&a.isMsAjaxLoaded())a._msAjaxError=Error;return a._msAjaxError},"set":function(a){this._msAjaxError=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,"msAjaxSerializer",{"get":function(){var a=this;if(a._msAjaxSerializer==c&&a.isMsAjaxLoaded())a._msAjaxSerializer=Sys.Serialization.JavaScriptSerializer;return a._msAjaxSerializer},"set":function(a){this._msAjaxSerializer=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,"msAjaxString",{"get":function(){var a=this;if(a._msAjaxString==c&&a.isMsAjaxLoaded())a._msAjaxSerializer=String;return a._msAjaxString},"set":function(a){this._msAjaxString=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,"msAjaxDebug",{"get":function(){var a=this;if(a._msAjaxDebug==c&&a.isMsAjaxLoaded())a._msAjaxDebug=Sys.Debug;return a._msAjaxDebug},"set":function(a){this._msAjaxDebug=a},enumerable:a,configurable:a});return b}();b.MicrosoftAjaxFactory=a})(OfficeExt||(OfficeExt={}));var OsfMsAjaxFactory=new OfficeExt.MicrosoftAjaxFactory,OSF=OSF||{},OfficeExt;(function(b){var a=function(){function a(a){this._internalStorage=a}a.prototype.getItem=function(a){try{return this._internalStorage&&this._internalStorage.getItem(a)}catch(b){return null}};a.prototype.setItem=function(b,a){try{this._internalStorage&&this._internalStorage.setItem(b,a)}catch(c){}};a.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(a){}};a.prototype.removeItem=function(a){try{this._internalStorage&&this._internalStorage.removeItem(a)}catch(b){}};a.prototype.getKeysWithPrefix=function(d){var b=[];try{for(var e=this._internalStorage&&this._internalStorage.length||0,a=0;a<e;a++){var c=this._internalStorage.key(a);c.indexOf(d)===0&&b.push(c)}}catch(f){}return b};return a}();b.SafeStorage=a})(OfficeExt||(OfficeExt={}));OSF.OUtil=function(){var f="on",o="configurable",n="writable",e="enumerable",g="undefined",c=true,a=false,h=2147483647,b=null,m=-1,s="&_xdm_Info=",p="&_serializer_version=",q="_xdm_",v="_serializer_version=",j="#",l={},u=3e4,i=b,k=b,d=+new Date;function t(){var a=h*Math.random();a^=d^(new Date).getMilliseconds()<<Math.floor(Math.random()*(31-10));return a.toString(16)}function r(){if(!i){try{var a=window.sessionStorage}catch(c){a=b}i=new OfficeExt.SafeStorage(a)}return i}return{set_entropy:function(a){if(typeof a=="string")for(var b=0;b<a.length;b+=4){for(var e=0,c=0;c<4&&b+c<a.length;c++)e=(e<<8)+a.charCodeAt(b+c);d^=e}else if(typeof a=="number")d^=a;else d^=h*Math.random();d&=h},extend:function(b,a){var c=function(){};c.prototype=a.prototype;b.prototype=new c;b.prototype.constructor=b;b.uber=a.prototype;if(a.prototype.constructor===Object.prototype.constructor)a.prototype.constructor=a},setNamespace:function(b,a){if(a&&b&&!a[b])a[b]={}},unsetNamespace:function(b,a){if(a&&b&&a[b])delete a[b]},loadScript:function(f,g,h){if(f&&g){var k=window.document,d=l[f];if(!d){var e=k.createElement("script");e.type="text/javascript";d={loaded:a,pendingCallbacks:[g],timer:b};l[f]=d;var i=function(){if(d.timer!=b){clearTimeout(d.timer);delete d.timer}d.loaded=c;for(var e=d.pendingCallbacks.length,a=0;a<e;a++){var f=d.pendingCallbacks.shift();f()}},j=function(){delete l[f];if(d.timer!=b){clearTimeout(d.timer);delete d.timer}for(var c=d.pendingCallbacks.length,a=0;a<c;a++){var e=d.pendingCallbacks.shift();e()}};if(e.readyState)e.onreadystatechange=function(){if(e.readyState=="loaded"||e.readyState=="complete"){e.onreadystatechange=b;i()}};else e.onload=i;e.onerror=j;h=h||u;d.timer=setTimeout(j,h);e.src=f;k.getElementsByTagName("head")[0].appendChild(e)}else if(d.loaded)g();else d.pendingCallbacks.push(g)}},loadCSS:function(c){if(c){var b=window.document,a=b.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=c;b.getElementsByTagName("head")[0].appendChild(a)}},parseEnum:function(b,c){var a=c[b.trim()];if(typeof a==g){OsfMsAjaxFactory.msAjaxDebug.trace("invalid enumeration string:"+b);throw OsfMsAjaxFactory.msAjaxError.argument("str");}return a},delayExecutionAndCache:function(){var a={calc:arguments[0]};return function(){if(a.calc){a.val=a.calc.apply(this,arguments);delete a.calc}return a.val}},getUniqueId:function(){m=m+1;return m.toString()},formatString:function(){var a=arguments,b=a[0];return b.replace(/{(\d+)}/gm,function(d,b){var c=parseInt(b,10)+1;return a[c]===undefined?"{"+b+"}":a[c]})},generateConversationId:function(){return[t(),t(),(+new Date).toString()].join("_")},getFrameNameAndConversationId:function(b,c){var a=q+b+this.generateConversationId();c.setAttribute("name",a);return this.generateConversationId()},addXdmInfoAsHash:function(b,a){return OSF.OUtil.addInfoAsHash(b,s,a)},addSerializerVersionAsHash:function(b,a){return OSF.OUtil.addInfoAsHash(b,p,a)},addInfoAsHash:function(a,f,d){a=a.trim()||"";var b=a.split(j),c=b.shift(),e=b.join(j);return[c,j,e,f,d].join("")},parseXdmInfo:function(a){return OSF.OUtil.parseXdmInfoWithGivenFragment(a,window.location.hash)},parseXdmInfoWithGivenFragment:function(a,b){return OSF.OUtil.parseInfoWithGivenFragment(s,q,a,b)},parseSerializerVersion:function(a){return OSF.OUtil.parseSerializerVersionWithGivenFragment(a,window.location.hash)},parseSerializerVersionWithGivenFragment:function(a,b){return parseInt(OSF.OUtil.parseInfoWithGivenFragment(p,v,a,b))},parseInfoWithGivenFragment:function(k,i,h,j){var e=j.split(k),a=e.length>1?e[e.length-1]:b,c=r();if(!h&&c){var d=window.name.indexOf(i);if(d>-1){var f=window.name.indexOf(";",d);if(f==-1)f=window.name.length;var g=window.name.substring(d,f);if(a)c.setItem(g,a);else a=c.getItem(g)}}return a},getConversationId:function(){var c=window.location.search,a=b;if(c){var d=c.indexOf("&");a=d>0?c.substring(1,d):c.substr(1);if(a&&a.charAt(a.length-1)==="="){a=a.substring(0,a.length-1);if(a)a=decodeURIComponent(a)}}return a},getInfoItems:function(b){var a=b.split("$");if(typeof a[1]==g)a=b.split("|");return a},getConversationUrl:function(){var b="",d=OSF.OUtil.parseXdmInfo(c);if(d){var a=OSF.OUtil.getInfoItems(d);if(a!=undefined&&a.length>=3)b=a[2]}return b},validateParamObject:function(f,e){var b=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:a},{name:"expectedProperties",type:Object,mayBeNull:a},{name:"callback",type:Function,mayBeNull:c}]);if(b)throw b;for(var d in e){b=Function._validateParameter(f[d],e[d],d);if(b)throw b;}},writeProfilerMark:function(a){if(window.msWriteProfilerMark){window.msWriteProfilerMark(a);OsfMsAjaxFactory.msAjaxDebug.trace(a)}},outputDebug:function(a){typeof Sys!==g&&Sys&&Sys.Debug&&OsfMsAjaxFactory.msAjaxDebug.trace(a)},defineNondefaultProperty:function(e,f,a,b){a=a||{};for(var g in b){var d=b[g];if(a[d]==undefined)a[d]=c}Object.defineProperty(e,f,a);return e},defineNondefaultProperties:function(c,a,d){a=a||{};for(var b in a)OSF.OUtil.defineNondefaultProperty(c,b,a[b],d);return c},defineEnumerableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,[e])},defineEnumerableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,[e])},defineMutableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,[n,e,o])},defineMutableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,[n,e,o])},finalizeProperties:function(e,d){d=d||{};for(var g=Object.getOwnPropertyNames(e),i=g.length,f=0;f<i;f++){var h=g[f],b=Object.getOwnPropertyDescriptor(e,h);if(!b.get&&!b.set)b.writable=d.writable||a;b.configurable=d.configurable||a;b.enumerable=d.enumerable||c;Object.defineProperty(e,h,b)}return e},mapList:function(a,c){var b=[];if(a)for(var d in a)b.push(c(a[d]));return b},listContainsKey:function(d,e){for(var b in d)if(e==b)return c;return a},listContainsValue:function(b,d){for(var e in b)if(d==b[e])return c;return a},augmentList:function(a,b){var d=a.push?function(c,b){a.push(b)}:function(c,b){a[c]=b};for(var c in b)d(c,b[c])},redefineList:function(a,b){for(var d in a)delete a[d];for(var c in b)a[c]=b[c]},isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},isFunction:function(a){return Object.prototype.toString.apply(a)==="[object Function]"},isDate:function(a){return Object.prototype.toString.apply(a)==="[object Date]"},addEventListener:function(b,c,d){if(b.addEventListener)b.addEventListener(c,d,a);else if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&b.attachEvent)b.attachEvent(f+c,d);else b[f+c]=d},removeEventListener:function(c,d,e){if(c.removeEventListener)c.removeEventListener(d,e,a);else if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&c.detachEvent)c.detachEvent(f+d,e);else c[f+d]=b},getCookieValue:function(b){var a=RegExp(b+"[^;]+").exec(document.cookie);return a.toString().replace(/^[^=]+./,"")},xhrGet:function(e,d,b){var a;try{a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200)d(a.responseText);else b(a.status)};a.open("GET",e,c);a.send()}catch(f){b(f)}},xhrGetFull:function(g,e,f,b){var a,d=e;try{a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200)f(a,d);else b(a.status)};a.open("GET",g,c);a.send()}catch(h){b(h)}},encodeBase64:function(c){if(!c)return c;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=[],b=[],h=0,j,g,i,d,e,f,a,m=c.length;do{j=c.charCodeAt(h++);g=c.charCodeAt(h++);i=c.charCodeAt(h++);a=0;d=j&255;e=j>>8;f=g&255;b[a++]=d>>2;b[a++]=(d&3)<<4|e>>4;b[a++]=(e&15)<<2|f>>6;b[a++]=f&63;if(!isNaN(g)){d=g>>8;e=i&255;f=i>>8;b[a++]=d>>2;b[a++]=(d&3)<<4|e>>4;b[a++]=(e&15)<<2|f>>6;b[a++]=f&63}if(isNaN(g))b[a-1]=64;else if(isNaN(i)){b[a-2]=64;b[a-1]=64}for(var k=0;k<a;k++)l.push(n.charAt(b[k]))}while(h<m);return l.join("")},getSessionStorage:function(){return r()},getLocalStorage:function(){if(!k){try{var a=window.localStorage}catch(c){a=b}k=new OfficeExt.SafeStorage(a)}return k},convertIntToCssHexColor:function(b){return"#"+(Number(b)+16777216).toString(16).slice(-6)},attachClickHandler:function(a,b){a.onclick=function(){b()};a.ontouchend=function(a){b();a.preventDefault()}},getQueryStringParamValue:function(b,d){var e=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:a},{name:"paramName",type:String,mayBeNull:a}]);if(e){OsfMsAjaxFactory.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null.");return""}var c=new RegExp("[\\?&]"+d+"=([^&#]*)","i");if(!c.test(b)){OsfMsAjaxFactory.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found.");return""}return c.exec(b)[1]},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?c:a},shallowCopy:function(a){var c=a.constructor();for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b];return c},serializeOMEXResponseErrorMessage:function(a){if(typeof JSON!==g)try{return JSON.stringify(a)}catch(b){}return""}}}();OSF.OUtil.Guid=function(){var a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var c="",d=+new Date,b=0;b<32&&d>0;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[d%16];d=Math.floor(d/16)}for(;b<32;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[Math.floor(Math.random()*16)]}return c}}}();window.OSF=OSF;var OfficeExt;(function(e){var d="\n",f=true,a=null,b="undefined",i=function(){function c(){}c.isInstanceOfType=function(e,d){if(typeof d===b||d===a)return false;if(d instanceof e)return f;var c=d.constructor;if(!c||typeof c!=="function"||c.__typeName==="Object")c=Object;return!!(c===e)||c.inheritsFrom&&c.inheritsFrom(e)||c.implementsInterface&&c.implementsInterface(e)};return c}();e.MsAjaxTypeHelper=i;var g=function(){var f="Parameter name: {0}";function e(){}e.create=function(c,b){var a=new Error(c);a.message=c;if(b)for(var d in b)a[d]=b[d];a.popStackFrame();return a};e.parameterCount=function(a){var c="Sys.ParameterCountException: "+(a?a:"Parameter count mismatch."),b=e.create(c,{name:"Sys.ParameterCountException"});b.popStackFrame();return b};e.argument=function(a,g){var b="Sys.ArgumentException: "+(g?g:"Value does not fall within the expected range.");if(a)b+=d+c.format(f,a);var h=e.create(b,{name:"Sys.ArgumentException",paramName:a});h.popStackFrame();return h};e.argumentNull=function(a,g){var b="Sys.ArgumentNullException: "+(g?g:"Value cannot be null.");if(a)b+=d+c.format(f,a);var h=e.create(b,{name:"Sys.ArgumentNullException",paramName:a});h.popStackFrame();return h};e.argumentOutOfRange=function(i,g,j){var h="Sys.ArgumentOutOfRangeException: "+(j?j:"Specified argument was out of the range of valid values.");if(i)h+=d+c.format(f,i);if(typeof g!==b&&g!==a)h+=d+c.format("Actual value was {0}.",g);var k=e.create(h,{name:"Sys.ArgumentOutOfRangeException",paramName:i,actualValue:g});k.popStackFrame();return k};e.argumentType=function(h,g,b,i){var a="Sys.ArgumentTypeException: ";if(i)a+=i;else if(g&&b)a+=c.format("Object of type '{0}' cannot be converted to type '{1}'.",g.getName?g.getName():g,b.getName?b.getName():b);else a+="Object cannot be converted to the required type.";if(h)a+=d+c.format(f,h);var j=e.create(a,{name:"Sys.ArgumentTypeException",paramName:h,actualType:g,expectedType:b});j.popStackFrame();return j};e.argumentUndefined=function(a,g){var b="Sys.ArgumentUndefinedException: "+(g?g:"Value cannot be undefined.");if(a)b+=d+c.format(f,a);var h=e.create(b,{name:"Sys.ArgumentUndefinedException",paramName:a});h.popStackFrame();return h};e.invalidOperation=function(a){var c="Sys.InvalidOperationException: "+(a?a:"Operation is not valid due to the current state of the object."),b=e.create(c,{name:"Sys.InvalidOperationException"});b.popStackFrame();return b};return e}();e.MsAjaxError=g;var c=function(){function a(){}a.format=function(c){for(var b=[],a=0;a<arguments.length-1;a++)b[a]=arguments[a+1];var d=c;return d.replace(/{(\d+)}/gm,function(d,a){var c=parseInt(a,10);return b[c]===undefined?"{"+a+"}":b[c]})};a.startsWith=function(b,a){return b.substr(0,a.length)===a};return a}();e.MsAjaxString=c;var h=function(){function a(){}a.trace=function(){};return a}();e.MsAjaxDebug=h;if(!OsfMsAjaxFactory.isMsAjaxLoaded()){if(!Function.createCallback)Function.createCallback=function(b,a){var c=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:f}]);if(c)throw c;return function(){var e=arguments.length;if(e>0){for(var d=[],c=0;c<e;c++)d[c]=arguments[c];d[e]=a;return b.apply(this,d)}return b.call(this,a)}};if(!Function.createDelegate)Function.createDelegate=function(b,c){var a=Function._validateParams(arguments,[{name:"instance",mayBeNull:f},{name:"method",type:Function}]);if(a)throw a;return function(){return c.apply(b,arguments)}};if(!Function._validateParams)Function._validateParams=function(i,g,e){var c,f=g.length;e=e||typeof e===b;c=Function._validateParameterCount(i,g,e);if(c){c.popStackFrame();return c}for(var d=0,k=i.length;d<k;d++){var h=g[Math.min(d,f-1)],j=h.name;if(h.parameterArray)j+="["+(d-f+1)+"]";else if(!e&&d>=f)break;c=Function._validateParameter(i[d],h,j);if(c){c.popStackFrame();return c}}return a};if(!Function._validateParameterCount)Function._validateParameterCount=function(m,e,l){var b,d,c=e.length,h=m.length;if(h<c){var i=c;for(b=0;b<c;b++){var j=e[b];if(j.optional||j.parameterArray)i--}if(h<i)d=f}else if(l&&h>c){d=f;for(b=0;b<c;b++)if(e[b].parameterArray){d=false;break}}if(d){var k=g.parameterCount();k.popStackFrame();return k}return a};if(!Function._validateParameter)Function._validateParameter=function(e,c,j){var d,i=c.type,n=!!c.integer,m=!!c.domElement,o=!!c.mayBeNull;d=Function._validateParameterType(e,i,n,m,o,j);if(d){d.popStackFrame();return d}var g=c.elementType,h=!!c.elementMayBeNull;if(i===Array&&typeof e!==b&&e!==a&&(g||!h))for(var l=!!c.elementInteger,k=!!c.elementDomElement,f=0;f<e.length;f++){var p=e[f];d=Function._validateParameterType(p,g,l,k,h,j+"["+f+"]");if(d){d.popStackFrame();return d}}return a};if(!Function._validateParameterType)Function._validateParameterType=function(d,f,j,i,h,g){var c,k;if(typeof d===b)if(h)return a;else{c=e.MsAjaxError.argumentUndefined(g);c.popStackFrame();return c}if(d===a)if(h)return a;else{c=e.MsAjaxError.argumentNull(g);c.popStackFrame();return c}if(f&&!e.MsAjaxTypeHelper.isInstanceOfType(f,d)){c=e.MsAjaxError.argumentType(g,typeof d,f);c.popStackFrame();return c}return a};if(!window.Type)window.Type=Function;if(!Type.registerNamespace)Type.registerNamespace=function(d){for(var c=d.split("."),b=window,a=0;a<c.length;a++){b[c[a]]=b[c[a]]||{};b=b[c[a]]}};if(!Type.prototype.registerClass)Type.prototype.registerClass=function(a){a={}};typeof Sys===b&&Type.registerNamespace("Sys");if(!Error.prototype.popStackFrame)Error.prototype.popStackFrame=function(){var c=this;if(arguments.length!==0)throw g.parameterCount();if(typeof c.stack===b||c.stack===a||typeof c.fileName===b||c.fileName===a||typeof c.lineNumber===b||c.lineNumber===a)return;var e=c.stack.split(d),h=e[0],j=c.fileName+":"+c.lineNumber;while(typeof h!==b&&h!==a&&h.indexOf(j)===-1){e.shift();h=e[0]}var i=e[1];if(typeof i===b||i===a)return;var f=i.match(/@(.*):(\d+)$/);if(typeof f===b||f===a)return;c.fileName=f[1];c.lineNumber=parseInt(f[2]);e.shift();c.stack=e.join(d)};OsfMsAjaxFactory.msAjaxError=g;OsfMsAjaxFactory.msAjaxString=c;OsfMsAjaxFactory.msAjaxDebug=h}})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(a){var b="undefined",c=null,d=function(){var h='["\\\\\\x00-\\x1F]',g='"',f="g";function d(){}d._init=function(){var c=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f"];d._charsToEscape[0]="\\";d._charsToEscapeRegExs["\\"]=new RegExp("\\\\",f);d._escapeChars["\\"]="\\\\";d._charsToEscape[1]=g;d._charsToEscapeRegExs[g]=new RegExp(g,f);d._escapeChars[g]='\\"';for(var a=0;a<32;a++){var b=String.fromCharCode(a);d._charsToEscape[a+2]=b;d._charsToEscapeRegExs[b]=new RegExp(b,f);d._escapeChars[b]=c[a]}};d.serialize=function(b){var a=new e;d.serializeWithBuilder(b,a,false);return a.toString()};d.deserialize=function(b,f){if(b.length===0)throw a.MsAjaxError.argument("data","Cannot deserialize empty string.");try{var e=b.replace(d._dateRegEx,"$1new Date($2)");if(f&&d._jsonRegEx.test(e.replace(d._jsonStringRegEx,"")))throw c;return eval("("+e+")")}catch(g){throw a.MsAjaxError.argument("data","Cannot deserialize. The data does not correspond to valid JSON.");}};d.serializeBooleanWithBuilder=function(b,a){a.append(b.toString())};d.serializeNumberWithBuilder=function(b,c){if(isFinite(b))c.append(String(b));else throw a.MsAjaxError.invalidOperation("Cannot serialize non finite numbers.");};d.serializeStringWithBuilder=function(a,c){c.append(g);if(d._escapeRegEx.test(a)){d._charsToEscape.length===0&&d._init();if(a.length<128)a=a.replace(d._escapeRegExGlobal,function(a){return d._escapeChars[a]});else for(var e=0;e<34;e++){var b=d._charsToEscape[e];if(a.indexOf(b)!==-1)if(navigator.userAgent.indexOf("OPR/")>-1||navigator.userAgent.indexOf("Firefox")>-1)a=a.split(b).join(d._escapeChars[b]);else a=a.replace(d._charsToEscapeRegExs[b],d._escapeChars[b])}}c.append(a);c.append(g)};d.serializeWithBuilder=function(e,c,l,f){var g;switch(typeof e){case"object":if(e){if(f){for(var m=0;m<f.length;m++)if(f[m]===e)throw a.MsAjaxError.invalidOperation("Cannot serialize object with cyclic reference within child properties.");}else f=[];try{a.MsAjaxArray.add(f,e);if(a.MsAjaxTypeHelper.isInstanceOfType(Number,e))d.serializeNumberWithBuilder(e,c);else if(a.MsAjaxTypeHelper.isInstanceOfType(Boolean,e))d.serializeBooleanWithBuilder(e,c);else if(a.MsAjaxTypeHelper.isInstanceOfType(String,e))d.serializeStringWithBuilder(e,c);else if(a.MsAjaxTypeHelper.isInstanceOfType(Array,e)){c.append("[");for(g=0;g<e.length;++g){g>0&&c.append(",");d.serializeWithBuilder(e[g],c,false,f)}c.append("]")}else{if(a.MsAjaxTypeHelper.isInstanceOfType(Date,e)){c.append('"\\/Date(');c.append(e.getTime());c.append(')\\/"');break}var h=[],i=0;for(var j in e){if(a.MsAjaxString.startsWith(j,"$"))continue;if(j===d._serverTypeFieldName&&i!==0){h[i++]=h[0];h[0]=j}else h[i++]=j}l&&h.sort();c.append("{");var n=false;for(g=0;g<i;g++){var k=e[h[g]];if(typeof k!==b&&typeof k!=="function"){if(n)c.append(",");else n=true;d.serializeWithBuilder(h[g],c,l,f);c.append(":");d.serializeWithBuilder(k,c,l,f)}}c.append("}")}}finally{a.MsAjaxArray.removeAt(f,f.length-1)}}else c.append("null");break;case"number":d.serializeNumberWithBuilder(e,c);break;case"string":d.serializeStringWithBuilder(e,c);break;case"boolean":d.serializeBooleanWithBuilder(e,c);break;default:c.append("null")}};d.__patchVersion=0;d._charsToEscapeRegExs=[];d._charsToEscape=[];d._dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',f);d._escapeChars={};d._escapeRegEx=new RegExp(h,"i");d._escapeRegExGlobal=new RegExp(h,f);d._jsonRegEx=new RegExp("[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]",f);d._jsonStringRegEx=new RegExp('"(\\\\.|[^"\\\\])*"',f);d._serverTypeFieldName="__type";return d}();a.MsAjaxJavaScriptSerializer=d;var f=function(){function a(){}a.add=function(a,b){a[a.length]=b};a.removeAt=function(a,b){a.splice(b,1)};a.clone=function(a){return a.length===1?[a[0]]:Array.apply(c,a)};a.remove=function(c,d){var b=a.indexOf(c,d);b>=0&&c.splice(b,1);return b>=0};a.indexOf=function(e,f,a){if(typeof f===b)return-1;var d=e.length;if(d!==0){a=a-0;if(isNaN(a))a=0;else{if(isFinite(a))a=a-a%1;if(a<0)a=Math.max(0,d+a)}for(var c=a;c<d;c++)if(typeof e[c]!==b&&e[c]===f)return c}return-1};return a}();a.MsAjaxArray=f;var e=function(){function a(a){this._parts=typeof a!==b&&a!==c&&a!==""?[a.toString()]:[];this._value={};this._len=0}a.prototype.append=function(a){this._parts[this._parts.length]=a};a.prototype.toString=function(a){var e=this;a=a||"";var d=e._parts;if(e._len!==d.length){e._value={};e._len=d.length}var g=e._value;if(typeof g[a]===b){if(a!=="")for(var f=0;f<d.length;)if(typeof d[f]===b||d[f]===""||d[f]===c)d.splice(f,1);else f++;g[a]=e._parts.join(a)}return g[a]};return a}();a.MsAjaxStringBuilder=e;if(!OsfMsAjaxFactory.isMsAjaxLoaded())OsfMsAjaxFactory.msAjaxSerializer=d})(OfficeExt||(OfficeExt={}));OSF.OUtil.setNamespace("Microsoft",window);OSF.OUtil.setNamespace("Office",Microsoft);OSF.OUtil.setNamespace("Common",Microsoft.Office);OSF.SerializerVersion={MsAjax:0,Browser:1};(function(a){"use strict";var j=new RegExp('"(\\\\.|[^"\\\\])*"',"g"),d=new RegExp("\\b(true|false|null)\\b","g"),h=new RegExp("-?(0|([1-9]\\d*))(\\.\\d+)?([eE][+-]?\\d+)?","g"),g=new RegExp("[^{:,\\[\\s](?=\\s*\\[)"),e=new RegExp("[^\\s\\[\\]{}:,]"),b="Cannot deserialize. The data does not correspond to valid JSON.";function k(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent&&a.attachEvent("on"+b,c)}function f(){return OsfMsAjaxFactory.msAjaxSerializer?OsfMsAjaxFactory.msAjaxSerializer:null}function i(f,k,i){var c;if(!k)return i(f);if(a.JSON&&a.JSON.parse)return a.JSON.parse(f);c=f.replace(j,"[]");c=c.replace(d,"[]");c=c.replace(h,"[]");if(g.test(c))throw b;if(e.test(c))throw b;try{eval("("+f+")")}catch(l){throw b;}}function c(){var a=f(),b;if(a===null||typeof a.deserialize!=="function")return false;if(a.__patchVersion>=1)return true;b=a.deserialize;a.deserialize=function(a){return i(a,true,b)};a.__patchVersion=1;return true}!c()&&k(a,"load",function(){c()})})(window);Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5};Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6};Microsoft.Office.Common.MessageType={request:0,response:1};Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2};Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1};Microsoft.Office.Common.MethodObject=function(c,b,a){this._method=c;this._invokeType=b;this._blockingOthers=a};Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}};Microsoft.Office.Common.EventMethodObject=function(b,a){this._registerMethodObject=b;this._unregisterMethodObject=a};Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}};Microsoft.Office.Common.ServiceEndPoint=function(c){var a=this,b=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:false}]);if(b)throw b;a._methodObjectList={};a._eventHandlerProxyList={};a._Id=c;a._conversations={};a._policyManager=null;a._appDomains={};a._onHandleRequestError=null};Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(g,h,b,e){var c="invokeType",a=false,d=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:a},{name:"method",type:Function,mayBeNull:a},{name:c,type:Number,mayBeNull:a},{name:"blockingOthers",type:Boolean,mayBeNull:a}]);if(d)throw d;if(b!==Microsoft.Office.Common.InvokeType.async&&b!==Microsoft.Office.Common.InvokeType.sync)throw OsfMsAjaxFactory.msAjaxError.argument(c);var f=new Microsoft.Office.Common.MethodObject(h,b,e);this._methodObjectList[g]=f},unregisterMethod:function(b){var a=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:false}]);if(a)throw a;delete this._methodObjectList[b]},registerEvent:function(f,d,c){var a=false,b=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:a},{name:"registerMethod",type:Function,mayBeNull:a},{name:"unregisterMethod",type:Function,mayBeNull:a}]);if(b)throw b;var e=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(d,Microsoft.Office.Common.InvokeType.syncRegisterEvent,a),new Microsoft.Office.Common.MethodObject(c,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,a));this._methodObjectList[f]=e},registerEventEx:function(h,f,d,e,c){var a=false,b=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:a},{name:"registerMethod",type:Function,mayBeNull:a},{name:"registerMethodInvokeType",type:Number,mayBeNull:a},{name:"unregisterMethod",type:Function,mayBeNull:a},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:a}]);if(b)throw b;var g=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(f,d,a),new Microsoft.Office.Common.MethodObject(e,c,a));this._methodObjectList[h]=g},unregisterEvent:function(b){var a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:false}]);if(a)throw a;this.unregisterMethod(b)},registerConversation:function(c,g,b,f){var d="appDomains",a=true,e=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false},{name:"conversationUrl",type:String,mayBeNull:false,optional:a},{name:d,type:Object,mayBeNull:a,optional:a},{name:"serializerVersion",type:Number,mayBeNull:a,optional:a}]);if(e)throw e;if(b){if(!(b instanceof Array))throw OsfMsAjaxFactory.msAjaxError.argument(d);this._appDomains[c]=b}this._conversations[c]={url:g,serializerVersion:f}},unregisterConversation:function(b){var a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false}]);if(a)throw a;delete this._conversations[b]},setPolicyManager:function(a){var b="policyManager",c=Function._validateParams(arguments,[{name:b,type:Object,mayBeNull:false}]);if(c)throw c;if(!a.checkPermission)throw OsfMsAjaxFactory.msAjaxError.argument(b);this._policyManager=a},getPolicyManager:function(){return this._policyManager}};Microsoft.Office.Common.ClientEndPoint=function(f,c,g,b){var d="targetWindow",a=this,e=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false},{name:d,mayBeNull:false},{name:"targetUrl",type:String,mayBeNull:false},{name:"serializerVersion",type:Number,mayBeNull:true,optional:true}]);if(e)throw e;if(!c.postMessage)throw OsfMsAjaxFactory.msAjaxError.argument(d);a._conversationId=f;a._targetWindow=c;a._targetUrl=g;a._callingIndex=0;a._callbackList={};a._eventHandlerList={};if(b!=null)a._serializerVersion=b;else a._serializerVersion=OSF.SerializerVersion.MsAjax};Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(g,d,b){var a=this,f=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"param",mayBeNull:true}]);if(f)throw f;var c=a._callingIndex++,j=new Date,e={callback:d,createdOn:j.getTime()};if(b&&typeof b==="object"&&typeof b.__timeout__==="number"){e.timeout=b.__timeout__;delete b.__timeout__}a._callbackList[c]=e;try{var h=new Microsoft.Office.Common.Request(g,Microsoft.Office.Common.ActionType.invoke,a._conversationId,c,b),i=Microsoft.Office.Common.MessagePackager.envelope(h,a._serializerVersion);a._targetWindow.postMessage(i,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(k){try{d!==null&&d(Microsoft.Office.Common.InvokeResultCode.errorInRequest,k)}finally{delete a._callbackList[c]}}},registerForEvent:function(d,f,c,h){var a=this,e=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:false},{name:"eventHandler",type:Function,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"data",mayBeNull:true,optional:true}]);if(e)throw e;var b=a._callingIndex++,j=new Date;a._callbackList[b]={callback:c,createdOn:j.getTime()};try{var g=new Microsoft.Office.Common.Request(d,Microsoft.Office.Common.ActionType.registerEvent,a._conversationId,b,h),i=Microsoft.Office.Common.MessagePackager.envelope(g,a._serializerVersion);a._targetWindow.postMessage(i,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer();a._eventHandlerList[d]=f}catch(k){try{c!==null&&c(Microsoft.Office.Common.InvokeResultCode.errorInRequest,k)}finally{delete a._callbackList[b]}}},unregisterForEvent:function(d,c,g){var a=this,e=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"data",mayBeNull:true,optional:true}]);if(e)throw e;var b=a._callingIndex++,i=new Date;a._callbackList[b]={callback:c,createdOn:i.getTime()};try{var f=new Microsoft.Office.Common.Request(d,Microsoft.Office.Common.ActionType.unregisterEvent,a._conversationId,b,g),h=Microsoft.Office.Common.MessagePackager.envelope(f,a._serializerVersion);a._targetWindow.postMessage(h,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(j){try{c!==null&&c(Microsoft.Office.Common.InvokeResultCode.errorInRequest,j)}finally{delete a._callbackList[b]}}finally{delete a._eventHandlerList[d]}}};Microsoft.Office.Common.XdmCommunicationManager=function(){var h=true,m="channel is not ready.",g="conversationId",l="Unknown conversation Id.",b=false,a=null,k=[],j=a,d=a,o=10,i=b,e=a,B=2e3,n=65e3,q=n,f={},c={},s=b;function D(b){for(var a in f)if(f[a]._conversations[b])return f[a];OsfMsAjaxFactory.msAjaxDebug.trace(l);throw OsfMsAjaxFactory.msAjaxError.argument(g);}function E(b){var a=c[b];if(!a){OsfMsAjaxFactory.msAjaxDebug.trace(l);throw OsfMsAjaxFactory.msAjaxError.argument(g);}return a}function w(e,c){var b=e._methodObjectList[c._actionName];if(!b){OsfMsAjaxFactory.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+c._actionName);throw OsfMsAjaxFactory.msAjaxError.argument("messageObject");}var d=a;if(c._actionType===Microsoft.Office.Common.ActionType.invoke)d=b;else if(c._actionType===Microsoft.Office.Common.ActionType.registerEvent)d=b.getRegisterMethodObject();else d=b.getUnregisterMethodObject();return d}function z(a){k.push(a)}function y(){if(d!==a){if(!i)if(k.length>0){var b=k.shift();p(b)}else{clearInterval(d);d=a}}else OsfMsAjaxFactory.msAjaxDebug.trace(m)}function p(a){i=a.getInvokeBlockingFlag();a.invoke();j=+new Date}function v(){if(e){var d,g=0,j=new Date,f;for(var i in c){d=c[i];for(var h in d._callbackList){var b=d._callbackList[h];f=b.timeout?b.timeout:q;if(f>=0&&Math.abs(j.getTime()-b.createdOn)>=f)try{b.callback&&b.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,a)}finally{delete d._callbackList[h]}else g++}}if(g===0){clearInterval(e);e=a}}else OsfMsAjaxFactory.msAjaxDebug.trace(m)}function F(){i=b}function x(a){if(window.addEventListener)window.addEventListener("message",a,b);else if(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent)window.attachEvent("onmessage",a);else{OsfMsAjaxFactory.msAjaxDebug.trace("Browser doesn't support the required API.");throw OsfMsAjaxFactory.msAjaxError.argument("Browser");}}function r(d,e){var f=b;if(d===h)return h;if(!d||!e||!d.length||!e.length)return f;var c,a;c=document.createElement("a");a=document.createElement("a");c.href=d;a.href=e;f=u(c,a);delete c,a;return f}function C(a,g){var c=b;if(!g||!g.length||!a||!(a instanceof Array)||!a.length)return c;var f=document.createElement("a"),e=document.createElement("a");f.href=g;for(var d=0;d<a.length&&!c;d++)if(a[d].indexOf("://")!==-1){e.href=a[d];c=u(f,e)}delete f,e;return c}function u(a,b){return a.hostname==b.hostname&&a.protocol==b.protocol&&a.port==b.port}function A(e){var u="Access Denied";if(e.data!=""){var c,f=OSF.SerializerVersion.MsAjax,v=e.data;try{c=Microsoft.Office.Common.MessagePackager.unenvelope(v,OSF.SerializerVersion.Browser);f=c._serializerVersion!=a?c._serializerVersion:f}catch(J){}if(f!=OSF.SerializerVersion.Browser)try{c=Microsoft.Office.Common.MessagePackager.unenvelope(v,f)}catch(J){return}if(typeof c._messageType=="undefined")return;if(c._messageType===Microsoft.Office.Common.MessageType.request){var A=e.origin==a||e.origin=="null"?c._origin:e.origin;try{var g=D(c._conversationId),m=g._conversations[c._conversationId];f=m.serializerVersion!=a?m.serializerVersion:f;if(!r(m.url,e.origin)&&!C(g._appDomains[c._conversationId],e.origin))throw"Failed origin check";var x=g.getPolicyManager();if(x&&!x.checkPermission(c._conversationId,c._actionName,c._data))throw u;var I=w(g,c),B=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,A,c._actionName,c._conversationId,c._correlationId,F,f),t=new Microsoft.Office.Common.Invoker(I,c._data,B,g._eventHandlerProxyList,c._conversationId,c._actionName,f),q=h;if(d==a)if((j==a||+new Date-j>o)&&!i){p(t);q=b}else d=setInterval(y,o);q&&z(t)}catch(J){g&&g._onHandleRequestError&&g._onHandleRequestError(c,J);var s=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;if(J==u)s=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied;var H=new Microsoft.Office.Common.Response(c._actionName,c._conversationId,c._correlationId,s,Microsoft.Office.Common.ResponseType.forCalling,J),G=Microsoft.Office.Common.MessagePackager.envelope(H,f);e.source&&e.source.postMessage&&e.source.postMessage(G,A)}}else if(c._messageType===Microsoft.Office.Common.MessageType.response){var k=E(c._conversationId);k._serializerVersion=f;if(!r(k._targetUrl,e.origin))throw"Failed orgin check";if(c._responseType===Microsoft.Office.Common.ResponseType.forCalling){var l=k._callbackList[c._correlationId];if(l)try{l.callback&&l.callback(c._errorCode,c._data)}finally{delete k._callbackList[c._correlationId]}}else{var n=k._eventHandlerList[c._actionName];n!==undefined&&n!==a&&n(c._data)}}else return}}function t(){if(!s){x(A);s=h}}return{connect:function(b,e,f,d){var a=c[b];if(!a){t();a=new Microsoft.Office.Common.ClientEndPoint(b,e,f,d);c[b]=a}return a},getClientEndPoint:function(d){var a=Function._validateParams(arguments,[{name:g,type:String,mayBeNull:b}]);if(a)throw a;return c[d]},createServiceEndPoint:function(a){t();var b=new Microsoft.Office.Common.ServiceEndPoint(a);f[a]=b;return b},getServiceEndPoint:function(c){var a=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:b}]);if(a)throw a;return f[c]},deleteClientEndPoint:function(d){var a=Function._validateParams(arguments,[{name:g,type:String,mayBeNull:b}]);if(a)throw a;delete c[d]},_setMethodTimeout:function(a){var c=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:b}]);if(c)throw c;q=a<=0?n:a},_startMethodTimeoutTimer:function(){if(!e)e=setInterval(v,B)}}}();Microsoft.Office.Common.Message=function(g,h,e,f,c){var b=false,a=this,d=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:b},{name:"actionName",type:String,mayBeNull:b},{name:"conversationId",type:String,mayBeNull:b},{name:"correlationId",mayBeNull:b},{name:"data",mayBeNull:true,optional:true}]);if(d)throw d;a._messageType=g;a._actionName=h;a._conversationId=e;a._correlationId=f;a._origin=window.location.href;if(typeof c=="undefined")a._data=null;else a._data=c};Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}};Microsoft.Office.Common.Request=function(c,d,a,b,e){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,c,a,b,e);this._actionType=d};OSF.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message);Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType};Microsoft.Office.Common.Response=function(d,a,b,e,c,f){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,d,a,b,f);this._errorCode=e;this._responseType=c};OSF.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message);Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode};Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType};Microsoft.Office.Common.MessagePackager={envelope:function(a,b){if(b==OSF.SerializerVersion.Browser&&typeof JSON!=="undefined"){if(typeof a==="object")a._serializerVersion=b;return JSON.stringify(a)}else{if(typeof a==="object")a._serializerVersion=OSF.SerializerVersion.MsAjax;return OsfMsAjaxFactory.msAjaxSerializer.serialize(a)}},unenvelope:function(a,b){return b==OSF.SerializerVersion.Browser&&typeof JSON!=="undefined"?JSON.parse(a):OsfMsAjaxFactory.msAjaxSerializer.deserialize(a,true)}};Microsoft.Office.Common.ResponseSender=function(f,i,k,g,h,j,e){var c=false,a=this,d=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:c},{name:"requesterUrl",type:String,mayBeNull:c},{name:"actionName",type:String,mayBeNull:c},{name:"conversationId",type:String,mayBeNull:c},{name:"correlationId",mayBeNull:c},{name:"responsetype",type:Number,maybeNull:c},{name:"serializerVersion",type:Number,maybeNull:true,optional:true}]);if(d)throw d;a._requesterWindow=f;a._requesterUrl=i;a._actionName=k;a._conversationId=g;a._correlationId=h;a._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError;a._responseType=j;var b=a;a._send=function(d){try{var c=new Microsoft.Office.Common.Response(b._actionName,b._conversationId,b._correlationId,b._invokeResultCode,b._responseType,d),a=Microsoft.Office.Common.MessagePackager.envelope(c,e);b._requesterWindow.postMessage(a,b._requesterUrl)}catch(f){OsfMsAjaxFactory.msAjaxDebug.trace("ResponseSender._send error:"+f.message)}}};Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(a){this._invokeResultCode=a}};Microsoft.Office.Common.InvokeCompleteCallback=function(e,h,i,f,g,d,c){var b=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(b,e,h,i,f,g,Microsoft.Office.Common.ResponseType.forCalling,c);b._postCallbackHandler=d;var a=b;b._send=function(e){try{var d=new Microsoft.Office.Common.Response(a._actionName,a._conversationId,a._correlationId,a._invokeResultCode,a._responseType,e),b=Microsoft.Office.Common.MessagePackager.envelope(d,c);a._requesterWindow.postMessage(b,a._requesterUrl);a._postCallbackHandler()}catch(f){OsfMsAjaxFactory.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+f.message)}}};OSF.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender);Microsoft.Office.Common.Invoker=function(i,j,e,f,h,k,g){var c=true,b=false,a=this,d=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:b},{name:"paramValue",mayBeNull:c},{name:"invokeCompleteCallback",mayBeNull:b},{name:"eventHandlerProxyList",mayBeNull:c},{name:"conversationId",type:String,mayBeNull:b},{name:"eventName",type:String,mayBeNull:b},{name:"serializerVersion",type:Number,mayBeNull:c,optional:c}]);if(d)throw d;a._methodObject=i;a._param=j;a._invokeCompleteCallback=e;a._eventHandlerProxyList=f;a._conversationId=h;a._eventName=k;a._serializerVersion=g};Microsoft.Office.Common.Invoker.prototype={invoke:function(){var a=this;try{var b;switch(a._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:a._methodObject.getMethod()(a._param,a._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:b=a._methodObject.getMethod()(a._param);a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var d=a._createEventHandlerProxyObject(a._invokeCompleteCallback);b=a._methodObject.getMethod()(d.getSend(),a._param);a._eventHandlerProxyList[a._conversationId+a._eventName]=d.getSend();a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var f=a._eventHandlerProxyList[a._conversationId+a._eventName];b=a._methodObject.getMethod()(f,a._param);delete a._eventHandlerProxyList[a._conversationId+a._eventName];a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var c=a._createEventHandlerProxyObject(a._invokeCompleteCallback);a._methodObject.getMethod()(c.getSend(),a._invokeCompleteCallback.getSend(),a._param);a._eventHandlerProxyList[a._callerId+a._eventName]=c.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var e=a._eventHandlerProxyList[a._callerId+a._eventName];a._methodObject.getMethod()(e,a._invokeCompleteCallback.getSend(),a._param);delete a._eventHandlerProxyList[a._callerId+a._eventName]}}catch(g){a._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse);a._invokeCompleteCallback.getSend()(g)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(a){return new Microsoft.Office.Common.ResponseSender(a.getRequesterWindow(),a.getRequesterUrl(),a.getActionName(),a.getConversationId(),a.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}};OSF.OUtil.setNamespace("OSF",window);OSF.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072};OSF.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"};OSF.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"};OSF.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9};OSF.SharedConstants={NotificationConversationIdSuffix:"_ntf"};OSF.OfficeAppContext=function(r,n,j,i,l,o,k,m,q,e,p,g,f,h,d,c,b){var a=this;a._id=r;a._appName=n;a._appVersion=j;a._appUILocale=i;a._dataLocale=l;a._docUrl=o;a._clientMode=k;a._settings=m;a._reason=q;a._osfControlType=e;a._eToken=p;a._correlationId=g;a._appInstanceId=f;a._touchEnabled=h;a._commerceAllowed=d;a._appMinorVersion=c;a._requirementMatrix=b;a.get_id=function(){return this._id};a.get_appName=function(){return this._appName};a.get_appVersion=function(){return this._appVersion};a.get_appUILocale=function(){return this._appUILocale};a.get_dataLocale=function(){return this._dataLocale};a.get_docUrl=function(){return this._docUrl};a.get_clientMode=function(){return this._clientMode};a.get_bindings=function(){return this._bindings};a.get_settings=function(){return this._settings};a.get_reason=function(){return this._reason};a.get_osfControlType=function(){return this._osfControlType};a.get_eToken=function(){return this._eToken};a.get_correlationId=function(){return this._correlationId};a.get_appInstanceId=function(){return this._appInstanceId};a.get_touchEnabled=function(){return this._touchEnabled};a.get_commerceAllowed=function(){return this._commerceAllowed};a.get_appMinorVersion=function(){return this._appMinorVersion};a.get_requirementMatrix=function(){return this._requirementMatrix}};OSF.OsfControlType={DocumentLevel:0,ContainerLevel:1};OSF.ClientMode={ReadOnly:0,ReadWrite:1};OSF.OUtil.setNamespace("Microsoft",window);OSF.OUtil.setNamespace("Office",Microsoft);OSF.OUtil.setNamespace("Client",Microsoft.Office);OSF.OUtil.setNamespace("WebExtension",Microsoft.Office);Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"};Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"};Microsoft.Office.WebExtension.FilterType={All:"all"};Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex"};OSF.OUtil.setNamespace("DDA",OSF);OSF.DDA.DocumentMode={ReadOnly:1,ReadWrite:0};OSF.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"};OSF.DDA.EventDescriptors={};OSF.DDA.ListDescriptors={};OSF.DDA.getXdmEventName=function(b,a){return a==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||a==Microsoft.Office.WebExtension.EventType.BindingDataChanged?b+"_"+a:a};OSF.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMethodMax:143,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123};OSF.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidActivationStatusChangedEvent:32,dispidAppCommandInvokedEvent:39,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63};OSF.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64};OSF.Xpath3Provider=function(f,e){var a=this;a._xmldoc=(new DOMParser).parseFromString(f,"text/xml");a._evaluator=new XPathEvaluator;a._namespaceMapping={};a._defaultNamespace=null;for(var d=e.split(" "),b,c=0;c<d.length;++c){b=/xmlns="([^"]*)"/g.exec(d[c]);if(b){a._defaultNamespace=b[1];continue}b=/xmlns:([^=]*)="([^"]*)"/g.exec(d[c]);if(b){a._namespaceMapping[b[1]]=b[2];continue}}a._resolver=a};OSF.Xpath3Provider.prototype={lookupNamespaceURI:function(a){var b=this._namespaceMapping[a];return b||this._defaultNamespace},selectSingleNode:function(d,a){var c=(a?"./":"/")+d;a=a||this.getDocumentElement();var b=this._evaluator.evaluate(c,a,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return b?b.singleNodeValue:null},selectNodes:function(f,a){var e=(a?"./":"/")+f;a=a||this.getDocumentElement();var b=this._evaluator.evaluate(e,a,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),d=[];if(b){var c=b.iterateNext();while(c){d.push(c);c=b.iterateNext()}}return d},getDocumentElement:function(){return this._xmldoc.documentElement}};OSF.IEXpathProvider=function(e,d){for(var a=null,c=["MSXML2.DOMDocument.6.0"],b=0;b<c.length;b++)try{a=new ActiveXObject(c[b]);a.setProperty("ResolveExternals",false);a.setProperty("ValidateOnParse",false);a.setProperty("ProhibitDTD",true);a.setProperty("MaxXMLSize",OSF.XmlConstants.MaxXmlSize);a.setProperty("MaxElementDepth",OSF.XmlConstants.MaxElementDepth);a.async=false;a.loadXML(e);a.setProperty("SelectionLanguage","XPath");a.setProperty("SelectionNamespaces",d);break}catch(f){OsfMsAjaxFactory.msAjaxDebug.trace("xml doc creating error:"+f)}this._xmldoc=a};OSF.IEXpathProvider.prototype={selectSingleNode:function(c,a){var b=(a?"./":"/")+c;a=a||this.getDocumentElement();return a.selectSingleNode(b)},selectNodes:function(c,a){var b=(a?"./":"/")+c;a=a||this.getDocumentElement();return a.selectNodes(b)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}};OSF.DomParserProvider=function(f,e){var b=this;try{b._xmldoc=(new DOMParser).parseFromString(f,"text/xml")}catch(g){Sys.Debug.trace("xml doc creating error:"+g)}b._namespaceMapping={};b._defaultNamespace=null;for(var d=e.split(" "),a,c=0;c<d.length;++c){a=/xmlns="([^"]*)"/g.exec(d[c]);if(a){b._defaultNamespace=a[1];continue}a=/xmlns:([^=]*)="([^"]*)"/g.exec(d[c]);if(a){b._namespaceMapping[a[1]]=a[2];continue}}};OSF.DomParserProvider.prototype={selectSingleNode:function(d,c){var b=c||this._xmldoc,a=this._selectNodes(d,b);return a.length===0?null:a[0]},selectNodes:function(c,b){var a=b||this._xmldoc;return this._selectNodes(c,a)},_selectNodes:function(h,g){var d=[];if(!h)return d;var a=h.split(":"),f,e;if(a.length===1){f=null;e=a[0]}else if(a.length===2){f=this._namespaceMapping[a[0]];e=a[1]}else throw OsfMsAjaxFactory.msAjaxError.argument("name");if(!g.hasChildNodes)return d;for(var c=g.childNodes,b=0;b<c.length;b++)e===this._removeNodePrefix(c[b].nodeName)&&f===c[b].namespaceURI&&d.push(c[b]);return d},_removeNodePrefix:function(b){var a=b.split(":");return a.length===1?b:a[1]},getDocumentElement:function(){return this._xmldoc.documentElement}};OSF.XmlProcessor=function(c,b){var a=this,d=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:false},{name:"xmlNamespaces",type:String,mayBeNull:false}]);if(d)throw d;if(document.implementation&&document.implementation.hasFeature("XPath","3.0"))a._provider=new OSF.Xpath3Provider(c,b);else{a._provider=new OSF.IEXpathProvider(c,b);if(!a._provider.getActiveXObject())a._provider=new OSF.DomParserProvider(c,b)}};OSF.XmlProcessor.prototype={selectSingleNode:function(c,b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false},{name:"contextNode",mayBeNull:true,optional:true}]);if(a)throw a;return this._provider.selectSingleNode(c,b)},selectNodes:function(c,b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false},{name:"contextNode",mayBeNull:true,optional:true}]);if(a)throw a;return this._provider.selectNodes(c,b)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(b){var c=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(c)throw c;var a;if(b.text)a=b.text;else a=b.textContent;return a},getNodeXml:function(b){var c=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(c)throw c;var a;if(b.xml)a=b.xml;else a=(new XMLSerializer).serializeToString(b);return a},getNodeNamespaceURI:function(b){var a=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(a)throw a;return b.namespaceURI},getNodePrefix:function(b){var a=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(a)throw a;return b.prefix},getNodeBaseName:function(b){var c=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(c)throw c;var a;if(b.baseName)a=b.baseName;else a=b.localName;return a},getNodeType:function(b){var a=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(a)throw a;return b.nodeType},_getAttributeLocalName:function(a){var b;if(a.localName)b=a.localName;else b=a.baseName;return b},readAttributes:function(e,c,h){var f=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false},{name:"attributesToRead",type:Object,mayBeNull:false},{name:"objectToFill",type:Object,mayBeNull:false}]);if(f)throw f;for(var a,d,b=0;b<e.attributes.length;b++){a=e.attributes[b];d=this._getAttributeLocalName(a);for(var g in c)if(d===g)h[c[g]]=a.value}}};var OfficeExt;(function(b){var a="undefined",d=function(){function b(){}b.prototype.Serialize=function(b){try{return typeof JSON!==a?JSON.stringify(b):OsfMsAjaxFactory.msAjaxSerializer.serialize(b)}catch(c){return null}};b.prototype.Deserialize=function(b){try{return typeof JSON!==a?JSON.parse(b):OsfMsAjaxFactory.msAjaxSerializer.deserialize(b,true)}catch(c){return null}};return b}();b.SafeSerializer=d;var c=function(){function b(a,b){this._localStorage=a;this._serializer=b}b.prototype.GetCacheItem=function(h,e,f){var d=this;if(typeof e===a)e=true;d.ValidateCurrentCache();var g=d._localStorage.getItem(h);if(g){var c=d._serializer.Deserialize(g);if(e){var i=new Date;if(Math.abs(i.getTime()-c.createdOn)<b.msPerDay*c.refreshRate)return c.data;else{d._localStorage.removeItem(h);if(f)f.cacheExpired=true}}else return c.data}};b.prototype.SetCacheItem=function(e,d,a){a=a||b.defaultRefreshRateInDays;var f=new Date,c={data:d,createdOn:f.getTime(),refreshRate:a};this._localStorage.setItem(e,this._serializer.Serialize(c))};b.prototype.RemoveCacheItem=function(a){this._localStorage.removeItem(a)};b.prototype.RemoveAll=function(c){for(var b=this._localStorage.getKeysWithPrefix(c),a=0,d=b.length;a<d;a++)this._localStorage.removeItem(b[a])};b.prototype.RemoveMatches=function(c){for(var d=this._localStorage.getKeysWithPrefix(""),a=0,g=d.length;a<g;a++)for(var e=d[a],b=0,f=c.length;b<f;b++)if(c[b].test(e)){this._localStorage.removeItem(e);break}};b.prototype.ValidateCurrentCache=function(){var a=this._localStorage.getItem(b.cacheVersionKey);if(a!=b.currentSchemaVersion){this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]);this._localStorage.setItem(b.cacheVersionKey,b.currentSchemaVersion)}};b.defaultRefreshRateInDays=3;b.msPerDay=864e5;b.currentSchemaVersion="1";b.checkedCache=false;b.cacheVersionKey="osfCacheVersion";return b}();b.AppsDataCacheManager=c})(OfficeExt||(OfficeExt={}));var OmexDataProvider=function(){var d=true,b=false,c=null;function a(a){this._cacheManager=a;this._cid="0"}a.GetInstance=function(b){if(a.instance==c)a.instance=new a(b);return a.instance};a.prototype.validateAndCacheNewManifest=function(){return b};a.prototype.localCacheAddinCommands=function(){};a.prototype.getEntitlementsAsync=function(f,h,e){var a,d=function(b){if(b!=c&&b.errorCode===OSF.InvokeResultCode.S_OK&&b.value){var g=b.value;a=[];for(var f=0;f<g.length;f++){var d=g[f],h={assetId:d[1],appVersion:d[4],storeId:d[11],storeType:OSF.StoreType.OMEX,targetType:d[3]};a.push(h)}}e(a)},g={storeType:OSF.StoreTypeEnum.MarketPlace,refresh:b,fromInsertDialog:b,callbackFunc:d};f.queryEntitlementDetails(g)};a.prototype.getManifestAsync=function(a,e){OSF.OUtil.validateParamObject(a,{contextActivationMgr:{type:Object,mayBeNull:b},referenceInUse:{type:Object,mayBeNull:b}},c);var g=this,h=function(b){if(b!=c&&b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){var d=b.value,f=new OSF.Manifest.Manifest(d.manifest,a.contextActivationMgr.getAppUILocale());!b.cached&&g.SetManifestAndETokenCache(a,d);OSF.OsfManifestManager.cacheManifest(a.referenceInUse.id,a.referenceInUse.version,f);e({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:f,context:a})}else e({statusCode:OSF.ProxyCallStatusCode.Failed,value:c})},i=function(){if(a.contextActivationMgr._omexAnonymousWSProxy.isReady&&a.contextActivationMgr._omexAnonymousWSProxy.clientEndPoint!=c){a.anonymous=d;a.clientEndPoint=a.contextActivationMgr._omexAnonymousWSProxy.clientEndPoint;a.manifestManager=OSF.OsfManifestManager;var f={applicationName:a.contextActivationMgr._hostType,assetID:a.referenceInUse.id,build:OSF.Constants.FileVersion,clientName:a.contextActivationMgr._getClientNameForOmex(),clientVersion:a.contextActivationMgr._getClientVersionForOmex(),clientAppInfoReturnType:OSF.ClientAppInfoReturnType.urlOnly,errors:{},correlationId:c,contentMarket:a.referenceInUse.storeLocator,clearManifest:b};g.GetManifestAndEToken(a,f,h)}else e({statusCode:OSF.ProxyCallStatusCode.Failed,value:c})},f=OSF.OsfManifestManager.getCachedManifest(a.referenceInUse.id,a.referenceInUse.version);if(f==c)a.contextActivationMgr._createOmexProxy(a.contextActivationMgr._omexAnonymousWSProxy,i);else e({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:f,context:a})};a.prototype.GetCacheKeyPrefix=function(b){OSF.OUtil.validateParamObject(b,{anonymous:{type:Boolean,mayBeNull:d}},c);return b.anonymous==c||b.anonymous?a.anonymousCacheKeyPrefix:a.gatedCacheKeyPrefix};a.prototype.GetCustomerId=function(){return this._cid};a.prototype.SetCustomerId=function(a){this._cid=a};a.prototype.AllCached=function(a,c){if(a&&!a.clearCache&&!a.clearToken&&!a.clearEntitlement&&!a.clearAppState&&!a.clearManifest)if(this.KilledAppsCached(a)&&this.AppStateCached(a,c)&&this.ManifestAndETokenCached(a,c))return d;return b};a.prototype.KilledAppsCached=function(f){var d=this.GetCacheKeyPrefix(f),e=OSF.OUtil.formatString(a.killedAppsWS.cacheKey,d),g=this._cacheManager.GetCacheItem(e,b);return g!=c};a.prototype.GetKilledApps=function(f,e,g){OSF.OUtil.validateParamObject(e,{clientName:{type:String,mayBeNull:d},clientVersion:{type:String,mayBeNull:d}},g);e.clearKilledApps=e.clearKilledApps||b;var h={context:f,statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,cached:b},i=OSF.OUtil.formatString(a.killedAppsWS.cacheKey,this.GetCacheKeyPrefix(f));if(e.clearKilledApps)this._cacheManager.RemoveCacheItem(i);else{var j=this._cacheManager.GetCacheItem(i,d,e.errors);if(j){h.value=j;h.cached=d;g(h);return}}f.manifestManager._invokeProxyMethodAsync(f,"OMEX_getKilledAppsAsync",g,e)};a.prototype.SetKilledAppsCache=function(f,d){OSF.OUtil.validateParamObject(d,{refreshRate:{type:String,mayBeNull:b}},c);var e=OSF.OUtil.formatString(a.killedAppsWS.cacheKey,this.GetCacheKeyPrefix(f));this._cacheManager.SetCacheItem(e,d,d.refreshRate/a.hourToDayConversionFactor)};a.prototype.AppStateCached=function(f,d){OSF.OUtil.validateParamObject(d,{assetID:{type:String,mayBeNull:b},contentMarket:{type:String,mayBeNull:b}},c);var e=OSF.OUtil.formatString(a.appStateWS.cacheKey,this.GetCacheKeyPrefix(f),d.contentMarket,d.assetID),g=this._cacheManager.GetCacheItem(e,b);return g!=c};a.prototype.GetAppState=function(f,e,g){OSF.OUtil.validateParamObject(e,{assetID:{type:String,mayBeNull:b},contentMarket:{type:String,mayBeNull:b},clientName:{type:String,mayBeNull:d},clientVersion:{type:String,mayBeNull:d}},g);e.clearAppState=e.clearAppState||b;var h={context:f,statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,cached:b},i=OSF.OUtil.formatString(a.appStateWS.cacheKey,this.GetCacheKeyPrefix(f),e.contentMarket,e.assetID);if(e.clearAppState)this._cacheManager.RemoveCacheItem(i);else{var j=this._cacheManager.GetCacheItem(i,d,e.errors);if(j){h.value=j;h.cached=d;g(h);return}}f.manifestManager._invokeProxyMethodAsync(f,"OMEX_getAppStateAsync",g,e)};a.prototype.SetAppStateCache=function(f,d){OSF.OUtil.validateParamObject(d,{refreshRate:{type:String,mayBeNull:b}},c);var e=f.referenceInUse,g=OSF.OUtil.formatString(a.appStateWS.cacheKey,this.GetCacheKeyPrefix(f),e.storeLocator,e.id);this._cacheManager.SetCacheItem(g,d,d.refreshRate/a.hourToDayConversionFactor)};a.prototype.ManifestAndETokenCached=function(f,d){OSF.OUtil.validateParamObject(d,{assetID:{type:String,mayBeNull:b},contentMarket:{type:String,mayBeNull:b}},c);var e;if(f.anonymous==c||f.anonymous)e=OSF.OUtil.formatString(a.anonymousAppInstallInfoWS.cacheKey,d.assetID,d.contentMarket);else e=OSF.OUtil.formatString(a.authenticatedAppInstallInfoWS.cacheKey,this._cid,d.assetID,d.userContentMarket,d.assetContentMarket);var g=this._cacheManager.GetCacheItem(e,b);return g!=c};a.prototype.GetManifestAndEToken=function(g,e,j){var m="OMEX_getManifestAndETokenAsync",k=this;OSF.OUtil.validateParamObject(e,{assetID:{type:String,mayBeNull:b},applicationName:{type:String,mayBeNull:b},contentMarket:{type:String,mayBeNull:d},userContentMarket:{type:String,mayBeNull:d},assetContentMarket:{type:String,mayBeNull:d},clientName:{type:String,mayBeNull:d},clientVersion:{type:String,mayBeNull:d}},j);e.clearToken=e.clearToken||b;e.clearManifest=e.clearManifest||b;var i={context:g,statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,cached:b},h;if(g.anonymous==c||g.anonymous)h=OSF.OUtil.formatString(a.anonymousAppInstallInfoWS.cacheKey,e.assetID,e.contentMarket);else h=OSF.OUtil.formatString(a.authenticatedAppInstallInfoWS.cacheKey,k._cid,e.assetID,e.userContentMarket,e.assetContentMarket);if(e.clearManifest)k._cacheManager.RemoveCacheItem(h);else{var f=k._cacheManager.GetCacheItem(h,d,e.errors);if(f){if(e.clearToken||f.tokenExpirationDate&&new Date(f.tokenExpirationDate)<=new Date){delete f.etoken;delete f.tokenExpirationDate;delete f.entitlementType}if((g.anonymous==c||g.anonymous||f.etoken)&&f.manifest){i.value=f;i.cached=d;j(i);return}}if(!g.anonymous){h=OSF.OUtil.formatString(a.anonymousAppInstallInfoWS.cacheKey,e.assetID,e.userContentMarket);var l=k._cacheManager.GetCacheItem(h,d,e.errors);if(l&&l.manifest){var n=function(a){var e=a.context;if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var d=a.value,f=parseInt(d.status);if(f===OSF.OmexClientAppStatus.OK)d.manifest=l.manifest;i.context=e;i.value=d;j(i)}else j({context:e,statusCode:OSF.ProxyCallStatusCode.Failed,value:c,cached:b})};if(!f||!f.etoken){e.clientAppInfoReturnType=OSF.ClientAppInfoReturnType.etokenOnly;g.manifestManager._invokeProxyMethodAsync(g,m,n,e);return}}}}g.manifestManager._invokeProxyMethodAsync(g,m,j,e)};a.prototype.SetManifestAndETokenCache=function(d,f){var b=d.referenceInUse,e;if(d.anonymous==c||d.anonymous)e=OSF.OUtil.formatString(a.anonymousAppInstallInfoWS.cacheKey,b.id,b.storeLocator);else e=OSF.OUtil.formatString(a.authenticatedAppInstallInfoWS.cacheKey,this._cid,b.id,b.storeLocator,d.osfControl._omexEntitlement.contentMarket);this._cacheManager.SetCacheItem(e,f,a.manifestRefreshRate)};a.prototype.RemoveManifestAndEToken=function(d){var b=".*",c=[];c.push(new RegExp(OSF.OUtil.formatString(a.authenticatedAppInstallInfoWS.cacheKey,b,d,b,b),"i"));this._cacheManager.RemoveMatches(c)};a.prototype.AppDetailsCached=function(k,f){var c=[];for(var i in f){c=f[i].split(",");break}for(var j=[],e=0;e<c.length;++e){var g=OSF.OUtil.formatString(a.appDetailKey,c[e]),h=this._cacheManager.GetCacheItem(g,b);if(!h)return b}return d};a.prototype.GetAppDetails=function(f,e,i){OSF.OUtil.validateParamObject(e,{assetID:{type:String,mayBeNull:b},contentMarket:{type:String,mayBeNull:b},clientName:{type:String,mayBeNull:d},clientVersion:{type:String,mayBeNull:d}},i);e.clearCache=e.clearCache||b;e.appDetails=[];if(e.clearCache)this._cacheManager.RemoveAll(a.ungatedCacheKeyPrefix);else{for(var k=e.assetID.split(","),h=[],g=0;g<k.length;++g){var m=OSF.OUtil.formatString(a.appDetailKey,k[g]),l=this._cacheManager.GetCacheItem(m,d,e.errors);if(l)e.appDetails.push(l);else h.push(k[g])}if(h.length===0){var j={context:f,statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,cached:b};j.value=e.appDetails;j.cached=d;i(j);return}e.assetID=h.join(",")}f.appDetails=e.appDetails;f.manifestManager._invokeProxyMethodAsync(f,"OMEX_getAppDetailsAsync",i,e)};a.prototype.SetAppDetailsCache=function(f,d){for(var b,e,c=0;c<d.length;++c){b=d[c];e=OSF.OUtil.formatString(a.appDetailKey,b.assetId);this._cacheManager.SetCacheItem(e,b)}};a.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.";a.gatedCacheKeyPrefix="__OSF_GATED_OMEX.";a.ungatedCacheKeyPrefix="__OSF_OMEX.";a.manifestRefreshRate=5*365;a.hourToDayConversionFactor=24;a.anonymousAppInstallInfoWS={url:"/appinstall/unauthenticated?cmu={0}&assetid={1}&ret=0",cacheKey:a.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}"};a.authenticatedAppInstallInfoWS={url:"/appinstall/authenticated?cmu={0}&cmf={1}&assetid={2}&ret={3}&rt=xml",cacheKey:a.gatedCacheKeyPrefix+"appinstall_authenticated.{0}.{1}.{2}.{3}"};a.killedAppsWS={url:"/appinfo/query?rt=xml",cacheKey:"{0}killedApps"};a.appStateWS={url:"/appstate/query?ma={0}:{1}",cacheKey:"{0}appState.{1}.{2}"};a.appDetailKey="__OSF_OMEX.appDetails.{0}";return a}(),OSFLog;(function(i){var f="Error",e="ResponseTime",d="Result",j="OperationMetadata",c="ErrorResult",g="AssetId",b="CorrelationId",a=true,h=function(){function b(a){this._table=a;this._fields={}}Object.defineProperty(b.prototype,"Fields",{"get":function(){return this._fields},enumerable:a,configurable:a});Object.defineProperty(b.prototype,"Table",{"get":function(){return this._table},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){};b.prototype.SetSerializedField=function(b,a){if(typeof a!=="undefined"&&a!==null)this._serializedFields[b]=a.toString()};b.prototype.SerializeRow=function(){var a=this;a._serializedFields={};a.SetSerializedField("Table",a._table);a.SerializeFields();return JSON.stringify(a._serializedFields)};return b}();i.BaseUsageData=h;var t=function(t){var s="Stage11Time",r="Stage10Time",q="Stage9Time",p="Stage8Time",o="Stage7Time",n="Stage6Time",m="Stage5Time",l="Stage4Time",k="Stage3Time",j="Stage2Time",i="Stage1Time",h="InstanceId",f="ActivationInfo",e="AppInfo";__extends(d,t);function d(){t.call(this,"AppLoadTime")}Object.defineProperty(d.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,h,{"get":function(){return this.Fields[h]},"set":function(a){this.Fields[h]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,g,{"get":function(){return this.Fields[g]},"set":function(a){this.Fields[g]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,i,{"get":function(){return this.Fields[i]},"set":function(a){this.Fields[i]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,j,{"get":function(){return this.Fields[j]},"set":function(a){this.Fields[j]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,k,{"get":function(){return this.Fields[k]},"set":function(a){this.Fields[k]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,l,{"get":function(){return this.Fields[l]},"set":function(a){this.Fields[l]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,m,{"get":function(){return this.Fields[m]},"set":function(a){this.Fields[m]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,n,{"get":function(){return this.Fields[n]},"set":function(a){this.Fields[n]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,o,{"get":function(){return this.Fields[o]},"set":function(a){this.Fields[o]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,p,{"get":function(){return this.Fields[p]},"set":function(a){this.Fields[p]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,q,{"get":function(){return this.Fields[q]},"set":function(a){this.Fields[q]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,r,{"get":function(){return this.Fields[r]},"set":function(a){this.Fields[r]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,s,{"get":function(){return this.Fields[s]},"set":function(a){this.Fields[s]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});d.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.CorrelationId);a.SetSerializedField(e,a.AppInfo);a.SetSerializedField(f,a.ActivationInfo);a.SetSerializedField(h,a.InstanceId);a.SetSerializedField(g,a.AssetId);a.SetSerializedField(i,a.Stage1Time);a.SetSerializedField(j,a.Stage2Time);a.SetSerializedField(k,a.Stage3Time);a.SetSerializedField(l,a.Stage4Time);a.SetSerializedField(m,a.Stage5Time);a.SetSerializedField(n,a.Stage6Time);a.SetSerializedField(o,a.Stage7Time);a.SetSerializedField(p,a.Stage8Time);a.SetSerializedField(q,a.Stage9Time);a.SetSerializedField(r,a.Stage10Time);a.SetSerializedField(s,a.Stage11Time);a.SetSerializedField(c,a.ErrorResult)};return d}(h);i.AppLoadTimeUsageData=t;var s=function(f){var e="NotificationClickInfo";__extends(d,f);function d(){f.call(this,"AppNotification")}Object.defineProperty(d.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});d.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.CorrelationId);a.SetSerializedField(c,a.ErrorResult);a.SetSerializedField(e,a.NotificationClickInfo)};return d}(h);i.AppNotificationUsageData=s;var r=function(d){__extends(b,d);function b(){d.call(this,"AppManagementMenu")}Object.defineProperty(b.prototype,g,{"get":function(){return this.Fields[g]},"set":function(a){this.Fields[g]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,j,{"get":function(){return this.Fields[j]},"set":function(a){this.Fields[j]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(g,a.AssetId);a.SetSerializedField(j,a.OperationMetadata);a.SetSerializedField(c,a.ErrorResult)};return b}(h);i.AppManagementMenuUsageData=r;var p=function(i){var h="LastActiveTabCount",f="LastActiveTab",e="DialogState",d="TrustPageSessionTime",c="TotalSessionTime";__extends(b,i);function b(){i.call(this,"InsertionDialogSession")}Object.defineProperty(b.prototype,g,{"get":function(){return this.Fields[g]},"set":function(a){this.Fields[g]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,h,{"get":function(){return this.Fields[h]},"set":function(a){this.Fields[h]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(g,a.AssetId);a.SetSerializedField(c,a.TotalSessionTime);a.SetSerializedField(d,a.TrustPageSessionTime);a.SetSerializedField(e,a.DialogState);a.SetSerializedField(f,a.LastActiveTab);a.SetSerializedField(h,a.LastActiveTabCount)};return b}(h);i.InsertionDialogSessionUsageData=p;var q=function(e){__extends(d,e);function d(){e.call(this,"UploadFileDevCatelog")}Object.defineProperty(d.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,j,{"get":function(){return this.Fields[j]},"set":function(a){this.Fields[j]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});d.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.CorrelationId);a.SetSerializedField(j,a.OperationMetadata);a.SetSerializedField(c,a.ErrorResult)};return d}(h);i.UploadFileDevCatelogUsageData=q;var o=function(k){var j="AppSizeHeight",i="AppSizeWidth",h="IsAppCommand",g="AppTargetType",f="AppVersion",e="AppId",d="StoreType";__extends(c,k);function c(){k.call(this,"UploadFileDevCatalogUsage")}Object.defineProperty(c.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,g,{"get":function(){return this.Fields[g]},"set":function(a){this.Fields[g]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,h,{"get":function(){return this.Fields[h]},"set":function(a){this.Fields[h]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,i,{"get":function(){return this.Fields[i]},"set":function(a){this.Fields[i]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,j,{"get":function(){return this.Fields[j]},"set":function(a){this.Fields[j]=a},enumerable:a,configurable:a});c.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.CorrelationId);a.SetSerializedField(d,a.StoreType);a.SetSerializedField(e,a.AppId);a.SetSerializedField(f,a.AppVersion);a.SetSerializedField(g,a.AppTargetType);a.SetSerializedField(h,a.IsAppCommand);a.SetSerializedField(i,a.AppSizeWidth);a.SetSerializedField(j,a.AppSizeHeight)};return c}(h);i.UploadFileDevCatalogUsageUsageData=o;var k=function(c){__extends(b,c);function b(){c.call(this,"OneDriveCatalogGetAccessToken")}Object.defineProperty(b.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(d,a.Result);a.SetSerializedField(e,a.ResponseTime);a.SetSerializedField(f,a.Error)};return b}(h);i.OneDriveCatalogGetAccessTokenUsageData=k;var m=function(c){__extends(b,c);function b(){c.call(this,"OneDriveCatalogGetManifests")}Object.defineProperty(b.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(d,a.Result);a.SetSerializedField(e,a.ResponseTime);a.SetSerializedField(f,a.Error)};return b}(h);i.OneDriveCatalogGetManifestsUsageData=m;var n=function(g){var c="id";__extends(b,g);function b(){g.call(this,"OneDriveCatalogGetManifest")}Object.defineProperty(b.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(c,a.id);a.SetSerializedField(d,a.Result);a.SetSerializedField(e,a.ResponseTime);a.SetSerializedField(f,a.Error)};return b}(h);i.OneDriveCatalogGetManifestUsageData=n;var l=function(c){__extends(b,c);function b(){c.call(this,"OneDriveCatalogInsertManifest")}Object.defineProperty(b.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(d,a.Result);a.SetSerializedField(e,a.ResponseTime);a.SetSerializedField(f,a.Error)};return b}(h);i.OneDriveCatalogInsertManifestUsageData=l})(OSFLog||(OSFLog={}));var Telemetry;(function(a){var d=null;"use strict";(function(a){var c="verboseEx",b="unexpected";a[a[b]=10]=b;a[a.warning=15]="warning";a[a.info=50]="info";a[a.verbose=100]="verbose";a[a[c]=200]=c})(a.ULSTraceLevel||(a.ULSTraceLevel={}));var u=a.ULSTraceLevel;(function(a){var h="msoulscat_Osf_UploadFileDevCatalogUsage",g="msoulscat_Osf_UploadFileDevCatelog",f="msoulscat_Osf_InsertionDialogSession",e="msoulscat_Osf_AppManagementMenu",d="msoulscat_Osf_Runtime",c="msoulscat_Osf_Notification",b="msoulscat_Osf_Latency";a[a[b]=1401]=b;a[a[c]=1402]=c;a[a[d]=1403]=d;a[a[e]=1404]=e;a[a[f]=1405]=f;a[a[g]=1406]=g;a[a[h]=1411]=h})(a.ULSCat||(a.ULSCat={}));var v=a.ULSCat,j;(function(a){var d="IsAnonymous",c="InsertionDialogClosed",b="ConfirmationDialogCancel";a[a[b]=256]=b;a[a[c]=512]=c;a[a[d]=1024]=d})(j||(j={}));var h;(function(a){var b="TrustPageVisited",e="Canceled",d="Inserted",c="Undefined";a[a[c]=0]=c;a[a[d]=1]=d;a[a[e]=2]=e;a[a.Closed=3]="Closed";a[a[b]=8]=b})(h||(h={}));var b=function(){var a=true;function b(){this.timeValue=0}b.prototype.Start=function(){this.timeValue=-+new Date;this.finishedMeasurement=false};b.prototype.Stop=function(){if(this.timeValue<0){this.timeValue+=+new Date;this.finishedMeasurement=a}};Object.defineProperty(b.prototype,"Finished",{"get":function(){return this.finishedMeasurement},enumerable:a,configurable:a});Object.defineProperty(b.prototype,"ElapsedTime",{"get":function(){var a=this.timeValue;if(!this.Finished&&a<0)a=Math.abs(a)-+new Date;return a},enumerable:a,configurable:a});return b}();a.LatencyStopwatch=b;var t=function(){function a(){}return a}();a.Context=t;var c=function(){function a(){}a.SendULSTraceTag=function(a,b,d,c){if(!Microsoft.Office.WebExtension.FULSSupported)return;Diag.UULS.trace(c,a,b,d)};return a}(),k=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){c.SendULSTraceTag(a.category,a.level,b.SerializeRow(),6062431)};a.category=1402;a.level=50;return a}();a.NotificationLogger=k;var i=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){c.SendULSTraceTag(a.category,a.level,b.SerializeRow(),17085957)};a.category=1404;a.level=50;return a}();a.AppManagementMenuLogger=i;var g=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){c.SendULSTraceTag(a.category,a.level,b.SerializeRow(),17085958)};a.category=1406;a.level=50;return a}();a.UploadFileDevCatelogLogger=g;var e=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){c.SendULSTraceTag(a.category,a.level,b.SerializeRow(),0)};a.category=1411;a.level=50;return a}();a.UploadFileDevCatalogUsageLogger=e;var l=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){c.SendULSTraceTag(a.category,a.level,b.SerializeRow(),4748055)};a.category=1401;a.level=50;return a}();a.LatencyLogger=l;var f=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){c.SendULSTraceTag(a.category,a.level,b.SerializeRow(),17085959)};a.category=1405;a.level=50;return a}();a.InsertionDialogSessionLogger=f;var r=function(){function a(){}a.LogNotification=function(c,d,b){var a=new OSFLog.AppNotificationUsageData;a.CorrelationId=c;a.ErrorResult=d;a.NotificationClickInfo=b;k.Instance().LogData(a)};return a}();a.AppNotificationHelper=r;var p=function(){function a(){}a.LogAppManagementMenuAction=function(c,b,h,d,f,g){var a=new OSFLog.AppManagementMenuUsageData,e=c.toLowerCase().indexOf("wa")===0?parseInt(c.substring(2),10):parseInt(c,10);if(d)b|=512;if(f)b|=1024;a.AssetId=e;a.OperationMetadata=b;a.ErrorResult=g;i.Instance().LogData(a)};return a}();a.AppManagementMenuHelper=p;var o=function(){function a(){}a.LogUploadFileDevCatelogAction=function(c,b,f,e,h,d){var a=new OSFLog.UploadFileDevCatelogUsageData;a.CorrelationId=c;a.OperationMetadata=b;a.ErrorResult=d;g.Instance().LogData(a)};return a}();a.UploadFileDevCatelogHelper=o;var m=function(){function a(){}a.LogUploadFileDevCatalogUsageAction=function(d,i,j,h,c,g,f,b){var a=new OSFLog.UploadFileDevCatalogUsageUsageData;a.CorrelationId=d;a.StoreType=i;a.AppId=j;a.AppVersion=h;a.AppTargetType=c;a.IsAppCommand=g;a.AppSizeWidth=f;a.AppSizeHeight=b;e.Instance().LogData(a)};return a}();a.UploadFileDevCatalogUsageHelper=m;var s=function(){var m="Stage11Time",k="Stage10Time",j="Stage9Time",i="Stage8Time",h="Stage7Time",g="Stage5Time",f="Stage4Time",e="Stage2Time",c="Stage1Time";function a(){}a.ActivationStart=function(d,o,p,l,n){a.activatingNumber++;d.LoadTime=new OSFLog.AppLoadTimeUsageData;d.Timers={};d.LoadTime.CorrelationId=l;d.LoadTime.AppInfo=o;d.LoadTime.ActivationInfo=0;d.LoadTime.InstanceId=n;d.LoadTime.AssetId=p;d.LoadTime.Stage1Time=0;d.Timers[c]=new b;d.LoadTime.Stage2Time=0;d.Timers[e]=new b;d.LoadTime.Stage3Time=0;d.LoadTime.Stage4Time=0;d.Timers[f]=new b;d.LoadTime.Stage5Time=0;d.Timers[g]=new b;d.LoadTime.Stage6Time=a.activatingNumber;d.LoadTime.Stage7Time=0;d.Timers[h]=new b;d.LoadTime.Stage8Time=0;d.Timers[i]=new b;d.LoadTime.Stage9Time=0;d.Timers[j]=new b;d.LoadTime.Stage10Time=0;d.Timers[k]=new b;d.LoadTime.Stage11Time=0;d.Timers[m]=new b;d.LoadTime.ErrorResult=0;a.StartStopwatch(d,c)};a.ActivationEnd=function(b){a.ActivateEndInternal(b)};a.PageStart=function(b){a.StartStopwatch(b,e)};a.PageLoaded=function(b){a.StopStopwatch(b,e)};a.ServerCallStart=function(b){a.StartStopwatch(b,f)};a.ServerCallEnd=function(b){a.StopStopwatch(b,f)};a.AuthenticationStart=function(b){a.StartStopwatch(b,g)};a.AuthenticationEnd=function(b){a.StopStopwatch(b,g)};a.EntitlementCheckStart=function(b){a.StartStopwatch(b,h)};a.EntitlementCheckEnd=function(b){a.StopStopwatch(b,h)};a.KilledAppsCheckStart=function(b){a.StartStopwatch(b,i)};a.KilledAppsCheckEnd=function(b){a.StopStopwatch(b,i)};a.AppStateCheckStart=function(b){a.StartStopwatch(b,j)};a.AppStateCheckEnd=function(b){a.StopStopwatch(b,j)};a.ManifestRequestStart=function(b){a.StartStopwatch(b,k)};a.ManifestRequestEnd=function(b){a.StopStopwatch(b,k)};a.OfficeJSStartToLoad=function(b){a.StartStopwatch(b,m)};a.OfficeJSLoaded=function(b){a.StopStopwatch(b,m)};a.SetAnonymousFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,0)};a.SetRetryCount=function(c,b){a.SetActivationInfoField(c,b,3,2)};a.SetManifestTrustCachedFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,5)};a.SetManifestDataCachedFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,7)};a.SetOmexHasEntitlementFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,9)};a.SetManifestDataInvalidFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,11)};a.SetAppStateDataCachedFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,13)};a.SetAppStateDataInvalidFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,15)};a.SetErrorResult=function(b,c){if(b.LoadTime){b.LoadTime.ErrorResult=c;a.ActivateEndInternal(b)}};a.ConvertFlagToBit=function(a){return a?2:1};a.SetActivationInfoField=function(b,e,c,d){if(b.LoadTime){a.UpdateActivatingNumber(b);b.LoadTime.ActivationInfo=a.SetBitField(b.LoadTime.ActivationInfo,e,c,d)}};a.SetBitField=function(d,e,c,a){var f=Math.pow(2,c)-1<<a,b=d&~f;return b|e<<a};a.StopStopwatch=function(b,c){if(b.LoadTime&&b.Timers&&b.Timers[c]){b.Timers[c].Stop();a.UpdateActivatingNumber(b)}};a.StartStopwatch=function(b,c){if(b.LoadTime&&b.Timers&&b.Timers[c]){b.Timers[c].Start();a.UpdateActivatingNumber(b)}};a.UpdateActivatingNumber=function(b){if(b.LoadTime)b.LoadTime.Stage6Time=b.LoadTime.Stage6Time>a.activatingNumber?b.LoadTime.Stage6Time:a.activatingNumber};a.ActivateEndInternal=function(b){if(b.LoadTime){a.StopStopwatch(b,c);if(b.Timers)for(var e in b.Timers)if(b.Timers[e].ElapsedTime!=d)b.LoadTime[e]=b.Timers[e].ElapsedTime;l.Instance().LogData(b.LoadTime);b.LoadTime=d;a.activatingNumber--}};a.activatingNumber=0;return a}();a.AppLoadTimeHelper=s;var q=function(){var b=" SourceTag: {0}.";function a(){}a.LogProxyFailure=function(e,g,f){var b;if(e==d)e="";b=OSF.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",e,g);Object.keys(f).forEach(function(c){var a=f[c];if(a!=d)a=a.toString();b+=", "+c+":"+a});c.SendULSTraceTag(a.category,15,b,6062432)};a.LogExceptionTag=function(h,f,g,i){var e=h;if(f){if(f.name)e+=" Exception name:"+f.name+".";if(f.paramName)e+=" Param name:"+f.paramName+"."}if(g!=d)e+=" AppCorrelationId:"+g+".";e+=OSF.OUtil.formatString(b,i);c.SendULSTraceTag(a.category,15,e,6062433)};a.LogCommonMessage=function(e,f){var d=e;d+=OSF.OUtil.formatString(b,f);c.SendULSTraceTag(a.category,50,d,17413706)};a.category=1403;return a}();a.RuntimeTelemetryHelper=q;var n=function(){function a(){}a.LogInsertionDialogSession=function(c,g,d,j,i,e){var a=new OSFLog.InsertionDialogSessionUsageData,h=c.toLowerCase().indexOf("wa")===0?parseInt(c.substring(2),10):parseInt(c,10),b=0;if(j)b|=1;else b|=2;if(d>0)b|=8;a.AssetId=h;a.TotalSessionTime=g;a.TrustPageSessionTime=d;a.DialogState=b;a.LastActiveTab=i;a.LastActiveTabCount=e;f.Instance().LogData(a)};return a}();a.InsertionDialogSessionHelper=n})(Telemetry||(Telemetry={}));var OfficeExt;(function(a){(function(f){var k="ov:Control",d="Unexpected",j="ov:Description",a=null,i="bt:Image",h="ov:VersionOverrides",g="o:OfficeApp",l=function(){function a(b){var d="bt:String",a=this;a.Images={};a.Urls={};a.LongStrings={};a.ShortStrings={};var e=b.manifest._xmlProcessor.selectSingleNode(g),c=b.selectSingleNode(e,[h,"ov:Resources"]);a.parseCollection(b,b.selectChildNodes(i,c,["bt:Images"]),a.Images);a.parseCollection(b,b.selectChildNodes("bt:Url",c,["bt:Urls"]),a.Urls);a.parseCollection(b,b.selectChildNodes(d,c,["bt:LongStrings"]),a.LongStrings);a.parseCollection(b,b.selectChildNodes(d,c,["bt:ShortStrings"]),a.ShortStrings)}a.prototype.parseCollection=function(d,b,f){for(var e=b.length,a=0;a<e;a++){var c=b[a],g=c.getAttribute("id");f[g]=d.parseLocaleAwareSettingsAndGetValue(c)}};return a}();f.ManifestResourceManager=l;var b=function(){function b(d,c,b,e){var a=this;a.hostType=d;a.formFactor=c;a.entitlement=b;a.manifest=e;a.resources=new l(a)}b.prototype.parseIdRequired=function(c){var b=c.getAttribute("id");if(b==a)throw"id requird";return b};b.prototype.parseLabel=function(c){var b=this.manifest._xmlProcessor.selectSingleNode("ov:Label",c);return b!=a?this.getShortString(b):a};b.prototype.parseLabelRequired=function(c){var b=this.parseLabel(c);if(b==a)throw"label required";return b};b.prototype.parseRequiredSuperTip=function(c){var b=this.parseSuperTip(c);if(b==a)throw"SuperTip required";return b};b.prototype.parseSuperTip=function(h){var c=this,e=a,b=c.manifest._xmlProcessor.selectSingleNode("ov:Supertip",h);if(b!=a){var f=b,g,d;b=c.manifest._xmlProcessor.selectSingleNode("ov:Title",f);g=c.getShortString(b);b=c.manifest._xmlProcessor.selectSingleNode(j,f);d=c.getLongString(b);e={title:g,description:d}}return e};b.prototype.parseRequiredIcon=function(c){var b=this.parseIcon(c);if(b==a)throw"Icon required";return b};b.prototype.parseIcon=function(g){var c=this.selectChildNodes(i,g,["ov:Icon"]),f=c.length;if(f==0)return a;for(var e={},b=0;b<f;b++){var d=c[b],h=d.getAttribute("size");e[h]=this.getImageResource(d)}return e};b.prototype.parseChildControls=function(a,d,c){var b=this.manifest._xmlProcessor.selectNodes(a,d);return this.parseControls(b,c)};b.prototype.parseControls=function(e,f){for(var c=[],g=e.length,b=0;b<g;b++){var h=e[b],d=f(this,h);if(d==a)throw"parser must return a control.";c.push(d)}return c};b.prototype.parseControlInGroup=function(e){var c=e.getAttribute(b.typeAttributeName),a;switch(c){case"Menu":a=new D;break;case"Button":a=new t(c);break;default:throw d;}a.parse(this,e);return a};b.prototype.parseMenuItem=function(b){var a=new s;a.parse(this,b);return a};b.prototype.parseLocaleAwareSettingsAndGetValue=function(a){var c={},e=a.getAttribute("DefaultValue");c[this.manifest._defaultLocale]=e;var b=this.manifest._xmlProcessor.selectNodes("bt:Override",a);if(b)for(var h=b.length,d=0;d<h;d++){var a=b[d],f=a.getAttribute("Locale"),g=a.getAttribute("Value");c[f]=g}return this.manifest._getDefaultValue(c)};b.prototype.selectSingleNode=function(b,c){if(c==a)return b;for(var d=0;d<c.length;d++){b=this.manifest._xmlProcessor.selectSingleNode(c[d],b);if(b==a)break}return b};b.prototype.selectChildNodes=function(c,b,d){b=this.selectSingleNode(b,d);return b==a?[]:this.manifest._xmlProcessor.selectNodes(c,b)};b.prototype.getResourceByNode=function(e,d){var b=d.getAttribute("resid"),c=e[b];if(c==a)throw"resid: "+b+" not found";return c};b.prototype.getImageResource=function(a){return this.getResourceByNode(this.resources.Images,a)};b.prototype.getUrlResource=function(a){return this.getResourceByNode(this.resources.Urls,a)};b.prototype.getLongString=function(a){return this.getResourceByNode(this.resources.LongStrings,a)};b.prototype.getShortString=function(a){return this.getResourceByNode(this.resources.ShortStrings,a)};b.typeAttributeName="xsi:type";return b}();f.ParsingContext=b;var c=function(){function a(){}a.buildControls=function(c,b){for(var e=b.length,a=0;a<e;a++){var d=b[a];d.apply(c)}};return a}(),x=function(){function a(a,b){this.functionFile=a;this.builder=b}return a}(),o=function(){function a(a){this.type=a}a.prototype.buildAction=function(){};a.prototype.parse=function(){};return a}(),m=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.parse=function(a,c){var b=a.manifest._xmlProcessor.selectSingleNode("ov:SourceLocation",c),d=a.getUrlResource(b);this.sourceLocation=d};return a}(o),z=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.buildAction=function(a){return a.actionBuilder.buildShowTaskpane(this.sourceLocation)};return a}(m),A=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.buildAction=function(a){return a.actionBuilder.buildShowDialog(this.sourceLocation)};return a}(m),w=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.buildAction=function(a){return a.actionBuilder.buildCallFunction(a.functionFile,this.functionName)};a.prototype.parse=function(a,c){var b=a.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",c);this.functionName=a.manifest._xmlProcessor.getNodeValue(b)};return a}(o),e=function(){function a(){}a.prototype.parse=function(a,b){this.id=a.parseIdRequired(b);this.label=a.parseLabelRequired(b)};return a}(),D=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.apply=function(a){a.controlBuilder.startBuildMenu(this);c.buildControls(a,this.children);a.controlBuilder.endBuildMenu()};a.prototype.parse=function(a,d){var c=this;b.prototype.parse.call(c,a,d);c.icon=a.parseRequiredIcon(d);c.superTip=a.parseRequiredSuperTip(d);var e=a.selectChildNodes("ov:Item",d,["ov:Items"]);c.children=a.parseControls(e,function(a,b){return a.parseMenuItem(b)})};return a}(e),n=function(c){__extends(a,c);function a(a){c.call(this);this.controlType=a}a.prototype.apply=function(b){var a=this,d=a.action.buildAction(b),c={id:a.id,label:a.label,icon:a.icon,superTip:a.superTip,actionType:a.actionType,action:d};a.applyControl(b,c)};a.prototype.parse=function(f,h){var a=this;c.prototype.parse.call(a,f,h);a.icon=a.parseIcon(f,h);a.superTip=f.parseRequiredSuperTip(h);var i=f.manifest._xmlProcessor.selectSingleNode("ov:Action",h),e=i.getAttribute(b.typeAttributeName),g;switch(e){case"ShowTaskpane":g=new z(e);break;case"ShowDialog":g=new A(e);break;case"ExecuteFunction":g=new w(e);break;default:throw d;}g.parse(f,i);a.actionType=e;a.action=g};a.prototype.applyControl=function(){throw d;};a.prototype.parseIcon=function(a,b){return a.parseIcon(b)};return a}(e),t=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.applyControl=function(a,b){a.controlBuilder.addButton(b)};a.prototype.parseIcon=function(a,b){return a.parseRequiredIcon(b)};return a}(n),s=function(b){__extends(a,b);function a(){b.call(this,"MenuItem")}a.prototype.applyControl=function(a,b){a.controlBuilder.addMenuItem(b)};return a}(n),p=function(){function b(c){var b=this;b.label=a;b.isOfficeTab=false;b.children=[];b.isOfficeTab=c}b.prototype.apply=function(a){a.builder.ribbonBuilder.startBuildTab(this);for(var d=this.children.length,b=0;b<d;b++){var c=this.children[b];c.apply(a)}a.builder.ribbonBuilder.endBuildTab()};b.prototype.parse=function(b,c){var a=this;a.id=b.parseIdRequired(c);if(!a.isOfficeTab)a.label=b.parseLabelRequired(c);a.children=b.parseChildControls("ov:Group",c,function(b,c){var a=new q;a.parse(b,c);return a})};return b}(),q=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.parse=function(a,c){b.prototype.parse.call(this,a,c);this.icon=a.parseRequiredIcon(c);this.children=a.parseChildControls(k,c,function(a,b){return a.parseControlInGroup(b)})};a.prototype.apply=function(a){a.builder.ribbonBuilder.startBuildGroup(this);c.buildControls({functionFile:a.functionFile,actionBuilder:a.builder.actionBuilder,controlBuilder:a.builder.ribbonBuilder},this.children);a.builder.ribbonBuilder.endBuildGroup()};return a}(e),y=function(){function b(a){this.type=a;this.tabs=[]}b.prototype.apply=function(b){if(this.type==b.builder.commandSurface)for(var c=this.tabs.length,a=0;a<c;a++){var d=this.tabs[a];d.apply(b)}};b.prototype.parse=function(c,e){var b=c.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",e);if(b!=a){var d=new p(true);d.parse(c,b);this.tabs.push(d)}b=c.manifest._xmlProcessor.selectSingleNode("ov:CustomTab",e);if(b!=a){var d=new p(false);d.parse(c,b);this.tabs.push(d)}};return b}(),C=function(){function b(){}b.prototype.parse=function(a,b){this.id=a.parseIdRequired(b);this.children=a.parseChildControls(k,b,function(a,b){return a.parseControlInGroup(b)})};b.prototype.apply=function(b){b.controlBuilder.startBuildMenu({id:this.id,label:a,superTip:a});c.buildControls(b,this.children);b.controlBuilder.endBuildMenu()};return b}(),v=function(){function a(a){this.type=a}a.prototype.apply=function(a){this.type==a.builder.commandSurface&&c.buildControls({functionFile:a.functionFile,actionBuilder:a.builder.actionBuilder,controlBuilder:a.builder.contextMenuBuilder},this.children)};a.prototype.parse=function(a,b){this.children=a.parseChildControls("ov:OfficeMenu",b,function(b,c){var a=new C;a.parse(b,c);return a})};return a}(),B=function(){function c(){this.cacheableUrls=[];this.ExtensionPoints=[]}c.prototype.cacheableResources=function(){return this.cacheableUrls};c.prototype.apply=function(b){var a=this;b.startApplyAddin({entitlement:a.extensionEntitlement,manifest:a.extensionManifest,overrides:{type:a.type,description:a.description}});for(var d=new x(a.functionFile,b),f=a.ExtensionPoints.length,c=0;c<f;c++){var e=a.ExtensionPoints[c];e.apply(d)}b.endApplyAddin()};c.prototype.parse=function(c,i){var m="Not Implemented",d=this;d.type=i.getAttribute(b.typeAttributeName);var f=c.manifest._xmlProcessor.selectSingleNode(j,i);if(f!=a)d.description=c.getLongString(f);for(var n=c.selectChildNodes("ov:Host",i,["ov:Hosts"]),h=a,l=n.length,e=0;e<l;e++){var p=n[e],s=p.getAttribute(b.typeAttributeName);if(s==c.hostType){h=c.manifest._xmlProcessor.selectSingleNode("ov:"+c.formFactor,p);break}}f=c.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",h);d.functionFile=c.getUrlResource(f);var o=c.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",h);l=o.length;for(var e=0;e<l;e++){var q=o[e],k=q.getAttribute(b.typeAttributeName),g;switch(k){case"Events":throw m;case"PrimaryCommandSurface":g=new y(k);break;case"ContextMenu":g=new v(k);break;default:throw m;}g.parse(c,q);d.ExtensionPoints.push(g)}var r=c.resources.Images;for(var t in r)d.cacheableUrls.push(r[t]);d.extensionEntitlement=c.entitlement;d.extensionManifest=c.manifest};return c}(),r=function(){function a(){}a.prototype.cacheableResources=function(){return[]};a.prototype.apply=function(){};return a}(),u=function(){function c(b,a){this.hostType=b;this.formFactor=a}c.prototype.parseExtensions=function(i,c){var f=c._xmlProcessor.selectSingleNode(g),e=c._xmlProcessor.selectSingleNode(h,f);if(e==a)return new r;var d=new B;d.parse(new b(this.hostType,this.formFactor,i,c),e);return d};return c}();f.AddinCommandsManifestParser=u})(a.Parser||(a.Parser={}));var b=a.Parser})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(b){var a=function(){function a(){}a.createManifestForAddinAction=function(c,d){var b=new OSF.Manifest.ExtensionSettings,f=OSF.FormFactor.Default;b._defaultHeight=null;b._defaultWidth=null;b._sourceLocations={};b._sourceLocations[c._UILocale]=d;var a=c,e=new OSF.Manifest.Manifest(function(c){c._xmlProcessor=a._xmlProcessor;c._displayNames=a._displayNames;c._iconUrls=a._iconUrls;c._extensionSettings={formFactor:b};c._highResolutionIconUrls=a._highResolutionIconUrls;c._target=a._target;c._id=a._id;c._version=a._version;c._providerName=a._providerName;c._idIssuer=a._idIssuer;c._alternateId=a._alternateId;c._defaultLocale=a._defaultLocale;c._signature=a._signature;c._capabilities=a._capabilities;c._hosts=a._hosts;c._descriptions=a._descriptions;c._appDomains=a._appDomains;c._permissions=a._permissions;c._requirements=a._requirements},a._UILocale);return e};a.cacheManifestForAction=function(b,c,a){OSF.OsfManifestManager.cacheManifest(c,a,b)};a.purgeManifestForAction=function(b,a){OSF.OsfManifestManager.purgeManifest(b,a)};return a}();b.AddinCommandsManifestManager=a})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(a){var d="##UILessContainer##",b=null;a.AddinActionContextMap={};var e;(function(a){var d="ooeOperationNotSupported",c="ooeSuccess",b="ooeTimeout";a[a[b]=-1]=b;a[a[c]=0]=c;a[a[d]=5e3]=d})(e||(e={}));var h=function(){function e(a,c,b){this.contextProvider=a;this.manifest=b;this.entitlement=c}e.prototype.buildShowTaskpane=function(a){return this.CreateManifestAndActivationContextForTaskpaneCommand(a)};e.prototype.buildShowDialog=function(a){return this.CreateManifestAndActivationContextForDialogCommand(a)};e.prototype.buildCallFunction=function(a,b){return this.CreateManifestAndActivationContextForUILessCommand(a,b)};e.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(a){var b=function(b,a){a!=0};return this.CreateManifestAndActivationContext(a,function(d,c,a){d.showTaskpane(c,a,b)})};e.prototype.CreateManifestAndActivationContextForDialogCommand=function(a){var b=function(b,a){a!=0};return this.CreateManifestAndActivationContext(a,function(d,c,a){d.showDialog(c,a,b)})};e.prototype.CreateManifestAndActivationContext=function(d,e){var b=this,c=a.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,d);return function(d){var f=b.contextProvider.createActionContext(d,function(g){var f={assetId:b.entitlement.assetId+d,appVersion:b.entitlement.appVersion,storeId:b.entitlement.storeId,storeType:OSF.StoreType.InMemory,targetType:OSF.OsfControlTarget.TaskPane};a.AddinCommandsManifestManager.cacheManifestForAction(c,f.assetId,f.appVersion);e(g,f,c)});a.AddinActionContextMap[d]=f}};e.prototype.CreateManifestAndActivationContextForUILessCommand=function(g,h){var e=this,i=function(a,d){if(d!=0)return;c.invokeAppCommand(a,h,b,function(){})},f=a.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,g);return function(b){var g=e.contextProvider.createActionContext(b,function(g){var b={assetId:e.entitlement.assetId+d,appVersion:e.entitlement.appVersion,storeId:e.entitlement.storeId,storeType:OSF.StoreType.InMemory,targetType:OSF.OsfControlTarget.TaskPane};a.AddinCommandsManifestManager.cacheManifestForAction(f,b.assetId,b.appVersion);g.createUILessSandbox(b,f,function(a,b){if(b==0)var d=c.ensureOsfHostEntry(a,g);i(a,b)})});a.AddinActionContextMap[b]=g}};return e}(),f=function(){function b(a,b){this.contextProvider=a;this.entitlement=b}b.prototype.buildShowTaskpane=function(){var b=this;return function(c){delete a.AddinActionContextMap[c];a.AddinCommandsManifestManager.purgeManifestForAction(b.entitlement.assetId+c,b.entitlement.appVersion)}};b.prototype.buildShowDialog=function(){var b=this;return function(c){delete a.AddinActionContextMap[c];a.AddinCommandsManifestManager.purgeManifestForAction(b.entitlement.assetId+c,b.entitlement.appVersion)}};b.prototype.buildCallFunction=function(){var b=this;return function(c){delete a.AddinActionContextMap[c];a.AddinCommandsManifestManager.purgeManifestForAction(b.entitlement.assetId+d,b.entitlement.appVersion)}};return b}(),g=function(){function b(){}b.createActionBuilder=function(a,c,b){return new h(a,c,b)};b.createDeleterActionBuilder=function(a,b){return new f(a,b)};b.bindAction=function(a,c){var b=c;b(a)};b.retrieveActionContext=function(b){return a.AddinActionContextMap[b]};return b}();a.DefaultControlActionBinder=g;var i=function(){function a(){this.invocationQueue={}}a.prototype.invokeAppCommand=function(i,g,j,k,d){var e=this,f={dispid:OSF.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:e.osfControlId};f[0]=i;f[1]=g;f[2]=j;d=d?d:a.defaultTimeout;var h={args:f,onComplete:k,timeout:d,timeoutTimer:b},c=e.invocationQueue[g];if(c==b){c=[];e.invocationQueue[g]=c}c.push(h);c.length==1&&e.trySendInvocation(h)};a.prototype.invocationCompleted=function(f,g,i){var c=this,h=c;for(var e in c.invocationQueue){var d=c.invocationQueue[e],a=d[0];if(f==a.args[0]){if(d.length>1){d.splice(0,1);var j=d[0];window.setTimeout(function(){h.trySendInvocation(j)},0)}else delete c.invocationQueue[e];if(a.timeoutTimer!=b){window.clearTimeout(a.timeoutTimer);a.timeoutTimer=b}a.onComplete(g,i);return}}};a.prototype.sendInvocations=function(c){var a=this;a.eventHandler=c;if(c==b)return;for(var d in a.invocationQueue){var e=a.invocationQueue[d],f=e[0];a.sendInvocation(c,f)}};a.prototype.trySendInvocation=function(c){var a=this.eventHandler;a!=b&&this.sendInvocation(a,c)};a.prototype.sendInvocation=function(c,a){var d=this,b=a.args;c(b);a.timeoutTimer=window.setTimeout(function(){d.invocationTimeout(b[0])},a.timeout)};a.prototype.invocationTimeout=function(a){this.invocationCompleted(a,-1,b)};a.prototype.disposeHost=function(){var a=this;for(var c in a.invocationQueue)return;a.host.disposeHost(a.osfControlId);a.onDisposed!=b&&a.onDisposed(a)};a.defaultTimeout=300*1e3;return a}(),c=function(){var e="targetId",d="controlId",c="eventDispId";function a(){}a.registerEvent=function(g,f,b){a.registerEventInternal(b[c],b[d],b[e],g,function(a){f&&f(a==0)})};a.unregisterEvent=function(g,f,b){a.unregisterEventInternal(b[c],b[d],b[e],g,function(a){f&&f(a==0)})};a.invokeAppCommand=function(d,c,g,f){var h=a.getOrCreateOsfHostEntry(d),b=a.getNextAppCommandId(),e=JSON.stringify(g);h.invokeAppCommand(b,c,e,f)};a.invocationCompleted=function(d,b){var f=a.getOrCreateOsfHostEntry(d),c=b[0],e=b[1],g=JSON.parse(b[2]);f.invocationCompleted(c,e,g)};a.ensureOsfHostEntry=function(d,e){var c=a.getOrCreateOsfHostEntry(d);if(c.host==b)c.host=e;return c};a.getNextAppCommandId=function(){return"AppCmd"+a._nextAppCommandId++};a.getOrCreateOsfHostEntry=function(d){var c=a._invocationQueues[d];if(c==b){c=new i;c.osfControlId=d;c.onDisposed=function(b){delete a._invocationQueues[b.osfControlId]};a._invocationQueues[d]=c}return c};a.registerEventInternal=function(c,d,g,e,b){switch(c){case OSF.DDA.EventDispId.dispidAppCommandInvokedEvent:var f=a.getOrCreateOsfHostEntry(d);b(0);f.sendInvocations(e);return}b(5e3)};a.unregisterEventInternal=function(e,f,h,g,c){switch(e){case OSF.DDA.EventDispId.dispidAppCommandInvokedEvent:var d=a.getOrCreateOsfHostEntry(f);if(d.eventHandler==g)d.eventHandler=b;c(0);return}c(5e3)};a._nextAppCommandId=0;a._invocationQueues={};return a}();a.AddinCommandsRuntimeManager=c})(OfficeExt||(OfficeExt={}));var SPCatalogDataProvider=function(){var a=null,b=false;function c(){}c.prototype.validateAndCacheNewManifest=function(){return b};c.prototype.localCacheAddinCommands=function(){};c.prototype.getEntitlementsAsync=function(c,j,g){if(!c||!c._enableMyOrg){g({statusCode:OSF.InvokeResultCode.E_CATALOG_NO_APPS,value:a});return}var f,d=function(b){if(b!=a&&b.errorCode===OSF.InvokeResultCode.S_OK&&b.value){var e=b.value;f=[];for(var d=0;d<e.length;d++){var c=e[d],h={assetId:c[1],appVersion:c[4],storeId:c[11],storeType:OSF.StoreType.SPCatalog,targetType:c[3]};f.push(h)}}g(f)},h=function(e){if(e!=a&&e.value){c._myOrgCatalogUrl=e.value;var f={storeType:OSF.StoreTypeEnum.Catalog,refresh:b,fromInsertDialog:b,callbackFunc:d};c.queryEntitlementDetails(f)}else d({statusCode:OSF.InvokeResultCode.E_GENERIC_ERROR,value:a})},i=0,e=function(b){if(b){var f={webUrl:c._spBaseUrl,clientEndPoint:b},g={webUrl:c._spBaseUrl};OSF.OsfManifestManager._invokeProxyMethodAsync(f,"OEM_getSPCatalogUrlAsync",h,g)}else if(i++<OSF.Constants.AuthenticatedConnectMaxTries)setTimeout(function(){c._createSharePointIFrameProxy(c._spBaseUrl,e)},500);else d({statusCode:OSF.InvokeResultCode.E_GENERIC_ERROR,value:a})};if(c._spBaseUrl&&c._iframeProxies&&c._iframeProxies[c._spBaseUrl]&&c._iframeProxies[c._spBaseUrl].clientEndPoint)e(c._iframeProxies[c._spBaseUrl].clientEndPoint);else c._createSharePointIFrameProxy(c._spBaseUrl,e)};c.prototype.getManifestAsync=function(c,d){OSF.OUtil.validateParamObject(c,{contextActivationMgr:{type:Object,mayBeNull:b},referenceInUse:{type:Object,mayBeNull:b}},a);var f=function(b){OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd);if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){for(var h=b.context.referenceInUse,g=b.value.entitlements,i=g.length,c=a,f=0;f<i;f++){var e=g[f];if(e.OfficeExtensionID&&h.id&&e.OfficeExtensionID.toLowerCase()===h.id.toLowerCase())if(!c||OSF.OsfManifestManager.versionLessThan(c.OfficeExtensionVersion,e.OfficeExtensionVersion))c=e}if(c!=a){b.context.manifestUrl=c.EncodedAbsUrl;b.context.appInstanceId=c.AppInstanceID;b.context.productId=c.ProductID;OSF.OsfManifestManager.getManifestAsync(b.context,Function.createDelegate(this,d))}else d({statusCode:OSF.ProxyCallStatusCode.Failed,value:a})}else d({statusCode:OSF.ProxyCallStatusCode.Failed,value:a})},e=OSF.OsfManifestManager.getCachedManifest(c.referenceInUse.id,c.referenceInUse.version);if(e==a){c.webUrl=c.referenceInUse.storeLocator;c.osfControl={_contextActivationMgr:c.contextActivationMgr,_telemetryContext:{}};c.noTargetType=true;c.hostType=c.contextActivationMgr._hostType;OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementStart);OSF.OsfManifestManager.getCorporateCatalogEntitlementsAsync(c,Function.createDelegate(this,f))}else d({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:e,context:c})};return c}(),OfficeExt;(function(b){var a=null,c=function(){var c=".";function b(a){this._cacheManager=a}b.prototype.validateAndCacheNewManifest=function(c,b,a,d,e){if(this.validateAddinIdAndVersion(b,a)){this.cacheManifest(c,b,a,d,e);return true}return false};b.prototype.localCacheAddinCommands=function(a,b){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(a),b)};b.prototype.getEntitlementsAsync=function(c,j,i){var b=this,h=b,d=[],g=[],f=j?b.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(c):b.getUploadFileDevCatalogAddinsCacheKey(c),e=b._cacheManager.GetCacheItem(f);if(e!=a){e.forEach(function(b){var e=h._cacheManager.GetCacheItem(h.getUploadFileDevCatalogManifestCacheKey(c,b));if(e!=a){var f=new OSF.Manifest.Manifest(e,c.getAppUILocale()),i={assetId:b,appVersion:f.getMarketplaceVersion(),storeId:"developer",storeType:OSF.StoreType.UploadFileDevCatalog,targetType:f.getTarget()};g.push(i);d.push(b)}});if(d.length!=e.length)if(d.length>0)b._cacheManager.SetCacheItem(f,d);else b._cacheManager.RemoveCacheItem(f)}i(g)};b.prototype.getManifestAsync=function(b,e){OSF.OUtil.validateParamObject(b,{contextActivationMgr:{type:Object,mayBeNull:false},referenceInUse:{type:Object,mayBeNull:false}},a);var c=OSF.OsfManifestManager.getCachedManifest(b.referenceInUse.id,b.referenceInUse.version);if(c==a){var d=this._cacheManager.GetCacheItem(this.getUploadFileDevCatalogManifestCacheKey(b.contextActivationMgr,b.referenceInUse.id));if(d!=a)c=new OSF.Manifest.Manifest(d,b.contextActivationMgr.getAppUILocale())}e(c!=a?{statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,context:b}:{statusCode:OSF.ProxyCallStatusCode.Failed,value:a})};b.prototype.cleanMyAddins=function(c){var b=this.getUploadFileDevCatalogAddinsCacheKey(c),d=this._cacheManager.GetCacheItem(b);d!=a&&this._cacheManager.RemoveCacheItem(b)};b.prototype.validateAddinIdAndVersion=function(c,a){return b.idRegExp.test(c)&&b.versionRegExp.test(a)};b.prototype.cacheManifest=function(c,b,e,d,f){var a=this;OSF.OsfManifestManager.cacheManifest(b,e,f);a.cacheMyAddins(a.getUploadFileDevCatalogAddinsCacheKey(c),b);a._cacheManager.SetCacheItem(a.getUploadFileDevCatalogManifestCacheKey(c,b),d)};b.prototype.cacheMyAddins=function(c,d){var b=this._cacheManager.GetCacheItem(c);if(b==a)b=[];if(b.lastIndexOf(d)<0){b.push(d);this._cacheManager.SetCacheItem(c,b)}};b.prototype.getUploadFileDevCatalogAddinsCacheKey=function(a){return b.UploadFileCatalogCacheKey.myAddins+c+a.getAppName()+c+a.getUserNameHashCode()};b.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(a){return b.UploadFileCatalogCacheKey.addinCommandsMyAddins+c+a.getAppName()+c+a.getUserNameHashCode()};b.prototype.getUploadFileDevCatalogManifestCacheKey=function(a,d){return b.UploadFileCatalogCacheKey.manifest+c+a.getAppName()+c+d};b.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.";b.UploadFileCatalogCacheKey={myAddins:b.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:b.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:b.UploadFileCatalogCacheKeyPrefix+"Manifest"};b.idRegExp=new RegExp("[\\w-]+");b.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}");return b}(),d=function(){function d(){}d.createAddinDataProvider=function(e){var d=a;switch(e){case OSF.StoreType.UploadFileDevCatalog:d=new c(new b.AppsDataCacheManager(OSF.OUtil.getLocalStorage(),new b.SafeSerializer));break;case OSF.StoreType.OMEX:d=OmexDataProvider.GetInstance(new b.AppsDataCacheManager(OSF.OUtil.getLocalStorage(),new b.SafeSerializer));break;case OSF.StoreType.SPCatalog:d=new SPCatalogDataProvider}return d};return d}();b.AddinDataProviderFactory=d})(OfficeExt||(OfficeExt={}));if(!isDefinePropertySupported){if(!OsfMsAjaxFactory.msAjaxError)OsfMsAjaxFactory.msAjaxError=Error;if(!OsfMsAjaxFactory.msAjaxSerializer)OsfMsAjaxFactory.msAjaxSerializer=Sys.Serialization.JavaScriptSerializer;if(!OsfMsAjaxFactory.msAjaxString)OsfMsAjaxFactory.msAjaxString=String;if(!OsfMsAjaxFactory.msAjaxDebug)OsfMsAjaxFactory.msAjaxDebug=Sys.Debug;Object.defineProperty=definePropertySave}OSF.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote"};OSF.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation"};OSF.HostPlatform={Web:"Web"};OSF.HostSpecificFileVersionDefault="16.00";OSF.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01"},onenote:{web:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.00"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01"}};OSF.getAppVerCode=function(c){var b="Invalid appName.",a;switch(c){case OSF.AppName.ExcelWebApp:a="excel.exe";break;case OSF.AppName.AccessWebApp:a="ZAC";break;case OSF.AppName.PowerpointWebApp:a="WAP";break;case OSF.AppName.WordWebApp:a="WAW";break;case OSF.AppName.OneNoteWebApp:a="WAO";break;default:OsfMsAjaxFactory.msAjaxDebug.trace(b);throw b;}return a};OSF.getManifestHostType=function(b){var a;switch(b){case OSF.HostType.Excel:a=OSF.ManifestHostType.Workbook;break;case OSF.HostType.Word:a=OSF.ManifestHostType.Document;break;case OSF.HostType.PowerPoint:a=OSF.ManifestHostType.Presentation;break;default:OsfMsAjaxFactory.msAjaxDebug.trace("Invalid host type.");throw"Invalid hostType.";}return a};OSF.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notes:"Notes"};OSF.HostCapability={Excel:OSF.Capability.Workbook,Outlook:OSF.Capability.Mailbox,Access:OSF.Capability.Database,PowerPoint:OSF.Capability.Presentation,Word:OSF.Capability.Document,Sway:OSF.Capability.Sway,OneNote:OSF.Capability.Notes};OSF.OsfControlTarget={InContent:0,TaskPane:1,Contextual:2};OSF.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadWriteDocument:6,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131};OSF.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8};OSF.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,Failed:4,FailedOriginCheck:5,FailedPermissionCheck:6};OSF.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",FileSystem:"filesystem",Exchange:"exchange",OneDrive:"onedrive",Registry:"registry",InMemory:"inmemory",UploadFileDevCatalog:"uploadfiledevcatalog"};OSF.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"};OSF.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15};OSF.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4};OSF.OmexTrialType={None:0,Office:1,External:2};OSF.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"};OSF.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3};OSF.OmexRemoveAppStatus={Failed:0,Success:1};OSF.OfficeAppType={ContentApp:OSF.OsfControlTarget.InContent,TaskPaneApp:OSF.OsfControlTarget.TaskPane,MailApp:OSF.OsfControlTarget.Contextual};OSF.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"};OSF.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"};OSF.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"};OSF.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"};OSF.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1};OSF.Constants={FileVersion:"16.0.6820.2201",ThreePartsFileVersion:"16.0.6820",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"http://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js"};var _omexXmlNamespaces='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';OSF.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160"};OSF.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4};OSF.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};function _getAppSubType(b){var a;if(b===0)a=OSF.AppSubType.Content;else if(b===1)a=OSF.AppSubType.Taskpane;else throw OsfMsAjaxFactory.msAjaxError.argument("officeExtentionTarget");return a}function _getAppVersion(b){var a=OSF.AppVersion[b.toLowerCase()];if(typeof a=="undefined")throw OsfMsAjaxFactory.msAjaxError.argument("applicationName");return a}function _invokeCallbackTag(g,h,k,j,a,l){var b=j;if(g){try{var d={status:h,result:k,failureInfo:null},e=function(a,c,b){if(a.failureInfo===null)a.failureInfo={};a.failureInfo[c]=b};if(a){var f=-1;if(a.get_statusCode)f=a.get_statusCode();if(!b)if(a.get_timedOut&&a.get_timedOut())b="Request timed out.";else if(a.get_aborted&&a.get_aborted())b="Request aborted.";if(f>=400||h===statusCode.Failed||b){e(d,"statusCode",f);e(d,"tagId",l);var c=a.get_webRequest();if(c){c.getResolvedUrl&&e(d,"url",c.getResolvedUrl());if(a.getResponseHeader&&c.get_userContext&&c.get_userContext()&&!c.get_userContext().correlationId){var i=a.getResponseHeader("X-CorrelationId");e(d,"correlationId",i)}}}}if(b){e(d,"message",b);OsfMsAjaxFactory.msAjaxDebug.trace(b)}}catch(m){OsfMsAjaxFactory.msAjaxDebug.trace("Encountered exception with logging: "+m)}g(d)}}var _serviceEndPoint=null,_defaultRefreshRate=3,_msPerDay=864e5,_defaultTimeout=6e4,_officeVersionHeader="X-Office-Version",_hourToDayConversionFactor=24,_buildParameter="&build=",_expectedVersionParameter="&expver=",_queryStringParameters={clientName:"client",clientVersion:"cv"},statusCode={Succeeded:1,Failed:0};function _sendWebRequest(e,h,c,g,b,d){b=b||{};var a=new Sys.Net.WebRequest;for(var f in c)a.get_headers()[f]=c[f];if(b){if(b.officeVersion)a.get_headers()[_officeVersionHeader]=b.officeVersion;if(b.correlationId)e+="&corr="+b.correlationId}d&&a.set_body(d);a.set_url(e);a.set_httpVerb(h);a.set_timeout(_defaultTimeout);a.set_userContext(b);a.add_completed(g);a.invoke()}function _onCompleted(a,f){var b=null,c=a.get_webRequest().get_userContext(),d=a.get_webRequest().get_url();if(a.get_timedOut()){OsfMsAjaxFactory.msAjaxDebug.trace("Request timed out: "+d);_invokeCallbackTag(c.callback,statusCode.Failed,b,b,a,8757955)}else if(a.get_aborted()){OsfMsAjaxFactory.msAjaxDebug.trace("Request aborted: "+d);_invokeCallbackTag(c.callback,statusCode.Failed,b,b,a,8757956)}else if(a.get_responseAvailable())if(a.get_statusCode()==200)try{c._onCompleteHandler(a,f)}catch(g){OsfMsAjaxFactory.msAjaxDebug.trace("Request failed with exception "+g+": "+d);_invokeCallbackTag(c.callback,statusCode.Failed,g,b,a,8757957)}else{var e=a.get_statusText();OsfMsAjaxFactory.msAjaxDebug.trace("Request failed with status code "+e+": "+d);_invokeCallbackTag(c.callback,statusCode.Failed,e,b,a,8757958)}else{OsfMsAjaxFactory.msAjaxDebug.trace("Request failed: "+d);_invokeCallbackTag(c.callback,statusCode.Failed,e,b,a,8757959)}}function _isProxyReady(b,a){a&&a({status:statusCode.Succeeded,result:true})}function _createQueryStringFragment(b){var c="";for(var d in b){var a=b[d];if(a===null||a===undefined||a==="")continue;c+="&"+encodeURIComponent(d)+"="+encodeURIComponent(a)}return c}OSF.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942};OSF.BWsaStreamTypes={Static:1};OSF.BWsaConfig={defaultMaxStreamRows:1e3};OSF.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052};OSF.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10};OSF.OmexClientNames=function(){var a={},b=OSF.AppName;a[b.ExcelWebApp]="WAC_Excel";a[b.WordWebApp]="WAC_Word";a[b.OutlookWebApp]="WAC_Outlook";a[b.AccessWebApp]="WAC_Access";a[b.PowerpointWebApp]="WAC_Powerpoint";a[b.OneNoteWebApp]="WAC_OneNote";return a}();OSF.OmexAppVersions=function(){var a={},b=OSF.AppName;a[b.ExcelWebApp]=OSF.AppVersion.excelwebapp;a[b.WordWebApp]=OSF.AppVersion.wordwebapp;a[b.OutlookWebApp]=OSF.AppVersion.outlookwebapp;a[b.AccessWebApp]=OSF.AppVersion.access;a[b.PowerpointWebApp]=OSF.AppVersion.powerpointwebapp;a[b.OneNoteWebApp]=OSF.AppVersion.OneNoteWebApp;return a}();OSF.ManifestSchemaVersion={"1.0":"1.0","1.1":"1.1"};OSF.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',"1.1":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides"'};OSF.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2};OSF.StoreTypeEnum={MarketPlace:0,Catalog:1,OneDrive:9};OSF.RequirementsChecker=function(d,f,e,c,b){var a=this;a.setCapabilities(d);a.setHosts(f);a.setRequirements(e);a.setSupportedControlTargets(c);a.setSupportedOmexAppVersions(b);a.setFilteringEnabled(false)};OSF.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(a){if(!this.isFilteringEnabled())return true;if(!a)return false;var b=a.getManifestSchemaVersion()||OSF.ManifestSchemaVersion["1.0"];switch(b){case OSF.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(a);case OSF.ManifestSchemaVersion["1.1"]:return this._checkManifest1_1(a);default:return false}},isEntitlementFromOmexSupported:function(a){var c=this;if(!c.isFilteringEnabled())return true;if(!a)return false;var d;switch(a.appSubType){case"1":d=OSF.OsfControlTarget.TaskPane;break;case"2":d=OSF.OsfControlTarget.InContent;break;case"3":d=OSF.OsfControlTarget.Contextual;break;case"4":d=OSF.OsfControlTarget.TaskPane;break;default:return false}if(!c._checkControlTarget(d))return false;if(!a.requirements&&!a.hosts)return!a.hasOwnProperty("appVersions")?true:c._checkOmexAppVersions(a.appVersions);var b=new OSF.Manifest.Manifest(function(){}),e,f,h,g;if(a.requirements){b._xmlProcessor=new OSF.XmlProcessor(a.requirements,OSF.ManifestNamespaces["1.1"]);f=b._xmlProcessor.getDocumentElement()}e=b._parseRequirements(f);if(a.hosts){b._xmlProcessor=new OSF.XmlProcessor(a.hosts,OSF.ManifestNamespaces["1.1"]);g=b._xmlProcessor.getDocumentElement()}h=b._parseHosts(g);return c._checkHosts(h)&&c._checkSets(e.sets)&&c._checkMethods(e.methods)},isEntitlementFromCorpCatalogSupported:function(c){var a=this;if(!a.isFilteringEnabled())return true;if(!c)return false;var i=OSF.OfficeAppType[c.OEType];if(!a._checkControlTarget(i))return false;var b=new OSF.Manifest.Manifest(function(){}),g,h,f;if(c.OfficeExtensionCapabilitiesXML){b._xmlProcessor=new OSF.XmlProcessor(c.OfficeExtensionCapabilitiesXML,OSF.ManifestNamespaces["1.1"]);var e,d;e=b._xmlProcessor.getDocumentElement();d=b._parseRequirements(e);h=d.sets;f=d.methods;g=b._parseHosts(e)}return a._checkHosts(g)&&a._checkSets(h)&&a._checkMethods(f)},setCapabilities:function(a){this._supportedCapabilities=this._scalarArrayToObject(a)},setHosts:function(a){this._supportedHosts=this._scalarArrayToObject(a)},setRequirements:function(a){var b=this;b._supportedSets=a&&b._arrayToSetsObject(a.sets)||{};b._supportedMethods=a&&b._scalarArrayToObject(a.methods)||{}},setSupportedControlTargets:function(a){this._supportedControlTargets=this._scalarArrayToObject(a)},setSupportedOmexAppVersions:function(a){this._supportedOmexAppVersions=a&&a.slice?a.slice(0):[]},setFilteringEnabled:function(a){this._filteringEnabled=a?true:false},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(a){return this._checkCapabilities(a.getCapabilities())},_checkCapabilities:function(a){if(!a||a.length===0)return true;for(var b=0;b<a.length;b++)if(this._supportedCapabilities[a[b]])return true;return false},_checkManifest1_1:function(b){var a=b.getRequirements()||{};return this._checkHosts(b.getHosts())&&this._checkSets(a.sets)&&this._checkMethods(a.methods)},_checkHosts:function(a){if(!a||a.length===0)return true;for(var b=0;b<a.length;b++)if(this._supportedHosts[a[b]])return true;return false},_checkSets:function(b){var a=this;if(!b||b.length===0)return true;for(var e=0;e<b.length;e++){var c=b[e],d=a._supportedSets[c.name];if(!d)return false;if(c.version)if(a._compareVersionStrings(d.minVersion||a.defaultMinMaxVersion,c.version)>0||a._compareVersionStrings(d.maxVersion||a.defaultMinMaxVersion,c.version)<0)return false}return true},_checkMethods:function(a){if(!a||a.length===0)return true;for(var b=0;b<a.length;b++)if(!this._supportedMethods[a[b]])return false;return true},_checkControlTarget:function(a){return a!=undefined&&this._supportedControlTargets[a]},_checkOmexAppVersions:function(b){if(!b)return false;for(var a=0;a<this._supportedOmexAppVersions.length;a++)if(b.indexOf(this._supportedOmexAppVersions[a])>=0)return true;return false},_scalarArrayToObject:function(a){var c={};if(a&&a.length)for(var b=0;b<a.length;b++)if(a[b]!=undefined)c[a[b]]=true;return c},_arrayToSetsObject:function(a){var d={};if(a&&a.length)for(var c=0;c<a.length;c++){var b=a[c];if(b&&b.name!=undefined)d[b.name]=b}return d},_getSupportedSet:function(){for(var a={},c=Object.getOwnPropertyNames(this._supportedSets),b=0;b<c.length;b++){var d=this._supportedSets[c[b]];a[d.name.toLowerCase()]=d.maxVersion||this.defaultMinMaxVersion}return typeof JSON!=="undefined"?JSON.stringify(a):a},_compareVersionStrings:function(b,a){b=b.split(".");a=a.split(".");for(var f=Math.max(b.length,a.length),c=0;c<f;c++){var e=parseInt(b[c],10)||0,d=parseInt(a[c],10)||0;if(e===d)continue;return e-d}return 0}};var _omexDataProvider=OmexDataProvider.GetInstance(new OfficeExt.AppsDataCacheManager(OSF.OUtil.getLocalStorage(),new OfficeExt.SafeSerializer));OSF.OsfControl=function(b){var d=null,e=true,c=false,a=this;OSF.OUtil.validateParamObject(b,{div:{type:Object,mayBeNull:c},contextActivationMgr:{type:Object,mayBeNull:c},id:{type:String,mayBeNull:c},marketplaceID:{type:String,mayBeNull:c},marketplaceVersion:{type:String,mayBeNull:c},store:{type:String,mayBeNull:c},storeType:{type:String,mayBeNull:c},alternateReference:{type:Object,mayBeNull:e},settings:{type:Object,mayBeNull:e},reason:{type:String,mayBeNull:e},osfControlType:{type:Number,mayBeNull:e},snapshotUrl:{type:String,mayBeNull:e},preactivationCallback:{type:Object,mayBeNull:e},virtualOsfControlActivationCallback:{type:Object,mayBeNull:e},isvirtualOsfControl:{type:Boolean,mayBeNull:e}},d);a._div=b.div;a._contextActivationMgr=b.contextActivationMgr;a._id=b.id;a._storeType=b.storeType.toLowerCase();a._storeLocator=b.store;a._marketplaceID=b.marketplaceID;a._marketplaceVersion=b.marketplaceVersion;a._alternateReference=b.alternateReference;a._settings=b.settings||{};a._reason=b.reason==undefined?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:b.reason;a._osfControlType=b.osfControlType==undefined?OSF.OsfControlType.DocumentLevel:b.osfControlType;a._snapshotUrl=b.snapshotUrl;a._status=OSF.OsfControlStatus.NotActivated;a._errorcode=0;a._notificationParams=d;a._iframeUrl=d;a._permission=d;a._conversationId=d;a._manifestUrl=d;a._pageStatus=OSF.OsfControlPageStatus.NotStarted;a._pageIsReadyTimerExpired=c;a._timer=d;a._retryLoadingNum=2;a._frame=d;a._agaveEndPoint=d;a._etoken="";a._sqmDWords=[0,0];a._preactivationCallback=b.preactivationCallback;a._telemetryContext={};a._controlFocus=c;a._dataProvider=OfficeExt.AddinDataProviderFactory.createAddinDataProvider(a._storeType,a._contextActivationMgr);a._manifest=d;a._virtualOsfControlActivationCallback=b.virtualOsfControlActivationCallback;a._isvirtualOsfControl=b.isvirtualOsfControl==undefined?c:b.isvirtualOsfControl;a._isvirtualOsfControlCallbackInvoked=c;if(OSF.OUtil.isiOS()){a._div.style.webkitOverflowScrolling="touch";a._div.style.overflow="auto"}a._appCorrelationId=OSF.OUtil.Guid.generateNewGuid();a._iframeOnLoadDelegate=Function.createDelegate(a,a._iframeOnLoad);a._retryActivate=d};OSF.OsfControl.prototype={activate:function(d){var f=true,c=null,h=false,a=this;try{Telemetry.AppLoadTimeHelper.ActivationStart(a._telemetryContext,a._sqmDWords[0],a._sqmDWords[1],a.getCorrelationId(),a._id);a._controlFocus=h;a._pageStatus=OSF.OsfControlPageStatus.Loading;OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.ActivationStart);if(a._status!==OSF.OsfControlStatus.Activated){if(a._frame){OSF.OUtil.removeEventListener(a._frame,"load",a._iframeOnLoadDelegate);a._frame=c}while(a._div.childNodes.length>0)a._div.removeChild(a._div.childNodes.item(0));a._contextActivationMgr._ErrorUXHelper.showProgress(a._div,a._id);a._contextActivationMgr.registerOsfControl(a);d=d||{};d.hostType=a._contextActivationMgr._hostType;d.osfControl=d.osfControl||a;d.referenceInUse=d.referenceInUse||{id:a._marketplaceID,version:a._marketplaceVersion,storeType:a._storeType,storeLocator:a._storeLocator};d.correlationId=d.osfControl._appCorrelationId;if(!a._doesBrowserSupportRequiredFeatures()){a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),c,c,c,f,OSF.ErrorStatusCodes.E_BROWSER_VERSION);a.invokePreactivationCompletedCallback();return}var o=document.createElement("iframe"),x="sandbox"in o;o=c;var m=h,l=OSF.OUtil.getLocalStorage();if(l)m=l.getItem(OSF.Constants.IgnoreSandBoxSupport);if(a._contextActivationMgr._autoTrusted&&!x&&!m){a._contextActivationMgr._ErrorUXHelper.removeProgressDiv(a._div,a._id);a._status=OSF.OsfControlStatus.NotSandBoxSupported;a._errorcode=OSF.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport;a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(a._activateAgavesBlockedBySandboxNotSupport,a._contextActivationMgr),url:OSF.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:c,reDisplay:f,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:f});a.invokePreactivationCompletedCallback();return}var b=a;Telemetry.AppLoadTimeHelper.ServerCallStart(a._telemetryContext);var e=d.referenceInUse;if(e.storeType===OSF.StoreType.UploadFileDevCatalog)a._dataProvider.getManifestAsync({referenceInUse:d.referenceInUse,contextActivationMgr:a._contextActivationMgr},Function.createDelegate(a,a._onGetManifestCompleted));else if(e.storeType===OSF.StoreType.Exchange||e.storeType===OSF.StoreType.InMemory)OSF.OsfManifestManager.getManifestAsync(d,Function.createDelegate(a,a._onGetManifestCompleted));else if(e.storeType===OSF.StoreType.Registry&&a._contextActivationMgr._enableDevCatalog)if(d.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened){var w=function(c){var a=new OSF.Manifest.Manifest(c,b._contextActivationMgr.getAppUILocale());!OSF.OsfManifestManager.hasManifest(a.getMarketplaceID(),a.getMarketplaceVersion())&&OSF.OsfManifestManager.cacheManifest(a.getMarketplaceID(),a.getMarketplaceVersion(),a);OSF.OsfManifestManager.getManifestAsync(d,Function.createDelegate(b,b._onGetManifestCompleted))},v=function(a){alert("Error when requsting manifest file: "+a)};OSF.OUtil.xhrGet(a._contextActivationMgr._devCatalogUrl+"/"+e.id+".xml",w,v)}else OSF.OsfManifestManager.getManifestAsync(d,Function.createDelegate(a,a._onGetManifestCompleted));else if(e.storeType===OSF.StoreType.OneDrive&&a._contextActivationMgr._enableOneDriveCatalog){var q=function(c){var a=new OSF.Manifest.Manifest(c,b._contextActivationMgr.getAppUILocale());OSF.OsfManifestManager.cacheManifest(e.id,a.getMarketplaceVersion(),a);OSF.OsfManifestManager.getManifestAsync(d,Function.createDelegate(b,b._onGetManifestCompleted))},r=function(){b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),c,c,c,c,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},y=window.location.protocol+"//"+window.location.host;OSF.OneDriveOAuth.setHostCallbackUri(y);var k=a._contextActivationMgr._oneDriveCatalogBaseApiUrl+"/root:/Manifests/"+e.id+":/content?access_token=",t=function(a){k=k+a;OSF.OUtil.xhrGet(k,q,r)},u=function(){b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),c,c,c,c,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)};OSF.OneDriveOAuth.getAccessToken(t,u)}else if(e.storeType===OSF.StoreType.SPCatalog)if(a._contextActivationMgr._doesUrlHaveSupportedProtocol(e.storeLocator)){Telemetry.AppLoadTimeHelper.EntitlementCheckStart(a._telemetryContext);d.webUrl=e.storeLocator;OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementStart);OSF.OsfManifestManager.getCorporateCatalogEntitlementsAsync(d,Function.createDelegate(a,a._onGetEntitlementsCompleted))}else a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,c,c,c,c,c,c,OSF.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID);else if(e.storeType===OSF.StoreType.SPApp){Telemetry.AppLoadTimeHelper.EntitlementCheckStart(a._telemetryContext);d.baseUrl=a._contextActivationMgr.getPageBaseUrl();d.pageUrl=a._contextActivationMgr._docUrl;d.webUrl=a._contextActivationMgr._webUrl;d.appWebUrl=a._contextActivationMgr._webUrl;OSF.OsfManifestManager.getSPAppEntitlementsAsync(d,Function.createDelegate(a,a._onGetEntitlementsCompleted))}else if(e.storeType===OSF.StoreType.OMEX)if(a._contextActivationMgr.isExternalMarketplaceAllowed()&&a._contextActivationMgr._doesUrlHaveSupportedProtocol(a._contextActivationMgr._osfOmexBaseUrl)){if(!a._omexEntitlement){a._omexEntitlement={contentMarket:e.storeLocator,version:e.version,assetId:e.id,etoken:"",hasEntitlement:h};a._omexEntitlement.endPointUrl=a._contextActivationMgr._getOmexEndPointPageUrl(e.id,e.storeLocator)}d.clientVersion=a._contextActivationMgr._getClientVersionForOmex();if(d.clientVersion){d.clientName=a._contextActivationMgr._getClientNameForOmex();d.appVersion=a._contextActivationMgr._getAppVersionForOmex()}var s=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var d=parseInt(a.value);if(d==OSF.OmexAuthNStatus.Authenticated){b._contextActivationMgr._omexAuthNStatus=OSF.OmexAuthNStatus.Authenticated;b._contextActivationMgr._createOmexProxy(b._contextActivationMgr._omexGatedWSProxy,i)}else if(d==OSF.OmexAuthNStatus.Anonymous||d==OSF.OmexAuthNStatus.Unknown){b._contextActivationMgr._omexAuthNStatus=OSF.OmexAuthNStatus.Anonymous;b._contextActivationMgr._createOmexProxy(b._contextActivationMgr._omexAnonymousWSProxy,g)}}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("OMEX_getAuthNStatus failed:"+OSF.OUtil.serializeOMEXResponseErrorMessage(a),c,c,17585048);b._contextActivationMgr._omexAuthNStatus=OSF.OmexAuthNStatus.CheckFailed;if(b._contextActivationMgr._omexForceAnonymous)b._contextActivationMgr._createOmexProxy(b._contextActivationMgr._omexAnonymousWSProxy,g);else b._contextActivationMgr._createOmexProxy(b._contextActivationMgr._omexGatedWSProxy,i)}},j=1,g=function(a){if(a)if(b._contextActivationMgr._omexAuthNStatus==OSF.OmexAuthNStatus.NotAttempted){var e={clientEndPoint:c};e.clientEndPoint=a;OSF.OsfManifestManager._invokeProxyMethodAsync(d,"OMEX_getAuthNStatus",s,e)}else{Telemetry.AppLoadTimeHelper.AuthenticationEnd(b._telemetryContext);Telemetry.AppLoadTimeHelper.KilledAppsCheckStart(b._telemetryContext);if(b._contextActivationMgr._omexAuthNStatus==OSF.OmexAuthNStatus.CheckFailed)b._contextActivationMgr._omexForceAnonymous=f;d.anonymous=f;Telemetry.AppLoadTimeHelper.SetAnonymousFlag(b._telemetryContext,d.anonymous);d.clientEndPoint=a;OSF.OsfManifestManager.getOmexKilledAppsAsync(d,Function.createDelegate(b,b._onGetOmexKilledAppsCompleted));Telemetry.AppLoadTimeHelper.AppStateCheckStart(b._telemetryContext);OSF.OsfManifestManager.getOmexAppStateAsync(d,Function.createDelegate(b,b._onGetOmexAppStateCompleted))}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("ClientEndPoint is null after creating anonymouseOmexProxy.",c,c,17356608);b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),c,c,c,c,OSF.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError)}};Telemetry.AppLoadTimeHelper.AuthenticationStart(a._telemetryContext);var i=function(a){Telemetry.AppLoadTimeHelper.SetRetryCount(b._telemetryContext,j);if(a){Telemetry.AppLoadTimeHelper.AuthenticationEnd(b._telemetryContext);Telemetry.AppLoadTimeHelper.EntitlementCheckStart(b._telemetryContext);d.anonymous=h;Telemetry.AppLoadTimeHelper.SetAnonymousFlag(b._telemetryContext,d.anonymous);d.clientEndPoint=a;OSF.OsfManifestManager.getOmexEntitlementsAsync(d,Function.createDelegate(b,b._onGetOmexEntitlementsCompleted));Telemetry.AppLoadTimeHelper.KilledAppsCheckStart(b._telemetryContext);OSF.OsfManifestManager.getOmexKilledAppsAsync(d,Function.createDelegate(b,b._onGetOmexKilledAppsCompleted))}else if(j<OSF.Constants.AuthenticatedConnectMaxTries){j++;if(b._contextActivationMgr._omexAuthNStatus==OSF.OmexAuthNStatus.CheckFailed)b._contextActivationMgr._createOmexProxy(b._contextActivationMgr._omexGatedWSProxy,i);else b._contextActivationMgr._createOmexProxy(b._contextActivationMgr._omexAnonymousWSProxy,g)}else b._contextActivationMgr._createOmexProxy(b._contextActivationMgr._omexAnonymousWSProxy,g)},n=f,p={contentMarket:e.storeLocator,assetID:e.id};if(_omexDataProvider.AllCached(d,p))try{Telemetry.AppLoadTimeHelper.AuthenticationEnd(b._telemetryContext);d.anonymous=f;d.clientEndPoint={};Telemetry.AppLoadTimeHelper.KilledAppsCheckStart(b._telemetryContext);OSF.OsfManifestManager.getOmexKilledAppsAsync(d,Function.createDelegate(b,b._onGetOmexKilledAppsCompleted));Telemetry.AppLoadTimeHelper.AppStateCheckStart(b._telemetryContext);OSF.OsfManifestManager.getOmexAppStateAsync(d,Function.createDelegate(b,b._onGetOmexAppStateCompleted));n=h}catch(A){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("omexDataProvider cache check failed.",A,c,17585049)}if(n)if(a._contextActivationMgr._omexAuthNStatus==OSF.OmexAuthNStatus.CheckFailed)if(a._contextActivationMgr._omexForceAnonymous)a._contextActivationMgr._createOmexProxy(a._contextActivationMgr._omexAnonymousWSProxy,g);else a._contextActivationMgr._createOmexProxy(a._contextActivationMgr._omexGatedWSProxy,i);else if(a._contextActivationMgr._omexForceAnonymous)a._contextActivationMgr._createOmexProxy(a._contextActivationMgr._omexAnonymousWSProxy,g);else{a._contextActivationMgr._omexAuthNStatus=OSF.OmexAuthNStatus.NotAttempted;a._contextActivationMgr._createOmexProxy(a._contextActivationMgr._omexGatedWSProxy,i)}a._contextActivationMgr._preloadOfficeJs()}else a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,c,c,c,c,c,c,OSF.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED);else if(e.storeType===OSF.StoreType.FileSystem||e.storeType===OSF.StoreType.Registry)a._showActivationWarning(OSF.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,c,c,c,c,OSF.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType);else if(e.storeType===OSF.StoreType.OneDrive)a._showActivationWarning(OSF.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,c,c,c,c,OSF.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType);else a._showActivationError(OSF.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,c,c,c,c,c,c,OSF.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}}catch(z){OsfMsAjaxFactory.msAjaxDebug.trace("Error getting app data: "+z);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Error getting app data.",z,a.getCorrelationId(),8208995);a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),c,c,c,c,OSF.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}a.invokePreactivationCompletedCallback()},deActivate:function(){var b=null,a=this;try{OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.DeactivationStart);a._contextActivationMgr.dismissMessages(a._id);a._retryActivate=b;if(a._status!==OSF.OsfControlStatus.NotActivated){if(a._agaveEndPoint){Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(a._agaveEndPoint._conversationId);a._agaveEndPoint=b}if(a._frame){OSF.OUtil.removeEventListener(a._frame,"load",a._iframeOnLoadDelegate);a._frame=b}if(a._timer){window.clearTimeout(a._timer);a._timer=b}while(a._div.childNodes.length>0)a._div.removeChild(a._div.childNodes.item(0));a._status=OSF.OsfControlStatus.NotActivated;a._conversationId&&a._contextActivationMgr._getServiceEndPoint().unregisterConversation(a._conversationId);a._contextActivationMgr.raiseOsfControlStatusChange(a)}a._controlFocus=false;OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.DeactivationEnd)}catch(c){OsfMsAjaxFactory.msAjaxDebug.trace("Deactivate failed: "+c);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Deactivate failed.",c,a.getCorrelationId(),8209024)}},purge:function(c){var a=this,b=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:false}]);if(b)throw b;try{a._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(a._id);a.deActivate();c&&OSF.OsfManifestManager.purgeManifest(a._marketplaceID,a._marketplaceVersion);a._contextActivationMgr.unregisterOsfControl(a)}catch(d){OsfMsAjaxFactory.msAjaxDebug.trace("Purge failed: "+d);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Purge failed.",d,a.getCorrelationId(),8209025)}},invokeVirtualOsfControlActivationCallback:function(b){var a=this;if(!a._isvirtualOsfControlCallbackInvoked&&a._virtualOsfControlActivationCallback){a._virtualOsfControlActivationCallback(a,b);a._isvirtualOsfControlCallbackInvoked=true}},onForceGetVirtualOsfControlManifestCompleted:function(a){var b=null;if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value)b=a.value;else{this._status=OSF.OsfControlStatus.ActivationFailed;this._errorcode=OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE}this.invokeVirtualOsfControlActivationCallback(b)},forceGetVirtualOsfControlManifest:function(){var b=null,a=this,c={contextActivationMgr:b,referenceInUse:b};c.referenceInUse={id:a._marketplaceID,version:a._marketplaceVersion,storeType:a._storeType,storeLocator:a._storeLocator};c.contextActivationMgr=a._contextActivationMgr;if(a._dataProvider!=b)a._dataProvider.getManifestAsync(c,a.onForceGetVirtualOsfControlManifestCompleted);else{alert("AddinCommands is not supported in "+c.referenceInUse.storeType+" store.");a.onForceGetVirtualOsfControlManifestCompleted({statusCode:OSF.ProxyCallStatusCode.Failed,value:b})}},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getMarketplaceID:function(){return this._marketplaceID},getMarketplaceVersion:function(){return this._marketplaceVersion},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(a){this._settings=a},getReason:function(){return this._reason},getOsfControlType:function(){return this._osfControlType},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},getStoreLocator:function(){return this._storeLocator},getProperty:function(b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false}]);if(a)throw a;return this._settings[b]},addProperty:function(c,b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false},{name:"value",type:String,mayBeNull:false}]);if(a)throw a;this._settings[c]=b},removeProperty:function(b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false}]);if(a)throw a;delete this._settings[b]},getStatus:function(){return this._status},getErrorcode:function(){return this._errorcode},getNotificationParams:function(){return this._notificationParams},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return false},getEToken:function(){return this._omexEntitlement?this._omexEntitlement.etoken:this._etoken},getCorrelationId:function(){return this._appCorrelationId},notifyAgave:function(a){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,a)},_onGetEntitlementsCompleted:function(b){var a=null,d=this;b.context&&b.context.referenceInUse.storeType===OSF.StoreType.SPCatalog&&OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd);if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){Telemetry.AppLoadTimeHelper.EntitlementCheckEnd(d._telemetryContext);for(var h=b.context.referenceInUse,g=b.value.entitlements,i=g.length,c,e=a,f=0;f<i;f++){c=g[f];if(c.OfficeExtensionID&&h.id&&c.OfficeExtensionID.toLowerCase()===h.id.toLowerCase())if(!e||d._lessThan(e.OfficeExtensionVersion,c.OfficeExtensionVersion))e=c}c=e;if(!c)d._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback(function(a){a.osfControl._refresh(a)},{clearCache:true,referenceInUse:b.context.referenceInUse,osfControl:b.context.osfControl}),a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST);else if(c.OfficeExtensionKillbit)d._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,a,a,a,a,a,a,OSF.ErrorStatusCodes.E_OEM_EXTENSION_KILLED);else{b.context.manifestUrl=c.EncodedAbsUrl;b.context.appInstanceId=c.AppInstanceID;b.context.productId=c.ProductID;if(b.context.appInstanceId)OSF.OsfManifestManager.getAppInstanceInfoByIdAsync(b.context,Function.createDelegate(d,d._onGetAppInstanceInfoByIdCompleted));else OSF.OsfManifestManager.getManifestAsync(b.context,Function.createDelegate(d,d._onGetManifestCompleted))}}else d._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(d,d._refresh),a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){var d=null,b=this;if(e.statusCode===OSF.ProxyCallStatusCode.Succeeded&&e.value){var c=e.value,a=e.context;if(c.AppWebFullUrl)a.appWebUrl=c.AppWebFullUrl;a.clientId=c.AppPrincipalId;a.remoteAppUrl=c.RemoteAppUrl;if(a.appWebUrl&&a.productId)OSF.OsfManifestManager.getSPTokenByProductIdAsync(a,Function.createDelegate(b,b._onGetSPTokenByProductIdCompleted));else OSF.OsfManifestManager.getManifestAsync(a,Function.createDelegate(b,b._onGetManifestCompleted))}else b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),d,d,d,d,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value)this._etoken=a.value;OSF.OsfManifestManager.getManifestAsync(a.context,Function.createDelegate(this,this._onGetManifestCompleted))},_onGetOmexEntitlementsCompleted:function(b){var d=null,a=this;if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){Telemetry.AppLoadTimeHelper.EntitlementCheckEnd(a._telemetryContext);var g=b.context.referenceInUse,f=b.value.entitlements,i=f.length,c,h=false;a._contextActivationMgr._omexBillingMarket=b.value.billingMarket;_omexDataProvider.SetCustomerId(b.value.cid);for(var e=0;e<i;e++){c=f[e];if(c.assetId&&g.id&&c.assetId.toLowerCase()===g.id.toLowerCase()){h=true;break}}if(h){a._omexEntitlement.hasEntitlement=true;a._omexEntitlement.productId=c.productId;a._omexEntitlement.version=c.version;a._omexEntitlement.contentMarket=c.contentMarket;a._omexEntitlement.licenseType=c.licenseType;a._omexEntitlement.endPointUrl=a._contextActivationMgr._getOmexEndPointPageUrl(a._omexEntitlement.assetId,a._omexEntitlement.contentMarket)}Telemetry.AppLoadTimeHelper.SetOmexHasEntitlementFlag(a._telemetryContext,a._omexEntitlement.hasEntitlement);Telemetry.AppLoadTimeHelper.AppStateCheckStart(a._telemetryContext);OSF.OsfManifestManager.getOmexAppStateAsync(b.context,Function.createDelegate(a,a._onGetOmexAppStateCompleted))}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("getOmexEntilements failed:"+OSF.OUtil.serializeOMEXResponseErrorMessage(b),d,d,17585050);a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),d,d,d,d,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}},_onGetOmexKilledAppsCompleted:function(b){var a=null,c=this;if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){Telemetry.AppLoadTimeHelper.KilledAppsCheckEnd(c._telemetryContext);!b.cached&&_omexDataProvider.SetKilledAppsCache(b.context,b.value);for(var e=b.value.killedApps,g=e.length,f=false,d=0;d<g;d++)if(e[d].assetId===c._marketplaceID){f=true;break}if(f){c._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,a,a,c._omexEntitlement.endPointUrl,a,a,a,OSF.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED);return}}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("getOmexKilledApps failed:"+OSF.OUtil.serializeOMEXResponseErrorMessage(b),a,a,17585051)},_onGetOmexAppStateCompleted:function(d){var f=true,b=null,a=this;if(d.statusCode===OSF.ProxyCallStatusCode.Succeeded&&d.value){Telemetry.AppLoadTimeHelper.AppStateCheckEnd(a._telemetryContext);Telemetry.AppLoadTimeHelper.SetAppStateDataCachedFlag(a._telemetryContext,d.cached);var c=d.context,g=d.value,h=parseInt(g.state);if(h===OSF.OmexState.Killed){a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,b,b,a._omexEntitlement.endPointUrl,b,b,b,OSF.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED);return}else if(h===OSF.OmexState.Flagged)c.showSoftKilled=f;else if(h===OSF.OmexState.DeveloperWithdrawn)c.showDeveloperWithDrawWarning=f;if(!a._omexEntitlement.hasEntitlement&&(c.showDeveloperWithDrawWarning||c.showSoftKilled)){a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveRetired_ERR,b,b,a._omexEntitlement.endPointUrl,b,b,b,OSF.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE);if(c.showSoftKilled)return}a._omexEntitlement.latestVersion=g.version;if(a._omexEntitlement.hasEntitlement&&a._lessThan(a._omexEntitlement.version,a._omexEntitlement.latestVersion)){c.showNewerVersion=f;c.expectedVersion=a._omexEntitlement.latestVersion}!d.cached&&_omexDataProvider.SetAppStateCache(c,g);if(!c.anonymous&&a._reason!=Microsoft.Office.WebExtension.InitializationReason.Inserted&&!a._omexEntitlement.hasEntitlement){var e=a,i=function(){c.anonymous=f;c.clientEndPoint=e._contextActivationMgr._omexAnonymousWSProxy.clientEndPoint;Telemetry.AppLoadTimeHelper.ManifestRequestStart(e._telemetryContext);OSF.OsfManifestManager.getOmexManifestAndETokenAsync(c,Function.createDelegate(e,e._onGetOmexManifestAndETokenCompleted))};e._contextActivationMgr._createOmexProxy(e._contextActivationMgr._omexAnonymousWSProxy,i);return}}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("getOmexAppState failed:"+OSF.OUtil.serializeOMEXResponseErrorMessage(d),b,b,17585052);Telemetry.AppLoadTimeHelper.ManifestRequestStart(a._telemetryContext);OSF.OsfManifestManager.getOmexManifestAndETokenAsync(d.context,Function.createDelegate(a,a._onGetOmexManifestAndETokenCompleted))},_onGetOmexManifestAndETokenCompleted:function(g){var a=null,c=true,b=this;if(g.statusCode===OSF.ProxyCallStatusCode.Succeeded&&g.value){var f=g.value,e=parseInt(f.status),d=g.context,h=d.referenceInUse;Telemetry.AppLoadTimeHelper.SetManifestDataCachedFlag(b._telemetryContext,g.cached);if(e===OSF.OmexClientAppStatus.OK){if(d.acceptedUpgrade){b._refresh({clearEntitlement:c,clearAppState:c,referenceInUse:h,osfControl:b});return}if(f.tokenExpirationDate&&new Date(f.tokenExpirationDate)<=new Date){b._showActivationWarning(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,OSF.ErrorStatusCodes.E_TOKEN_EXPIRED);return}b._omexEntitlement.etoken=f.etoken;b._omexEntitlement.entitlementType=f.entitlementType;if(!d.anonymous&&b._omexEntitlement.entitlementType&&b._omexEntitlement.entitlementType.toLowerCase()===OSF.OmexEntitlementType.Trial)d.showTrialInfo=c;try{!g.cached&&_omexDataProvider.SetManifestAndETokenCache(d,f);var i=new OSF.Manifest.Manifest(f.manifest,b._contextActivationMgr.getAppUILocale());d.manifestCached=f.cached;OSF.OsfManifestManager.cacheManifest(h.id,h.version,i);if(b._omexEntitlement.latestVersion&&b._lessThan(i.getMarketplaceVersion(),b._omexEntitlement.latestVersion)){d.showNewerVersion=c;d.expectedVersion=b._omexEntitlement.latestVersion}b._onGetManifestCompleted({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:i,context:d})}catch(n){OsfMsAjaxFactory.msAjaxDebug.trace("Invalid manifest from marketplace: "+n);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest from marketplace.",n,b.getCorrelationId(),8209026);b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);return}}else if(e===OSF.OmexClientAppStatus.KilledAsset)b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,a,a,b._omexEntitlement.endPointUrl,a,a,a,OSF.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED);else if(e===OSF.OmexClientAppStatus.NoEntitlement||e===OSF.OmexClientAppStatus.TrialNotSupported||e===OSF.OmexClientAppStatus.LimitedTrial||e===OSF.OmexClientAppStatus.EntitlementDeactivated)if(!d.anonymous){var j=function(b){var a=b.osfControl;a._refresh({clearCache:c,referenceInUse:b.referenceInUse,osfControl:a})},l=function(d){var b=d.osfControl;window.open(b._omexEntitlement.endPointUrl);b._contextActivationMgr.displayNotification({id:b._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:Function.createCallback(j,d),url:a,dismissCallback:a,detailView:c,reDisplay:c,displayDeactive:c,retryAll:c,errorCode:OSF.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})};b._retryActivate=Function.createCallback(j,d);b._showActivationWarning(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,Strings.OsfRuntime.L_BuyButton_TXT,Function.createCallback(l,d),a,a,OSF.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED)}else{var m=function(d){var b=d.osfControl,c=window.location.href,a=b._contextActivationMgr._osfOmexBaseUrl+OSF.Constants.SignInRedirectUrl+encodeURIComponent(c);window.open(a)};b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,Strings.OsfRuntime.L_SignInButton_TXT,Function.createCallback(m,d),a,a,Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,a,OSF.ErrorStatusCodes.E_USER_NOT_SIGNED_IN)}else if(e===OSF.OmexClientAppStatus.UnknownAssetId)b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,a,a,a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST);else if(e===OSF.OmexClientAppStatus.Expired||e===OSF.OmexClientAppStatus.Invalid)b._showActivationWarning(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,OSF.ErrorStatusCodes.E_TOKEN_EXPIRED);else if(e===OSF.OmexClientAppStatus.Revoked)b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveRetired_ERR,a,a,b._omexEntitlement.endPointUrl,a,a,a,OSF.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE);else if(e===OSF.OmexClientAppStatus.VersionMismatch){var k=function(b){var a=b.osfControl;a._refresh({clearManifest:c,clearToken:c,referenceInUse:b.referenceInUse,osfControl:a,acceptedUpgrade:c,expectedVersion:f.version})};b._contextActivationMgr.displayNotification({id:b._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:Function.createCallback(k,d),url:b._omexEntitlement.endPointUrl,dismissCallback:a,detailView:false,reDisplay:c,highPriority:c,displayDeactive:c,logAsError:c,errorCode:OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})}else if(e===OSF.OmexClientAppStatus.VersionNotSupported)b._showActivationWarning(OSF.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,a,a,a,a,OSF.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType);else b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,a,a,OSF.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus)}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("GetOmexManifestAndEToken failed:"+OSF.OUtil.serializeOMEXResponseErrorMessage(g),a,a,17585053);b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}},_retryActivation:function(){var a=this;a._retryLoadingNum--;if(a._pageStatus===OSF.OsfControlPageStatus.Ready||a._retryLoadingNum<=0){a._contextActivationMgr._ErrorUXHelper.removeProgressDiv(a._div,a._id);a._retryLoadingNum=2}else a._refresh()},_iframeOnLoad:function(){var a=this;Telemetry.AppLoadTimeHelper.PageLoaded(this._telemetryContext);var b=function(a){var b=null;if(a){if(a._contextActivationMgr._ErrorUXHelper){OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.SelectionTimeout);a._contextActivationMgr._ErrorUXHelper.removeProgressDiv(a._div,a._id)}if(a._pageStatus!==OSF.OsfControlPageStatus.Ready)if(a._retryLoadingNum===2){var c=OSF.ErrorStatusCodes.WAC_AgaveActivationError;switch(a._pageStatus){case OSF.OsfControlPageStatus.FailedOriginCheck:c=OSF.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case OSF.OsfControlPageStatus.FailedPermissionCheck:c=OSF.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case OSF.OsfControlPageStatus.Failed:c=OSF.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._retryActivation),b,b,b,b,c)}else a._retryLoadingNum===1&&a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(a,a._retryActivation),b,b,b,b,OSF.ErrorStatusCodes.WAC_ActivateAttempLoading);if(a._timer){window.clearTimeout(a._timer);a._timer=b}a._pageIsReadyTimerExpired=true}};if(a._pageStatus!==OSF.OsfControlPageStatus.Ready)a._timer=window.setTimeout(function(){b(a)},5e3*a._retryLoadingNum+1)},_isOsfControlInEmbeddingMode:function(d){var a=false;try{var c=d.getContainingDiv().parentNode.parentNode,b=c.id,e=b.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/ig);a=e!=null}catch(f){OsfMsAjaxFactory.msAjaxDebug.trace("_isOsfControlInEmbeddingMode error: "+f)}return a},_createIframeAndActivateOsfControl:function(c){var b=this,a=document.createElement("iframe");a.setAttribute("id",b._id);a.setAttribute("width","100%");a.setAttribute("height","100%");a.setAttribute("frameborder","0");var e=c?c:Strings.OsfRuntime.L_IframeTitle_TXT;a.setAttribute("title",e);a.style.msUserSelect="element";a.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");for(var d in b._contextActivationMgr._iframeAttributeBag)a.setAttribute(d,b._contextActivationMgr._iframeAttributeBag[d]);b._activate(a,b._iframeUrl);b._frame=a},_onGetManifestCompleted:function(h){var b=null,f=false,d=true,a=this;if(h.statusCode===OSF.ProxyCallStatusCode.Succeeded&&h.value){Telemetry.AppLoadTimeHelper.ManifestRequestEnd(a._telemetryContext);Telemetry.AppLoadTimeHelper.ServerCallEnd(a._telemetryContext);var g=h.value,c=h.context,j=c.referenceInUse,e=j.storeType,k=g.getDefaultDisplayName();a._manifest=g;if(c.manifestCached&&!c.retried){var q=g.getMarketplaceVersion();if(a._lessThan(q,j.version))if(e===OSF.StoreType.SPApp||e===OSF.StoreType.SPCatalog){a._refresh({clearCache:d,referenceInUse:j,osfControl:c.osfControl,retried:d});return}else if(e===OSF.StoreType.OMEX&&!c.showNewerVersion){c.showNewerVersion=d;c.expectedVersion=j.version}}if(g.requirementsSupported===f||g.requirementsSupported===undefined&&!a._contextActivationMgr.getRequirementsChecker().isManifestSupported(g)){g.requirementsSupported=f;var m,l,n=b;if(e===OSF.StoreType.OMEX){m=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR;l=OSF.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex;n=a._omexEntitlement.endPointUrl}else{m=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR;l=OSF.ErrorStatusCodes.WAC_AgaveRequirementsError}a._showActivationError(OSF.OsfControlStatus.ActivationFailed,m,b,b,n,b,b,d,l);return}g.requirementsSupported=d;a._iframeUrl=g.getDefaultSourceLocation(a._contextActivationMgr.getFormFactor());a._permission=g.getPermission();a._appDomains=g.getAppDomains();if((e===OSF.StoreType.SPApp||e===OSF.StoreType.SPCatalog)&&a._iframeUrl){if(c.clientId)a._iframeUrl=a._iframeUrl.replace(/~clientid/ig,c.clientId);if(c.appWebUrl)a._iframeUrl=a._iframeUrl.replace(/~appweburl/ig,c.appWebUrl);if(c.remoteAppUrl)a._iframeUrl=a._iframeUrl.replace(/~remoteappurl/ig,c.remoteAppUrl)}if(!a._contextActivationMgr._doesUrlHaveSupportedProtocol(a._iframeUrl)){a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,b,b,b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);return}if((!c.anonymous||!a._isOsfControlInEmbeddingMode(c.osfControl))&&!a._isvirtualOsfControl&&e!=OSF.StoreType.SPApp&&e!=OSF.StoreType.Exchange&&e!=OSF.StoreType.InMemory&&e!=OSF.StoreType.Registry&&e!=OSF.StoreType.UploadFileDevCatalog){var i=f,t=a._reason==Microsoft.Office.WebExtension.InitializationReason.Inserted||a._contextActivationMgr._autoTrusted||f;c.cacheKey=OSF.OUtil.formatString(OSF.Constants.ActivatedCacheKey,c.referenceInUse.id.toLowerCase(),c.referenceInUse.storeType,c.referenceInUse.storeLocator);i=a._getCachedFlag(c.cacheKey);if(e==OSF.StoreType.OMEX&&_omexDataProvider.GetCustomerId()!="0")i=a._omexEntitlement&&a._omexEntitlement.hasEntitlement;Telemetry.AppLoadTimeHelper.SetManifestTrustCachedFlag(a._telemetryContext,i);if(!i&&!t&&!a.getTrustNoPrompt()){OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.ActivationEnd);var s=function(c){var a=c.osfControl;a._setCachedFlag(c.cacheKey);Telemetry.AppLoadTimeHelper.ActivationStart(a._telemetryContext,a._sqmDWords[0],a._sqmDWords[1],a._appCorrelationId,a._id);this._pageStatus=OSF.OsfControlPageStatus.Loading;if(e==OSF.StoreType.OMEX&&_omexDataProvider.GetCustomerId()!="0"){c.anonymous=f;c.clientEndPoint=a._contextActivationMgr._omexGatedWSProxy.clientEndPoint;var g=function(c){if(c.statusCode===OSF.ProxyCallStatusCode.Succeeded&&c.value){var e=c.value,f=parseInt(e.status),g=c.context;if(f===OSF.OmexClientAppStatus.OK){!c.cached&&_omexDataProvider.SetManifestAndETokenCache(g,e);a._refresh({clearEntitlement:d,osfControl:a});return}}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Manual active getOmexManifestAndEToken failed:"+OSF.OUtil.serializeOMEXResponseErrorMessage(c),b,b,17585054);a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)};OSF.OsfManifestManager.getOmexManifestAndETokenAsync(c,Function.createDelegate(a,g))}else{Telemetry.AppLoadTimeHelper.SetAnonymousFlag(a._telemetryContext,c.anonymous);a._createIframeAndActivateOsfControl(k)}};a._showTrustError(k,g.getProviderName(),e,Function.createCallback(s,c));return}if(a._reason==Microsoft.Office.WebExtension.InitializationReason.Inserted){a._contextActivationMgr._setCachedFlag(c.cacheKey);c.osfControl._retryActivate=b;a._contextActivationMgr.retryAll(c.osfControl._marketplaceID)}}if(c.showNewerVersion){var r=function(a){var b=a.osfControl;b._refresh({clearManifest:d,clearToken:d,referenceInUse:a.referenceInUse,osfControl:b,acceptedUpgrade:d,expectedVersion:a.expectedVersion,retried:d})};a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:Function.createCallback(r,c),url:a._omexEntitlement.endPointUrl,dismissCallback:b,detailView:f,reDisplay:d,highPriority:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})}else if(c.showDeveloperWithDrawWarning)a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:b,url:a._omexEntitlement.endPointUrl,dismissCallback:b,detailView:f,reDisplay:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE});else if(c.showSoftKilled)a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:b,url:a._omexEntitlement.endPointUrl,dismissCallback:b,detailView:f,reDisplay:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED});else if(c.showTrialInfo){var o=function(b){var a=b.osfControl;a._refresh({clearCache:d,referenceInUse:b.referenceInUse,osfControl:a})},p=function(b){var a=b.osfControl;window.open(a._omexEntitlement.endPointUrl)};a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Information,title:Strings.OsfRuntime.L_AgaveInformationTitle_TXT,description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:Function.createCallback(p,c),url:b,dismissCallback:b,reDisplay:d,highPriority:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE});a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Information,title:Strings.OsfRuntime.L_AgaveInformationTitle_TXT,description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:Function.createCallback(o,c),url:b,dismissCallback:b,detailView:d,reDisplay:d,highPriority:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.S_USER_CLICKED_BUY})}if(!a._isvirtualOsfControl)a._createIframeAndActivateOsfControl(k);else!c.showNewerVersion&&a.invokeVirtualOsfControlActivationCallback(g)}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+OSF.OUtil.serializeOMEXResponseErrorMessage(h),b,b,17585055);a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}},_lessThan:function(a,b){return OSF.OsfManifestManager.versionLessThan(a,b)},_showTrustError:function(g,f,i,e){var b=true,a=this,d=OSF.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,g?g:"");d=a._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(d);var c=OSF.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,f?f:"");c=a._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(c);var h=OSF.OUtil.formatString(Strings.OsfRuntime.L_AgaveUntrusted_INFO,d,c);a._retryActivate=e;a._errorcode=OSF.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED;a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.SecurityInfo,title:Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,description:h,buttonTxt:Strings.OsfRuntime.L_ActivateButton_TXT,buttonCallback:e,url:i===OSF.StoreType.OMEX?a._omexEntitlement.endPointUrl:null,dismissCallback:null,reDisplay:b,displayDeactive:b,logAsError:b,retryAll:b,errorCode:OSF.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED})},_showActivationError:function(e,k,i,f,l,d,g,h,c){var b=true,a=this;a._status=e;a._errorcode=c;var j={id:a._id,infoType:OSF.InfoType.Error,status:e,title:g||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:k,buttonTxt:i||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:f||null,url:l||null,dismissCallback:d||null,reDisplay:!d?b:false,displayDeactive:b,detailView:h?b:false,logAsError:b,errorCode:c?c:0};a._contextActivationMgr.displayNotification(j);a._contextActivationMgr.raiseOsfControlStatusChange(a)},_showActivationWarning:function(d,h,f,e,i,c,b){var a=this;a._status=d;a._errorcode=b;var g={id:a._id,infoType:OSF.InfoType.Warning,status:d,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:h,buttonTxt:f||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:e||null,url:i||null,dismissCallback:c||null,reDisplay:!c?true:false,displayDeactive:true,logAsError:true,errorCode:b?b:0};a._contextActivationMgr.displayNotification(g);a._contextActivationMgr.raiseOsfControlStatusChange(a)},_refresh:function(a){this.deActivate();this.activate(a)},_activateAgavesBlockedBySandboxNotSupport:function(b){b.activateAgavesBlockedBySandboxNotSupport();var a=OSF.OUtil.getLocalStorage();a&&a.setItem(OSF.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(a){this._contextActivationMgr._setCachedFlag(a)},_getCachedFlag:function(a){return this._contextActivationMgr._getCachedFlag(a)},_deleteCachedFlag:function(a){this._contextActivationMgr._deleteCachedFlag(a)},_addETokenAsQueryParameter:function(e){var a=document.createElement("a");a.href=e;var f=this.getEToken(),b=OSF.Constants.ETokenParameterName+"="+encodeURIComponent(OSF.OUtil.encodeBase64(f)),d=a.search.length>1?a.search.substr(1)+"&":"";a.search=d+b;var c=a.href;a=null;return c},_activate:function(c,d){var a=this;Telemetry.AppLoadTimeHelper.PageStart(a._telemetryContext);d=a._addETokenAsQueryParameter(d);var h=a._contextActivationMgr.getClientId()+"_"+a._contextActivationMgr.getDocUrl()+"_"+a._id;a._conversationId=OSF.OUtil.getFrameNameAndConversationId(h,c);var f=function(d,e){d=d.trim()||"";var f="?",k="_host_Info=",g="&_host_Info=",c="#",i=d.split(c),b=i.shift(),j=i.join(c),h=b.split(f),a;if(h.length>1)a=b+g+e;else if(h.le>0)a=b+f+g+e;return[a,c,j].join("")},g=[a._contextActivationMgr._hostType,a._contextActivationMgr._hostPlatform,a._contextActivationMgr._hostSpecificFileVersion,a._contextActivationMgr._appUILocale,a.getCorrelationId()],i=g.join("|"),b=f(d,i),e=window.location.href;b=OSF.OUtil.addXdmInfoAsHash(b,a._conversationId+"|"+a._id+"|"+(e.indexOf("$")>=0?encodeURIComponent(e):e));b=OSF.OUtil.addSerializerVersionAsHash(b,OSF.SerializerVersion.Browser);a._contextActivationMgr._getServiceEndPoint().registerConversation(a._conversationId,b,a._appDomains);a._pageIsReadyTimerExpired=false;OSF.OUtil.addEventListener(c,"load",a._iframeOnLoadDelegate);c.setAttribute("src",b);a._div.appendChild(c);a._status=OSF.OsfControlStatus.Activated;OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.ActivationEnd);a._contextActivationMgr.raiseOsfControlStatusChange(a);Telemetry.AppLoadTimeHelper.OfficeJSStartToLoad(a._telemetryContext)},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var a=false;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{"get":function(){return this.desc},"set":function(a){this.desc=a}});a=true}catch(b){}return a}};OSF.OUtil.setNamespace("Manifest",OSF);OSF.Manifest.HostApp=function(a){this._appName=a;this._minVersion=null};OSF.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(a){this._minVersion=a}};OSF.Manifest.ExtensionSettings=function(){this._sourceLocations={};this._defaultHeight=null;this._defaultWidth=null};OSF.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(a,b){this._sourceLocations[a]=b},_setDefaultWidth:function(a){this._defaultWidth=a},_setDefaultHeight:function(a){this._defaultHeight=a}};OSF.Manifest.Manifest=function(d,i){var f="o:OfficeApp",a=this;a._UILocale=i||"en-us";if(typeof d!=="string"){d(a);return}a._displayNames={};a._descriptions={};a._iconUrls={};a._extensionSettings={};a._highResolutionIconUrls={};var e;a._xmlProcessor=new OSF.XmlProcessor(d,OSF.ManifestNamespaces["1.1"]);if(a._xmlProcessor.selectSingleNode(f)){e=h;a._manifestSchemaVersion=OSF.ManifestSchemaVersion["1.1"]}else{a._xmlProcessor=new OSF.XmlProcessor(d,OSF.ManifestNamespaces["1.0"]);e=g;a._manifestSchemaVersion=OSF.ManifestSchemaVersion["1.0"]}var b=a._xmlProcessor.getDocumentElement();a._target=OSF.OUtil.parseEnum(b.getAttribute("xsi:type"),OSF.OfficeAppType);var c=a._xmlProcessor.selectSingleNode(f);b=a._xmlProcessor.selectSingleNode("o:Id",c);a._id=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:Version",c);a._version=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:ProviderName",c);a._providerName=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:IdIssuer",c);a._idIssuer=a._parseIdIssuer(b);b=a._xmlProcessor.selectSingleNode("o:AlternateId",c);if(b)a._alternateId=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:DefaultLocale",c);a._defaultLocale=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:DisplayName",c);a._parseLocaleAwareSettings(b,Function.createDelegate(a,a._addDisplayName));b=a._xmlProcessor.selectSingleNode("o:Description",c);a._parseLocaleAwareSettings(b,Function.createDelegate(a,a._addDescription));b=a._xmlProcessor.selectSingleNode("o:AppDomains",c);a._appDomains=a._parseAppDomains(b);b=a._xmlProcessor.selectSingleNode("o:IconUrl",c);b&&a._parseLocaleAwareSettings(b,Function.createDelegate(a,a._addIconUrl));b=a._xmlProcessor.selectSingleNode("o:Signature",c);if(b)a._signature=a._xmlProcessor.getNodeValue(b);a._parseExtensionSettings();b=a._xmlProcessor.selectSingleNode("o:Permissions",c);a._permissions=a._parsePermission(b);e.apply(a);function g(){var a=this,d=a._xmlProcessor.selectSingleNode("o:Capabilities",c),b=a._xmlProcessor.selectNodes("o:Capability",d);a._capabilities=a._parseCapabilities(b)}function h(){var a=this,b=a._xmlProcessor.selectSingleNode("o:Hosts",c);a._hosts=a._parseHosts(b);b=a._xmlProcessor.selectSingleNode("o:Requirements",c);a._requirements=a._parseRequirements(b);b=a._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",c);b&&a._parseLocaleAwareSettings(b,Function.createDelegate(a,a._addHighResolutionIconUrl))}};OSF.Manifest.Manifest.prototype={getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(a){return this._displayNames[a]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(a){return this._descriptions[a]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(a){return this._iconUrls[a]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(d,c){var a=this._getExtensionSetting(c),b=a.getSourceLocations();return b[d]},getDefaultSourceLocation:function(c){var a=this._getExtensionSetting(c),b=a.getSourceLocations();return this._getDefaultValue(b)},getDefaultWidth:function(b){var a=this._getExtensionSetting(b);return a.getDefaultWidth()},getDefaultHeight:function(b){var a=this._getExtensionSetting(b);return a.getDefaultHeight()},getTarget:function(){return this._target},getPermission:function(){return this._permissions},hasPermission:function(a){return(this._permissions&a)===a},getHosts:function(){return this._hosts},getRequirements:function(){return this._requirements},getHighResolutionIconUrl:function(a){return this._highResolutionIconUrls[a]},getAppDomains:function(){return this._appDomains},_getDefaultValue:function(c){var d="undefined",b=this,a;if(typeof c[b._UILocale]==d)if(typeof c[b._defaultLocale]==d)for(var e in c){a=e;break}else a=b._defaultLocale;else a=b._UILocale;return c[a]},_getExtensionSetting:function(c){var a=this,b;if(typeof a._extensionSettings[c]!="undefined")b=a._extensionSettings[c];else for(var d in a._extensionSettings){b=a._extensionSettings[d];break}return b},_addDisplayName:function(a,b){this._displayNames[a]=b},_addDescription:function(a,b){this._descriptions[a]=b},_addIconUrl:function(a,b){this._iconUrls[a]=b},_parseLocaleAwareSettings:function(a,d){if(!a)throw OsfMsAjaxFactory.msAjaxError.argument("Manifest");var f=a.getAttribute("DefaultValue");d(this._defaultLocale,f);var b=this._xmlProcessor.selectNodes("o:Override",a);if(b)for(var i=b.length,c=0;c<i;c++){var e=b[c],g=e.getAttribute("Locale"),h=e.getAttribute("Value");d(g,h)}},_parseBooleanNode:function(b){if(!b)return false;else{var a=this._xmlProcessor.getNodeValue(b).toLowerCase();return a==="true"||a==="1"}},_parseIdIssuer:function(a){if(!a)return OSF.ManifestIdIssuer.Custom;else{var b=this._xmlProcessor.getNodeValue(a);return OSF.OUtil.parseEnum(b,OSF.ManifestIdIssuer)}},_parseCapabilities:function(d){for(var c=[],a,b=0;b<d.length;b++){var e=d[b];a=e.getAttribute("Name");a=OSF.OUtil.parseEnum(a,OSF.Capability);c.push(a)}return c},_parsePermission:function(a){if(!a)throw OsfMsAjaxFactory.msAjaxError.argument("Manifest");var b=this._xmlProcessor.getNodeValue(a);return OSF.OUtil.parseEnum(b,OSF.OsfControlPermission)},_parseExtensionSettings:function(){var a=this,c,d,b;for(var e in OSF.FormFactor){var g=a._xmlProcessor.selectSingleNode("o:OfficeApp");d=a._xmlProcessor.selectSingleNode("o:"+OSF.FormFactor[e],g);if(d){c=new OSF.Manifest.ExtensionSettings;b=a._xmlProcessor.selectSingleNode("o:SourceLocation",d);var f=function(a,b){c._addSourceLocation(a,b)};a._parseLocaleAwareSettings(b,f);b=a._xmlProcessor.selectSingleNode("o:RequestedWidth",d);b&&c._setDefaultWidth(a._xmlProcessor.getNodeValue(b));b=a._xmlProcessor.selectSingleNode("o:RequestedHeight",d);b&&c._setDefaultHeight(a._xmlProcessor.getNodeValue(b));a._extensionSettings[e]=c}}if(!c)throw OsfMsAjaxFactory.msAjaxError.argument("Manifest");},_parseHosts:function(d){var b=[];if(d)for(var c=this._xmlProcessor.selectNodes("o:Host",d),a=0;a<c.length;a++)b.push(c[a].getAttribute("Name"));return b},_parseRequirements:function(b){var a=this,c={sets:[],methods:[]};if(b){var e=a._xmlProcessor.selectSingleNode("o:Sets",b);c.sets=a._parseSets(e);var d=a._xmlProcessor.selectSingleNode("o:Methods",b);c.methods=a._parseMethods(d)}return c},_parseSets:function(a){var e=[];if(a)for(var g=a.getAttribute("DefaultMinVersion"),c=this._xmlProcessor.selectNodes("o:Set",a),b=0;b<c.length;b++){var d=c[b],f=d.getAttribute("MinVersion");e.push({name:d.getAttribute("Name"),version:f||g})}return e},_parseMethods:function(c){var d=[];if(c)for(var b=this._xmlProcessor.selectNodes("o:Method",c),a=0;a<b.length;a++)d.push(b[a].getAttribute("Name"));return d},_parseAppDomains:function(c){var d=[];if(c)for(var b=this._xmlProcessor.selectNodes("o:AppDomain",c),a=0;a<b.length;a++)d.push(this._xmlProcessor.getNodeValue(b[a]));return d},_addHighResolutionIconUrl:function(a,b){this._highResolutionIconUrls[a]=b},_isAddinCommandsManifest:function(h){var b=null,a=this,e=a._xmlProcessor.selectSingleNode("o:OfficeApp");if(e!==b&&a.getManifestSchemaVersion()===OSF.ManifestSchemaVersion["1.1"]){var f=a._xmlProcessor.selectSingleNode("ov:VersionOverrides",e);if(f!==b){var g=a._xmlProcessor.selectSingleNode("ov:Hosts",f);if(g!==b){var c=a._xmlProcessor.selectNodes("ov:Host",g);if(c!==b)for(var k=c.length,d=0;d<k;d++){var j=c[d].getAttribute("xsi:type");if(j===h){var i=a._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",c[d]);if(i!=b)return true}}}}}return false}};OSF.OUtil.setNamespace("AppSpecificSetup",OSF);OSF.ContextActivationManager=function(f){var g="0",i="osfControl for the given ID doesn't exist.",d=null,e=true,c=false,a=this;OSF.OUtil.validateParamObject(f,{appName:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},clientMode:{type:Number,mayBeNull:c},appUILocale:{type:String,mayBeNull:c},dataLocale:{type:String,mayBeNull:c},osfOmexBaseUrl:{type:String,mayBeNull:e},devCatalogUrl:{type:String,mayBeNull:e},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:e},spBaseUrl:{type:String,mayBeNull:e},docUrl:{type:String,mayBeNull:e},hostControl:{type:Object,mayBeNull:e},pageBaseUrl:{type:String,mayBeNull:e},lcid:{type:String,mayBeNull:e},formFactor:{type:String,mayBeNull:e},controlStatusChanged:{type:Object,mayBeNull:e},notifyHost:{type:Object,mayBeNull:e},allowExternalMarketplace:{type:Boolean,mayBeNull:e},localizedScriptsUrl:{type:String,mayBeNull:e},localizedImagesUrl:{type:String,mayBeNull:e},localizedStylesUrl:{type:String,mayBeNull:e},localizedResourcesUrl:{type:String,mayBeNull:e},trustAgaves:{type:Boolean,mayBeNull:e},enableMyOrg:{type:Boolean,mayBeNull:e},enableMyApps:{type:Boolean,mayBeNull:e},enableDevCatalog:{type:Boolean,mayBeNull:e},enableOneDriveCatalog:{type:Boolean,mayBeNull:e},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:e},omexForceAnonymous:{type:Boolean,mayBeNull:e},userNameHashCode:{type:Number,mayBeNull:e}},d);a._osfOmexBaseUrl=f.osfOmexBaseUrl;a._devCatalogUrl=f.devCatalogUrl;a._oneDriveCatalogBaseApiUrl=f.oneDriveCatalogBaseApiUrl;a._spBaseUrl=f.spBaseUrl;a._myOrgCatalogUrl=d;a._enableMyOrg=f.enableMyOrg||c;a._enableMyApps=f.enableMyApps||c;a._enableDevCatalog=f.enableDevCatalog||c;a._enableOneDriveCatalog=f.enableOneDriveCatalog||c;a._enableUploadFileDevCatalog=f.enableUploadFileDevCatalog||c;a._appName=f.appName;a._appVersion=f.appVersion;a._clientMode=f.clientMode;a._appUILocale=f.appUILocale;a._dataLocale=f.dataLocale;a._docUrl=f.docUrl;a._hostControl=f.hostControl;a._formFactor=f.formFactor||OSF.FormFactor.Default;a._pageBaseUrl=f.pageBaseUrl;a._lcid=f.lcid;a._controlStatusChanged=f.controlStatusChanged;a._notifyHost=f.notifyHost;a._allowExternalMarketplace=f.allowExternalMarketplace;a._localizedScriptsUrl=f.localizedScriptsUrl;a._localizedImagesUrl=f.localizedImagesUrl;a._localizedStylesUrl=f.localizedStylesUrl;a._localizedResourcesUrl=f.localizedResourcesUrl;a._autoTrusted=f.trustAgaves;a._omexForceAnonymous=f.omexForceAnonymous||c;a._userNameHashCode=f.userNameHashCode||0;if(a._pageBaseUrl&&a._pageBaseUrl.charAt(a._pageBaseUrl.length-1)!=="/")a._pageBaseUrl=a._pageBaseUrl+"/";if(a._localizedResourcesUrl&&a._localizedResourcesUrl.charAt(a._localizedResourcesUrl.length-1)!=="/")a._localizedResourcesUrl=a._localizedResourcesUrl+"/";a._clientId=OSF.OUtil.getUniqueId();a._cachedOsfControls={};a._iframeAttributeBag={};a._serviceEndPoint=d;a._serviceEndPointInternal=d;a._internalConversationId=d;a._iframeProxies={};a._iframeProxyCount=0;a._iframeNamePrefix="__officeExtensionProxy";a._webUrl=d;a._wsa=d;a._insertDialogDiv=d;a._hasPreloadedOfficeJs=c;a._contextMgrCorrelationId=OSF.OUtil.Guid.generateNewGuid();Telemetry.RuntimeTelemetryHelper.LogCommonMessage("_contextMgrCorrelationId :"+a._contextMgrCorrelationId,0);a._hostType=d;a._hostPlatform=d;a._hostSpecificFileVersion=d;a._requirementsChecker=new OSF.RequirementsChecker;if(a._osfOmexBaseUrl){var h,k=a._osfOmexBaseUrl.indexOf(OSF.Constants.ProtocolSeparator);if(k>=0)h=a._osfOmexBaseUrl.substr(k);else h=OSF.Constants.ProtocolSeparator+a._osfOmexBaseUrl;var m=OSF.Constants.Https+h,l=OSF.Constants.Https+h;if(OSF.OUtil.getQueryStringParamValue(window.location.search,OSF.Constants.OmexForceAnonymousParamName).toLowerCase()==OSF.Constants.OmexForceAnonymousParamValue.toLowerCase()){a._omexAuthNStatus=OSF.OmexAuthNStatus.Anonymous;a._omexForceAnonymous=e}else a._omexAuthNStatus=OSF.OmexAuthNStatus.NotAttempted;a._omexGatedWSProxy={proxyUrl:m+OSF.Constants.OmexGatedServiceExtension,proxyName:"__omexExtensionGatedProxy",isReady:c,clientEndPoint:d,pendingCallbacks:[]};a._omexWSProxy={proxyUrl:l+OSF.Constants.OmexUnGatedServiceExtension,proxyName:"__omexExtensionProxy",isReady:c,clientEndPoint:d,pendingCallbacks:[]};a._omexAnonymousWSProxy={proxyUrl:m+OSF.Constants.OmexAnonymousServiceExtension,proxyName:"__omexExtensionAnonymousProxy",isReady:c,clientEndPoint:d,pendingCallbacks:[]};a._omexBillingMarket=d;a._omexEndPointBaseUrl=l}OSF.OsfManifestManager._setUILocale(a._appUILocale);var b=a,t=function(o,l){var f="contextId",e=Function._validateParams(arguments,[{name:f,type:String,mayBeNull:c},{name:"gotAppContext",type:Function,mayBeNull:c}]);if(e){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",e,d,9204816);throw e;}var a=b.getOsfControl(o);if(!a){OsfMsAjaxFactory.msAjaxDebug.trace(i);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",d,d,9204817);throw OsfMsAjaxFactory.msAjaxError.argument(f);}else{Telemetry.AppLoadTimeHelper.OfficeJSLoaded(a._telemetryContext);var p=a.getEToken(),h=0;if(b._hostSpecificFileVersion&&b._hostSpecificFileVersion.indexOf(".")!=-1){var g=b._hostSpecificFileVersion.split("."),k=g[1];if(!isNaN(k))h=parseInt(g[1])}var m=b._requirementsChecker._getSupportedSet(),n=new OSF.OfficeAppContext(a.getMarketplaceID(),b._appName,b._appVersion,b._appUILocale,b._dataLocale,b._docUrl||window.location.href,b._clientMode,a.getSettings(),a.getReason(),a.getOsfControlType(),p,a._appCorrelationId,a.getID(),c,c,h,m);l(n);a._pageStatus=OSF.OsfControlPageStatus.Ready;a._pageIsReadyTimerExpired&&Telemetry.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",d,a.getCorrelationId(),8209027);a._contextActivationMgr._ErrorUXHelper&&a._contextActivationMgr._ErrorUXHelper.removeProgressDiv(a._div,a._id);if(a._timer){window.clearTimeout(a._timer);a._timer=d}var j=a._conversationId+OSF.SharedConstants.NotificationConversationIdSuffix;a._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(j,a._frame.contentWindow,a._iframeUrl);Telemetry.AppLoadTimeHelper.ActivationEnd(a._telemetryContext)}},z=function(a){(!a||a.length!=2)&&OsfMsAjaxFactory.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var d=a[0],e=a[1],c=b.getOsfControl(d);if(!c)OsfMsAjaxFactory.msAjaxDebug.trace(i);else if(c._contextActivationMgr._notifyHost)c._contextActivationMgr._notifyHost(d,e);else OsfMsAjaxFactory.msAjaxDebug.trace("No notifyHost provided by the host.")},w=function(a){window.open(a.strUrl,a.strWindowName,a.strWindowFeatures)},j=function(f,h){if(!f.hasOwnProperty("fromInsertDialog")||f.fromInsertDialog)b._insertDialogDiv!=d&&b._insertDialogDiv.childNodes.length==2&&b._insertDialogDiv.removeChild(b._insertDialogDiv.lastChild);var g;if(f.storeType==OSF.StoreTypeEnum.MarketPlace)g={storeType:OSF.StoreType.OMEX,storeLocator:b._osfOmexBaseUrl};else if(f.storeType==OSF.StoreTypeEnum.Catalog)g={storeType:OSF.StoreType.SPCatalog,storeLocator:b._myOrgCatalogUrl};else if(f.storeType==OSF.StoreTypeEnum.OneDrive)g={storeType:OSF.StoreType.OneDrive,storeLocator:b._oneDriveCatalogBaseApiUrl};var a={assetId:"",contentMarket:"",anonymous:c,clientEndPoint:d,clearCache:c||f.refresh,clearKilledApps:c,referenceInUse:g,hostType:b._hostType},i=1;if(f&&f.storeType==OSF.StoreTypeEnum.MarketPlace){a.clientVersion=b._getClientVersionForOmex();if(a.clientVersion){a.clientName=b._getClientNameForOmex();a.appVersion=b._getAppVersionForOmex()}var l=function(g){if(g.statusCode===OSF.ProxyCallStatusCode.Succeeded&&g.value){var t=g.context.referenceInUse,o=g.value.entitlements,j=o.length;j===0&&h({errorCode:OSF.InvokeResultCode.S_OK});for(var f,d={},q=[],k=0;k<j;k++){f=o[k];if(d[f.contentMarket])d[f.contentMarket]+=","+f.assetId;else d[f.contentMarket]=f.assetId}i=1;var p=0,m=function(f){if(f.statusCode===OSF.ProxyCallStatusCode.Succeeded&&f.value&&f.value.length&&f.value.length>0){var c=f.value;!f.cached&&_omexDataProvider.SetAppDetailsCache(a,c);if(a.appDetails&&a.appDetails.length>0)for(var g=0;g<a.appDetails.length;g++)c.push(a.appDetails[g]);for(var i=b.getRequirementsChecker(),e=0;e<c.length;e++){if(i.isEntitlementFromOmexSupported(c[e])){var d=[];d.push(c[e].name);d.push(c[e].assetId);d.push(c[e].description);d.push(OSF.OUtil.getTargetType(c[e].appSubType));d.push(OSF.OUtil.normalizeAppVersion(c[e].version));d.push(c[e].assetId);d.push(OSF.StoreType.OMEX);d.push(parseInt(c[e].defaultWidth));d.push(parseInt(c[e].defaultHeight));d.push(c[e].iconUrl);d.push(c[e].provider);d.push(f.context.contentMarket);d.push(OSF.StoreType.OMEX);q.push(d)}p++}}if(p===j){var k={value:q,errorCode:OSF.InvokeResultCode.S_OK};h(k)}},l=function(e){if(e)for(var f in d){a.anonymous=c;a.clientEndPoint=e;a.assetId=d[f];a.contentMarket=f;var h=OSF.OUtil.shallowCopy(a);OSF.OsfManifestManager.getOmexAppDetailsAsync(h,Function.createDelegate(b,m))}else if(i<OSF.Constants.AuthenticatedConnectMaxTries){i++;b._createOmexProxy(b._omexWSProxy,l)}else{var j=window.location.href,g=b._osfOmexBaseUrl+OSF.Constants.SignInRedirectUrl+encodeURIComponent(j);window.location.assign(g)}},n=e;if(_omexDataProvider.AppDetailsCached(a,d))try{a.clientEndPoint=b._omexWSProxy.clientEndPoint;for(var r in d){a.anonymous=c;a.assetId=d[r];a.contentMarket=r;OSF.OsfManifestManager.getOmexAppDetailsAsync(a,Function.createDelegate(b,m))}n=c}catch(s){}n&&b._createOmexProxy(b._omexWSProxy,l)}},m=function(e){if(e.isReady){a.anonymous=c;a.clientEndPoint=e.clientEndPoint;OSF.OsfManifestManager.getOmexEntitlementsAsync(a,Function.createDelegate(b,l))}else{var f={value:d,errorCode:OSF.InvokeResultCode.E_USER_NOT_SIGNED_IN};h(f)}};b._omexGatedWSProxy.refresh=f.refresh;b.isMyAppsReady(m)}else if(f&&f.storeType==OSF.StoreTypeEnum.Catalog){var k=function(e){e.context&&e.context.referenceInUse.storeType===OSF.StoreType.SPCatalog&&OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd);var f;if(e.statusCode===OSF.ProxyCallStatusCode.Succeeded&&e.value){for(var k=e.value.entitlements,n=k.length,c,l=[],j=0,m=b.getRequirementsChecker(),i=0;i<n;i++){c=k[i];if(m.isEntitlementFromCorpCatalogSupported(c)){var a=[];a.push(c.Title);a.push(c.OfficeExtensionID);a.push(c.OfficeExtensionDescription);a.push(OSF.OfficeAppType[c.OEType]);a.push(OSF.OUtil.normalizeAppVersion(c.OfficeExtensionVersion));a.push(c.OfficeExtensionID);a.push(OSF.StoreType.SPCatalog);a.push(parseInt(c.OfficeExtensionDefaultWidth.toString()));a.push(parseInt(c.OfficeExtensionDefaultHeight.toString()));a.push(c.OfficeExtensionIcon);a.push(c.OEProviderName);a.push(g.storeLocator);a.push(OSF.StoreType.SPCatalog);l.push(a);j++}}if(j>0)f={value:l,errorCode:OSF.InvokeResultCode.S_OK};else f={value:d,errorCode:OSF.InvokeResultCode.E_CATALOG_NO_APPS}}else if(!g.storeLocator)f={value:d,errorCode:OSF.InvokeResultCode.E_CATALOG_NO_APPS};else f={value:d,errorCode:OSF.InvokeResultCode.E_GENERIC_ERROR};h(f)};a.webUrl=g.storeLocator;a.osfControl={_contextActivationMgr:b,_telemetryContext:{}};a.noTargetType=e;OSF.OsfManifestManager.getCorporateCatalogEntitlementsAsync(a,Function.createDelegate(b,k))}else if(f&&f.storeType==OSF.StoreTypeEnum.OneDrive){var j=function(a){var b;if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var c=a.value.entitlements;b={value:c,errorCode:OSF.InvokeResultCode.S_OK};h(b)}};OSF.OsfManifestManager.getOneDriveEntitlementsAsync(a,j)}else OsfMsAjaxFactory.msAjaxDebug.trace("Unknown store type.")},x=function(){var c=window.location.href,a=b._osfOmexBaseUrl+OSF.Constants.SignInRedirectUrl+encodeURIComponent(c);window.location.assign(a)},v=function(a){window.open(a.pageUrl)},r=function(a){OsfMsAjaxFactory.msAjaxDebug.trace("onClickInsertOsfControl!");b._notifyHost(g,OSF.AgaveHostAction.InsertAgave,a)},p=function(i){if(!b._enableUploadFileDevCatalog)return;OsfMsAjaxFactory.msAjaxDebug.trace("onClickInstallOsfControl!");try{OSF.OUtil.validateParamObject(i,{manifest:{type:String,mayBeNull:c}},d);var f=new OSF.Manifest.Manifest(i.manifest,b.getAppUILocale()),h=f.getMarketplaceID(),j=f.getMarketplaceVersion(),k=OfficeExt.AddinDataProviderFactory.createAddinDataProvider(OSF.StoreType.UploadFileDevCatalog,d);if(k.validateAndCacheNewManifest(b,h,j,i.manifest,f)){var a={id:h,targetType:f.getTarget(),appVersion:j,currentStoreType:OSF.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:h,assetStoreId:OSF.StoreType.UploadFileDevCatalog,width:parseInt(f.getDefaultWidth()||g),height:parseInt(f.getDefaultHeight()||g),isAddinCommands:f._isAddinCommandsManifest(OSF.getManifestHostType(b._hostType))};OSF.OUtil.validateParamObject(a,{id:{type:String,mayBeNull:c},targetType:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},width:{type:Number,mayBeNull:e},height:{type:Number,mayBeNull:e}},d);Telemetry.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,a.currentStoreType,a.assetId,a.appVersion,a.targetType,a.isAddinCommands,a.width,a.height);b._notifyHost(g,OSF.AgaveHostAction.InsertAgave,a)}else b._notifyHost(g,OSF.AgaveHostAction.NotifyHostError,d)}catch(l){OsfMsAjaxFactory.msAjaxDebug.trace("Invalid manifest from addincommands dev catalog: "+l);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest from addincommands dev catalog.",l,this._appCorrelationId,9315269);b._notifyHost(g,OSF.AgaveHostAction.NotifyHostError,d);return}},o=function(a){OsfMsAjaxFactory.msAjaxDebug.trace("onClickRefreshfAddinCommands!");b._notifyHost(g,OSF.AgaveHostAction.RefreshAddinCommands,a)},s=function(){OsfMsAjaxFactory.msAjaxDebug.trace("onClickCancelDialog!");b._notifyHost(g,OSF.AgaveHostAction.CancelDialog);if(b._internalConversationId){b._serviceEndPointInternal.unregisterConversation(b._internalConversationId);b._internalConversationId=d}},y=function(f){var a={anonymous:d,clientAppInfoReturnType:OSF.ClientAppInfoReturnType.both,clientEndPoint:d,clientName:d,appVersion:d,clientVersion:d,hostType:d,osfControl:{_omexEntitlement:d},referenceInUse:d},j=e;a.referenceInUse={id:f.assetId,storeType:OSF.StoreType.OMEX,storeLocator:f.storeId};a.clientVersion=b._getClientVersionForOmex();if(a.clientVersion){a.clientName=b._getClientNameForOmex();a.appVersion=b._getAppVersionForOmex()}a.hostType=b._hostType;f.contentMarket=f.storeId;f.assetID=f.assetId;if(_omexDataProvider.AllCached(a,f))try{a.anonymous=e;a.clientEndPoint={};OSF.OsfManifestManager.getOmexKilledAppsAsync(a,i);OSF.OsfManifestManager.getOmexAppStateAsync(a,g);j=c}catch(m){}if(j){var k=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var j=a.context.referenceInUse,i=a.value.entitlements,l=i.length,b,k=c;_omexDataProvider.SetCustomerId(a.value.cid);for(var h=0;h<l;h++){b=i[h];if(b.assetId&&j.id&&b.assetId.toLowerCase()===j.id.toLowerCase()){k=e;break}}var f=a.context;f.osfControl._omexEntitlement={contentMarket:d,hasEntitlement:c,version:d};if(k){f.osfControl._omexEntitlement.contentMarket=b.contentMarket;f.osfControl._omexEntitlement.hasEntitlement=e;f.osfControl._omexEntitlement.version=b.version}OSF.OsfManifestManager.getOmexAppStateAsync(f,g)}},h=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var b=a.value,c=parseInt(b.status),d=a.context;if(c===OSF.OmexClientAppStatus.OK)!a.cached&&_omexDataProvider.SetManifestAndETokenCache(d,b)}},i=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value)!a.cached&&_omexDataProvider.SetKilledAppsCache(a.context,a.value)},g=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var f=a.value,c=a.context;!a.cached&&_omexDataProvider.SetAppStateCache(a.context,f);var d=function(){c.clientEndPoint=b._omexAnonymousWSProxy.clientEndPoint;OSF.OsfManifestManager.getOmexManifestAndETokenAsync(c,h)};if(c.osfControl._omexEntitlement&&!c.osfControl._omexEntitlement.hasEntitlement){c.anonymous=e;b._createOmexProxy(b._omexAnonymousWSProxy,d)}else OSF.OsfManifestManager.getOmexManifestAndETokenAsync(c,h)}},l=function(c){try{a.anonymous=!c.isReady;a.clientEndPoint=a.anonymous?b._omexAnonymousWSProxy.clientEndPoint:b._omexGatedWSProxy.clientEndPoint;!a.anonymous&&OSF.OsfManifestManager.getOmexEntitlementsAsync(a,k);OSF.OsfManifestManager.getOmexKilledAppsAsync(a,i);a.anonymous&&OSF.OsfManifestManager.getOmexAppStateAsync(a,g)}catch(d){}};b.isMyAppsReady(l)}},q=function(e,h){var d={errorCode:OSF.InvokeResultCode.E_OEM_REMOVED_FAILED},a={assetId:e.id,clientVersion:b._getClientVersionForOmex(),clientName:b._getClientNameForOmex(),clientEndPoint:b._omexGatedWSProxy.clientEndPoint},g=b._insertDialogDiv,f=function(f){var l=0;if(f.statusCode===OSF.ProxyCallStatusCode.Succeeded&&f.value&&f.value.removedApps&&f.value.removedApps.length>0){for(var k=f.value.removedApps,j=OSF.InvokeResultCode.E_OEM_REMOVED_FAILED,i=0;i<k.length;i++)if(k[i].assetId==a.assetId){if(k[i].result==OSF.OmexRemoveAppStatus.Success)j=OSF.InvokeResultCode.S_OK;break}_omexDataProvider.RemoveManifestAndEToken(a.assetId);if(j==OSF.InvokeResultCode.S_OK)l=b.untrustOsfControls(e);d.errorCode=j}var m=!document.documentElement.contains(g);Telemetry.AppManagementMenuHelper.LogAppManagementMenuAction(a.assetId,OSF.AppManagementAction.Remove,l,m,c,d.errorCode);h(d)};OSF.OsfManifestManager.removeOmexAppAsync(a,Function.createDelegate(b,f))},n=function(a){switch(a.datapointName){case OSF.DataPointNames.AppManagementMenu:OSF.OUtil.validateParamObject(a,{assetId:{type:String,mayBeNull:c},operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},d);Telemetry.AppManagementMenuHelper.LogAppManagementMenuAction(a.assetId,a.operationMetadata,0,c,c,a.hrStatus);break;case OSF.DataPointNames.InsertionDialogSession:OSF.OUtil.validateParamObject(a,{assetId:{type:String,mayBeNull:c},totalSessionTime:{type:Number,mayBeNull:c},trustPageSessionTime:{type:Number,mayBeNull:c},appInserted:{type:Boolean,mayBeNull:c},lastActiveTab:{type:Number,mayBeNull:c},lastActiveTabCount:{type:Number,mayBeNull:c}},d);Telemetry.InsertionDialogSessionHelper.LogInsertionDialogSession(a.assetId,a.totalSessionTime,a.trustPageSessionTime,a.appInserted,a.lastActiveTab,a.lastActiveTabCount);break;case OSF.DataPointNames.UploadFileDevCatelog:OSF.OUtil.validateParamObject(a,{operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},d);Telemetry.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,a.operationMetadata,0,c,c,a.hrStatus);break;case OSF.DataPointNames.UploadFileDevCatalogUsage:OSF.OUtil.validateParamObject(a,{currentStoreType:{type:String,mayBeNull:c},id:{type:String,mayBeNull:e},appVersion:{type:String,mayBeNull:e},appTargetType:{type:Number,mayBeNull:c},isAppCommand:{type:String,mayBeNull:c},appSizeWidth:{type:Number,mayBeNull:e},appSizeHeight:{type:Number,mayBeNull:e}},d);Telemetry.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,a.currentStoreType,a.Id,a.appVersion,a.appTargetType,a.isAppCommand,a.appSizeWidth,a.appSizeHeight)}};a._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(a._clientId);a._serviceEndPoint._onHandleRequestError=function(g,f){var e,a;if(g&&(e=g._data)){a=typeof e==="object"?e[0]:e;a=typeof a==="string"?a:d;var c;if(a&&(c=b.getOsfControl(a))){if(f==="Failed origin check")c._pageStatus=OSF.OsfControlPageStatus.FailedOriginCheck;else if(f==="Access Denied")c._pageStatus=OSF.OsfControlPageStatus.FailedPermissionCheck;else c._pageStatus=OSF.OsfControlPageStatus.Failed;Telemetry.RuntimeTelemetryHelper.LogExceptionTag(f,d,c.getCorrelationId(),17585056)}}};a._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",t,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",z,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",w,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(a._clientId+OSF.Constants.EndPointInternalSuffix);a._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",j,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",x,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",v,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",r,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",p,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",o,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",s,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",q,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",n,Microsoft.Office.Common.InvokeType.async,c);a._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",y,Microsoft.Office.Common.InvokeType.async,c);OSF.AppSpecificSetup._setupFacade(a._hostControl,a,a._serviceEndPoint,a._serviceEndPointInternal);a._localeStringLoadingPendingCallbacks=[];if(a._localizedScriptsUrl&&a._localizedScriptsUrl!="null/"){var u=function(){this._ErrorUXHelper=new OSF._ErrorUXHelper(this)};a._loadLocaleString(Function.createDelegate(a,u))}a.queryEntitlementDetails=function(a){j(a,a.callbackFunc)}};OSF.ContextActivationManager.prototype={insertOsfControl:function(a){var b=true,d=false,f=this;OSF.OUtil.validateParamObject(a,{div:{type:Object,mayBeNull:d},id:{type:String,mayBeNull:d},marketplaceID:{type:String,mayBeNull:d},marketplaceVersion:{type:String,mayBeNull:d},store:{type:String,mayBeNull:d},storeType:{type:String,mayBeNull:d},alternateReference:{type:Object,mayBeNull:b},settings:{type:Object,mayBeNull:b},reason:{type:String,mayBeNull:b},osfControlType:{type:Number,mayBeNull:b},snapshotUrl:{type:String,mayBeNull:b},preactivationCallback:{type:Object,mayBeNull:b},virtualOsfControlActivationCallback:{type:Object,mayBeNull:b},isvirtualOsfControl:{type:Boolean,mayBeNull:b}},null);var e={div:a.div,id:a.id,marketplaceID:a.marketplaceID,marketplaceVersion:a.marketplaceVersion,store:a.store,storeType:a.storeType,alternateReference:a.alternateReference,settings:a.settings,reason:a.reason,osfControlType:a.osfControlType,snapshotUrl:a.snapshotUrl,contextActivationMgr:f,preactivationCallback:a.preactivationCallback,virtualOsfControlActivationCallback:a.virtualOsfControlActivationCallback,isvirtualOsfControl:a.isvirtualOsfControl},g=f.getSQMAgaveUsage(e.storeType,e.osfControlType,e.reason,a.marketplaceID),c=new OSF.OsfControl(e);c._sqmDWords[0]=g[0];c._sqmDWords[1]=g[1];c._contextActivationMgr._ErrorUXHelper&&c._contextActivationMgr._ErrorUXHelper.showProgress(c._div,c._id);var h=function(){c.activate()};f._loadLocaleString(Function.createDelegate(f,h));return c},setLocalizedUrl:function(d,e,f){var a=this,b=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:false},{name:"imageUrl",type:String,mayBeNull:false},{name:"styleUrl",type:String,mayBeNull:false}]);if(b)throw b;a._localizedScriptsUrl=d;a._localizedImagesUrl=e;a._localizedStylesUrl=f;if(a._localizedScriptsUrl&&a._localizedScriptsUrl!="null/"){var c=function(){if(!this._ErrorUXHelper)this._ErrorUXHelper=new OSF._ErrorUXHelper(this)};a._loadLocaleString(Function.createDelegate(a,c))}},getOsfControlStatus:function(b){var a=this._cachedOsfControls[b];return a?a.getStatus():OSF.OsfControlStatus.InvalidOsfControl},activateOsfControl:function(c){var b=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false}]);if(b)throw b;var a=this._cachedOsfControls[c];typeof a!="undefined"&&a.activate()},deActivateOsfControl:function(c){var b=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false}]);if(b)throw b;var a=this._cachedOsfControls[c];typeof a!="undefined"&&a.deActivate()},purgeOsfControl:function(d,c){var b=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false},{name:"purgeManifest",type:Boolean,mayBeNull:false}]);if(b)throw b;var a=this._cachedOsfControls[d];typeof a!="undefined"&&a.purge(c)},purgeOsfControlNotifications:function(){for(var a in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(a)},untrustOsfControls:function(a){var c=this,d=0,e=OSF.OUtil.formatString(OSF.Constants.ActivatedCacheKey,a.id.toLowerCase(),a.currentStoreType,a.storeId);c._deleteCachedFlag(e);for(var f in c._cachedOsfControls){var b=c._cachedOsfControls[f];if(b._marketplaceID.toLowerCase()==a.id.toLowerCase()){c._ErrorUXHelper.purgeOsfControlNotification(b._id);b.deActivate();b._showTrustError(a.displayName,a.providerName,a.currentStoreType,Function.createDelegate(b,b.activate));d++}}return d},retryAll:function(d){var b=this;for(var c in b._cachedOsfControls){var a=b._cachedOsfControls[c];if(a._marketplaceID.toLowerCase()==d.toLowerCase())if(a._retryActivate){b._ErrorUXHelper.purgeOsfControlNotification(a._id);b._ErrorUXHelper.removeInfoBarDiv(c,false);a._retryActivate();a._retryActivate=null}}},getOsfControl:function(b){var a=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false}]);if(a)throw a;return this._cachedOsfControls[b]},getOsfControls:function(){var a=[];for(var b in this._cachedOsfControls)a.push(this._cachedOsfControls[b]);return a},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(a){this._controlStatusChanged&&this._controlStatusChanged(a)},registerOsfControl:function(a){var b=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:false}]);if(b)throw b;this._cachedOsfControls[a.getID()]=a},unregisterOsfControl:function(b){var a=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:false}]);if(a)throw a;delete this._cachedOsfControls[b.getID()]},setIframeAttributeBag:function(a){this._iframeAttributeBag=a},displayNotification:function(a){var b=true,d=false,e=this;OSF.OUtil.validateParamObject(a,{infoType:{type:Number,mayBeNull:d},id:{type:String,mayBeNull:d},title:{type:String,mayBeNull:d},description:{type:String,mayBeNull:d},url:{type:String,mayBeNull:b},buttonTxt:{type:String,mayBeNull:b},buttonCallback:{type:Function,mayBeNull:b},dismissCallback:{type:Function,mayBeNull:b},"displayDeactive ":{type:Boolean,mayBeNull:b},highPriority:{type:Boolean,mayBeNull:b},detailView:{type:Boolean,mayBeNull:b},reDisplay:{type:Boolean,mayBeNull:b},logAsError:{type:Boolean,mayBeNull:b},errorCode:{type:Number,mayBeNull:b},retryAll:{type:Boolean,mayBeNull:b}},null);if(!a.errorCode)a.errorCode=0;var c=e._cachedOsfControls[a.id];if(c)if(c._isvirtualOsfControl){c._notificationParams=a;if(!c._isvirtualOsfControlCallbackInvoked)if(c._manifest!=null)c.invokeVirtualOsfControlActivationCallback(c._manifest);else c.forceGetVirtualOsfControlManifest()}else{if(a.logAsError){Telemetry.AppLoadTimeHelper.SetErrorResult(c._telemetryContext,a.errorCode);if(e._notifyHostError){var f={errorCode:a.errorCode};e._notifyHostError(a.id,OSF.AgaveHostAction.NotifyHostError,f)}}if(a.displayDeactive)a.detailView=b;a.div=c._div;e._ErrorUXHelper.showNotification(a)}},dismissMessages:function(a){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(a)},notifyAgave:function(c,b){var d=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false},{name:"actionId",type:Number,mayBeNull:false}]);if(d)throw d;var a=this._cachedOsfControls[c];if(typeof a!="undefined")if(a._pageStatus!==OSF.OsfControlPageStatus.Ready&&(b===OSF.AgaveHostAction.CtrlF6In||b===OSF.AgaveHostAction.Select))this._ErrorUXHelper.focusOnNotificationUx(c);else a.notifyAgave(b)},setWSA:function(b){var a=this;a._wsa=b;if(a._wsa){a._wsa.createStreamUnobfuscated(OSF.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,OSF.BWsaStreamTypes.Static,2,OSF.BWsaConfig.defaultMaxStreamRows);a._wsa.createStreamUnobfuscated(OSF.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,OSF.BWsaStreamTypes.Static,4,OSF.BWsaConfig.defaultMaxStreamRows)}},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(h,i,d,e){var a;switch(h.toLowerCase()){case OSF.StoreType.OMEX:a=0;break;case OSF.StoreType.SPCatalog:a=1;break;case OSF.StoreType.FileSystem:a=2;break;case OSF.StoreType.Registry:a=3;break;case OSF.StoreType.Exchange:a=4;break;case OSF.StoreType.SPApp:a=5;break;default:a=15}var b;switch(i){case OSF.OsfControlType.DocumentLevel:b=1;break;case OSF.OsfControlType.ContainerLevel:b=0;break;default:b=2}var c=7;if(d&&d.toLowerCase)switch(d.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():c=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():c=1}var g=e.toLowerCase().indexOf("wa")===0?parseInt(e.substring(2),10):0,f=0;f=c<<8|b<<4|a;return[f,g]},isMyAppsReady:function(b){var c=false,a=this;if(!a._enableMyApps){b({isReady:c});return}if(a._omexGatedWSProxy&&a._omexGatedWSProxy.clientEndPoint){b({isReady:true,clientEndPoint:a._omexGatedWSProxy.clientEndPoint});return}var e=1,g=function(e){if(e.statusCode===OSF.ProxyCallStatusCode.Succeeded&&e.value){var f=parseInt(e.value);if(f==OSF.OmexAuthNStatus.Authenticated)a._omexAuthNStatus=OSF.OmexAuthNStatus.Authenticated;else if(f==OSF.OmexAuthNStatus.Anonymous||f==OSF.OmexAuthNStatus.Unknown){b({isReady:c});return}}else a._omexAuthNStatus=OSF.OmexAuthNStatus.CheckFailed;a._createOmexProxy(a._omexGatedWSProxy,d)},f=function(e){if(e&&(a._omexAuthNStatus==OSF.OmexAuthNStatus.NotAttempted||a._omexAuthNStatus==OSF.OmexAuthNStatus.Anonymous))if(a._omexAuthNStatus==OSF.OmexAuthNStatus.NotAttempted){var f={clientEndPoint:null};f.clientEndPoint=e;OSF.OsfManifestManager._invokeProxyMethodAsync(f,"OMEX_getAuthNStatus",g,f)}else a._omexAuthNStatus==OSF.OmexAuthNStatus.Anonymous&&b({isReady:c,clientEndPoint:e});else a._createOmexProxy(a._omexGatedWSProxy,d)},d=function(g){if(g)b({isReady:true,clientEndPoint:g});else if(e<OSF.Constants.AuthenticatedConnectMaxTries){e++;if(a._omexAuthNStatus==OSF.OmexAuthNStatus.CheckFailed)setTimeout(function(){a._createOmexProxy(a._omexGatedWSProxy,d)},500);else a._createOmexProxy(a._omexAnonymousWSProxy,f)}else b({isReady:c})};a._createOmexProxy(a._omexGatedWSProxy,d)},isMyOrgReady:function(b){var a=this;if(!a._enableMyOrg){b({isReady:false});return}if(a._spBaseUrl&&a._iframeProxies&&a._iframeProxies[a._spBaseUrl]&&a._iframeProxies[a._spBaseUrl].clientEndPoint){b({isReady:true,clientEndPoint:a._iframeProxies[a._spBaseUrl].clientEndPoint});return}var c=function(a){if(a)b({isReady:true,clientEndPoint:a});else b({isReady:false})};a._createSharePointIFrameProxy(a._spBaseUrl,c)},openInputUrlDialog:function(d){var e=document.createElement("p");e.setAttribute("id","title-p");e.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):";d.appendChild(e);var a=document.createElement("input");a.setAttribute("type","url");a.setAttribute("id","url-input");a.setAttribute("size","80");d.appendChild(a);var c=this,f=function(d){var a=new OSF.Manifest.Manifest(d,c.getAppUILocale());!OSF.OsfManifestManager.hasManifest(a.getMarketplaceID(),a.getMarketplaceVersion())&&OSF.OsfManifestManager.cacheManifest(a.getMarketplaceID(),a.getMarketplaceVersion(),a);var b={id:a.getMarketplaceID(),targetType:a.getTarget(),appVersion:a.getMarketplaceVersion(),currentStoreType:OSF.StoreType.Registry,storeId:"developer",assetId:a.getMarketplaceID(),assetStoreId:OSF.StoreType.Registry,width:a.getDefaultWidth()||0,height:a.getDefaultHeight()||0,isAddinCommands:a._isAddinCommandsManifest(OSF.getManifestHostType(c._hostType))};Telemetry.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,b.currentStoreType,b.id,b.appVersion,b.targetType,b.isAddinCommands,b.width,b.height);c._notifyHost("0",OSF.AgaveHostAction.InsertAgave,b)},g=function(a){alert("Error when requsting manifest file: "+a)},h=function(){OSF.OUtil.xhrGet(c._devCatalogUrl+"/"+a.value,f,g)},b=document.createElement("input");b.setAttribute("type","button");b.setAttribute("value","Insert");OSF.OUtil.addEventListener(b,"click",h);d.appendChild(b)},launchInsertDialog:function(e,l,g){var c=null,d="100%";e.childNodes.length!=0&&e.removeChild(e.childNodes.item(0));var b;if(this._enableDevCatalog){b=document.createElement("div");b.style.width=d;b.style.height="80%";e.appendChild(b);var h=document.createElement("div");h.style.width=d;h.style.height="20%";e.appendChild(h);this.openInputUrlDialog(h)}else b=e;var a=this;a._insertDialogDiv=b;var f=document.createElement("div");f.style.width=d;f.style.height=d;f.style.backgroundImage="url("+a.getLocalizedImageFilePath("progress.gif")+")";f.style.backgroundRepeat="no-repeat";f.style.backgroundPosition="center";b.appendChild(f);var m={MyApp:"0",MyOrg:"1",Store:"{98143890-AC66-440E-A448-ED8771A02D52}",OneDrive:"9"},i=function(b,d){if(!a._enableMyOrg){d({statusCode:OSF.InvokeResultCode.E_CATALOG_NO_APPS,value:c,context:b});return}OSF.OUtil.validateParamObject(b,{webUrl:{type:String,mayBeNull:false}},d);var e=function(a){if(a.isReady){b.clientEndPoint=a.clientEndPoint;var e={webUrl:b.webUrl};OSF.OsfManifestManager._invokeProxyMethodAsync(b,"OEM_getSPCatalogUrlAsync",d,e)}else d({statusCode:OSF.InvokeResultCode.E_GENERIC_ERROR,value:c,context:b})};a.isMyOrgReady(e)},j=function(k){var t=', "myOneDrive":',s='{ "myOrg":',r=', "myOrg":',o='{ "myApp":',n='"}',q='], "url":"',f=" }",e=document.createElement("iframe");e.setAttribute("id","InsertDialog");e.setAttribute("src","about:blank");e.setAttribute("width",d);e.setAttribute("height",d);e.setAttribute("marginHeight","0");e.setAttribute("marginWidth","0");e.setAttribute("frameBorder","0");e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");typeof Strings!="undefined"&&Strings&&Strings.OsfRuntime&&e.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var i=c,m=c,y='{ "IsUploadFileDevCatalogEnabled":'+a._enableUploadFileDevCatalog+f;if(a.isExternalMarketplaceAllowed()){var z=a._enableMyApps?OSF.InvokeResultCode.S_OK.toString():OSF.InvokeResultCode.S_HIDE_PROVIDER.toString();i='{ "provValues":[0,0,0,'+z+q+a._osfOmexBaseUrl+'", "client":"'+a._getClientNameForOmex()+n;m=o+i+f}var j=c;if(a._enableMyOrg){a._myOrgCatalogUrl=k.value;var A=k.statusCode;j='{ "provValues":[1,1,0,'+A+q+k.value+n;m=a.isExternalMarketplaceAllowed()?o+i+r+j+f:s+j+f}if(a._enableOneDriveCatalog)if(document.cookie.indexOf("OneDriveCatalog=true")!=-1){var h=c;a._myOneDriveCatalogUrl=k.value;h='{ "provValues":[9,9,0,0], "url":"'+k.value+n;if(a._enableMyOrg)m=a.isExternalMarketplaceAllowed()?o+i+r+j+t+h+f:s+j+',"myOneDrive":'+h+f;else m=a.isExternalMarketplaceAllowed()?o+i+t+h+f:'{"myOneDrive":'+h+f}a._internalConversationId&&a._serviceEndPointInternal.unregisterConversation(a._internalConversationId);var w=a.getClientId()+"_"+a.getDocUrl(),u=OSF.OUtil.getFrameNameAndConversationId(w,e);a._internalConversationId=OSF.OUtil.getFrameNameAndConversationId(w,e);var v=c;if(g!=c)v='{ "navigationMode":'+g.navigationMode+', "assetId": "'+g.assetId+'", "category":"'+g.category+n;var p="",B=[u,encodeURIComponent(window.location.href),a._appVersion,OSF.getAppVerCode(a._appName),a.getLcid(),OSF.Constants.FileVersion,encodeURIComponent(m),l,encodeURIComponent(y),encodeURIComponent(v),a._contextMgrCorrelationId];if(a._localizedResourcesUrl)p=a._localizedResourcesUrl+"WefGallery.htm?b="+OSF.Constants.FileVersion;else p=a._pageBaseUrl+a.getLcid()+"/WefGallery.htm?b="+OSF.Constants.FileVersion;var x=OSF.OUtil.addXdmInfoAsHash(p,B.join("|"));a._serviceEndPointInternal.registerConversation(u,x);e.setAttribute("src",x);if(a._insertDialogDiv){b.childNodes.length!=0&&b.removeChild(b.childNodes.item(0));b.appendChild(e)}else{b.insertBefore(e,b.firstChild);a._insertDialogDiv=b}},k={webUrl:a._spBaseUrl};i(k,j);a._preloadOfficeJs()},activateAgavesBlockedBySandboxNotSupport:function(){for(var b in this._cachedOsfControls){var a=this._cachedOsfControls[b];a._status===OSF.OsfControlStatus.NotSandBoxSupported&&a.activate()}},setRequirementsChecker:function(a){this._requirementsChecker=a},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(a){return this._ErrorUXHelper?this._ErrorUXHelper.appHasNotifications(a):false},_doesUrlHaveSupportedProtocol:function(b){var a=false;if(b){var c=decodeURIComponent(b),d=c.match(/^https?:\/\/.+$/ig);a=d!=null}return a},_loadLocaleString:function(c){var a=this;if(typeof Strings=="undefined"||!Strings||!Strings.OsfRuntime){a._localeStringLoadingPendingCallbacks.push(c);var b=a._localeStringLoadingPendingCallbacks;if(b.length===1){var e=function(){for(var c=b.length,a=0;a<c;a++){var d=b.shift();d()}};a._loadStringScript(e)}}else{for(var f=a._localeStringLoadingPendingCallbacks.length,d=0;d<f;d++){var g=a._localeStringLoadingPendingCallbacks.shift();g()}c()}},_loadStringScript:function(c){var a=this.getLocalizedScriptsUrl();a+="osfruntime_strings.js";var b=function(){if(typeof Strings=="undefined"||!Strings||!Strings.OsfRuntime){this._localeStringLoadingPendingCallbacks.length=0;throw OSF.OUtil.formatString("The locale, {0}, provided by the host app is not supported.",this.getLcid());}else c()};OSF.OUtil.loadScript(a,Function.createDelegate(this,b))},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(b,a){return OSF.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,a,b)},_getManifestAndTargetByConversationId:function(b){for(var c in this._cachedOsfControls){var a=this._cachedOsfControls[c];if(b===a._getConversationId())return{manifest:OSF.OsfManifestManager.getCachedManifest(a.getMarketplaceID(),a.getMarketplaceVersion()),target:a.getOsfControlType()}}return null},_createOmexProxy:function(a,f){var g="load",b=null,h=b,i=function(){if(a.clientEndPoint)a.clientEndPoint.invoke("OMEX_isProxyReady",j,{__timeout__:500});else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error, iframe loaded again after failing OMEX_isProxyReady.",b,b,8209028);OSF.OUtil.set_entropy(+new Date)};if(a.refresh){a.isReady=false;a.refresh=false;if(a.clientEndPoint){Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(a.clientEndPoint._conversationId);a.clientEndPoint=b}if(a.iframe){OSF.OUtil.removeEventListener(a.iframe,g,i);a.iframe.parentNode.removeChild(a.iframe)}}if(a.isReady){!a.clientEndPoint&&Telemetry.RuntimeTelemetryHelper.LogExceptionTag("OmexProxy is ready while clientEndPoint is null.",b,b,17356609);f(a.clientEndPoint)}else if(!a.clientEndPoint){if(!this._doesUrlHaveSupportedProtocol(a.proxyUrl)){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Protocal of proxyUrl is not supported.",b,b,17356610);f(b);return}var d=OSF.OUtil.generateConversationId(),c=document.createElement("iframe");c.setAttribute("id",a.proxyName);c.setAttribute("name",a.proxyName);var e=a.proxyUrl+"?"+d+"&ClientSessionId="+this._contextMgrCorrelationId;e=OSF.OUtil.addXdmInfoAsHash(e,d+"|"+a.proxyName+"|"+window.location.href);e=OSF.OUtil.addSerializerVersionAsHash(e,OSF.SerializerVersion.Browser);c.setAttribute("src",e);c.setAttribute("scrolling","auto");c.setAttribute("border","0");c.setAttribute("width","0");c.setAttribute("height","0");c.setAttribute("style","position: absolute; left: -100px; top:0px;");var j=function(f,j){var e=a.pendingCallbacks.length;if(e==0)return;if(f===0&&j.status){a.isReady=true;a.iframe=c;h=a.clientEndPoint}else{var m=OSF.OUtil.formatString("Proxy is not ready, errorCode:{0}, proxyUrl:{1}. {2}",f,a.proxyUrl,OSF.OUtil.serializeOMEXResponseErrorMessage(j));Telemetry.RuntimeTelemetryHelper.LogExceptionTag(m,b,b,17379404);a.clientEndPoint=b;if(Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(d)){Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(d);OSF.OUtil.removeEventListener(c,g,i);c.parentNode.removeChild(c)}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with marketplace proxy.",b,b,8209029);h=b}for(var k=0;k<e;k++){var l=a.pendingCallbacks.shift();l(h)}};try{document.body.appendChild(c);OSF.OUtil.addEventListener(c,g,i);a.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(d,c.contentWindow,a.proxyUrl);a.pendingCallbacks.push(f)}catch(k){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Error creating client endpoint with proxyUrl=["+a.proxyUrl+"].",k,b,17356612);throw k;}}else a.pendingCallbacks.push(f)},_createSharePointIFrameProxy:function(b,h){var d=null,c=this;if(!c._doesUrlHaveSupportedProtocol(b)){h(d);return}var l=b.length;if(b.charAt(l-1)==="/")b=b.substr(0,l-1);var i=c._iframeProxies[b];if(!i){var e=OSF.OUtil.generateConversationId(),a=document.createElement("iframe");c._iframeProxyCount=c._iframeProxyCount+1;var j=c._iframeNamePrefix+c._iframeProxyCount;a.setAttribute("id",j);a.setAttribute("name",j);var f=b+"/_layouts/15/OfficeExtensionManager.aspx?"+e;f=OSF.OUtil.addXdmInfoAsHash(f,e+"|"+j+"|"+window.location.href);f=OSF.OUtil.addSerializerVersionAsHash(f,OSF.SerializerVersion.Browser);a.setAttribute("scrolling","auto");a.setAttribute("border","0");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("style","position: absolute; left: -100px; top:0px;");var g=c,m=function(l,m){var f,c=g._iframeProxies[b];if(c&&l===0&&m.status){c.isReady=true;f=c.clientEndPoint}else{delete g._iframeProxies[b];if(Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e)){Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e);OSF.OUtil.removeEventListener(a,"load",k);a.parentNode.removeChild(a)}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",d,d,8209030);f=d}if(c)for(var i=c.pendingCallbacks.length,h=0;h<i;h++){var j=c.pendingCallbacks.shift();j(f)}},k=function(){if(g._iframeProxies[b]){g._iframeProxies[b].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(e,a.contentWindow,b);g._iframeProxies[b].clientEndPoint.invoke("OEM_isProxyReady",m,{__timeout__:2e3})}};document.body.appendChild(a);OSF.OUtil.addEventListener(a,"load",k);a.setAttribute("src",f);c._iframeProxies[b]={clientEndPoint:d,isReady:false,pendingCallbacks:[h]}}else if(i.isReady)h(i.clientEndPoint);else i.pendingCallbacks.push(h)},_getClientVersionForOmex:function(){if(!this._appVersion)return undefined;var b=this._appVersion.split("."),c=parseInt(b[0],10),d=parseInt(b[1],10)||0;if(c<=15&&d<=0)return undefined;var a=OSF.Constants.FileVersion.split(".");return c+"."+d+"."+a[2]+"."+a[3]},_getClientNameForOmex:function(){return OSF.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return OSF.OmexAppVersions[this._appName]},_setCachedFlag:function(b){var a=OSF.OUtil.getLocalStorage();a&&a.setItem(b,"true")},_getCachedFlag:function(c){var a=OSF.OUtil.getLocalStorage();if(a){var b=a.getItem(c);return b?true:false}},_deleteCachedFlag:function(b){var a=OSF.OUtil.getLocalStorage();a&&a.removeItem(b)},_preloadOfficeJs:function(){var b=this;if(b._hasPreloadedOfficeJs)return;var a=document.createElement("script");a.src=OSF.OUtil.formatString("{0}?locale={1}&host={2}&version={3}",OSF.Constants.PreloadOfficeJsUrl,b._appUILocale,b._appName,b._hostSpecificFileVersion);a.type="text/javascript";a.id=OSF.Constants.PreloadOfficeJsId;a.onerror=function(){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Failed to connect to preload service.",null,null,8757954)};document.getElementsByTagName("head")[0].appendChild(a);b._hasPreloadedOfficeJs=true},isAddinCommandsAsync:function(b,d){var c=null,a=false;OSF.OUtil.validateParamObject(b,{marketplaceId:{type:String,mayBeNull:a},marketplaceVersion:{type:String,mayBeNull:a},storeType:{type:String,mayBeNull:a},storeId:{type:String,mayBeNull:a},targetData:{type:Object,mayBeNull:a}},c);var e=b.storeType.toLowerCase(),g,f={contextActivationMgr:c,referenceInUse:c};try{f.referenceInUse={id:b.marketplaceId,version:b.marketplaceVersion,storeType:b.storeType,storeLocator:b.storeId};f.contextActivationMgr=this;if(OSF.StoreType.OMEX===e||OSF.StoreType.UploadFileDevCatalog===e||OSF.StoreType.SPCatalog===e){var h=function(e){if(e!=c&&e.statusCode==OSF.ProxyCallStatusCode.Succeeded&&e.value!=c)d(true,e.value._isAddinCommandsManifest(OSF.getManifestHostType(f.contextActivationMgr._hostType)),b);else d(a,a,b)};g=OfficeExt.AddinDataProviderFactory.createAddinDataProvider(e,this);if(g!=c)g.getManifestAsync(f,h);else d(a,a,b)}else d(true,a,b)}catch(i){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",i,c,17425604);d(a,a,b)}},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getUserNameHashCode:function(){return this._userNameHashCode}};OSF.OsfManifestManager=function(){var i="undefined",g="marketplaceVersion",f="marketplaceID",h="cacheExpired",b=null,c=true,a=false,d={},j="en-us",k={};function e(b,a){return b+"_"+a}return{getManifestAsync:function(f,h){OSF.OUtil.validateParamObject(f,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a}},h);var g=f.referenceInUse,k=e(g.id,g.version),i=d[k];f.manifestCached=a;if(i){f.manifestCached=c;h({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:i,context:f})}else if(f.clientEndPoint&&f.manifestUrl){Telemetry.AppLoadTimeHelper.ManifestRequestStart(f.osfControl._telemetryContext);var j=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var d;try{d=a.context.osfControl;var e;if(typeof a.value==="string"){a.context.manifestCached=c;e=a.value}else{a.context.manifestCached=a.value.cached;e=a.value.manifest}Telemetry.AppLoadTimeHelper.SetManifestDataCachedFlag(d._telemetryContext,a.value.cached);a.value=new OSF.Manifest.Manifest(e,d._contextActivationMgr.getAppUILocale());OSF.OsfManifestManager.cacheManifest(g.id,g.version,a.value)}catch(i){a.value=b;var f;if(d)f=d._appCorrelationId;OsfMsAjaxFactory.msAjaxDebug.trace("Invalid manifest in getManifestAsync: "+i);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest in getManifestAsync.",i,f,8209031)}}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("getManifestAsync failed:"+OSF.OUtil.serializeOMEXResponseErrorMessage(a),b,b,17585057);h(a)},l={manifestUrl:f.manifestUrl,id:g.id,version:g.version,clearCache:f.clearCache||a};this._invokeProxyMethodAsync(f,"OEM_getManifestAsync",j,l)}else h({statusCode:OSF.ProxyCallStatusCode.Failed,value:b,context:f})},getAppInstanceInfoByIdAsync:function(b,c){OSF.OUtil.validateParamObject(b,{webUrl:{type:String,mayBeNull:a},appInstanceId:{type:String,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},c);var d={webUrl:b.webUrl,appInstanceId:b.appInstanceId,clearCache:b.clearCache||a};this._invokeProxyMethodAsync(b,"OEM_getSPAppInstanceInfoByIdAsync",c,d)},getSPTokenByProductIdAsync:function(c,d){OSF.OUtil.validateParamObject(c,{appWebUrl:{type:String,mayBeNull:a},productId:{type:String,mayBeNull:a}},d);var f=this,e=function(e){if(e){var g={webUrl:c.appWebUrl,productId:c.productId,clearCache:c.clearCache||a,clientEndPoint:e};f._invokeProxyMethodAsync(c,"OEM_getSPTokenByProductIdAsync",d,g)}else d({statusCode:OSF.ProxyCallStatusCode.ProxyNotReady,value:b,context:c})};c.osfControl._contextActivationMgr._createSharePointIFrameProxy(c.appWebUrl,e)},getSPAppEntitlementsAsync:function(d,g){var f="/";OSF.OUtil.validateParamObject(d,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},baseUrl:{type:String,mayBeNull:a},pageUrl:{type:String,mayBeNull:a},webUrl:{type:String,mayBeNull:c}},g);if(!d.webUrl){var h=document.createElement("a");h.href=d.pageUrl;var o=h.pathname,m=o.split(f),r=m.length-1,e=h.href.substring(0,h.href.length-o.length);if(e&&e.charAt(e.length-1)!==f)e+=f;for(var j=[e],k=0;k<r;k++)if(m[k]){e=e+m[k]+f;j.push(e)}h=b;var p=this,l=d.osfControl._contextActivationMgr,i=j.pop(),q=function(b){if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded){var a=b.value;if(a&&a.charAt(a.length-1)!==f)a+=f;l._webUrl=a;b.context.webUrl=a;b.context.appWebUrl=a;p.getCorporateCatalogEntitlementsAsync(b.context,g)}else g(b)},n=function(c){if(c){d.clientEndPoint=c;var e={pageUrl:d.pageUrl,baseUrl:i,clearCache:d.clearCache||a};p._invokeProxyMethodAsync(d,"OEM_getSPAppWebUrlFromPageUrlAsync",q,e)}else if(j.length>0){i=j.pop();l._createSharePointIFrameProxy(i,n)}else g({statusCode:OSF.ProxyCallStatusCode.Failed,value:b,context:d})};l._createSharePointIFrameProxy(i,n)}else this.getCorporateCatalogEntitlementsAsync(d,g)},getOneDriveEntitlementsAsync:function(d,o){var g="Content-Type",p=d.referenceInUse.storeLocator,m=d.referenceInUse.storeLocator+"/root:/Manifests",c=OSF.OneDriveOAuth.getAccessTokenFromCookie();c==""||c==undefined;var h="?access_token="+c,k=m+h,b=new XMLHttpRequest,a=new XMLHttpRequest;b.onreadystatechange=function(){if(b.readyState==4)if(b.status==200){var f=JSON.parse(b.response),e=f.id,c=d.referenceInUse.storeLocator+"/items/"+e+"/children"+h;a.open("GET",c);a.setRequestHeader(g,"json");a.send()}};var i=[],j=0,f=0,e=function(){j==f&&o({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:{entitlements:i},context:d})},l=function(g,d){f++;var c=d;try{var b=new OSF.Manifest.Manifest(g.responseText),a=[];a.push(b.getDefaultDisplayName());a.push(c);a.push(b.getDefaultDescription());a.push(b.getTarget());a.push(b.getMarketplaceVersion());a.push(c);a.push(OSF.StoreType.OneDrive);a.push(b.getDefaultWidth()||0);a.push(b.getDefaultHeight()||0);a.push(b.getDefaultIconUrl());a.push(b.getProviderName());a.push(b.getDefaultLocale());a.push(OSF.StoreType.OneDrive);i.push(a)}catch(h){}e()},n=function(){f++;e()};a.onreadystatechange=function(){if(a.readyState==4&&a.status==200){for(var d=JSON.parse(a.responseText),b=0;b<d.value.length;b++)if(d.value[b].name.substr(d.value[b].name.length-4).toLowerCase()==".xml"){var f=p+"/root:/Manifests/"+d.value[b].name+":/content?access_token="+c;OSF.OUtil.xhrGetFull(f,d.value[b].name,l,n);j++}e()}};b.open("GET",k);b.setRequestHeader(g,"json");b.send()},getCorporateCatalogEntitlementsAsync:function(d,e){OSF.OUtil.validateParamObject(d,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},webUrl:{type:String,mayBeNull:a}},e);Telemetry.AppLoadTimeHelper.AuthenticationStart(d.osfControl._telemetryContext);var h=this,g=0,f=function(i){if(i){Telemetry.AppLoadTimeHelper.AuthenticationEnd(d.osfControl._telemetryContext);d.clientEndPoint=i;var j={webUrl:d.webUrl,applicationName:OSF.HostCapability[d.hostType],officeExtentionTarget:d.noTargetType||d.osfControl.getOsfControlType()===OSF.OsfControlTarget.TaskPane?b:d.osfControl.getOsfControlType(),clearCache:d.clearCache||a,supportedManifestVersions:{"1.0":c,"1.1":c}};h._invokeProxyMethodAsync(d,"OEM_getEntitlementSummaryAsync",e,j)}else if(g<OSF.Constants.AuthenticatedConnectMaxTries){g++;setTimeout(function(){d.osfControl._contextActivationMgr._createSharePointIFrameProxy(d.webUrl,f)},500)}else e({statusCode:OSF.ProxyCallStatusCode.ProxyNotReady,value:b,context:d})};d.osfControl._contextActivationMgr._createSharePointIFrameProxy(d.webUrl,f)},_invokeProxyMethodAsync:function(c,g,p,a){var o=a.clientEndPoint?a.clientEndPoint._targetUrl:c.clientEndPoint._targetUrl,j=[o,g],e;for(var m in a){e=typeof a[m];(e==="string"||e==="number"||e==="boolean")&&j.push(a[m])}var f=j.join("."),d=k,i={onCompleted:p,context:c,methodName:g},h=d[f];if(!h){d[f]=[i];var n=function(l,c){var i=b,h=OSF.ProxyCallStatusCode.Failed;if(l===0&&c.status){i=c.result;h=OSF.ProxyCallStatusCode.Succeeded}var g=d[f];delete d[f];for(var k=g.length,j=0;j<k;j++){var a=g.shift(),e;try{if(a.context&&a.context.osfControl)e=a.context.osfControl._appCorrelationId;c&&c.failureInfo&&Telemetry.RuntimeTelemetryHelper.LogProxyFailure(e,a.methodName,c.failureInfo);a.onCompleted({statusCode:h,value:i,context:a.context})}catch(m){OsfMsAjaxFactory.msAjaxDebug.trace("_invokeProxyMethodAsync failed: "+m);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("_invokeProxyMethodAsync failed.",m,e,8209032)}}},l=c.clientEndPoint;if(a.clientEndPoint){l=a.clientEndPoint;delete a.clientEndPoint}if(c.referenceInUse&&c.referenceInUse.storeType===OSF.StoreType.OMEX)a.officeVersion=OSF.Constants.ThreePartsFileVersion;l.invoke(g,n,a)}else h.push(i)},getOmexEntitlementsAsync:function(b,c){OSF.OUtil.validateParamObject(b,{referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a},anonymous:{type:Boolean,mayBeNull:a}},c);var d={applicationName:b.hostType,appVersion:b.appVersion,build:OSF.Constants.FileVersion,clearEntitlement:b.clearCache||b.clearEntitlement||a,clientName:b.clientName,clientVersion:b.clientVersion,correlationId:b.correlationId};this._invokeProxyMethodAsync(b,"OMEX_getEntitlementSummaryAsync",c,d)},getOmexAppDetailsAsync:function(b,d){OSF.OUtil.validateParamObject(b,{assetId:{type:String,mayBeNull:a},contentMarket:{type:String,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:c},anonymous:{type:Boolean,mayBeNull:a},clientName:{type:String,mayBeNull:a},clientVersion:{type:String,mayBeNull:a}},d);var e={assetid:"",assetID:b.assetId,contentMarket:b.contentMarket,build:OSF.Constants.FileVersion,clearCache:b.clearCache||b.clearEntitlement||a,clientName:b.clientName,clientVersion:b.clientVersion,correlationId:b.correlationId};b.manifestManager=this;_omexDataProvider.GetAppDetails(b,e,d)},getOmexKilledAppsAsync:function(b,c){OSF.OUtil.validateParamObject(b,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a},anonymous:{type:Boolean,mayBeNull:a}},c);var d={clearKilledApps:b.clearCache||b.clearKilledApps||a,clientName:b.clientName,clientVersion:b.clientVersion,correlationId:b.correlationId};b.manifestManager=this;_omexDataProvider.GetKilledApps(b,d,c)},getOmexAppStateAsync:function(b,d){OSF.OUtil.validateParamObject(b,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a},anonymous:{type:Boolean,mayBeNull:c}},d);var e=b.referenceInUse,f={assetID:e.id,contentMarket:e.storeLocator,clearAppState:b.clearCache||b.clearAppState||a,clientName:b.clientName,errors:{},clientVersion:b.clientVersion,correlationId:b.correlationId};b.manifestManager=this;_omexDataProvider.GetAppState(b,f,d);b.osfControl._telemetryContext&&Telemetry.AppLoadTimeHelper.SetAppStateDataInvalidFlag(b.osfControl._telemetryContext,f.errors[h])},getOmexManifestAndETokenAsync:function(b,e){OSF.OUtil.validateParamObject(b,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a},anonymous:{type:Boolean,mayBeNull:a}},e);var d=b.referenceInUse,c={applicationName:b.hostType,assetID:d.id,build:OSF.Constants.FileVersion,clientName:b.clientName,clientVersion:b.clientVersion,clientAppInfoReturnType:b.clientAppInfoReturnType,errors:{},correlationId:b.correlationId};if(b.anonymous){c.contentMarket=d.storeLocator;c.clearManifest=b.clearCache||b.clearManifest||a}else{c.assetContentMarket=b.osfControl._omexEntitlement.contentMarket;c.userContentMarket=d.storeLocator;c.clearToken=b.clearCache||b.clearToken||a;c.clearManifest=b.clearCache||b.clearManifest||a;if(b.acceptedUpgrade)c.expectedVersion=b.expectedVersion;else if(b.osfControl._omexEntitlement.hasEntitlement)c.expectedVersion=b.osfControl._omexEntitlement.version}b.manifestManager=this;_omexDataProvider.GetManifestAndEToken(b,c,e);b.osfControl._telemetryContext&&Telemetry.AppLoadTimeHelper.SetManifestDataInvalidFlag(b.osfControl._telemetryContext,c.errors[h])},removeOmexAppAsync:function(b,c){OSF.OUtil.validateParamObject(b,{assetId:{type:String,mayBeNull:a},clientName:{type:String,mayBeNull:a},clientVersion:{type:String,mayBeNull:a}},c);var d={assetID:b.assetId,clientName:b.clientName,clientVersion:b.clientVersion,correlationId:b.correlationId};this._invokeProxyMethodAsync(b,"OMEX_removeAppAsync",c,d)},removeOmexCacheAsync:function(b,e){OSF.OUtil.validateParamObject(b,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},e);var d=b.referenceInUse,c={applicationName:b.hostType,assetID:d.id,officeExtentionTarget:b.osfControl.getOsfControlType(),clearEntitlement:b.clearEntitlement||a,clearToken:b.clearToken||a,clearAppState:b.clearAppState||a,clearManifest:b.clearManifest||a,appVersion:b.appVersion};if(b.anonymous)c.contentMarket=d.storeLocator;else{c.assetContentMarket=b.osfControl._omexEntitlement.contentMarket;c.userContentMarket=d.storeLocator}this._invokeProxyMethodAsync(b,"OMEX_removeCacheAsync",e,c)},purgeManifest:function(j,h){var c=Function._validateParams(arguments,[{name:f,type:String,mayBeNull:a},{name:g,type:String,mayBeNull:a}]);if(c)throw c;var b=e(j,h);if(typeof d[b]!=i)delete d[b]},cacheManifest:function(i,h,b){var c=Function._validateParams(arguments,[{name:f,type:String,mayBeNull:a},{name:g,type:String,mayBeNull:a},{name:"manifest",type:Object,mayBeNull:a}]);if(c)throw c;var k=e(i,h);b._UILocale=j;d[k]=b},hasManifest:function(j,h){var b=Function._validateParams(arguments,[{name:f,type:String,mayBeNull:a},{name:g,type:String,mayBeNull:a}]);if(b)throw b;var k=e(j,h);return typeof d[k]!=i?c:a},getCachedManifest:function(h,c){var b=Function._validateParams(arguments,[{name:f,type:String,mayBeNull:a},{name:g,type:String,mayBeNull:a}]);if(b)throw b;var i=e(h,c);return d[i]},versionLessThan:function(i,j){for(var e=i.split("."),d=j.split("."),g=Math.min(e.length,d.length),f,c,b=0;b<g;b++)try{f=parseFloat(e[b]);c=parseFloat(d[b]);if(f!=c)return f<c}catch(k){}if(e.length>=d.length)return a;else{g=d.length;var h=0;for(b=e.length;b<g;b++){try{c=parseFloat(d[b])}catch(k){c=0}h+=c}return h>0}},_setUILocale:function(a){j=a}}}();OSF.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3};OSF._ErrorUXHelper=function(G){var y="progress_",i=true,f=false,h="100%",x="center",w="no-repeat",v="alpha(opacity=100)",u="url(",g="onclick",k="tabindex",j="type",d="id",t="moe-background",c="class",e="div",F="notificationbackground_",E="moe-infobar-body_",z="agavedefaulticon96x96.png",l="moe_status_icons.png",B="progress.gif",m="img",b=G;OSF.OUtil.loadCSS(b.getLocalizedCSSFilePath("moeerrorux.css"));var L=document.createElement(m);L.src=b.getLocalizedImageFilePath(B);var J=document.createElement(m);J.src=b.getLocalizedImageFilePath(l);var I=document.createElement(m);I.src=b.getLocalizedImageFilePath(z);var a={},q=0,p=function(a){var d=a.childNodes.length,c=0,b;while(c<d){b=a.childNodes.item(c);if(b.tagName.toLowerCase()==="iframe")c++;else{a.removeChild(b);d--}}},r=function(b){var a=document.getElementById(b);a&&a.parentNode.removeChild(a)},M=function(a){OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveStage1Start);r("icon_"+a);OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveStage1End)},s=function(b,e){OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveStage2Start);var c;if(e)c=E+b;else c=F+b;var d=a[b]&&a[b].length>0;if(d&&a[b][0].highPriority)q--;r(c);d&&a[b].shift();OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveStage2End)},D=function(a){OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderStage1Start);p(a.div);var f=document.createElement(e);f.setAttribute(c,t);f.setAttribute(d,"icon_"+a.id);var i=document.createElement("input");i.setAttribute(d,"iconImg_"+a.id);i.setAttribute(j,"image");i.setAttribute(k,"0");i.src=b.getLocalizedImageFilePath(l);var r=function(a){a.sqmDWords[1]|=2;C(a);n(a.id)};i.setAttribute(g,"getIntoStage2(params)");OSF.OUtil.attachClickHandler(i,function(){r(a)});f.appendChild(i);if(a.displayDeactive){f.style.backgroundImage=u+b.getLocalizedImageFilePath(z)+")";f.style.backgroundColor="white";f.style.opacity="1";f.style.filter=v;f.style.backgroundRepeat=w;f.style.backgroundPosition=x;f.style.height=h}var m,q,o;if(a.infoType===OSF.InfoType.Error){m="moe-status-error-icon";q="iconImg_error_"+a.id;o=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT}else if(a.infoType===OSF.InfoType.Warning){m="moe-status-warning-icon";q="iconImg_warning_"+a.id;o=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT}else if(a.infoType===OSF.InfoType.Information){m="moe-status-info-icon";q="iconImg_info_"+a.id;o=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT}else{m="moe-status-secinfo-icon";q="iconImg_secinfo_"+a.id;o=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT}var s=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(s.exec(navigator.userAgent)!=null&&parseFloat(RegExp.$1)==9)m+="_ie";i.setAttribute(c,m);i.setAttribute(d,q);i.setAttribute("alt",o);if(a.div.childNodes.length!=0)a.div.insertBefore(f,a.div.childNodes[0]);else a.div.appendChild(f);A(a.id);OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderStage1End)},C=function(q){var T="moe-infobar-button",L="button",S="presentation";OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderStage2Start);p(q.div);var Y=q.description;if(q.title.length>100)q.title=q.title.substring(0,99);if(q.description.length>255)q.description=q.description.substring(0,254);var W=E+q.id,G=document.getElementById(W);if(G==undefined){G=document.createElement(e);G.setAttribute(c,"moe-infobar-body");G.setAttribute(d,W)}var P=document.createElement(e);P.innerHTML=Y;G.setAttribute("title",P.textContent);P=null;var J=document.createElement("table");J.setAttribute(c,"moe-infobar-infotable");J.setAttribute("role",S);for(var X,R=0;R<3;R++){X=J.insertRow(R);X.setAttribute("role",S)}var r=J.rows;r[0].insertCell(0);r[0].insertCell(1);r[0].insertCell(2);r[0].cells[1].setAttribute("rowSpan","2");r[1].insertCell(0);r[1].insertCell(1);r[2].insertCell(0);r[2].insertCell(1);r[2].insertCell(2);r[0].cells[0].setAttribute(c,"moe-infobar-top-left-cell");r[0].cells[1].setAttribute(c,"moe-infobar-message-cell");r[0].cells[2].setAttribute(c,"moe-infobar-top-right-cell");r[2].cells[1].setAttribute(c,"moe-infobar-button-cell");var M=document.createElement(m);M.src=b.getLocalizedImageFilePath(l);var I,K;if(q.infoType===OSF.InfoType.Error){I="moe-infobar-error";K=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT}else if(q.infoType===OSF.InfoType.Warning){I="moe-infobar-warning";K=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT}else if(q.infoType===OSF.InfoType.Information){I="moe-infobar-info";K=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT}else{I="moe-infobar-secinfo";K=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT}M.setAttribute(c,I);M.setAttribute("alt",K);r[0].cells[0].appendChild(M);var N=document.createElement(e);N.setAttribute(c,"moe-infobar-message-div");var Q=document.createElement("span");Q.setAttribute(c,"moe-infobar-title");Q.innerHTML=q.title;var U="moe-infobar-message_"+q.id,H=document.getElementById(U);if(H==undefined){H=document.createElement("span");H.setAttribute(c,"moe-infobar-message");H.setAttribute(d,U)}H.innerHTML=q.description;N.appendChild(Q);N.appendChild(H);r[0].cells[1].appendChild(N);var O=function(a){var c=b.getOsfControl(a.id);Telemetry.AppNotificationHelper.LogNotification(c._appCorrelationId,a.sqmDWords[0],a.sqmDWords[1])},V=function(){q.sqmDWords[1]|=8;O(q);!q.reDisplay&&s(q.id,q.displayDeactive);if(q.reDisplay)o(q);else if(a[q.id].length>0){var b=a[q.id][0];o(b)}q.dismissCallback&&q.dismissCallback();n(q.id)},C=document.createElement("input");C.setAttribute(j,"image");C.setAttribute("src",b.getLocalizedImageFilePath(l));C.setAttribute(c,"moe-infobar-dismiss");C.setAttribute(d,"moe-infobar-dismiss_"+q.id);C.setAttribute(k,"0");C.setAttribute("alt",Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT);C.setAttribute(g,"handleDismiss();");OSF.OUtil.attachClickHandler(C,V);r[0].cells[2].appendChild(C);q.detailView=f;var B=document.createElement(L);B.setAttribute(c,T);B.innerHTML=q.buttonTxt;B.setAttribute(d,"moe-infobar-button_"+q.id);B.setAttribute(k,"0");B.setAttribute(j,L);if(q.buttonCallback){var ab=function(){q.sqmDWords[1]|=4;O(q);s(q.id,f);if(a[q.id].length>0){var d=a[q.id][0];o(d)}if(q.retryAll===i){var c=b.getOsfControl(q.id);c._retryActivate=null;b.retryAll(c._marketplaceID)}q.buttonCallback();n(q.id)};B.setAttribute(g,"handleButtonClick()");OSF.OUtil.attachClickHandler(B,ab)}else{B.setAttribute(g,"handleDismiss()");OSF.OUtil.attachClickHandler(B,V)}r[2].cells[1].appendChild(B);if(q.url){var Z=function(){q.sqmDWords[1]|=4;O(q);q.sqmDWords[1]=1;window.open(q.url)},D=document.createElement(L);D.setAttribute(c,T);D.innerHTML=q.urlButtonTxt?q.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT;D.setAttribute(d,"moe-infobar-button2_"+q.id);D.setAttribute(g,"moreInfoButtonClick()");OSF.OUtil.attachClickHandler(D,Z);D.setAttribute(k,"0");D.setAttribute(j,L);r[2].cells[1].appendChild(D)}G.appendChild(J);var y=document.createElement(e);y.setAttribute(c,t);y.setAttribute(d,F+q.id);if(q.displayDeactive){y.style.backgroundImage=u+b.getLocalizedImageFilePath(z)+")";y.style.backgroundColor="white";y.style.opacity="1";y.style.filter=v;y.style.backgroundRepeat=w;y.style.backgroundPosition=x;y.style.height=h}y.appendChild(G);if(q.div.childNodes.length!=0)q.div.insertBefore(y,q.div.childNodes[0]);else q.div.appendChild(y);A(q.id);OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderStage2End)},n=function(c){var a=b.getOsfControl(c);if(a)a._controlFocus=i},A=function(d){var g=b.getOsfControl(d);if(g)if(g._controlFocus)if(a[d]&&a[d].length>0){var f=a[d][0];if(f&&f.div){var c=f.div.querySelectorAll("input,a,button");if(c&&c.length>0){var e;if(c.length===1)e=c[0];else e=c[1];if(e instanceof HTMLElement){e.focus();b._notifyHost&&b._notifyHost(d,OSF.AgaveHostAction.SelectWithError)}}}}},o=function(a){if(a.detailView==undefined||a.detailView===f){a.sqmDWords[1]=0;D(a)}else{a.sqmDWords[1]=1;C(a)}},K=function(b){if(a[b]){if(a[b].length>0){var c=a[b][0].div;p(c)}delete a[b]}},H=function(c){var a=document.createElement(e),b=document.createTextNode(c);a.appendChild(b);return a.innerHTML};return{showProgress:function(k,i){try{OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderLoadingAnimationStart);var j=document.getElementById(y+i);if(!j){a[i]=[];var f=document.createElement(e);f.setAttribute(c,t);f.setAttribute(d,y+i);f.style.backgroundColor="rgba(255, 255, 255, 0.5)";f.style.opacity="1";f.style.filter=v;f.style.height=h;var g=document.createElement(e);g.style.width=h;g.style.height=h;g.style.backgroundImage=u+b.getLocalizedImageFilePath(B)+")";g.style.backgroundRepeat=w;g.style.backgroundPosition=x;f.appendChild(g);k.appendChild(f)}OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(l){}},showNotification:function(b){b.sqmDWords=[b.errorCode,0];delete b.errorCode;if(b.highPriority==undefined)b.highPriority=b.infoType===OSF.InfoType.Error?i:f;if(b.reDisplay==undefined)b.reDisplay=b.infoType===OSF.InfoType.Error?i:f;var c=a[b.id];if(c===undefined){c=[];a[b.id]=c}if(b.highPriority===f)c.push(b);else{c.splice(q,0,b);q++}(a[b.id].length===1||b.highPriority)&&o(c[0])},showICon:function(a){D(a)},removeDOMElement:function(a){r(a)},removeProgressDiv:function(a,c){OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveLoadingAnimationStart);var b=a.ownerDocument.getElementById(y+c);b&&p(a);OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(a){M(a)},removeInfoBarDiv:function(b,a){s(b,a)},dismissMessages:function(a){K(a)},getHTMLEncodedString:function(a){return H(a)},purgeOsfControlNotification:function(d){var c=a[d],e=b.getOsfControl(d);c&&c.length>0&&e&&Telemetry.AppNotificationHelper.LogNotification(d,c[0].sqmDWords[0],c[0].sqmDWords[1])},focusOnNotificationUx:function(a){n(a);A(a)},appHasNotifications:function(b){return a[b]&&a[b].length>0}}};OSF.RequirementSetNames={ActiveView:"ActiveView",BindingEvents:"BindingEvents",CompressedFile:"CompressedFile",CustomXmlParts:"CustomXmlParts",DocumentEvents:"DocumentEvents",ExcelApi:"ExcelApi",File:"File",HtmlCoercion:"HtmlCoercion",ImageCoercion:"ImageCoercion",Mailbox:"Mailbox",MatrixBindings:"MatrixBindings",MatrixCoercion:"MatrixCoercion",OoxmlCoercion:"OoxmlCoercion",PartialTableBindings:"PartialTableBindings",PdfFile:"PdfFile",Selection:"Selection",Settings:"Settings",TableBindings:"TableBindings",TableCoercion:"TableCoercion",TextBindings:"TextBindings",TextCoercion:"TextCoercion",TextFile:"TextFile",WordApi:"WordApi"};OSF.RequirementMethodNames={"Binding.addHandlerAsync":"Binding.addHandlerAsync","Binding.removeHandlerAsync":"Binding.removeHandlerAsync","Bindings.addFromNamedItemAsync":"Bindings.addFromNamedItemAsync","Bindings.addFromPromptAsync":"Bindings.addFromPromptAsync","Bindings.addFromSelectionAsync":"Bindings.addFromSelectionAsync","Bindings.getAllAsync":"Bindings.getAllAsync","Bindings.getByIdAsync":"Bindings.getByIdAsync","Bindings.releaseByIdAsync":"Bindings.releaseByIdAsync","CustomXmlParts.addAsync":"CustomXmlParts.addAsync","CustomXmlParts.getByIdAsync":"CustomXmlParts.getByIdAsync","CustomXmlParts.getByNamespaceAsync":"CustomXmlParts.getByNamespaceAsync","CustomXmlPart.getXmlAsync":"CustomXmlPart.getXmlAsync","CustomXmlPart.getNodesAsync":"CustomXmlPart.getNodesAsync","CustomXmlPart.deleteAsync":"CustomXmlPart.deleteAsync","CustomXmlNode.getNodesAsync":"CustomXmlNode.getNodesAsync","CustomXmlNode.getNodeValueAsync":"CustomXmlNode.getNodeValueAsync","CustomXmlNode.getXmlAsync":"CustomXmlNode.getXmlAsync","CustomXmlNode.setNodeValueAsync":"CustomXmlNode.setNodeValueAsync","CustomXmlNode.setXmlAsync":"CustomXmlNode.setXmlAsync","CustomXmlPrefixMappings.addNamespaceAsync":"CustomXmlPrefixMappings.addNamespaceAsync","CustomXmlPrefixMappings.getNamespaceAsync":"CustomXmlPrefixMappings.getNamespaceAsync","CustomXmlPrefixMappings.getPrefixAsync":"CustomXmlPrefixMappings.getPrefixAsync","Document.addHandlerAsync":"Document.addHandlerAsync","Document.getActiveViewAsync":"Document.getActiveViewAsync","Document.getFileAsync":"Document.getFileAsync","Document.getFilePropertiesAsync":"Document.getFilePropertiesAsync","Document.getSelectedDataAsync":"Document.getSelectedDataAsync","Document.goToByIdAsync":"Document.goToByIdAsync","Document.removeHandlerAsync":"Document.removeHandlerAsync","Document.setSelectedDataAsync":"Document.setSelectedDataAsync","File.closeAsync":"File.closeAsync","File.getSliceAsync":"File.getSliceAsync","MatrixBinding.getDataAsync":"MatrixBinding.getDataAsync","MatrixBinding.setDataAsync":"MatrixBinding.setDataAsync","Settings.addHandlerAsync":"Settings.addHandlerAsync","Settings.get":"Settings.get","Settings.refreshAsync":"Settings.refreshAsync","Settings.remove":"Settings.remove","Settings.removeHandlerAsync":"Settings.removeHandlerAsync","Settings.saveAsync":"Settings.saveAsync","Settings.set":"Settings.set","TableBinding.addColumnsAsync":"TableBinding.addColumnsAsync","TableBinding.addRowsAsync":"TableBinding.addRowsAsync","TableBinding.clearFormatsAsync":"TableBinding.clearFormatsAsync","TableBinding.deleteAllDataValuesAsync":"TableBinding.deleteAllDataValuesAsync","TableBinding.getDataAsync":"TableBinding.getDataAsync","TableBinding.setDataAsync":"TableBinding.setDataAsync","TableBinding.setFormatsAsync":"TableBinding.setFormatsAsync","TableBinding.setTableOptionsAsync":"TableBinding.setTableOptionsAsync","TextBinding.getDataAsync":"TextBinding.getDataAsync","TextBinding.setDataAsync":"TextBinding.setDataAsync","CustomXmlPart.addHandlerAsync":"CustomXmlPart.addHandlerAsync","CustomXmlPart.removeHandlerAsync":"CustomXmlPart.removeHandlerAsync"};var OsfRuntime;(function(a){(function(a){(function(a){var e="ThrottledRequestTokensUnavailable",d="ThrottledTooManyIncompleteRequests",c="ThrottledThrottleNotInitialized",b="ThrottledUnspecified";a[a.Allowed=0]="Allowed";a[a[b]=10]=b;a[a[c]=11]=c;a[a[d]=12]=d;a[a[e]=13]=e})(a.ThrottleRequestStatus||(a.ThrottleRequestStatus={}));var b=a.ThrottleRequestStatus})(a.Throttling||(a.Throttling={}));var b=a.Throttling})(OsfRuntime||(OsfRuntime={}));var OsfRuntime;(function(a){(function(b){var a=function(){function a(b,a){if(typeof a==="undefined")a=-1;this._maxIncompleteRequestCount=b;this._timeoutInMilliSec=a;this.reset()}a.prototype.tryRequest=function(a){if(!this._shouldRequestBeAllowed())return 12;a();return 0};a.prototype.tryAsyncRequest=function(a){var c=this;if(!this._shouldRequestBeAllowed())return 12;var b=this._addRequestAndGetToken();a(function(){c._removeRequestWithToken(b)});return 0};a.prototype.reset=function(){this._currentlyExecutingRequestsToTimeoutIDMapping={};this._currentlyExecutingRequestCount=0;this._requestToken=0};a.prototype._shouldRequestBeAllowed=function(){return this._currentlyExecutingRequestCount<this._maxIncompleteRequestCount};a.prototype._addRequestAndGetToken=function(){var a=this,d=a,b=a._requestToken;if(a._timeoutInMilliSec>=0)var c=setTimeout(function(){return d._removeRequestWithToken(b)},a._timeoutInMilliSec);a._currentlyExecutingRequestsToTimeoutIDMapping[b]=c;a._currentlyExecutingRequestCount++;a._requestToken++;return b};a.prototype._removeRequestWithToken=function(b){var a=this;if(!a._currentlyExecutingRequestsToTimeoutIDMapping.hasOwnProperty(b.toString()))return;var c=a._currentlyExecutingRequestsToTimeoutIDMapping[b];delete a._currentlyExecutingRequestsToTimeoutIDMapping[b];a._currentlyExecutingRequestCount--;clearTimeout(c)};return a}();b.IncompleteRequestThrottle=a})(a.Throttling||(a.Throttling={}));var b=a.Throttling})(OsfRuntime||(OsfRuntime={}));var OsfRuntime;(function(a){(function(b){var a=function(){function a(b,a){this._bucketCapacity=b;this._tokenFillingIntervalInMilliSec=a;this.reset()}a.prototype.tryRequest=function(a){return this._tryRequestInternal(a,false)};a.prototype.tryAsyncRequest=function(a){return this._tryRequestInternal(a,true)};a.prototype.reset=function(){this._lastCallStartedAt=0;this._tokenCountAfterLastCall=this._bucketCapacity};a.prototype._tryRequestInternal=function(d,e){var a=+new Date,b=this._getTokenCountAtTime(a);if(b<1)return 13;this._lastCallStartedAt=a;this._tokenCountAfterLastCall=b-1;var c=e?[function(){}]:[];d.apply(undefined,c);return 0};a.prototype._getTokenCountAtTime=function(b){var a=this;return b<a._lastCallStartedAt?0:Math.min(a._bucketCapacity,a._tokenCountAfterLastCall+(b-a._lastCallStartedAt)/a._tokenFillingIntervalInMilliSec)};return a}();b.TokenBucketThrottle=a})(a.Throttling||(a.Throttling={}));var b=a.Throttling})(OsfRuntime||(OsfRuntime={}));var OsfRuntime;(function(a){(function(a){var b=function(){function b(){}b.prototype.createIncompleteRequestThrottle=function(b,c){return new a.IncompleteRequestThrottle(b,c)};b.prototype.createTokenBucketThrottle=function(c,b){return new a.TokenBucketThrottle(c,b)};b.prototype.createChainedThrottle=function(b){return new a.ChainedThrottle(b)};return b}();a.ThrottleFactory=b})(a.Throttling||(a.Throttling={}));var b=a.Throttling})(OsfRuntime||(OsfRuntime={}));var OsfRuntime;(function(a){(function(b){var a=function(){function a(a){this._throttles=a;this._throttles=a||[]}a.prototype.tryRequest=function(d){var a=this._throttles.length;if(a===0){d();return 0}var c=0;function f(){c++;c===a&&d()}for(var b=0;b<a;++b){var e=this._throttles[b].tryRequest(f);if(e!==0)break}return e};a.prototype.tryAsyncRequest=function(g){var a=this._throttles.length;if(a===0){g(function(){});return 0}var f=0,e=false,c=new Array(a);function d(){for(var b=0;b<a;++b)c[b]&&c[b]()}function i(b){return function(h){e&&h();c[b]=h;f++;f===a&&g(d)}}for(var b=0;b<a;++b){var h=this._throttles[b].tryAsyncRequest(i(b));if(h!==0){e=true;d();break}}return h};a.prototype.reset=function(){for(var a=0,b=this._throttles.length;a<b;++a)this._throttles[a].reset()};return a}();b.ChainedThrottle=a})(a.Throttling||(a.Throttling={}));var b=a.Throttling})(OsfRuntime||(OsfRuntime={}));OSF.DataPointNames={AppManagementMenu:"appmanagementmenu",InsertionDialogSession:"insertiondialogsession",UploadFileDevCatelog:"uploadfiledevcatelog",UploadFileDevCatalogUsage:"uploadfiledevcatalogusage"};OSF.AppManagementAction={Cancel:0,AppDetails:1,RateReview:2,Remove:3};OSF.UploadFileDevCatelogAction={OpenUploadFileDialog:0,Install:1,Cancel:2};OSF.OUtil.normalizeAppVersion=function(b){for(var d=b.split("."),a=b,c=0;c<4-d.length;c++)a+=".0";return a};OSF.OUtil.getTargetType=function(b){var a=0;switch(b){case"1":a=1;break;case"2":a=0;break;case"4":a=1;break;default:OsfMsAjaxFactory.msAjaxDebug.trace("targetType value is invalid.")}return a};OSF.OUtil.setNamespace("Marshaling",OSF.DDA);OSF.DDA.Marshaling.UniqueArgumentKeys={Data:"Data",GetData:"DdaGetBindingData",SetData:"DdaSetBindingData",SettingsRequest:"DdaSettingsMethod",Properties:"Properties",BindingRequest:"DdaBindingsMethod",BindingResponse:"Bindings",ArrayData:"ArrayData",AddRowsColumns:"DdaAddRowsColumns"};OSF.DDA.Marshaling.ApiResponseKeys={Error:"Error"};OSF.OUtil.setNamespace("Marshaling",OSF.DDA);OSF.DDA.Marshaling.BindingParameterKeys={Id:"BindingId",BindingType:"BindingType",ItemName:"ItemName",StartRow:"StartRow",StartCol:"StartCol",RowCount:"RowCount",ColCount:"ColCount"};OSF.DDA.Marshaling.TableBindingParameterKeys={TableHeaders:"TableHeaders",TableRows:"TableRows"};OSF.DDA.Marshaling.AppBindingKeys={BindingId:"Name",BindingType:"BindingType",BindingProperties:0,BindingEventSource:"ddaBinding",RowCount:"RowCount",ColumnCount:"ColCount",HasHeaders:"HasHeaders"};OSF.DDA.Marshaling.TableSubsetKeys={TableSubset:"subset",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount"};var OSF_DDA_Marshaling_BindingType;(function(a){a[a.Table=1]="Table";a[a.Text=2]="Text";a[a.Matrix=3]="Matrix"})(OSF_DDA_Marshaling_BindingType||(OSF_DDA_Marshaling_BindingType={}));OSF.DDA.Marshaling.BindingType=OSF_DDA_Marshaling_BindingType;OSF.OUtil.setNamespace("Marshaling",OSF.DDA);OSF.DDA.Marshaling.GetDataKeys={CoercionType:"CoerceType"};OSF.DDA.Marshaling.SetDataKeys={CoercionType:"CoerceType",Data:"Data",ImageLeft:"ImageLeft",ImageTop:"ImageTop",ImageWidth:"ImageWidth",ImageHeight:"ImageHeight"};OSF.DDA.Marshaling.CoercionTypeKeys={Html:"html",Ooxml:"ooxml",SlideRange:"slideRange",Text:"text",Table:"table",Matrix:"matrix",Image:"image"};OSF.OUtil.setNamespace("Marshaling",OSF.DDA);var OSF_DDA_Marshaling_FilePropertiesKeys;(function(a){var b="Properties";a[a[b]=0]=b;a[a.Url=1]="Url"})(OSF_DDA_Marshaling_FilePropertiesKeys||(OSF_DDA_Marshaling_FilePropertiesKeys={}));OSF.DDA.Marshaling.FilePropertiesKeys=OSF_DDA_Marshaling_FilePropertiesKeys;OSF.OUtil.setNamespace("Marshaling",OSF.DDA);OSF.OUtil.setNamespace("File",OSF.DDA.Marshaling);var OSF_DDA_Marshaling_File_FilePropertiesKeys;(function(a){var b="FileSize";a[a.Handle=0]="Handle";a[a[b]=1]=b})(OSF_DDA_Marshaling_File_FilePropertiesKeys||(OSF_DDA_Marshaling_File_FilePropertiesKeys={}));OSF.DDA.Marshaling.File.FilePropertiesKeys=OSF_DDA_Marshaling_File_FilePropertiesKeys;var OSF_DDA_Marshaling_File_SlicePropertiesKeys;(function(a){var b="SliceSize";a[a.Data=0]="Data";a[a[b]=1]=b})(OSF_DDA_Marshaling_File_SlicePropertiesKeys||(OSF_DDA_Marshaling_File_SlicePropertiesKeys={}));OSF.DDA.Marshaling.File.SlicePropertiesKeys=OSF_DDA_Marshaling_File_SlicePropertiesKeys;var OSF_DDA_Marshaling_File_FileType;(function(a){var b="Compressed";a[a.Text=0]="Text";a[a[b]=1]=b;a[a.Pdf=2]="Pdf"})(OSF_DDA_Marshaling_File_FileType||(OSF_DDA_Marshaling_File_FileType={}));OSF.DDA.Marshaling.File.FileType=OSF_DDA_Marshaling_File_FileType;var OSF_DDA_Marshaling_File_ParameterKeys;(function(a){var d="SliceIndex",c="SliceSize",b="FileType";a[a[b]=0]=b;a[a[c]=1]=c;a[a.Handle=2]="Handle";a[a[d]=3]=d})(OSF_DDA_Marshaling_File_ParameterKeys||(OSF_DDA_Marshaling_File_ParameterKeys={}));OSF.DDA.Marshaling.File.ParameterKeys=OSF_DDA_Marshaling_File_ParameterKeys;OSF.OUtil.setNamespace("Marshaling",OSF.DDA);OSF.DDA.Marshaling.SettingsKeys={SerializedSettings:"Properties"};OSF.OUtil.setNamespace("Marshaling",OSF.DDA);OSF.DDA.Marshaling.CustomXmlPartsKeys={Id:"id",Namespace:"namespace",Xml:"xml",XPath:"xpath",Prefix:"prefix"};OSF.DDA.Marshaling.DataPartProperties={Id:"id",BuiltIn:"DataPartBuiltIn"};OSF.DDA.Marshaling.PropertyDescriptors={DataPartProperties:"dataPartProperties",DataNodeProperties:"dataNodeProperties"};OSF.DDA.Marshaling.DataNodeProperties={Handle:"DataNodeHandle",BaseName:"DataNodeBaseName",NamespaceUri:"DataNodeNamespaceUri",NodeType:"DataNodeType"};OSF.DDA.Marshaling.ListDescriptors={DataPartList:"DataPartList",DataNodeList:"DataNodeList"};OSF.OUtil.setNamespace("Marshaling",OSF.DDA);OSF.DDA.Marshaling.NavigationKeys={NavigationRequest:"DdaGoToByIdMethod",Id:"Id",GoToType:"GoToType",SelectionMode:"SelectionMode"};var OSF_DDA_Marshaling_GoToType;(function(a){var b="NamedItem";a[a.Binding=0]="Binding";a[a[b]=1]=b;a[a.Slide=2]="Slide";a[a.Index=3]="Index"})(OSF_DDA_Marshaling_GoToType||(OSF_DDA_Marshaling_GoToType={}));OSF.DDA.Marshaling.GoToType=OSF_DDA_Marshaling_GoToType;var OSF_DDA_Marshaling_SelectionMode;(function(a){var b="Selected";a[a.Default=0]="Default";a[a[b]=1]=b;a[a.None=2]="None"})(OSF_DDA_Marshaling_SelectionMode||(OSF_DDA_Marshaling_SelectionMode={}));OSF.DDA.Marshaling.SelectionMode=OSF_DDA_Marshaling_SelectionMode;OSF.OneDriveOAuth=function(){var e="We had a problem connecting to OneDrive. Please try again.",a=null,l="000000004C16753E",j="https://login.live.com/oauth20_authorize.srf";if(window.location.href.indexOf("live-int.com")!=-1){l="00000000604C4E61";j="https://login.live-int.com/oauth20_authorize.srf"}var s="onedrive.readonly wl.signin",i="onedrive_appcatalog_access_token",r="http://datatest1.azurewebsites.net/odauth/callback-redirect.html",g=["http://datatest1.azurewebsites.net"],h=a,k=a,b=a,c=a,d=false;function f(){for(var e=i+"=",d=document.cookie.split(";"),c=0;c<d.length;++c){var b=d[c];while(b.charAt(0)==" ")b=b.substring(1);if(b.indexOf(e)==0)return b.substring(e.length,b.length)}return a}function m(b){var a=document.createElement("iframe");a.setAttribute("src",b);a.setAttribute("height","0");a.setAttribute("width","0");document.body.appendChild(a)}function p(){var a=document.createElement("script");a.setAttribute("type","text/javascript");a.text="OSF.OUtil.addEventListener(window, 'message', OSF.OneDriveOAuth.receiveToken)";document.getElementsByTagName("head")[0].appendChild(a)}function n(){c=window.setTimeout(function(){OSF.OneDriveOAuth.getAccessTokenFromCookie()==a&&b()},1e4);p();var d=j+"?client_id="+l+"&scope="+encodeURIComponent(s)+"&response_type=token&redirect_uri="+encodeURIComponent(r+"?host_callback_uri="+h);m(d)}function o(h){var g=a;try{g=JSON.parse('{"'+h.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(b,a){return b===""?a:decodeURIComponent(a)})}catch(j){b("We encountered a problem getting auth response from live.com.");return}var f=g.access_token;if(f===""||f==a){b(e);return}clearTimeout(c);var i=parseInt(g.expires_in);q(f,i);d=false;k(f)}function q(d,c){var a=new Date;a.setTime(a.getTime()+c*1e3);var b=i+"="+d+"; path=/; expires="+a.toUTCString();if(document.location.protocol.toLowerCase()=="https")b=b+";secure";document.cookie=b}return{setHostCallbackUri:function(a){h=a},getAccessTokenFromCookie:function(){return f()},getAccessToken:function(e,h){k=e;b=h;var g=f();if(g!=a){e(g);return}if(d==false){d=true;n()}else c=window.setTimeout(function(){if(OSF.OneDriveOAuth.getAccessTokenFromCookie()==a)b();else e()},1e4)},receiveToken:function(f){for(var d=0;d<g.length;++d)if(f.origin==g[d]){var c=f.data;if(c===""||c==a||c===undefined){b(e);return}o(c);break}}}}();Microsoft.Office.WebExtension.EventType={BindingSelectionChanged:"bindingSelectionChanged",BindingDataChanged:"bindingDataChanged"};var OsfRuntime;(function(b){var a=function(){var a=false;function b(i,f){var e="registeredActions",d=this,h=Function._validateParams(arguments,[{name:"contextActivationMgr",type:Object,mayBeNull:a},{name:e,type:Object,mayBeNull:a}]);if(h)throw h;d._contextActivationManager=i;d._registeredActions={};var c,b;for(var g in f){c=true;b=f[g];if(typeof b==="object")for(var j in b){c=d.validatePermissionInput(b[j]);if(!c)break}else c=d.validatePermissionInput(b);if(!c)throw OsfMsAjaxFactory.msAjaxError.argument(e);d._registeredActions[g]=b}}b.prototype.checkPermission=function(e,f,c){var b=this._registeredActions[f];if(!b)return a;if(typeof b==="object")if(c&&c.DdaMethod&&c.DdaMethod.DispatchId&&b[c.DdaMethod.DispatchId])b=b[c.DdaMethod.DispatchId];else return a;if(b===OSF.OsfControlPermission.Restricted)return true;var d=this._contextActivationManager._getManifestAndTargetByConversationId(e);return d&&d.manifest?d.manifest.hasPermission(b):a};b.prototype.validatePermissionInput=function(d){var b=a;for(var c in OSF.OsfControlPermission)if(OSF.OsfControlPermission[c]===d){b=true;break}return b};return b}();b.PolicyManager=a})(OsfRuntime||(OsfRuntime={}));OSF.PolicyManager=OsfRuntime.PolicyManager;var ContextActivationManagerBuilderBase=function(){function a(b,a){this._params={};this._addParams(b);this._addParams(a)}a.prototype.setHostInfo=function(){return this};a.prototype.setLocaleInfo=function(){return this};a.prototype.setUrlInfo=function(a){this._addParams(a);return this};a.prototype.setHostControlInfo=function(a){this._addParams(a);return this};a.prototype.setMiscellaneousActivationParameters=function(a){this._addParams(a);return this};a.prototype.setUserInfo=function(a){this._addParams(a);return this};a.prototype.construct=function(){return new OSF.ContextActivationManager(this._params)};a.prototype._addParams=function(a){for(var b in a)if(a.hasOwnProperty(b))this._params[b]=a[b]};return a}();OSF.ContextActivationManagerBuilder=ContextActivationManagerBuilderBase;Microsoft.Office.WebExtension.FULSSupported=true;OSF.DDA.ErrorCodeManager=OSF.DDA.ErrorCodeManager||{errorCodes:{ooeSuccess:0,ooeCoercionTypeNotSupported:1e3,ooeGetSelectionNotMatchDataType:1001,ooeCoercionTypeNotMatchBinding:1002,ooeSelectionNotSupportCoercionType:1004,ooeInvalidGetStartRowColumn:1005,ooeNonUniformPartialGetNotSupported:1006,ooeFileTypeNotSupported:1009,ooeCannotWriteToSelection:2001,ooeDataNotMatchBindingSize:2004,ooeInvalidSetStartRowColumn:2005,ooeInvalidDataFormat:2006,ooeInvalidGetRowColumnCounts:2010,ooeDataNotMatchCoercionType:2007,ooeDataNotMatchBindingType:2008,ooeBindingNotExist:3002,ooeInvalidSelectionForBindingType:3004,ooeNamedItemNotFound:3006,ooeMultipleNamedItemFound:3007,ooeInvalidNamedItemForBindingType:3008,ooeUnknownBindingType:3009,ooeInternalError:5001,ooeDocumentReadOnly:5002,ooeUnsupportedEnumeration:5007,ooeIndexOutOfRange:5008,ooeBrowserAPINotSupported:5009,ooeRequestTimeout:5011,ooeTooManyIncompleteRequests:5100,ooeRequestTokenUnavailable:5101,ooeCustomXmlNodeNotFound:6e3,ooeCustomXmlError:6100,ooeCustomXmlExceedQuota:6101,ooeCustomXmlOutOfDate:6102,ooeCannotNavTo:7001,ooeSpecifiedIdNotExist:7002,ooeNavOutOfBound:7004,ooeMemoryFileLimit:11e3,ooeNetworkProblemRetrieveFile:11001,ooeInvalidSliceSize:11002}};var OsfRuntime;(function(b){var a=function(){function a(h,b){var f="targetId",e="controlId",d="eventDispId",a=this;a.wnd=h;a.hostControl=b;var c=a,g=function(d,i){var e="Bindings";if(d.Error==0){var a=i.DdaMethod.DispatchId;if(a==OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod||a==OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod||a==OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod||a==OSF.DDA.MethodDispId.dispidGetBindingMethod||a==OSF.DDA.MethodDispId.dispidGetAllBindingsMethod){var f=c.serviceEndpoint._policyManager._registeredActions;for(var h in d[e]){var g=d[e][h].Name,b=OSF.DDA.getXdmEventName(g,Microsoft.Office.WebExtension.EventType.BindingSelectionChanged);if(!f[b]){c.serviceEndpoint.registerEventEx(b,c.registerEvent,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,c.unregisterEvent,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent);f[b]=OSF.OsfControlPermission.Restricted}}}}};a.executeMethod=function(c,a){b.invokeDdaMethod(c,function(b){g(b,c);a&&a(b)},null)};a.registerEvent=function(c,g,a){b.registerDdaEventAsync(a[d],a[e],a[f],c,g)};a.unregisterEvent=function(c,g,a){b.unregisterDdaEventAsync(a[d],a[e],a[f],c,g)}}return a}();b.BaseWACFacade=a;var c=function(b){__extends(a,b);function a(e,c){b.call(this,e,c);if(!c.getThrottleForCall)return;var d=this.executeMethod;this.executeMethod=function(f,b){var i=c.getThrottleForCall(f);if(!i){d(f,b);return}var e=i.tryAsyncRequest(function(a){d(f,function(c){a();b&&b(c)})});if(e!==0){var g=a._throttleStatusToErrorCodeMapping,j=g.hasOwnProperty(e.toString())?g[e]:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,h={};h[OSF.DDA.Marshaling.ApiResponseKeys.Error]=j;b&&b(h)}}}a._getThrottleStatusToErrorCodeMapping=function(){var a={};a[13]=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTokenUnavailable;a[12]=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests;return a};a._throttleStatusToErrorCodeMapping=a._getThrottleStatusToErrorCodeMapping();return a}(a);b.ThrottledWACFacade=c})(OsfRuntime||(OsfRuntime={}));var WordWACRuntime;(function(a){function b(r,c,e,i){var d=new OsfRuntime.ThrottledWACFacade(window,r);d.serviceEndpoint=e;var b={ContextActivationManager_getAppContextAsync:OSF.OsfControlPermission.Restricted,ContextActivationManager_notifyHost:OSF.OsfControlPermission.Restricted,ContextActivationManager_openWindowInHost:OSF.OsfControlPermission.Restricted,documentSelectionChanged:OSF.OsfControlPermission.ReadDocument,settingsChanged:OSF.OsfControlPermission.Restricted,appCommandInvoked:OSF.OsfControlPermission.Restricted,executeMethod:{}};b.executeMethod[OSF.DDA.MethodDispId.dispidAddDataPartMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataPartByIdMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataPartsByNamespaceMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataPartXmlMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataPartNodesMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidDeleteDataPartMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataNodeValueMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataNodeXmlMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataNodesMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidSetDataNodeValueMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidSetDataNodeXmlMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidAddDataNamespaceMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataUriByPrefixMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDataPrefixByUriMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetSelectedDataMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidSetSelectedDataMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidSaveSettingsMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidLoadSettingsMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetBindingMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetAllBindingsMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidReleaseBindingMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidGetBindingDataMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidSetBindingDataMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidNavigateToMethod]=OSF.OsfControlPermission.ReadDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod]=OSF.OsfControlPermission.Restricted;b.executeMethod[OSF.DDA.MethodDispId.dispidAddRowsMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidAddColumnsMethod]=OSF.OsfControlPermission.WriteDocument;b.executeMethod[OSF.DDA.MethodDispId.dispidClearAllRowsMethod]=OSF.OsfControlPermission.WriteDocument;var p=new OSF.PolicyManager(c,b);e.setPolicyManager(p);e.registerMethod("executeMethod",d.executeMethod,Microsoft.Office.Common.InvokeType.async,false);e.registerEventEx("documentSelectionChanged",d.registerEvent,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,d.unregisterEvent,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent);e.registerEventEx("bindingSelectionChanged",d.registerEvent,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,d.unregisterEvent,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent);e.registerEventEx("settingsChanged",d.registerEvent,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,d.unregisterEvent,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent);e.registerEventEx("appCommandInvoked",OfficeExt.AddinCommandsRuntimeManager.registerEvent,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,OfficeExt.AddinCommandsRuntimeManager.unregisterEvent,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent);var h={ContextActivationManager_onClickInsertOsfControl:OSF.OsfControlPermission.Restricted,ContextActivationManager_onClickInstallOsfControl:OSF.OsfControlPermission.Restricted,ContextActivationManager_onClickRefreshAddinCommands:OSF.OsfControlPermission.Restricted,ContextActivationManager_onClickCancelDialog:OSF.OsfControlPermission.Restricted,ContextActivationManager_getEntitlementsForInsertDialog:OSF.OsfControlPermission.Restricted,ContextActivationManager_invokeSignIn:OSF.OsfControlPermission.Restricted,ContextActivationManager_invokeWindowOpen:OSF.OsfControlPermission.Restricted,ContextActivationManager_removeAppForInsertDialog:OSF.OsfControlPermission.Restricted,ContextActivationManager_logTelemetryDataForInsertDialog:OSF.OsfControlPermission.Restricted,ContextActivationManager_getOmexData:OSF.OsfControlPermission.Restricted},k=new OSF.PolicyManager(c,h);i.setPolicyManager(k);c.getLocalizedImageFilePath=function(a){return this.getLocalizedImagesUrl()+a};c.getLocalizedCSSFilePath=function(a){return this.getLocalizedStylesUrl()+a};c._hostType=OSF.HostType.Word;c._hostPlatform=OSF.HostPlatform.Web;c._hostSpecificFileVersion=OSF.HostSpecificFileVersionMap.word.web;if(!c._spBaseUrl&&c._enableMyOrg&&c._docUrl){var f=c._docUrl.split("/");c._spBaseUrl=f.length>2?f[0]+"//"+f[2]:null}var l=[OSF.Capability.Document],o=[OSF.Capability.Document],q=[{name:OSF.RequirementSetNames.CompressedFile},{name:OSF.RequirementSetNames.DocumentEvents},{name:OSF.RequirementSetNames.File},{name:OSF.RequirementSetNames.ImageCoercion},{name:OSF.RequirementSetNames.MatrixCoercion},{name:OSF.RequirementSetNames.OoxmlCoercion},{name:OSF.RequirementSetNames.PdfFile},{name:OSF.RequirementSetNames.Selection},{name:OSF.RequirementSetNames.Settings},{name:OSF.RequirementSetNames.TableCoercion},{name:OSF.RequirementSetNames.TextCoercion},{name:OSF.RequirementSetNames.TextFile}],a=OSF.RequirementMethodNames,n=[a["Bindings.addFromNamedItemAsync"],a["Bindings.addFromSelectionAsync"],a["Binding.addHandlerAsync"],a["Binding.removeHandlerAsync"],a["Bindings.getAllAsync"],a["Bindings.getByIdAsync"],a["Bindings.releaseByIdAsync"],a["Binding.getDataAsync"],a["Binding.setDataAsync"],a["CustomXmlParts.addAync"],a["CustomXmlParts.getByIdAsync"],a["CustomXmlParts.getByNamespaceAsync"],a["CustomXmlPart.getXmlAsync"],a["CustomXmlPart.getNodesAsync"],a["CustomXmlPart.deleteAsync"],a["CustomXmlNode.getNodesAsync"],a["CustomXmlNode.getNodeValueAsync"],a["CustomXmlNode.getXmlAsync"],a["CustomXmlNode.setNodeValueAsync"],a["CustomXmlNode.setXmlAsync"],a["CustomXmlPrefixMappings.addNamespaceAsync"],a["CustomXmlPrefixMappings.getNamespaceAsync"],a["CustomXmlPrefixMappings.getPrefixAsync"],a["Document.addHandlerAsync"],a["Document.getFileAsync"],a["Document.getFilePropertiesAsync"],a["Document.getSelectedDataAsync"],a["Document.setSelectedDataAsync"],a["Document.removeHandlerAsync"],a["Document.goToByIdAsync"],a["File.getSliceAsync"],a["File.closeAsync"],a["MatrixBinding.getDataAsync"],a["MatrixBinding.setDataAsync"],a["Settings.get"],a["Settings.set"],a["Settings.saveAsync"],a["Settings.refreshAsync"],a["TableBinding.addColumnsAsync"],a["TableBinding.addRowsAsync"],a["TableBinding.deleteAllDataValuesAsync"],a["TableBinding.getDataAsync"],a["TableBinding.setDataAsync"],a["TextBinding.getDataAsync"],a["TextBinding.setDataAsync"]],j=[OSF.OsfControlTarget.TaskPane,OSF.OsfControlTarget.InContent],m=["WAW160"],g=new OSF.RequirementsChecker(l,o,{sets:q,methods:n},j,m);g.setFilteringEnabled(true);c.setRequirementsChecker(g)}a._setupFacade=b})(WordWACRuntime||(WordWACRuntime={}));OSF.AppSpecificSetup._setupFacade=WordWACRuntime._setupFacade;var OfficeExtension;(function(a){var b;(function(a){var b=function(){function a(){}a.httpMethodGet="GET";a.httpMethodPost="POST";a.httpMethodPatch="PATCH";a.httpMethodDelete="DELETE";a.processQuery="ProcessQuery";a.actionId="ActionId";a.actions="Actions";a.arrayTypeSufix="[]";a.code="Code";a.count="Count";a.error="Error";a.expand="Expand";a.getAsyncEnumeratorJsName="getAsyncEnumerator";a.getItemAt="GetItemAt";a.getObjectByReferenceId="_GetObjectByReferenceId";a.id="Id";a.idLowerCase="id";a.idPrivate="_Id";a.idPrivateLowerCase="_id";a.index="_Index";a.items="_Items";a.location="Location";a.message="Message";a.nullableTypeSuffix="?";a.onAccess="_OnAccess";a.referenceId="_ReferenceId";a.referenceIdLowerCase="_referenceid";a.results="Results";a.traceIds="TraceIds";a.value="Value";return a}();a.Constants=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(b){var a=function(){function a(){}a.accessDenied="AccessDenied";a.apiNotFound="ApiNotFound";a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.invalidOperation="InvalidOperation";a.invalidRequest="InvalidRequest";return a}();b.ErrorCodes=a})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(a){this.m_context=a;this.m_requestMessage=JSON.parse(this.m_context.request.body);this.m_objectPaths={};this.m_traceIds=[]}b.prototype.process=function(){var b=this;this.m_context.response.writer.startObjectScope();this.m_context.response.writer.writeName(a.Constants.results);this.m_context.response.writer.startArrayScope();for(var c=a.Utility.createPromiseFromResult(null),d=0;d<this.m_requestMessage.Actions.length;d++){var e=this.createProcessOneActionFunc(this.m_requestMessage.Actions[d]);c=c.then(e)}return c.then(function(){b.m_context.response.writer.endScope();b.writeTraceIds(b.m_context.response.writer);b.m_context.response.writer.endScope()})["catch"](function(a){b.processError(a)})};b.prototype.processError=function(e){this.m_context.response.reset();var c=this.m_context.response.writer,d=a.UtilityInternal.convertToRichApiException(e);c.startObjectScope();c.writeName(a.Constants.error);b.writeError(c,d);this.writeTraceIds(c);c.endScope()};b.writeError=function(b,c){b.startObjectScope();b.writeName(a.Constants.code);b.writeValue(c.code);b.writeName(a.Constants.message);b.writeValue(c.message);if(!a.Utility.isNullOrEmptyString(c.location)){b.writeName(a.Constants.location);b.writeValue(c.location)}b.endScope()};b.prototype.createProcessOneActionFunc=function(a){var b=this;return function(){return b.processOneAction(a)}};b.prototype.processOneAction=function(b){switch(b.ActionType){case 1:return this.processActionInstantiate(b);break;case 3:return this.processActionMethod(b);break;case 2:return this.processActionQuery(b);break;case 4:return this.processActionSetProperty(b);break;case 5:return this.procesActionTrace(b);break;default:throw a.Utility.createInvalidOperationException();}};b.prototype.processActionInstantiate=function(b){var c=this;return this.getObjectFromObjectPathId(b.ObjectPathId).then(function(e){var d=c.m_context.response.writer;d.startObjectScope();d.writeName(a.Constants.actionId);d.writeValue(b.Id);d.writeName(a.Constants.value);if(e)return c.writeObjectBasicIds(d,e).then(function(){d.endScope()});else{d.writeValueNull();d.endScope()}})};b.prototype.writeObjectBasicIds=function(c,e){var f=this,d=this.m_context.typeReg.getType(e.getTypeName());c.startObjectScope();var b=a.Utility.createPromiseFromResult(null);b=b.then(function(){var b=d.tryGetProperty(a.Constants.id);if(b)return a.UtilityInternal.invokePropertyGetAsync(f.m_context,d,b,e).then(function(b){c.writeName(a.Constants.id);c.writeValue(b)})});b=b.then(function(){var b=d.tryGetProperty(a.Constants.idPrivate);if(b)return a.UtilityInternal.invokePropertyGetAsync(f.m_context,d,b,e).then(function(b){c.writeName(a.Constants.idPrivate);c.writeValue(b)})});b=b.then(function(){var b=d.tryGetProperty(a.Constants.referenceId);if(b)return a.UtilityInternal.invokePropertyGetAsync(f.m_context,d,b,e).then(function(b){if(typeof b=="string"&&!a.Utility.isNullOrEmptyString(b)){c.writeName(a.Constants.referenceId);c.writeValue(b)}})});b=b.then(function(){c.endScope()});return b};b.prototype.processActionMethod=function(c){var d=this,b=this.m_context.response.writer;return this.getObjectFromObjectPathId(c.ObjectPathId).then(function(g){var f=d.m_context.typeReg.getType(g.getTypeName()),e=f.getMethod(c.Name);return d.resolveMethodArguments(c.ArgumentInfo,e.parameters).then(function(h){return a.UtilityInternal.invokeMethodAsync(d.m_context,f,e,g,h).then(function(g){b.startObjectScope();b.writeName(a.Constants.actionId);b.writeValue(c.Id);b.writeName(a.Constants.value);var f=d.m_context.typeReg.tryGetType(e.returnTypeName);a.UtilityInternal.writeValue(b,f,g);b.endScope()})})})};b.prototype.processActionQuery=function(c){var d=this,b=this.m_context.response.writer;return this.getObjectFromObjectPathId(c.ObjectPathId).then(function(e){b.startObjectScope();b.writeName(a.Constants.actionId);b.writeValue(c.Id);b.writeName(a.Constants.value);if(e){var g=d.m_context.typeReg.getType(e.getTypeName()),f=new a.RESTfulQuery;f.init(c.QueryInfo.Select,c.QueryInfo.Expand,c.QueryInfo.Top,c.QueryInfo.Skip);return d.writeQueryResult(b,f,e,g,-1).then(function(){b.endScope()})}else{b.writeValueNull();b.endScope()}})};b.prototype.processActionSetProperty=function(c){var b=this;return this.getObjectFromObjectPathId(c.ObjectPathId).then(function(f){var e=b.m_context.typeReg.getType(f.getTypeName()),d=e.getProperty(c.Name),g="HostName:"+b.m_context.host.hostName()+",AppId:"+b.m_context.host.appId()+",UsageDataType:"+2+",MethodName:"+d.apiName;a.Logger.SendULSTraceTag(g,369,100,17441856);return b.resolveMethodArguments(c.ArgumentInfo,d.parameters).then(function(c){return a.UtilityInternal.invokePropertySetAsync(b.m_context,e,d,f,c[0])})})};b.prototype.procesActionTrace=function(b){var c=this;return a.Utility.createPromiseFromResult(null).then(function(){c.m_traceIds.push(b.Id)})};b.prototype.getObjectFromObjectPathId=function(b){var c=this,a=this.m_objectPaths[b];if(a)return a.then(function(a){return c.invokeOnAccess(a)});a=this.createObjectFromObjectPath(this.m_requestMessage.ObjectPaths[b]);this.m_objectPaths[b]=a;return a.then(function(a){return c.invokeOnAccess(a)})};b.prototype.createObjectFromObjectPath=function(b){switch(b.ObjectPathType){case 1:return this.createObjectFromObjectPathGlobalObject(b);break;case 5:return this.createObjectFromObjectPathIndexer(b);break;case 3:return this.createObjectFromObjectPathMethod(b);break;case 2:return this.createObjectFromObjectPathNewObject(b);break;case 4:return this.createObjectFromObjectPathProperty(b);break;case 6:return this.createObjectFromObjectPathReferenceId(b)}throw a.Utility.createInvalidOperationException();};b.prototype.createObjectFromObjectPathGlobalObject=function(){var b=this.m_context.request.globalObject;return a.Utility.createPromiseFromResult(b)};b.prototype.createObjectFromObjectPathIndexer=function(b){var c=this;return this.getObjectFromObjectPathId(b.ParentObjectPathId).then(function(e){var d=c.m_context.typeReg.getType(e.getTypeName()),f=d.getIndexerMethod();return a.UtilityInternal.invokeMethodAsync(c.m_context,d,f,e,b.ArgumentInfo.Arguments)})};b.prototype.createObjectFromObjectPathMethod=function(c){var b=this;return this.getObjectFromObjectPathId(c.ParentObjectPathId).then(function(f){var e=b.m_context.typeReg.getType(f.getTypeName()),d=e.getMethod(c.Name),g="HostName:"+b.m_context.host.hostName()+",AppId:"+b.m_context.host.appId()+",UsageDataType:"+3+",MethodName:"+d.apiName;a.Logger.SendULSTraceTag(g,369,100,17441857);return b.resolveMethodArguments(c.ArgumentInfo,d.parameters).then(function(c){return a.UtilityInternal.invokeMethodAsync(b.m_context,e,d,f,c)})})};b.prototype.createObjectFromObjectPathNewObject=function(b){var c=b.Name,d=this.m_context.host.createInstance(c);return a.Utility.createPromiseFromResult(d)};b.prototype.createObjectFromObjectPathProperty=function(b){var c=this;return this.getObjectFromObjectPathId(b.ParentObjectPathId).then(function(e){var d=c.m_context.typeReg.getType(e.getTypeName()),f=d.getProperty(b.Name);return a.UtilityInternal.invokePropertyGetAsync(c.m_context,d,f,e)})};b.prototype.createObjectFromObjectPathReferenceId=function(e){var d=e.Name,b=this.m_context.typeReg.getType(this.m_context.request.globalObject.getTypeName()),c=b.getMethod(a.Constants.getObjectByReferenceId);return a.UtilityInternal.invokeMethodAsync(this.m_context,b,c,this.m_context.request.globalObject,[d])};b.prototype.resolveMethodArguments=function(e,f){for(var c=[],b=0;b<f.length&&b<e.Arguments.length;b++)c.push(e.Arguments[b]);for(var b=0;b<f.length&&b<c.length;b++){var g=this.m_context.typeReg.tryGetType(f[b].parameterTypeName);if(g&&g.isEnum&&typeof c[b]==="string")c[b]=g.getEnumFieldValue(c[b])}var h=a.Utility.createPromiseFromResult(null);if(e.ReferencedObjectPathIds){for(var d=[],b=0;b<c.length;b++)this.collectObjectPathIdInfos(d,[b],c[b],e.ReferencedObjectPathIds[b]);for(var b=0;b<d.length;b++){var i=this.createGetObjectFromObjectPathIdAndStoreParameterArgFunc(d[b].objectPathId,c,d[b].indices);h=h.then(i)}}return h.then(function(){return a.Utility.createPromiseFromResult(c)})};b.prototype.collectObjectPathIdInfos=function(g,d,e,a){if(Array.isArray(a)&&Array.isArray(e))for(var i=a,h=e,b=0;b<h.length;b++){for(var c=[],f=0;f<d.length;f++)c.push(d[f]);c.push(b);this.collectObjectPathIdInfos(g,c,h[b],i[b])}else a>0&&a===e&&g.push({objectPathId:a,indices:d})};b.prototype.createGetObjectFromObjectPathIdAndStoreParameterArgFunc=function(b,d,a){var c=this;return function(){return c.getObjectFromObjectPathId(b).then(function(e){for(var b=d,c=0;c<a.length-1;c++)b=b[a[c]];b[a[a.length-1]]=e})}};b.prototype.writeTraceIds=function(b){if(this.m_traceIds.length>0){b.writeName(a.Constants.traceIds);b.startArrayScope();for(var c=0;c<this.m_traceIds.length;c++)b.writeValue(this.m_traceIds[c]);b.endScope()}};b.prototype.writeQueryResult=function(c,e,g,d,i){var f=this;c.startObjectScope();if(i>=0){c.writeName(a.Constants.index);c.writeValue(i)}var b=a.Utility.createPromiseFromResult(null),h=d.tryGetItemAtMethod();if(d.supportEnumeration){b=b.then(function(){return f.writeScalarProperties(c,e,g,d,true)});b=b.then(function(){return f.writeChildItemsUsingEnumerator(c,e,g,d)})}else if(h){b=b.then(function(){return f.writeScalarProperties(c,e,g,d,true)});b=b.then(function(){return f.writeChildItemsUsingGetItemAt(c,e,g,d,h)})}else{b=b.then(function(){return f.writeScalarProperties(c,e,g,d,false)});b=b.then(function(){return f.writeNavigationProperties(c,e,d,g)})}return b.then(function(){c.endScope()})};b.prototype.writeScalarProperties=function(g,h,k,c,e){var d=a.Utility.createPromiseFromResult(null);for(var j in c.properties){var b=c.properties[j];if(b.propertyTypeCategory==1)if(e||h.shouldSelectProperty(b.lowerCaseName)){var f=this.m_context.typeReg.tryGetType(b.propertyTypeName),i=this.createWriteScalarOnePropertyFunc(g,c,b,k,f);d=d.then(i)}}return d};b.prototype.createWriteScalarOnePropertyFunc=function(c,e,b,g,d){var f=this;return function(){return a.UtilityInternal.invokePropertyGetAsync(f.m_context,e,b,g).then(function(e){c.writeName(b.name);a.UtilityInternal.writeValue(c,d,e)})}};b.prototype.writeNavigationProperties=function(h,e,c,k){var d=a.Utility.createPromiseFromResult(null);for(var j in c.properties){var b=c.properties[j];if(b.propertyTypeCategory==3)if(e.shouldExpandProperty(b.lowerCaseName)){var f=this.m_context.typeReg.getType(b.propertyTypeName),g=e.createQueryForProperty(b.lowerCaseName),i=this.createWiteNavigationOnePropertyFunc(h,c,b,k,g,f);d=d.then(i)}}return d};b.prototype.createWiteNavigationOnePropertyFunc=function(b,g,c,h,f,e){var d=this;return function(){return a.UtilityInternal.invokePropertyGetAsync(d.m_context,g,c,h).then(function(g){b.writeName(c.name);if(a.Utility.isNullOrUndefined(g))b.writeValueNull();else return d.writeQueryResult(b,f,g,e,-1)})}};b.prototype.writeChildItemsUsingEnumerator=function(b,c,h,g){var f=this,d=0;if(c.skip>0)d=c.skip;var e=0;if(c.top>0)e=c.top;return a.UtilityInternal.invokeGetAsyncEnumerator(this.m_context,g,h,d,e).then(function(l){var j=f.m_context.typeReg.getType(g.childItemTypeName),k=d,i=0;if(e>0)i=d+e;b.writeName(a.Constants.items);b.startArrayScope();var h=f.enumeratorLoop(l,k,i,function(d,e){if(a.Utility.isNullOrUndefined(d)){b.writeValueNull();return a.Utility.createPromiseFromResult(null)}else return f.writeQueryResult(b,c,d,j,e)});h=h.then(function(){b.endScope()});return h})};b.prototype.enumeratorLoop=function(d,b,c,e){var f=this;return c===0||b<c?d.moveNext().then(function(g){return g?e(d.get_current(),b).then(function(){return f.enumeratorLoop(d,b+1,c,e)}):a.Utility.createPromiseFromResult(null)}):a.Utility.createPromiseFromResult(null)};b.prototype.writeChildItemsUsingGetItemAt=function(b,c,h,d,e){var g=this,i=this.m_context.typeReg.getType(e.returnTypeName),f=d.tryGetProperty(a.Constants.count);return!f?a.Utility.createPromiseFromResult(null):a.UtilityInternal.invokePropertyGetAsync(this.m_context,d,f,h).then(function(j){var k=0;if(c.skip>0)k=c.skip;var f=j;if(c.top>0){f=k+c.top;if(f>j)f=j}b.writeName(a.Constants.items);b.startArrayScope();return g.getItemAtLoop(d,e,h,k,f,function(d,e){if(a.Utility.isNullOrUndefined(d)){b.writeValueNull();return a.Utility.createPromiseFromResult(null)}else return g.writeQueryResult(b,c,d,i,e)}).then(function(){b.endScope()})})};b.prototype.getItemAtLoop=function(d,c,g,b,f,e){var h=this;return b<f?a.UtilityInternal.invokeMethodAsync(this.m_context,d,c,g,[b]).then(function(a){return e(a,b)}).then(function(){return h.getItemAtLoop(d,c,g,b+1,f,e)}):a.Utility.createPromiseFromResult(null)};b.prototype.invokeOnAccess=function(b){if(b){var d=this.m_context.typeReg.getType(b.getTypeName()),c=d.tryGetMethod(a.Constants.onAccess);if(c)return a.UtilityInternal.invokeMethodAsync(this.m_context,d,c,b,[]).then(function(){return b})}return a.Utility.createPromiseFromResult(b)};return b}();a.JsComRequestProcessor=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b;(function(a){a[a.object=0]="object";a[a.array=1]="array"})(b||(b={}));var c=function(){function b(){this.m_scopes=[]}b.prototype.startScope=function(c){var b;if(c==0)b={scopeType:c,object:{}};else b={scopeType:c,object:[]};if(this.m_scopes.length>0){var d=b.object;if(this.m_scopes[this.m_scopes.length-1].scopeType==1)this.m_scopes[this.m_scopes.length-1].object.push(d);else{if(a.Utility.isNullOrEmptyString(this.m_pendingPropertyName))throw a.Utility.createInvalidOperationException();this.m_scopes[this.m_scopes.length-1].object[this.m_pendingPropertyName]=d;this.m_pendingPropertyName=null}}this.m_scopes.push(b);if(a.Utility.isNullOrUndefined(this.m_firstScope))this.m_firstScope=b};b.prototype.endScope=function(){this.m_scopes.splice(this.m_scopes.length-1)};b.prototype.startArrayScope=function(){this.startScope(1)};b.prototype.startObjectScope=function(){this.startScope(0)};b.prototype.writeName=function(b){if(this.m_scopes.length<1||this.m_scopes[this.m_scopes.length-1].scopeType!=0)throw a.Utility.createInvalidOperationException();if(!a.Utility.isNullOrEmptyString(this.m_pendingPropertyName))throw a.Utility.createInvalidOperationException();this.m_pendingPropertyName=b};b.prototype.writeValue=function(b){if(a.Utility.isNullOrUndefined(b))b=null;if(this.m_scopes.length<1)throw a.Utility.createInvalidOperationException();if(this.m_scopes[this.m_scopes.length-1].scopeType==1)this.m_scopes[this.m_scopes.length-1].object.push(b);else{if(a.Utility.isNullOrEmptyString(this.m_pendingPropertyName))throw a.Utility.createInvalidOperationException();this.m_scopes[this.m_scopes.length-1].object[this.m_pendingPropertyName]=b;this.m_pendingPropertyName=null}};b.prototype.writeValueNull=function(){this.writeValue(null)};b.prototype.getJsonString=function(){return this.m_firstScope?JSON.stringify(this.m_firstScope.object):""};return b}();a.JsonWriter=c})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(d,b,g,e,c,f){this.m_name=b;this.m_dispatchId=g;this.m_returnTypeName=e;this.m_returnTypeCategory=c;this.m_operationType=f;this.m_parameters=[];this.m_apiName=a.UtilityInternal.getApiName(d,b)}Object.defineProperty(b.prototype,"name",{"get":function(){return this.m_name},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"returnTypeCategory",{"get":function(){return this.m_returnTypeCategory},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"returnTypeName",{"get":function(){return this.m_returnTypeName},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"dispatchId",{"get":function(){return this.m_dispatchId},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"methodOperationType",{"get":function(){return this.m_operationType},enumerable:true,configurable:true});b.prototype.addParameter=function(e,d,c){var b=new a.ParameterInformation(e,d,c);this.m_parameters.push(b);return b};Object.defineProperty(b.prototype,"parameters",{"get":function(){return this.m_parameters},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"apiName",{"get":function(){return this.m_apiName},enumerable:true,configurable:true});return b}();a.MethodInformation=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){(function(a){a[a.defaultValue=0]="defaultValue";a[a.read=1]="read"})(a.OperationType||(a.OperationType={}));var b=a.OperationType})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(b){var a=function(){function a(c,b,a){this.m_name=c;this.m_typeName=b;this.m_typeCategory=a}Object.defineProperty(a.prototype,"name",{"get":function(){return this.m_name},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"parameterTypeName",{"get":function(){return this.m_typeName},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"parameterTypeCategory",{"get":function(){return this.m_typeCategory},enumerable:true,configurable:true});return a}();b.ParameterInformation=a})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(e,b,f,d,c,g){this.m_name=b;this.m_dispatchId=f;this.m_propertyTypeName=d;this.m_propertyTypeCategory=c;this.m_isReadonly=g;this.m_parameters=[];this.m_parameters.push(new a.ParameterInformation("value",d,c));this.m_apiName=a.UtilityInternal.getApiName(e,b);this.m_lowerCaseName=b.toLowerCase()}Object.defineProperty(b.prototype,"name",{"get":function(){return this.m_name},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"lowerCaseName",{"get":function(){return this.m_lowerCaseName},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"propertyTypeCategory",{"get":function(){return this.m_propertyTypeCategory},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"propertyTypeName",{"get":function(){return this.m_propertyTypeName},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"dispatchId",{"get":function(){return this.m_dispatchId},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"parameters",{"get":function(){return this.m_parameters},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"apiName",{"get":function(){return this.m_apiName},enumerable:true,configurable:true});return b}();a.PropertyInformation=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(b){var a=function(){function a(){}a.accessDenied="AccessDenied";a.apiNotFound="ApiNotFound";a.invalidArgument="InvalidArgument";a.invalidOperation="InvalidOperation";a.invalidRequest="InvalidRequest";return a}();b.ResourceStrings=a})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(){this.m_select=new a.SelectExpandQuery;this.m_expand=new a.SelectExpandQuery;this.m_top=0;this.m_skip=0}Object.defineProperty(b.prototype,"top",{"get":function(){return this.m_top},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"skip",{"get":function(){return this.m_skip},enumerable:true,configurable:true});b.prototype.init=function(b,a,d,c){this.m_select.init(true,b);this.m_expand.init(false,a);this.m_top=d;this.m_skip=c};b.prototype.shouldSelectProperty=function(b){return this.m_select.isEmpty||this.m_select.hasWildcard?true:this.m_select.properties[b]?true:this.m_expand.properties[b]?true:b==a.Constants.idLowerCase||b==a.Constants.idPrivateLowerCase||b==a.Constants.referenceIdLowerCase?true:false};b.prototype.shouldExpandProperty=function(a){return this.shouldSelectProperty(a)&&(this.m_expand.properties[a]||this.m_select.properties[a])?true:false};b.prototype.createQueryForProperty=function(a){var c=new b;if(this.m_select.properties[a])c.m_select=this.m_select.properties[a];if(this.m_expand.properties[a])c.m_expand=this.m_expand.properties[a];return c};return b}();a.RESTfulQuery=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(){}b.executeRichApiRequest=function(h,e,g,j){if(!b.s_typeReg){var d=new a.TypeRegistration;e&&e(d);d.addAuxEnumTypes();b.s_typeReg=d}var c=new a.RichApiRequestContext(b.s_typeReg,h);c.request.init(j,g);var f=a.Utility.createPromiseFromResult(null);if(c.request.requestType==0){var i=new a.JsComRequestProcessor(c);f=i.process()}return f.then(function(){return a.Utility.createPromiseFromResult(c.response.toArrayData())})};return b}();a.RichApi=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var __extends=this.__extends||function(b,a){for(var c in a)if(a.hasOwnProperty(c))b[c]=a[c];function d(){this.constructor=b}d.prototype=a.prototype;b.prototype=new d},OfficeExtension;(function(a){var b;(function(b){var a=function(b){__extends(a,b);function a(e,a,c,d){b.call(this,a);this.name="OfficeExtension.WacRuntime.RichApiException";this.code=e;this.message=a;this.httpStatusCode=c;this.location=d}return a}(Error);b.RichApiException=a})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){(function(a){a[a.csom=0]="csom";a[a.rest=1]="rest"})(a.RichApiRequestType||(a.RichApiRequestType={}));var c=a.RichApiRequestType,b=function(){function b(){}b.prototype.init=function(c,e){this.m_globalObject=e;this.m_method=c[1];var b=c[2],d=b.indexOf("?");if(d>=0){this.m_path=b.substr(0,d);this.m_query=b.substr(d+1)}else{this.m_path=b;this.m_query=""}if(this.m_method==a.Constants.httpMethodPost&&this.m_path==a.Constants.processQuery)this.m_requestType=0;else this.m_requestType=1;this.m_body=c[4];this.m_requestFlags=c[6]};Object.defineProperty(b.prototype,"requestType",{"get":function(){return this.m_requestType},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"method",{"get":function(){return this.m_method},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"path",{"get":function(){return this.m_path},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"query",{"get":function(){return this.m_query},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"body",{"get":function(){return this.m_body},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"requestFlags",{"get":function(){return this.m_requestFlags},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"globalObject",{"get":function(){return this.m_globalObject},enumerable:true,configurable:true});return b}();a.RichApiRequest=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var c=function(){function b(){}b.prototype.hostName=function(){return""};b.prototype.appId=function(){return""};b.prototype.createInstance=function(){throw a.Utility.createInvalidRequestException();};return b}(),b=function(){function b(d,b){this.m_typeReg=d;this.m_request=new a.RichApiRequest;this.m_response=new a.RichApiResponse;if(!b)b=new c;this.m_richApiHost=b}Object.defineProperty(b.prototype,"request",{"get":function(){return this.m_request},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"response",{"get":function(){return this.m_response},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"typeReg",{"get":function(){return this.m_typeReg},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"host",{"get":function(){return this.m_richApiHost},enumerable:true,configurable:true});return b}();a.RichApiRequestContext=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){(function(a){a[a.None=0]="None";a[a.WriteOperation=1]="WriteOperation"})(a.RichApiRequestFlags||(a.RichApiRequestFlags={}));var b=a.RichApiRequestFlags})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(){this.m_writer=new a.JsonWriter}b.prototype.reset=function(){this.m_writer=new a.JsonWriter};Object.defineProperty(b.prototype,"writer",{"get":function(){return this.m_writer},enumerable:true,configurable:true});b.prototype.toArrayData=function(){var a=[];a[0]=200;a[1]=null;a[2]=this.m_writer.getJsonString();return a};return b}();a.RichApiResponse=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(){this.m_hasWildcard=false;this.m_properties={}}Object.defineProperty(b.prototype,"hasWildcard",{"get":function(){return this.m_hasWildcard},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isEmpty",{"get":function(){var a=true;for(var b in this.m_properties){a=false;break}return a},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"properties",{"get":function(){return this.m_properties},enumerable:true,configurable:true});b.prototype.init=function(j,f){if(f)for(var g=0;g<f.length;g++)for(var d=this,i=f[g].split("/"),h=0;h<i.length;h++){var c=i[h];c=c.trim().toLowerCase();if(c=="*"){if(!j)throw a.Utility.createInvalidRequestException();d.m_hasWildcard=true}else{var e=d.m_properties[c];if(!e){e=new b;d.m_properties[c]=e}d=e}}};return b}();a.SelectExpandQuery=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function a(){}return a}();a.Settings=b;a.settings=new b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){(function(a){a[a.msoulscat_Wac_WordEditorExtension=369]="msoulscat_Wac_WordEditorExtension"})(a.ULSCat||(a.ULSCat={}));var e=a.ULSCat;(function(a){a[a.error=10]="error";a[a.warning=15]="warning";a[a.info=50]="info";a[a.verbose=100]="verbose";a[a.spam=200]="spam"})(a.ULSTraceLevel||(a.ULSTraceLevel={}));var c=a.ULSTraceLevel;(function(a){a[a.objectCreate=0]="objectCreate";a[a.objectPropertyLoad=1]="objectPropertyLoad";a[a.objectPropertySet=2]="objectPropertySet";a[a.objectMethodCall=3]="objectMethodCall"})(a.UsageDataType||(a.UsageDataType={}));var d=a.UsageDataType,b=function(){function a(){}a.SendULSTraceTag=function(d,a,b,c){if(!Microsoft.Office.WebExtension.FULSSupported)return;Diag.UULS.trace(c,a,b,d)};return a}();a.Logger=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){(function(a){a[a.none=0]="none";a[a.primitive=1]="primitive";a[a.valueObject=2]="valueObject";a[a.classObject=3]="classObject"})(a.TypeCategory||(a.TypeCategory={}));var b=a.TypeCategory})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(d,a,b,c){this.m_name=d;this.m_interfaceId=a;this.m_classId=b;this.m_properties={};this.m_methods={};this.m_enumFields={};this.m_enumFieldLowerCaseNameToValue={};this.m_enumFieldValueToName={};this.m_isEnum=c}Object.defineProperty(b.prototype,"name",{"get":function(){return this.m_name},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isEnum",{"get":function(){return this.m_isEnum},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isNullableEnum",{"get":function(){return this.m_isNullableEnum},"set":function(a){this.m_isNullableEnum=a},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"classId",{"get":function(){return this.m_classId},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"interfaceId",{"get":function(){return this.m_interfaceId},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"properties",{"get":function(){return this.m_properties},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"supportEnumeration",{"get":function(){return this.m_supportEnumeration},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"childItemTypeName",{"get":function(){return this.m_childItemTypeName},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"enumFields",{"get":function(){return this.m_enumFields},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"arrayItemTypeInfo",{"get":function(){return this.m_arrayItemTypeInfo},"set":function(a){this.m_arrayItemTypeInfo=a},enumerable:true,configurable:true});b.prototype.addProperty=function(b,f,d,e,g){var c=new a.PropertyInformation(this.m_name,b,f,d,e,g);this.m_properties[b.toLowerCase()]=c;return c};b.prototype.addMethod=function(c,g,e,d,f){var b=new a.MethodInformation(this.m_name,c,g,e,d,f);this.m_methods[c.toLowerCase()]=b;return b};b.prototype.addIndexerMethod=function(d,c,a){return this.addMethod(b.s_indexerMethodName,d,c,a,1,null)};b.prototype.addEnumField=function(b,a){this.m_enumFields[b]=a;this.m_enumFieldLowerCaseNameToValue[b.toLowerCase()]=a;this.m_enumFieldValueToName[a]=b};b.prototype.setRESTfulOperationMethodNames=function(a,b){this.m_createItemOperationName=a;this.m_deleteOperationName=b};b.prototype.setCollectionInfo=function(b,a){this.m_childItemTypeName=b;this.m_supportEnumeration=a};b.prototype.tryGetIndexerMethod=function(){return this.tryGetMethod(b.s_indexerMethodName)};b.prototype.getIndexerMethod=function(){return this.getMethod(b.s_indexerMethodName)};b.prototype.getMethod=function(b){b=b.toLowerCase();var c=this.m_methods[b];if(!c)throw a.Utility.createApiNotFoundException(b);return c};b.prototype.tryGetMethod=function(a){a=a.toLowerCase();return this.m_methods[a]};b.prototype.getProperty=function(b){b=b.toLowerCase();var c=this.m_properties[b];if(!c)throw a.Utility.createApiNotFoundException(b);return c};b.prototype.tryGetProperty=function(a){a=a.toLowerCase();return this.m_properties[a]};b.prototype.getEnumFieldValue=function(c){var b=this.m_enumFieldLowerCaseNameToValue[c.toLowerCase()];if(a.Utility.isUndefined(b))throw a.Utility.createInvalidRequestException();return b};b.prototype.getEnumFieldName=function(a){return this.m_enumFieldValueToName[a]};b.prototype.tryGetItemAtMethod=function(){return this.tryGetMethod(a.Constants.getItemAt)};b.s_indexerMethodName=".indexer";return b}();a.TypeInformation=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(){this.m_types={}}b.prototype.getType=function(c){var b=this.m_types[c];if(!b)throw a.Utility.createInvalidRequestException();return b};b.prototype.tryGetType=function(a){return this.m_types[a]};b.prototype.addType=function(b,d,e){var c=new a.TypeInformation(b,d,e,false);this.m_types[b]=c;return c};b.prototype.addEnumType=function(b){var c=new a.TypeInformation(b,null,null,true);this.m_types[b]=c;return c};b.prototype.addAuxEnumTypes=function(){var e=[];for(var l in this.m_types){var b=this.m_types[l];b.isEnum&&!b.isNullableEnum&&e.push(b)}for(var g=0;g<e.length;g++){var b=e[g],d=b.name;d=d+a.Constants.nullableTypeSuffix;var j=this.addEnumType(d);j.isNullableEnum=true;for(var i in b.enumFields)j.addEnumField(i,b.enumFields[i]);var c=b.name+a.Constants.arrayTypeSufix,f=new a.TypeInformation(c,null,null,false);f.arrayItemTypeInfo=b;this.m_types[c]=f;var h=c+a.Constants.arrayTypeSufix,k=new a.TypeInformation(h,null,null,false);k.arrayItemTypeInfo=f;this.m_types[h]=k}};return b}();a.TypeRegistration=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(b){var c=function(){function c(){}c.isNullOrUndefined=function(a){return a===null?true:typeof a==="undefined"?true:false};c.isUndefined=function(a){return typeof a==="undefined"?true:false};c.isNullOrEmptyString=function(a){return a===null?true:typeof a==="undefined"?true:a.length==0?true:false};c.trim=function(a){return a.replace(new RegExp("^\\s+|\\s+$","g"),"")};c.caseInsensitiveCompareString=function(b,a){return c.isNullOrUndefined(b)?c.isNullOrUndefined(a):c.isNullOrUndefined(a)?false:b.toUpperCase()==a.toUpperCase()};c.createInvalidArgumentException=function(a){return new b.RichApiException(b.ErrorCodes.invalidArgument,c.getLocalizedString(b.ResourceStrings.invalidArgument,a))};c.createInvalidOperationException=function(){return new b.RichApiException(b.ErrorCodes.invalidOperation,c.getLocalizedString(b.ResourceStrings.invalidOperation))};c.createInvalidRequestException=function(){return new b.RichApiException(b.ErrorCodes.invalidRequest,c.getLocalizedString(b.ResourceStrings.invalidRequest))};c.createApiNotFoundException=function(a){var d=a.toString();return new b.RichApiException(b.ErrorCodes.apiNotFound,c.getLocalizedString(b.ResourceStrings.apiNotFound,d))};c.createRichApiException=function(e,d,a,c){return new b.RichApiException(e,d,a,c)};c.getLocalizedString=function(d,e){var a=d;if(b.settings.getLocalizedStringFunc)a=b.settings.getLocalizedStringFunc(d);if(!c.isNullOrEmptyString(e))a=a.replace("{0}",e);return a};c.createPromise=function(b){a._EnsurePromise();return new a.Promise(b)};c.createPromiseFromResult=function(b){a._EnsurePromise();return new a.Promise(function(a){a(b)})};c.getAndValidateArgument=function(d,b,a){return c.validateArgument(d[b],a)};c.validateArgument=function(e,a){var b=e;if(c.isNullOrUndefined(b))if(a===c.s_expectedTypeInt)b=0;else if(a===c.s_expectedTypeNumber)b=0;else if(a===c.s_expectedTypeBoolean)b=false;else b=null;else if(a!==c.s_expectedTypeAny)if(a===c.s_expectedTypeInt||a===c.s_expectedTypeIntNullable){if(!c.isInt(b))throw c.createInvalidArgumentException("value");}else if(a===c.s_expectedTypeBoolean||a===c.s_expectedTypeBooleanNullable){if(typeof b!==c.s_scriptTypeBoolean)throw c.createInvalidArgumentException("value");}else if(a===c.s_expectedTypeNumber||a===c.s_expectedTypeNumberNullable){if(typeof b!==c.s_scriptTypeNumber)throw c.createInvalidArgumentException("value");}else if(a===c.s_expectedTypeString){if(typeof b!==c.s_scriptTypeString)throw c.createInvalidArgumentException("value");}else if(a.indexOf(c.s_expectedTypeArrayPrefix)===0){if(!Array.isArray(b))throw c.createInvalidArgumentException("value");}else if(a.indexOf(".")>0){var d=c.getTypeFromTypeName(a);if(!(b instanceof d))throw c.createInvalidArgumentException("value");}return b};c.getTypeFromTypeName=function(e){var b=e.split(".");if(b.length==0)throw c.createInvalidOperationException();for(var a=window,d=0;d<b.length;d++)if(a)a=a[b[d]];else throw c.createInvalidArgumentException("typeName");if(a&&typeof a===c.s_scriptTypeFunction)return a;else throw c.createInvalidArgumentException("typeName");};c.isInt=function(a){return Number(a)===a&&a%1===0};c.s_expectedTypeInt="int";c.s_expectedTypeNumber="number";c.s_expectedTypeBoolean="boolean";c.s_expectedTypeString="string";c.s_expectedTypeAny="any";c.s_expectedTypeArrayPrefix="Array<";c.s_expectedTypeNullableSuffix="?";c.s_expectedTypeIntNullable="int?";c.s_expectedTypeBooleanNullable="boolean?";c.s_expectedTypeNumberNullable="number?";c.s_scriptTypeNumber="number";c.s_scriptTypeBoolean="boolean";c.s_scriptTypeString="string";c.s_scriptTypeFunction="function";return c}();b.Utility=c})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){var b;(function(a){var b=function(){function b(){}b.isUpper=function(a){return a==a.toUpperCase()};b.getApiName=function(c,e){var a=e;if(a==".indexer")a="GetItem";a=b.toCamelLowerCase(a);var d=c.lastIndexOf(".");return d>0?c.substr(d+1)+"."+a:c+"."+a};b.toCamelLowerCase=function(c){var a=0;while(a<c.length&&b.isUpper(c.charAt(a)))a++;if(a<c.length){var d=c.substr(0,a);d=d.toLowerCase();return d+c.substr(a)}else return c.toLowerCase()};b.invokePropertyGet=function(f,g,a,e){var d=a.dispatchId;try{return e.invokePropertyGet(d)}catch(h){var c=b.convertToRichApiException(h);c.location=a.apiName;throw c;}};b.invokePropertyGetAsync=function(f,g,c,e){var d=c.dispatchId;return a.Utility.createPromiseFromResult(null).then(function(){return e.invokePropertyGetAsync(d)})["catch"](function(d){var a=b.convertToRichApiException(d);a.location=c.apiName;throw a;})};b.checkPropertyWritePermission=function(b,c){if((b.request.requestFlags&1)===0){var d=a.Utility.getLocalizedString(a.ResourceStrings.accessDenied);throw a.Utility.createRichApiException(a.ErrorCodes.accessDenied,d,403,c.apiName);}};b.checkMethodPermission=function(c,b){if(b.methodOperationType!=1&&(c.request.requestFlags&1)===0){var d=a.Utility.getLocalizedString(a.ResourceStrings.accessDenied);throw a.Utility.createRichApiException(a.ErrorCodes.accessDenied,d,403,b.apiName);}};b.invokePropertySet=function(d,j,c,i,g){var f=c.dispatchId;try{b.checkPropertyWritePermission(d,c);i.invokePropertySet(f,[g])}catch(k){var e=b.convertToRichApiException(k);e.location=c.apiName;var h="HostName:"+d.host.hostName()+",AppId:"+d.host.appId()+",PropertySetError:"+c.apiName;a.Logger.SendULSTraceTag(h,369,100,17441858);throw e;}};b.invokePropertySetAsync=function(d,h,c,g,f){var e=c.dispatchId;return a.Utility.createPromiseFromResult(null).then(function(){b.checkPropertyWritePermission(d,c);return g.invokePropertySetAsync(e,[f])})["catch"](function(f){var e=b.convertToRichApiException(f);e.location=c.apiName;var g="HostName:"+d.host.hostName()+",AppId:"+d.host.appId()+",PropertySetAsyncError:"+c.apiName;a.Logger.SendULSTraceTag(g,369,100,17441859);throw e;})};b.invokeMethod=function(d,j,c,i,g){var f=c.dispatchId;try{b.checkMethodPermission(d,c);return i.invokeMethod(f,g)}catch(k){var e=b.convertToRichApiException(k);e.location=c.apiName;var h="HostName:"+d.host.hostName()+",AppId:"+d.host.appId()+",MethodCallError:"+c.apiName;a.Logger.SendULSTraceTag(h,369,100,17441860);throw e;}};b.invokeMethodAsync=function(d,h,c,g,f){var e=c.dispatchId;return a.Utility.createPromiseFromResult(null).then(function(){b.checkMethodPermission(d,c);return g.invokeMethodAsync(e,f)})["catch"](function(f){var e=b.convertToRichApiException(f);e.location=c.apiName;var g="HostName:"+d.host.hostName()+",AppId:"+d.host.appId()+",MethodCallAsyncError:"+c.apiName;a.Logger.SendULSTraceTag(g,369,100,17441861);throw e;})};b.invokeGetAsyncEnumerator=function(d,e,b,a,c){return b.getAsyncEnumerator(a,c)};b.writeValue=function(e,d,c){if(a.Utility.isNullOrUndefined(c)){e.writeValueNull();return}if(d)c=b.convertEnumValueToStringIfApplicable(d,c);e.writeValue(c)};b.convertEnumValueToStringIfApplicable=function(d,a){if(d.isEnum&&typeof a=="number")return d.getEnumFieldName(a);if(Array.isArray(a)){var f=d.arrayItemTypeInfo;if(f)for(var e=a,c=0;c<e.length;c++)e[c]=b.convertEnumValueToStringIfApplicable(f,e[c])}return a};b.convertToRichApiException=function(b){var d;if(b instanceof a.RichApiException)d=b;else{var c;if(b.message)c=b.message;else c=b.toString();d=new a.RichApiException(a.ErrorCodes.generalException,c)}return d};return b}();a.UtilityInternal=b})(b=a.WacRuntime||(a.WacRuntime={}))})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){(function(a){a[a.CustomData=0]="CustomData";a[a.Method=1]="Method";a[a.PathAndQuery=2]="PathAndQuery";a[a.Headers=3]="Headers";a[a.Body=4]="Body";a[a.AppPermission=5]="AppPermission";a[a.RequestFlags=6]="RequestFlags"})(a.RichApiRequestMessageIndex||(a.RichApiRequestMessageIndex={}));var c=a.RichApiRequestMessageIndex;(function(a){a[a.StatusCode=0]="StatusCode";a[a.Headers=1]="Headers";a[a.Body=2]="Body"})(a.RichApiResponseMessageIndex||(a.RichApiResponseMessageIndex={}));var b=a.RichApiResponseMessageIndex;(function(a){a[a.Instantiate=1]="Instantiate";a[a.Query=2]="Query";a[a.Method=3]="Method";a[a.SetProperty=4]="SetProperty";a[a.Trace=5]="Trace"})(a.ActionType||(a.ActionType={}));var e=a.ActionType;(function(a){a[a.GlobalObject=1]="GlobalObject";a[a.NewObject=2]="NewObject";a[a.Method=3]="Method";a[a.Property=4]="Property";a[a.Indexer=5]="Indexer";a[a.ReferenceId=6]="ReferenceId"})(a.ObjectPathType||(a.ObjectPathType={}));var d=a.ObjectPathType})(OfficeExtension||(OfficeExtension={}));var OfficeExtension;(function(a){function c(){!a.Promise&&b.Init()}a._EnsurePromise=c;var b;(function(b){function c(){(function(){"use strict";function Q(a){return typeof a==="function"||typeof a==="object"&&a!==null}function u(a){return typeof a==="function"}function T(a){return typeof a==="object"&&a!==null}var v;if(!Array.isArray)v=function(a){return Object.prototype.toString.call(a)==="[object Array]"};else v=Array.isArray;var D=v,o=0,mb={}.toString,C,s,h=function(a,b){n[o]=a;n[o+1]=b;o+=2;if(o===2)if(s)s(m);else j()};function cb(a){s=a}function kb(a){h=a}var A=typeof window!=="undefined"?window:undefined,z=A||{},w=z.MutationObserver||z.WebKitMutationObserver,lb=typeof process!=="undefined"&&{}.toString.call(process)==="[object process]",jb=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function eb(){var b=process.nextTick,a=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);if(Array.isArray(a)&&a[1]==="0"&&a[2]==="10")b=setImmediate;return function(){b(m)}}function Y(){return function(){C(m)}}function L(){var a=0,c=new w(m),b=document.createTextNode("");c.observe(b,{characterData:true});return function(){b.data=a=++a%2}}function O(){var a=new MessageChannel;a.port1.onmessage=m;return function(){a.port2.postMessage(0)}}function B(){return function(){setTimeout(m,1)}}var n=new Array(1e3);function m(){for(var a=0;a<o;a+=2){var b=n[a],c=n[a+1];b(c);n[a]=undefined;n[a+1]=undefined}o=0}function X(){try{var b=require,a=b("vertx");C=a.runOnLoop||a.runOnContext;return Y()}catch(c){return B()}}var j;if(lb)j=eb();else if(w)j=L();else if(jb)j=O();else if(A===undefined&&typeof require==="function")j=X();else j=B();function l(){}var g=void 0,i=1,f=2,p=new y;function J(){return new TypeError("You cannot resolve a promise with itself")}function K(){return new TypeError("A promises callback cannot return that same promise.")}function ab(a){try{return a.then}catch(b){p.error=b;return p}}function bb(d,c,a,b){try{d.call(c,a,b)}catch(e){return e}}function E(c,a,e){h(function(f){var c=false,g=bb(e,a,function(b){if(c)return;c=true;if(a!==b)k(f,b);else d(f,b)},function(a){if(c)return;c=true;b(f,a)},"Settle: "+(f._label||" unknown promise"));if(!c&&g){c=true;b(f,g)}},c)}function G(c,a){if(a._state===i)d(c,a._result);else if(a._state===f)b(c,a._result);else q(a,undefined,function(a){k(c,a)},function(a){b(c,a)})}function F(c,a){if(a.constructor===c.constructor)G(c,a);else{var e=ab(a);if(e===p)b(c,p.error);else if(e===undefined)d(c,a);else if(u(e))E(c,a,e);else d(c,a)}}function k(a,c){if(a===c)b(a,J());else if(Q(c))F(a,c);else d(a,c)}function I(a){a._onerror&&a._onerror(a._result);t(a)}function d(a,b){if(a._state!==g)return;a._result=b;a._state=i;a._subscribers.length!==0&&h(t,a)}function b(a,b){if(a._state!==g)return;a._state=f;a._result=b;h(I,a)}function q(c,g,d,e){var a=c._subscribers,b=a.length;c._onerror=null;a[b]=g;a[b+i]=d;a[b+f]=e;b===0&&c._state&&h(t,c)}function t(b){var a=b._subscribers,f=b._state;if(a.length===0)return;for(var e,d,g=b._result,c=0;c<a.length;c+=3){e=a[c];d=a[c+f];if(e)x(f,e,d,g);else d(g)}b._subscribers.length=0}function y(){this.error=null}var r=new y;function W(a,b){try{return a(b)}catch(c){r.error=c;return r}}function x(l,c,j,m){var h=u(j),a,o,e,n;if(h){a=W(j,m);if(a===r){n=true;o=a.error;a=null}else e=true;if(c===a){b(c,K());return}}else{a=m;e=true}if(c._state===g)if(h&&e)k(c,a);else if(n)b(c,o);else if(l===i)d(c,a);else l===f&&b(c,a)}function H(a,c){try{c(function(b){k(a,b)},function(c){b(a,c)})}catch(d){b(a,d)}}function e(e,c){var a=this;a._instanceConstructor=e;a.promise=new e(l);if(a._validateInput(c)){a._input=c;a.length=c.length;a._remaining=c.length;a._init();if(a.length===0)d(a.promise,a._result);else{a.length=a.length||0;a._enumerate();a._remaining===0&&d(a.promise,a._result)}}else b(a.promise,a._validationError())}e.prototype._validateInput=function(a){return D(a)};e.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")};e.prototype._init=function(){this._result=new Array(this.length)};var Z=e;e.prototype._enumerate=function(){for(var a=this,d=a.length,c=a.promise,e=a._input,b=0;c._state===g&&b<d;b++)a._eachEntry(e[b],b)};e.prototype._eachEntry=function(a,c){var b=this,d=b._instanceConstructor;if(T(a))if(a.constructor===d&&a._state!==g){a._onerror=null;b._settledAt(a._state,c,a._result)}else b._willSettleAt(d.resolve(a),c);else{b._remaining--;b._result[c]=a}};e.prototype._settledAt=function(h,i,e){var a=this,c=a.promise;if(c._state===g){a._remaining--;if(h===f)b(c,e);else a._result[i]=e}a._remaining===0&&d(c,a._result)};e.prototype._willSettleAt=function(c,b){var a=this;q(c,undefined,function(c){a._settledAt(i,b,c)},function(c){a._settledAt(f,b,c)})};function ib(a){return new Z(this,a).promise}var V=ib;function db(c){var e=this,a=new e(l);if(!D(c)){b(a,new TypeError("You must pass an array to race."));return a}var i=c.length;function f(b){k(a,b)}function h(c){b(a,c)}for(var d=0;a._state===g&&d<i;d++)q(e.resolve(c[d]),undefined,f,h);return a}var U=db;function N(a){var b=this;if(a&&typeof a==="object"&&a.constructor===b)return a;var c=new b(l);k(c,a);return c}var M=N;function S(d){var c=this,a=new c(l);b(a,d);return a}var P=S,gb=0;function R(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function fb(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}var hb=c;function c(a){this._id=gb++;this._state=undefined;this._result=undefined;this._subscribers=[];if(l!==a){!u(a)&&R();!(this instanceof c)&&fb();H(this,a)}}c.all=V;c.race=U;c.resolve=M;c.reject=P;c._setScheduler=cb;c._setAsap=kb;c._asap=h;c.prototype={constructor:c,then:function(d,e){var b=this,a=b._state;if(a===i&&!d||a===f&&!e)return this;var c=new this.constructor(l),j=b._result;if(a){var g=arguments[a-1];h(function(){x(a,c,g,j)})}else q(b,c,d,e);return c},"catch":function(a){return this.then(null,a)}};a.Promise=hb}).call(this)}b.Init=c})(b||(b={}))})(OfficeExtension||(OfficeExtension={}));Type.registerNamespace("WEAFO");WEAFO.$cS=function(){};WEAFO.$cS.registerInterface("WEAFO.$cS");WEAFO.$Sv=function(){};WEAFO.$Sv.registerInterface("WEAFO.$Sv");WEAFO.$FF=function(){};WEAFO.$FF.registerInterface("WEAFO.$FF");WEAFO.$ML=function(){};WEAFO.$ML.registerInterface("WEAFO.$ML");WEAFO.$Ih=function(){};WEAFO.$Ih.registerInterface("WEAFO.$Ih");WEAFO.$bN=function(){};WEAFO.$bN.registerInterface("WEAFO.$bN");WEAFO.$4E=function(){};WEAFO.$KW=function(a,b,c,d,e,f){this.$$d_$5yj=Function.createDelegate(this,this.$5yj);this.$$d_$5H9=Function.createDelegate(this,this.$5H9);this.$K=a;this.$24=b;this.$6p=c;this.$2N=d;this.$2Vf=f;this.$2g=e;this.$IH=new($$sc.$3j.$$(B4Ac.$4Y));this.$IH.set_$5("3587754593",1);this.$IH.set_$5("1745735045",1)};WEAFO.$KW.prototype={$K:null,$24:null,$2Vf:null,$IH:null,$2g:null,$6p:null,$2N:null,$3wf:4,get_$3JX:function(){return this.$2Vf.get_$Q()},$3F:function(){this.$K.$ZT(3587754593,2,this.$$d_$5H9,4);this.$K.$ZT(1745735045,2,this.$$d_$5H9,4);this.$K.$1W(1110196777,2,this.$$d_$5yj,4)},$5yj:function(p,q,n,r,o){if(n===1)return 32;var a=o;if(!a||a.length!==this.$3wf)return 8;var h=a[0],d=a[1],i=a[2],k=a[3],j=this.$2g.$59(15,0);j.$1o(k);if(this.$K.$2u(1172238996,2)!==32)return 8;var e=0;if(d){for(var b=0;b<d.length;++b){var l=h[e];d[b]&&this.$3wl(l[b],d[b].toString())}e++}for(var f=0;f<i.length;++f){for(var g=i[f],m=h[e],c=0;c<g.length;++c)g[c]&&this.$3wl(m[c],g[c].toString());e++}j.dispose();return 32},$3wl:function(c,d){var a=Box4.$E.$13(c);!a.$1J(1)&&this.$6p.$OP(a,true,null);var b=Box4.$S.$4j(a,false);this.$2N.$6u(Box4.$P.$40(b,0),d)},$5H9:function(f,a,g,h,i,b){var d=this.$IH.get_$5(a.toString()),c=this,e=this.get_$3JX().$x(f,a,d,new($$sc.$x.$$(B4Ac.$Rp))(function(){return c.$3NT(a,b)}),g,h,i,b);return e},$3NT:function(a,b){if(a===3587754593)return new B4Ac.$dJ(b,this.$24);if(a===1745735045)return new B4Ac.$ZH(b,this.$24);Diag.$2.$m(6348963,341,false,"Could not find an import strategy for action {0}",a);return null}};WEAFO.$W6=function(){WEAFO.$W6.initializeBase(this)};WEAFO.$W6.prototype={get_$5gU:function(){return"PreinstalledAppsData_Word"},get_$28F:function(){return"WAC_Word"},$t9:function(a){Common.App.AppsForOfficeCommon.$rT.prototype.$t9.call(this,a);var b=Common.$0.$o.$1A("WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled"),d=Common.$0.$o.$1A("WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled"),c=Common.$0.$o.$1A("WordEditorContentControlReadIsEnabled"),e=Common.$0.$o.$1A("WordEditorContentControlWriteIsEnabled"),f=this;a.$e(WEAFO.$CF).$1p(WEAFO.$bN).$p().$n(function(){return new WEAFO.$CF(WEAFO.$CF.$4IY,Box4.App.$K5,Box4.$1T.get_$4(),Box4.App.get_$X().$1L.get_$2v(),new DiagUse.$OL,Common.$0.$o,a.$J(WEAFO.$G0))});if(c&&b){var g=this;a.$e(WEAFO.$PK).$1p(WEAFO.$Ih).$p().$n(function(){return new WEAFO.$PK(a.$J(WEAFO.$Oq),a.$J(WordEditor.$Gh),Box4.$h.get_$4(),new Box4.$5X,new($$sc.$x.$$(Box4.$Ag))(function(){return Box4.App.get_$X().$1L.get_$2v().get_$3V()}),a.$J(WEAFO.$Jz),a.$J(WordEditor.$8y))})}var h=this;a.$e(WEAFO.$Jz).$p().$n(function(){return new WEAFO.$Jz(Common.$0.get_$r(),Box4.$h.get_$4())});var i=this;a.$e(WEAFO.$QD).$1p(WEAFO.$FF).$p().$n(function(){return new WEAFO.$QD});var j=this;a.$e(WEAFO.$QF).$1p(WEAFO.$ML).$p().$n(function(){return new WEAFO.$QF(new($$sc.$x.$$(Number))(function(){return Common.$0.$o.$5L("WordEditorCustomXmlMaximumDataCollectionNumber",1024)}))});var k=this;a.$e(WEAFO.$TO).$1p(WordEditor.$Mk).$p().$n(function(){return new WEAFO.$TO(Common.$0.get_$1Y().get_$CN(),function(){return Box4.$1T.get_$4().$2Dg(Box4.App.get_$X().$1L.get_$2v())},Box4.App.$K5,a.$2S(WordEditor.$D5),WordEditor.$3g.$ng)});var l=this;a.$e(WEAFO.$TN).$1p(WordEditor.$Mj).$p().$n(function(){return new WEAFO.$TN(a.$J(WordEditor.$Mk))});var m=this;a.$e(WEAFO.$KB).$1p(WEAFO.$cS).$p().$n(function(){return new WEAFO.$KB(Box4.$h.get_$4(),Common.$0.get_$r(),a.$J(WEAFO.$CF),a.$J(Common.App.AppsForOfficeCommon.$MC),a.$J(WordEditor.$Mk),a.$J(WordEditor.$Mj),new Box4.$5X,c&&b?a.$J(WEAFO.$Ih):null,a.$J(WordEditor.Extension.Document),a.$J(WEAFO.$Jz),new Box4.$4A)});var n=this;a.$e(WEAFO.$Us).$1p(WEAFO.$Sv).$p().$n(function(){return new WEAFO.$Us});var o=this;a.$e(WEAFO.$9d).$1p(Common.App.AppsForOfficeCommon.$ao).$p().$n(function(){return new WEAFO.$9d(a.$J(WEAFO.$KB),Common.$0.$o,a.$J(WEAFO.$Sv))});var p=this;a.$e(WEAFO.$G1).$1p(Common.App.AppsForOfficeCommon.$am).$p().$n(function(){return WEAFO.$G1.$4Zk(a.$J(WEAFO.$G0),a.$J(WEAFO.$KB))});var q=this;a.$e(WEAFO.$Ho).$1p(Common.App.AppsForOfficeCommon.$ap).$p().$n(function(){return new WEAFO.$Ho(new OsfRuntime.Throttling.ThrottleFactory,Common.$0.$o)});var r=this;a.$e(Common.App.AppsForOfficeCommon.$I0).$1p(Common.App.AppsForOfficeCommon.$an).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$I0(a.$J(WEAFO.$9d),a.$J(WEAFO.$G1),a.$J(WEAFO.$Ho))});var s=this;a.$e(WEAFO.$G0).$1p(Common.App.AppsForOfficeCommon.$Ii).$p().$n(function(){return new WEAFO.$G0(a.$7a(Common.App.AppsForOfficeCommon.$R8),a.$J(Common.App.AppsForOfficeCommon.$I3),a.$7a(Common.App.AppsForOfficeCommon.$MI),Common.$b.$4(),Common.$59.get_$4(),Common.$0.get_$r(),Common.$0.$o,a.$J(Common.App.AppsForOfficeCommon.$M6),null,Box4.TaskPaneManager.$3k.get_$4())});var t=this;a.$e(WEAFO.$KW).$p().$n(function(){return new WEAFO.$KW(Common.$0.get_$r(),Common.$X.get_$4(),a.$J(Box4.$7j),a.$J(Box4.$4r),new Box4.$5X,a.$7a(B4Ac.$MG))});var u=this;a.$e(WEAFO.$Ux).$1p(Common.App.AppsForOfficeCommon.$R9).$p().$n(function(){return new WEAFO.$Ux(new Box4.$5X,new WordEditor.$W2)});var v=this;a.$e(WEAFO.$Oq).$1p(Common.App.AppsForOfficeCommon.$MC).$p().$n(function(){return new WEAFO.$Oq(Box4.$1P.get_$4(),new Box4.$5X,new WordEditor.$W1,a.$J(Common.App.AppsForOfficeCommon.$R9),Common.$0.$o)});var w=this;a.$e(Common.App.AppsForOfficeCommon.$I5).$1p(Common.App.AppsForOfficeCommon.$R8).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$I5(a.$J(Common.App.AppsForOfficeCommon.$Ii),a.$J(Common.App.AppsForOfficeCommon.$MC))});var x=this;a.$e(Common.App.AppsForOfficeCommon.$M0).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$M0(a.$J(Common.App.AppsForOfficeCommon.$I4),a.$J(WEAFO.$G0))});a.$e(WEAFO.$Oo).$1p(Common.App.AppsForOfficeCommon.$ak).$p();var y=this;a.$e(Common.App.AppsForOfficeCommon.$RS).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$Xe(a.$J(WEAFO.$Oo))});var z=this;a.$e(OSF.ContextActivationManagerBuilder).$n(function(){return a.$J(Common.App.AppsForOfficeCommon.$RS).$x()});var A=this;a.$e(Common.App.AppsForOfficeCommon.$RT).$p().$n(function(){return new Common.App.AppsForOfficeCommon.$Xf(a.$J(OSF.ContextActivationManagerBuilder),a.$J(WEAFO.$Oo),a.$J(Common.App.AppsForOfficeCommon.$M0))});var B=this;a.$e(Common.App.AppsForOfficeCommon.$MI).$n(function(){return a.$J(Common.App.AppsForOfficeCommon.$RT).$x()});var C=this;a.$e(WEAFO.$Op).$p().$n(function(){return new WEAFO.$Op(a.$J(Common.App.AppsForOfficeCommon.$I5),a.$J(Common.App.AppsForOfficeCommon.$I3),a.$J(Common.App.AppsForOfficeCommon.$I0),a.$J(Common.App.AppsForOfficeCommon.$I4),a.$J(WEAFO.$G0),e&&d?a.$J(WEAFO.$Ih):null,Common.$0.$o,a.$J(WEAFO.$KW))});var D=this;this.$U.$e(WordEditor.$PJ).$1p(WordEditor.$CJ).$p().$n(function(){return new WordEditor.$PJ})},get_$5j:function(){return"WordEditor.AppsForOffice"},$7Y:function(){this.$16s=this.$U.$J(WEAFO.$Op);var a=this;Common.$0.$o.$UQ(function(){a.$16s.$8F();if(Common.$0.$o.$1A("WordEditorAppsForOfficeContextMenuIsEnabled")){var c=a.$U.$J(WEUI.$2H),b=a.$16s.$16t;c.$5lJ(b.$$d_$4Jd||(b.$$d_$4Jd=Function.createDelegate(b,b.$4Jd)))}});var b=this.$U.$J(Common.App.AppsForOfficeCommon.$I5),d=this;WordEditor.$5x.$5KV(function(){b.$8F()});var c=this.$U.$J(WordEditor.$Gh);c.$4Io(this.$U.$J(WordEditor.$CJ))}};WEAFO.$qL=function(){};WEAFO.$qL.$5Sr=function(){WordEditor.App.get_$43Q()&&Common.App.$f.get_$4().$3M(new WEAFO.$W6)};WEAFO.$Oo=function(){};WEAFO.$Oo.prototype={$3Yd:function(){return new Common.App.AppsForOfficeCommon.$ag(OSF.AppName.WordWebApp,"16",OSF.ClientMode.ReadWrite,null)},$3ZM:function(){var a=Common.$H.$5Y(Common.$0.$6J);return new Common.App.AppsForOfficeCommon.$cv(a?a.$JM:null,Common.$49.get_$1Br().name,Common.$0.$6J.toString())},$58z:function(){return{omexForceAnonymous:false,allowExternalMarketplace:Common.$0.$o.$1A("AppsForOfficeAllowExternalMarketplace"),enableMyApps:Common.$0.$o.$1A("InsertAgaveEnableMyAppsForHost"),enableMyOrg:Common.$0.$o.$1A("InsertAgaveMyOrgEnabledForHost"),enableDevCatalog:Common.$0.$o.$1A("AppsForOfficeDevCatalogIsEnabled"),enableOneDriveCatalog:Common.$0.$o.$1A("AppsForOfficeOneDriveCatalogIsEnabled"),enableUploadFileDevCatalog:Common.$0.$o.$1A("AddInCommandsIsEnabled")}},$5Dl:function(){var a=Common.$1F.$pa+Common.$1F.$28S,b=Common.$1F.$pa+Common.$1F.$1h8,c=Common.$1F.$pa+Common.$1F.$28R,d=Common.$1F.$2j7(Common.$1F.$1h8);return new Common.App.AppsForOfficeCommon.$im(Common.$0.$o.$5G.AppsForOfficeOmexBaseUrl,Common.$0.$o.$5G.AppsForOfficeDevCatalogUrl,Common.$0.$o.$5G.OneDriveCatalogBaseApiUrl,null,Common.$0.$11a,null,a,b,c,d)},$5Dp:function(){return new Common.App.AppsForOfficeCommon.$ip(Common.$9.$110(Common.$0.$wh))}};WEAFO.$Ux=function(a,b){this.dispose=this.$d;this.$2g=a;this.$2Uj=b};WEAFO.$Ux.prototype={$2g:null,$2Uj:null,$3WS:function(f){var a={},b=this.$2sr(f);if(!b){Diag.$2.$9(7143683,344,15,"propertyIterator is null");return a}if(!b.$1J(21))return a;do{var c=b.get_$A(),d=c.$s(String,Box4.AppProperties.$1.$2k7),e=c.$s(String,Box4.AppProperties.$1.$2k8);a[d]=e}while(b.$4h(21));return a},$5rH:function(f,b){if(!b){Diag.$2.$9(7143684,344,15,"property is null, assum it means empty setting");b={}}var i={},a=this.$2sr(f);if(!a){Diag.$2.$9(7143685,344,15,"propertyIterator is null");return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}while(a.$1J(21))a.$4v();a=this.$2sr(f);var c=b;for(var d in c){var e={key:d,value:c[d]},g=this.$4hX(e.key,e.value),h=Common.$1O.$x();a.$1Au(g,21,new Common.$C(h,1))}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$d:function(){},$4hX:function(b,c){var a=this.$2Uj.$eQ();a.$M(Box4.AppProperties.$1.$2k7,b);a.$M(Box4.AppProperties.$1.$2k8,c);return a},$2sr:function(c){if(!Box4.$Rj.isInstanceOfType(c)){Diag.$2.$9(7143686,344,15,"appObj is not a graph node");return null}var b=c,a=null;if(b){a=new Box4.$E;a.$h(b)}return a}};WEAFO.$KB=function(c,d,e,f,g,h,i,j,a,k,b){WEAFO.$KB.initializeBase(this,[c,d,f]);this.$2Qy=e;this.$zS=g;this.$zR=h;this.$JY=k;this.$2g=i;this.$AK=j;this.$62=a;this.$1y=b};WEAFO.$KB.prototype={$zS:null,$zR:null,$JY:null,$AK:null,$2g:null,$62:null,$1y:null,$2Qy:null,get_$12e:function(){return this.$2Qy},$5Bv:function(a){a.val={};return this.$JY.$3as(OSF.DDA.Marshaling.CoercionTypeKeys.Table,a)},$5Bs:function(e){var a={},b,c,d=(c=this.$JY.$3as(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix,b={val:a}),a=b.val,c);e.val=a.rows;return d},$2sx:function(c,a,b){b.val={};return a.$80?this.$AK.$eJ(c,a,b):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError},$5EU:function(l,m,n,o,p){var e=[],a=null,c=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(!this.$AK)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;c=this.$AK.$2tL(l,p,e);if(c===OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;if(c!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return c;a=e[0];var b=a.$D;if(!Box4.$A.$3D(b))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var d=this.$1y.$DI(b);if(!d.$1X(23))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(!Box4.$R.$1B8(d.get_$6U())){var h=new Box4.$1A(7,0,null);h.$1o(d.get_$6U());Box4.$R.$1pr(d.get_$6U());h.$d()}var i=n.get_$2o(),g=b.$4N(i).get_$4E();if(!g)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;g.scrollIntoView();if(m===OSF.DDA.Marshaling.SelectionMode.Selected){var j=new Box4.$4S(e,true);this.$Dx.$2s(j,null,false,false)}else{var f=a.$j;if(a.$1t===17)f=0;else if(a.$1t===19)f=Box4.$A.$2Y(b);var k=Box4.$L.$4I(b,f);this.$Dx.$2s(k,null,false,false)}o.$2MH();window.focus();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$52h:function(b,c){c.val=[];if(b.$80){var d=Box4.$E.$13(this.$Tn.$eR()),a=Box4.$1v.$Fq(d);while(a.$2j())if(!Box4.$A.$3D(a.get_$A()))continue;return this.$AK.$3WG(b,c)}else return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError},$45e:function(c,d,e,b){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,f=this.$2g.$59(15,0);f.$1o(this.$Tn.$eR());if(e===OSF.DDA.Marshaling.BindingType.Text.toString())a=this.$32Z(c,d,WEAFO.$4E.$2b,b);else if(e===OSF.DDA.Marshaling.BindingType.Matrix.toString())a=this.$32Z(c,d,WEAFO.$4E.$1Th,b);else if(e===OSF.DDA.Marshaling.BindingType.Table.toString())a=this.$32Z(c,d,WEAFO.$4E.$8J,b);else{b.val=null;a=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType}f.dispose();return a},$45d:function(c,d,e,f,b){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,g=this.$2g.$59(15,0);g.$1o(this.$Tn.$eR());if(f===OSF.DDA.Marshaling.BindingType.Text.toString())a=this.$32Y(c,d,WEAFO.$4E.$2b,e,b);else if(f===OSF.DDA.Marshaling.BindingType.Matrix.toString())a=this.$32Y(c,d,WEAFO.$4E.$1Th,e,b);else if(f===OSF.DDA.Marshaling.BindingType.Table.toString())a=this.$32Y(c,d,WEAFO.$4E.$8J,e,b);else{b.val=null;a=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType}g.dispose();return a},$3Wd:function(a,b,c){return this.$AK.$3Wd(a,b,c)},$53O:function(b,c,d,a){a.val=null;return this.$AK.$3Wb(b,c,true,d,a)},$53L:function(f,g,h,d){d.val=null;var a=null,b,c,e=(c=this.$AK.$3Wb(f,g,false,h,b={val:a}),a=b.val,c);d.val=a.rows;return e},$3vB:function(c,d,e){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,b=this.$2g.$59(15,0);b.$1o(this.$Tn.$eR());a=this.$AK.$3vB(c,d,e);b.dispose();return a},$53N:function(e,f,a){var b=[],d=this.$AK.$2tL(f,e,b);if(d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){a(d,null);return}if(b.length<=0){a(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null);return}var g=this,c=this;this.$zR.$1Rs(b,function(b){a(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,b)},function(b){var d=c.$2I4(b);c.$2HY(b,3);a(d,null)})},$5vX:function(f,g,d,h,e){var a=d.TableHeaders,b=d.TableRows;if((!a||!a.length)&&(!b||!b.length)){e(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"table");return}var c=this.$2g.$59(15,0);c.$1o(this.$Tn.$eR());this.$AK.$3vA(f,g,true,a,b,h,e);c.dispose()},$5vV:function(d,e,a,f,c){if(!a||!a.length){c(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"matrix");return}var b=this.$2g.$59(15,0);b.$1o(this.$Tn.$eR());this.$AK.$3vA(d,e,false,null,a,f,c);b.dispose()},$5mL:function(b,a,c){if(a.$80){c(this.$5hq(b,a));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError},$3NF:function(d,b,c){if(b.$80){var a=this.$2g.$59(15,0);a.$1o(this.$Tn.$eR());this.$AK.$3NF(d,b,c);a.dispose()}else c(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},$3FB:function(e,d,a,b){if(!a||!a.length)b(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam);else if(d.$80){var c=this.$2g.$59(15,0);c.$1o(this.$Tn.$eR());this.$AK.$3FB(e,d,a,b);c.dispose()}else b(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},$3Ec:function(f,e,a,b,g,c){if((!a||!a.length)&&(!b||!b.length))c(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam);else if(e.$80){var d=this.$2g.$59(15,0);d.$1o(this.$Tn.$eR());this.$AK.$3Ec(f,e,a,b,g,c);d.dispose()}else c(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},$2HY:function(a,b){switch(b){case 0:if(WordEditor.$DA.$2GB(a))Diag.$2.$9(8159503,341,50,"SetSelectedOoxml failed with error code: {0}",a);else Diag.$2.$9(7611806,341,10,"SetSelectedOoxml failed with error code: {0}",a);break;case 1:if(WordEditor.$DA.$2GB(a))Diag.$2.$9(8159504,341,50,"GetSelectedOoxml failed with error code: {0}",a);else Diag.$2.$9(7151686,341,10,"GetSelectedOoxml failed with error code: {0}",a);break;case 2:if(WordEditor.$DA.$2GB(a))Diag.$2.$9(17385219,341,50,"SetBindingOoxml failed with error code: {0}",a);else Diag.$2.$9(17385220,341,10,"SetBindingOoxml failed with error code: {0}",a);break;case 3:if(WordEditor.$DA.$2GB(a))Diag.$2.$9(17331611,341,50,"GetBindingOoxml failed with error code: {0}",a);else Diag.$2.$9(17331612,341,10,"GetBindingOoxml failed with error code: {0}",a)}},$5Bt:function(b){var c=this,a=this;this.$zS.$3Zu(this.$Dx.get_$23(),function(a){b(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,a)},function(c){var d=a.$2I4(c);a.$2HY(c,1);b(d,null)})},$5yJ:function(a,b){this.$2KP(1745735045,a,b)},$5yM:function(c,b){var d=this,a=this;this.$zS.$3w8(this.$Dx.get_$23(),c,function(){b(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},function(c){var d=a.$2I4(c);a.$2HY(c,0);b(d)})},$5yN:function(d,c){var a=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders],b=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows];if((!a||!a.length)&&(!b||!b.length)){c(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType);return}else if(a&&a.length>1){Diag.$2.$9(8458368,344,15,"SetSelectedTable failed for app want to add multi-row header table");c(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType);return}a=a[0];this.$JY.$3wU(a,b,c)},$5yL:function(a,b){if(!a||!a.length){b(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType);return}this.$JY.$3wU(null,a,b)},$5yK:function(d,l,m,f){var a=document.createElement("img");d=d.trim();var h=new Box4.$QK,b=h.$1Dp(l/72,0),c=h.$1Dp(m/72,0),e="",g=this,j=function(){var h=a.width,i=a.height;if(i&&h){if(b&&!c||!b&&c){var j=h/i;if(!b)b=c*j;else c=b/j}e=g.$3La(d,b,c);g.$2KP(1745735045,e,f)}else f(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)},n=this,k=function(){f(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)},i=false;i=a.onload!==undefined&&a.onerror!==undefined;if(i){a.onload=j;a.onerror=k;a.src=String.format("data:image/png;base64,{0}",d)}else{e=this.$3La(d,b,c);this.$2KP(1745735045,e,f)}},$3La:function(c,a,b){return String.format("<img src='data:image/png;base64,{0}'{1}{2} />",c,!a?"":String.format(" width='{0}px'",a),!b?"":String.format(" height='{0}px'",b))},$5vW:function(h,i,j,a){var c=null,e,f,b=(f=this.$AK.$52z(i,h,e={val:c}),c=e.val,f);if(b!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){a(b);return}if(c.$PD!==WEAFO.$4E.$2b){a(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);return}var d=[];b=this.$AK.$2tL(i,h,d);if(b!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){a(b);return}if(d.length<=0){a(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}var k=this,g=this;this.$zR.$36T(d,j,function(){a(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},function(b){var c=g.$2I4(b);g.$2HY(b,2);a(c)})},$5hq:function(c,d){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,b=this.$2g.$59(15,0);b.$1o(this.$Tn.$eR());a=this.$AK.$3qZ(c,d);a===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.$AK.$3qu(d,c);b.dispose();return a},$32Z:function(h,b,e,c){c.val=null;if(!b||b==="")return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(e===WEAFO.$4E.$1Th||e===WEAFO.$4E.$8J)if(!this.$JY.$5OV())return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType;var d=0,f,g,a=(g=this.$AK.$4fN(f={val:d}),d=f.val,g);if(a!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){c.val=null;return a}var i=new Common.App.AppsForOfficeCommon.$AL(b,e,this.$AK.$2sy(d));a=this.$AK.$3EW(h,i);if(a!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){c.val=null;return a}return this.$AK.$eJ(b,h,c)},$32Y:function(k,c,l,o,m){m.val=null;if(!c||c==="")return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var b=0,f,g,a=(g=this.$AK.$54Z(o,f={val:b}),b=f.val,g);if(a!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return a;if(l!==WEAFO.$4E.$2b){var d=null,e=null,h,i,j;a=(j=this.$AK.$54b(b,h={val:d},i={val:e}),d=h.val,e=i.val,j);if(a!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return a;if(!this.$JY.$Ed(d,e))return OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType}var n=new Common.App.AppsForOfficeCommon.$AL(c,l,this.$AK.$2sy(b));a=this.$AK.$3EW(k,n);return a!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?a:this.$AK.$eJ(c,k,m)},$2I4:function(a){switch(a){case 1:return OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;case 7:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidDataFormat;default:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}},$66G:function(a){a.val=null;if(Box4.App.$l4){a.val=Box4.App.$l4;return true}return false},$4rO:function(i,a,b){var d=this.$Tn.$eR();this.$62.$1b.$KN.$WU(d);this.$62.$1b.$4k=a;var e=new WordEditor.Extension.$fj(a),f=WordEditor.Extension.TypeRegister.registerTypes,g=this.$62,c=this,h=OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(e,f,g,i).then(function(a){c.$62.$1b.$KN.$nW();if(!a){Diag.$2.$9(9204820,344,10,"The rich api executor call failed.");b(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null}b(a,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null});h["catch"](function(){this.$62.$1b.$KN.EndTransaction();callback(null,AppsForOfficeCode.InternalError)})},$5rZ:function(b,c){return this.$Tn.$3t8(b,c)},$5Rb:function(b){return this.$Tn.$3pp(b)}};WEAFO.$Ho=function(a,b){this.$1fF=a;this.$3H=b};WEAFO.$Ho.$5OF=function(c){var d=c.DdaMethod.DispatchId,a=null,e,f,b=d===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod&&(f=Common.App.AppsForOfficeCommon.$Cm.$2OH(c,e={val:a},OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType),a=e.val,f),g,h;b=b||d===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod&&(h=Common.App.AppsForOfficeCommon.$Cm.$2OH(c,g={val:a},OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType),a=g.val,h);var i,j;b=b||d===OSF.DDA.MethodDispId.dispidGetBindingDataMethod&&(j=Common.App.AppsForOfficeCommon.$Cm.$2OH(c,i={val:a},OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType),a=i.val,j);var k,l;b=b||d===OSF.DDA.MethodDispId.dispidSetBindingDataMethod&&(l=Common.App.AppsForOfficeCommon.$Cm.$2OH(c,k={val:a},OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType),a=k.val,l);b=b&&!!a&&a===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml;return b};WEAFO.$Ho.prototype={$1fF:null,$3H:null,$5DR:function(a){return WEAFO.$Ho.$5OF(a)?this.get_$5dG():null},$21l:null,get_$5dG:function(){if(!this.$21l){var a=[],b=this.$3H.$5L("WordEditorAppsForOfficeSelectionOoxmlMaxIncompleteRequests",1),c=this.$3H.$5L("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",3e4);a.push(this.$1fF.createIncompleteRequestThrottle(b,c));var d=this.$3H.$5L("WordEditorAppsForOfficeSelectionOoxmlTokenBucketCapacity",3),e=this.$3H.$5L("WordEditorAppsForOfficeSelectionOoxmlTokenBucketFillingIntervalMilliSec",2e3);a.push(this.$1fF.createTokenBucketThrottle(d,e));this.$21l=this.$1fF.createChainedThrottle(a)}return this.$21l}};WEAFO.$Op=function(a,b,c,d,e,f,g,h){WEAFO.$Op.initializeBase(this,[a,b,c,d,e]);this.$2UV=h;this.$AK=f;this.$3H=g};WEAFO.$Op.prototype={$2UV:null,$AK:null,$3H:null,$8F:function(){Common.App.AppsForOfficeCommon.$rR.prototype.$8F.call(this);this.$2UV.$3F();this.$AK&&this.$AK.$5lN()}};WEAFO.$Oq=function(a,b,c,d,e){this.dispose=this.$d;this.$2g=b;this.$2Ui=c;this.$1ec=d;this.$h9=a;this.$ys=e.$1A("WordEditorAppsForOfficePersistenceIsEnabled");this.$1Is=new($$sc.$F.$$(Common.App.AppsForOfficeCommon.$El))};WEAFO.$Oq.prototype={$1Is:null,$2g:null,$2Ui:null,$1ec:null,$h9:null,$ys:false,$8F:function(){this.$ys&&this.$5k0()},$eR:function(){var b=WordEditor.App.get_$7S().$1L.get_$2v(),a=Box4.$E.$13(b);Box4.$1P.get_$4().$XM(a);return a.get_$A()},$2ss:function(d){var a=null;if(!this.$ys)return a;for(var b=0;b<this.$1Is.get_$14();b++){var c=this.$1Is.get_$5(b);if(c.$1HS===d){a=c;return a}}return a},$1RX:function(a){if(a&&a.$PK){this.$2pD(a);return this.$1RX(a.$PK)}var c=new($$sc.$F.$$(Common.App.AppsForOfficeCommon.$AL));if(a&&a.get_$oY()){var e=this.$12S(a),d=Box4.$1v.$Ca(e);while(d.$2j()){var b=d.get_$A();b.get_$19()===50&&c.$F(new Common.App.AppsForOfficeCommon.$AL(b.$s(String,Box4.AppProperties.$1.$1B6),b.$s(String,Box4.AppProperties.$1.$1P3),b.$s(String,Box4.AppProperties.$1.$1P2)))}}return c},$3WG:function(){var b=new($$sc.$F.$$(Common.App.AppsForOfficeCommon.$AL)),d=this.$1k7(),c=Box4.$1v.$Ca(d.get_$A());while(c.$2j()){var a=c.get_$A();a.get_$19()===50&&b.$F(new Common.App.AppsForOfficeCommon.$AL(a.$s(String,Box4.AppProperties.$1.$1B6),a.$s(String,Box4.AppProperties.$1.$1P3),a.$s(String,Box4.AppProperties.$1.$1P2)))}return b},$531:function(){var b=new($$sc.$F.$$(Object)),c=this.$1k7(),a=this;this.$4uL(c,function(c){var d=a.$2n1(c);a.$4uK(c,function(a){b.$F({appInstanceId:d.$1HS,appBindingData:new Common.App.AppsForOfficeCommon.$AL(a.$s(String,Box4.AppProperties.$1.$1B6),a.$s(String,Box4.AppProperties.$1.$1P3),a.$s(String,Box4.AppProperties.$1.$1P2))})})});return b},$4uL:function(a,b){if(a&&a.$1J(19))do b(a);while(a.$5h(19))},$4uK:function(a,b){if(a&&a.$1J(22))do b(a.get_$A());while(a.$5h(22))},$33H:function(a,e){if(!a||!e)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(a.$PK)return this.$33H(a.$PK,e);if(a.get_$oY()){var b=this.$12S(a);if(b){var c=Box4.$E.$13(b),d=c.$1J(22);while(d){if(d.$s(String,Box4.AppProperties.$1.$1B6)===e){c.$4v();b.$M(Box4.AppProperties.$5.$NZ,new Date);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}d=c.$5h(22)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}}return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError},$eJ:function(d,e){var c=this.$1RX(d),a=c.$$lge();while(a.$$mn()){var b=a.$$cu();if(b.$VI===e)return b}return null},$530:function(e){var d=this.$3WG(),b=new($$sc.$F.$$(Common.App.AppsForOfficeCommon.$AL)),a=d.$$lge();while(a.$$mn()){var c=a.$$cu();c.$Qt===e&&b.$F(c)}return b},$3e8:function(a,b){if(!a)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(a.$PK){this.$2pD(a);return this.$3e8(a.$PK,b)}if(a.get_$oY()){var c=this.$12S(a);if(!c)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.$eJ(a,b.$VI))return this.$67o(a,b);else{var d=this.$4V4(b);this.$45f(c,d)}}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$2sl:function(){return this.$1Is},$2Fb:function(a){if(!this.$ys||!a)return;if(a.get_$oY()){var b=this.$12S(a);if(!b){var c=this.$4es(a);this.$45a(c,a)}}},$5vP:function(c){if(!this.$ys)return;var a=this.$12S(c);if(a){var b=this.$2g.$59(15,0);b.$1o(a);a.$M(Box4.AppProperties.$1.$278,c.$1H4);a.$M(Box4.AppProperties.$5.$NZ,new Date);b.dispose()}},$3pp:function(a){if(!this.$ys)return null;if(!a)return null;if(a.$PK)return this.$3pp(a.$PK);if(a.get_$oY()){var b=this.$12S(a);if(b)return this.$1ec.$3WS(b)}return null},$3t8:function(a,d){if(!this.$ys)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(!a)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(a.$PK){this.$2pD(a);return this.$3t8(a.$PK,d)}if(a.get_$oY()){var b=this.$12S(a);if(b){var c=this.$2g.$59(15,0);c.$1o(b);var e=this.$1ec.$5rH(b,d);b.$M(Box4.AppProperties.$5.$NZ,new Date);c.dispose();return e}}Diag.$2.$9(7143687,344,15,"App Node not found when trying to save settings");return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError},$d:function(){},$5k0:function(){var a=this.$1k7();if(a&&a.$1J(19))do{var b=this.$2n1(a);b&&this.$1Is.$F(b)}while(a.$4h(19))},$12S:function(c){var a=this.$1k7();if(a&&a.$1J(19))do{var b=this.$2n1(a);if(b.$4Hi(c))return a.get_$A()}while(a.$4h(19));return null},$2n1:function(k){var a=k.get_$A(),d=this.$1ec.$3WS(a),e=a.$s(String,Box4.AppProperties.$1.$1gH),f=a.$s(String,Box4.AppProperties.$1.$2k9),g=a.$s(String,Box4.AppProperties.$1.$1gJ),h=a.$s(String,Box4.AppProperties.$1.$1gK),i=a.$s(Boolean,Box4.AppProperties.$1.$2jx),j=a.$s(Boolean,Box4.AppProperties.$1.$278),c=a.get_$E().toString(),b=null;if(!i){b=new Common.App.AppsForOfficeCommon.$El(c,c,e,f,g,h,j);b.$Au=d}return b},$3in:function(a){this.$h9.$XM(a);var b=a.$1J(18);return b},$1k7:function(){var a=null,b=WordEditor.App.get_$7S().$1L.get_$2v();if(b){a=new Box4.$E;a.$h(b);var c=this.$3in(a);if(!c)a=null}return a},$4es:function(b){var a=this.$2Ui.$eQ();a.$M(Box4.AppProperties.$1.$1gH,b.$80);a.$M(Box4.AppProperties.$1.$2k9,b.$1IT);a.$M(Box4.AppProperties.$1.$1gJ,b.$1ID);a.$M(Box4.AppProperties.$1.$1gK,b.$xN);a.$M(Box4.AppProperties.$1.$278,b.$1H4);a.$M(Box4.AppProperties.$1.$2jx,false);a.$M(Box4.AppProperties.$1.$3G8,false);a.$M(Box4.AppProperties.$1.$3Gk,"");a.$M(Box4.AppProperties.$1.$3Gl,"right");a.$M(Box4.AppProperties.$1.$3Go,350);a.$M(Box4.AppProperties.$1.$3Gn,1);a.$M(Box4.AppProperties.$1.$3Gm,false);return a},$53M:function(d,e){var a=Box4.$E.$13(d);if(a&&a.$1J(22))do{var b=a.get_$A(),c=b.$s(String,Box4.AppProperties.$1.$1B6);if(e===c)return b}while(a.$4h(22));return null},$4V4:function(b){var c=new WordEditor.$Vp,a=c.$eQ();a.$M(Box4.AppProperties.$1.$1B6,b.$VI);a.$M(Box4.AppProperties.$1.$1P3,b.$PD);a.$M(Box4.AppProperties.$1.$1P2,b.$Qt);return a},$67o:function(d,c){var a=this.$12S(d);if(!a)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var b=this.$53M(a,c.$VI);if(!b)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;b.$M(Box4.AppProperties.$1.$1P3,c.$PD);b.$M(Box4.AppProperties.$1.$1P2,c.$Qt);a.$M(Box4.AppProperties.$5.$NZ,new Date);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$45f:function(a,c){var b=Box4.$E.$13(a);b.$3p(c,22);a.$M(Box4.AppProperties.$5.$NZ,new Date)},$45a:function(b,c){var a=this.$1k7();if(!a)return;!b.$21&&a.$1Au(b,19,Common.$C.$7r(c.$2Pc))},$2pD:function(a){this.$2Fb(a.$PK)}};WEAFO.$G0=function(a,b,c,d,e,f,g,h,i,j){this.$$d_$5ce=Function.createDelegate(this,this.$5ce);WEAFO.$G0.initializeBase(this,[a,b,c,d,e,f,g,i]);this.$IU=j||Box4.TaskPaneManager.$3k.get_$4();this.$Ps=new($$sc.$3j.$$(CommandUI.TaskPane.$WH));this.$1Ii=h};WEAFO.$G0.prototype={$IU:null,$Ps:null,$1Ii:null,$Xf:function(b,m,d){var k=this.$2I.get_$AS(),n=this.$Ps.get_$14(),c=null,e,f,l=(f=this.$669(b,e={val:c}),c=e.val,f);if(!l){this.$3L2(b,m,d);this.$IU.$Xf(this.$Ps.get_$5(b));this.$Ps.get_$5(b).$14b(this.$$d_$5ce);var g=this.$2I.$2w(this.$Ps.get_$5(b).$y),i=this;g.$ZU(function(){i.$5vL(d.id,Common.$7.get_$7Z())});var j=this;g.$26Z(function(){j.$5vN(d.id)})}else{var a=this.$Ps.get_$5(c),h=this.$3Z0(a);if(!a.$VQ||!this.$5Ku(h)){this.$5jy(h);this.$IU.$Xf(a);a.$14b(this.$$d_$5ce);this.$4m.$IX(a.$y)}}this.$2I.$8x(k.$5j);this.$lB=null;return true},$4jc:function(a,b,c){this.$3L2(a,b,c)},$2px:function(a){return this.$1Ii.$3Yz(a)},$d:function(){Common.App.AppsForOfficeCommon.$9i.prototype.$d.call(this);if(this.$Ps){var b=this.$Ps.$3f();while(b.$$mn()){var a=b.$$cu();a.get_$Q()&&this.$IU.$11Z(a.get_$Q().$y,a.get_$Q())}this.$Ps=null}},$5DC:function(b){var a=this.$1Ii.$535(b);return this.$Ps.get_$5(a).$y},$5ce:function(a){var b=this.$3Z0(a);this.$3k3(b);this.$4m.$Gw(a.$y);this.$IU.$133(a)},$3Z0:function(e){var b=null,a=this.$Ps.$3f();while(a.$$mn()){var c=a.$$cu();if(e.$y===c.get_$Q().$y){b=c.get_$Ao();break}}var d=this.$1Ii.$3Yz(b);return d},$669:function(d,c){c.val=null;var a=this.$Ps.get_$UW().$$ge();while(a.$$mn()){var b=a.$$cu();if(b.toLowerCase()===d.toLowerCase()){c.val=b;return true}}return false},$4Gm:function(b){if(!b)return;var a=null,c,d;if((d=this.$Ps.$9F(b.getMarketplaceID(),c={val:a}),a=c.val,d)&&a&&(!a.get_$6L()||a.get_$6L()==="")){var e=OSF.OsfManifestManager.getCachedManifest(b.getMarketplaceID(),b.getMarketplaceVersion());if(e){a.set_$6L(e.getDefaultDisplayName());a.$Ab()}}},$3L2:function(d,l,b){var e=String.format("AppForOfficePanel{0}",this.$Ps.get_$14()),c=null,f=Common.$m.$27d("AppContainer",true,""),g=Common.$m.$4KB(f),h=Common.$m.$1gb(e,l,330,g),i=Common.$m.$4Jl(h),j=CommandUI.$2v.$1hP(i);this.$Ps.set_$5(d,this.$IU.$29B(j,e,1,330));var k=this.$Ps.get_$5(d);c=k.$3b5();c.style.overflowY="hidden";var a=document.createElement("div");a.className="AppsForOfficeTaskPaneAppContainer";a.id=b.id;c.appendChild(a);b.div=a;this.$44A(b);this.$1Ii.$F(b,d)}};WEAFO.$G1=function(a,b,c){WEAFO.$G1.initializeBase(this,[a,b]);this.$1Kc=c};WEAFO.$G1.$4Zk=function(b,c){var a=new($$sc.$9P.$$(Common.App.AppsForOfficeCommon.$Vo));a.set_$5(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,WEAFO.$BH.get_$4());a.set_$5(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent,WEAFO.$BA.get_$4());return new WEAFO.$G1(b,a,c)};WEAFO.$G1.prototype={$1Kc:null,$2sp:function(b){var a=Common.App.AppsForOfficeCommon.$rN.prototype.$2sp.call(this,b);if(a)a.$4Z=this.$1Kc;return a}};WEAFO.$9d=function(a,b,c){WEAFO.$9d.initializeBase(this);this.$1Kc=a;this.$3H=b;this.$Jb=c};WEAFO.$9d.prototype={$1Kc:null,$3H:null,$Jb:null,$3WP:function(b){var a=Common.App.AppsForOfficeCommon.$rP.prototype.$3WP.call(this,b);if(a)a.$4Z=this.$1Kc;return a},$5g1:function(){var a=new($$sc.$9P.$$(Function)),d=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,function(){return new WEAFO.$aO(d.get_$2Gm(),d.$3H,d.get_$2JU(),d.$Jb)});var c=this;a.set_$5(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,function(){var a=c.$3H.$1A("WordEditorAppsForOfficeImportExternalHtmlDataIsEnabled")&&Common.$7.get_$3zD();return new WEAFO.$gi(a,c.get_$2Gm(),c.get_$2JU(),c.$Jb,c.$3H)});var k=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,function(){return new WEAFO.$aK});var n=this;a.set_$5(OSF.DDA.MethodDispId.dispidAddDataPartMethod,function(){return new WEAFO.$VM});var o=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataPartByIdMethod,function(){return new WEAFO.$aD});var r=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataPartsByNamespaceMethod,function(){return new WEAFO.$aF});var s=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataPartXmlMethod,function(){return new WEAFO.$aG});var u=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataPartNodesMethod,function(){return new WEAFO.$aE});var w=this;a.set_$5(OSF.DDA.MethodDispId.dispidDeleteDataPartMethod,function(){return new WEAFO.$YP});var x=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataNodeValueMethod,function(){return new WEAFO.$aB});var z=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataNodeXmlMethod,function(){return new WEAFO.$aC});var B=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataNodesMethod,function(){return new WEAFO.$aA});var C=this;a.set_$5(OSF.DDA.MethodDispId.dispidSetDataNodeValueMethod,function(){return new WEAFO.$gf});var D=this;a.set_$5(OSF.DDA.MethodDispId.dispidSetDataNodeXmlMethod,function(){return new WEAFO.$gg});var E=this;a.set_$5(OSF.DDA.MethodDispId.dispidAddDataNamespaceMethod,function(){return new WEAFO.$VL});var F=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataUriByPrefixMethod,function(){return new WEAFO.$aI});var G=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDataPrefixByUriMethod,function(){return new WEAFO.$aH});var h=this.$3H.$1A(WEAFO.$9d.$2js),b=this.$3H.$1A(WEAFO.$9d.$3Fu),H=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetBindingMethod,function(){return new WEAFO.$a9(h)});var I=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetAllBindingsMethod,function(){return new WEAFO.$a6(h)});var J=this;a.set_$5(OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod,function(){return new WEAFO.$VK(b)});var K=this;a.set_$5(OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod,function(){return new WEAFO.$VJ(b)});var f=this;a.set_$5(OSF.DDA.MethodDispId.dispidSetBindingDataMethod,function(){return new WEAFO.$ge(f.get_$2Gm(),b,f.get_$2JU(),f.$Jb)});var g=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetBindingDataMethod,function(){return new WEAFO.$a8(g.get_$2Gm(),h,g.get_$2JU(),g.$Jb)});var L=this;a.set_$5(OSF.DDA.MethodDispId.dispidReleaseBindingMethod,function(){return new WEAFO.$fL(b)});var M=this;a.set_$5(OSF.DDA.MethodDispId.dispidAddColumnsMethod,function(){return new WEAFO.$VZ(b)});var N=this;a.set_$5(OSF.DDA.MethodDispId.dispidAddRowsMethod,function(){return new WEAFO.$Va(b)});var O=this;a.set_$5(OSF.DDA.MethodDispId.dispidClearAllRowsMethod,function(){return new WEAFO.$YS(b)});if(Common.$7.get_$63T()){var e=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,function(){var a=e.$3H.$1A("WordEditorAppsForOfficeGetDocxFileIsEnabled"),b=e.$3H.$1A("WordEditorAppsForOfficeGetPdfFileIsEnabled"),c=e.$3H.$1A("WordEditorAppsForOfficeGetTextFileIsEnabled");return new WEAFO.$Ge(a,b,c)});var l=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,function(){return new WEAFO.$aJ});var m=this;a.set_$5(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,function(){return new WEAFO.$fM})}else{var p=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,function(){return WEAFO.$Ee.$2nG(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)});var q=this;a.set_$5(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,function(){return WEAFO.$Ee.$2nG(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)});var t=this;a.set_$5(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,function(){return WEAFO.$Ee.$2nG(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)})}var i=this;a.set_$5(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,function(){var a=i.$3H.$1A("WordEditorExtensionRichAPIIsEnabled");return new WEAFO.$Z9(a)});var v=this;a.set_$5(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,function(){return new WEAFO.$cu});var y=this;a.set_$5(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,function(){return new WEAFO.$fy});var j=this;a.set_$5(OSF.DDA.MethodDispId.dispidNavigateToMethod,function(){var a=j.$3H.$1A(WEAFO.$9d.$2js);return new WEAFO.$aQ(Box4.$h.get_$4(),Box4.$13.get_$4().get_$41().get_$3C(),Box4.App.get_$X(),a)});var A=this;a.set_$5(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,function(){return new WEAFO.$Vq});return a},get_$2Gm:function(){return this.$3H.$1A("WordEditorAppsForOfficeSelectionOoxmlIsEnabled")},get_$2JU:function(){return this.$3H.$5L("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",3e4)}};WEAFO.$BA=function(a){this.$$d_$3mU=Function.createDelegate(this,this.$3mU);WEAFO.$BA.initializeBase(this);this.$25=a};WEAFO.$BA.get_$4=function(){return WEAFO.$BA.$T||(WEAFO.$BA.$T=new WEAFO.$BA(Common.$0.get_$2e()))};WEAFO.$BA.prototype={$25:null,$AK:null,$cD:null,get_$2jr:function(){if(!this.$AK)this.$AK=Common.Utils.$8.get_$4().$J(WEAFO.$Ih);return this.$AK},$1O:function(a,d,b,c){if(!this.$4Z)this.$111(b,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else{!this.$Bh.get_$14()&&this.$4Z.add_$1pQ(this.$$d_$3mU);this.$Bh.set_$5(this.$27F(a,c),d);this.get_$2jr().$LL(a,c,"Binidng.AddHandler");this.$1gd(b)}},$2X:function(a,c,b){if(!b)this.$5n4(a,c);else if(!this.$4Z||!this.$Bh.$30(this.$27F(a,b)))this.$111(c,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else{this.$Bh.$73(this.$27F(a,b));!this.$Bh.get_$14()&&this.$4Z.remove_$1pQ(this.$$d_$3mU);this.get_$2jr().$LL(a,b,"Binidng.RemoveHandler");this.$1gd(c)}},$5n4:function(g,e){if(!this.$4Z)this.$111(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else{var c=new($$sc.$F.$$(String)),a=this.$Bh.get_$UW().$$ge();while(a.$$mn()){var d=a.$$cu();d.startsWith(g)&&c.$F(d)}var b=c.$$lge();while(b.$$mn()){var f=b.$$cu();this.$Bh.$73(f)}!this.$Bh.get_$14()&&this.$4Z.remove_$1pQ(this.$$d_$3mU);this.$1gd(e)}},$3mU:function(){if(this.$cD)this.$25.$66(this.$cD);else{var a=this;this.$cD=new Common.$1e(4,1,100,function(){a.$cD=null;a.onEvent()})}this.$25.$2f(this.$cD)},$27F:function(a,b){return a+"-"+b},onEvent:function(){var h=this.get_$2jr().$5Bp(),f=h.$$lge();while(f.$$mn()){var a=f.$$cu(),i=a.appInstanceId,j=a.appReferenceId,g=a[OSF.DDA.Marshaling.AppBindingKeys.BindingId],b=a[OSF.DDA.Marshaling.AppBindingKeys.BindingType],c=this.$27F(i,g);if(this.$Bh.$30(c)&&this.$Bh.get_$5(c)){WordEditor.$5S.$LL(7,j,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{BindingType:b});var d={};d[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=g;d[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=b;var e={};e[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=d;if(b===WEAFO.$4E.$8J)e[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=a[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset];this.$Bh.get_$5(c)(e)}}}};WEAFO.$BH=function(a){this.$$d_$3mU=Function.createDelegate(this,this.$3mU);WEAFO.$BH.initializeBase(this);this.$25=a};WEAFO.$BH.get_$4=function(){return WEAFO.$BH.$T||(WEAFO.$BH.$T=new WEAFO.$BH(Common.$0.get_$2e()))};WEAFO.$BH.prototype={$25:null,$cD:null,$1O:function(b,c,a){if(!this.$4Z)this.$111(a,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else{!this.$Bh.get_$14()&&this.$4Z.add_$1pQ(this.$$d_$3mU);this.$Bh.set_$5(b,c);this.$1gd(a)}},$2X:function(a,b){if(!this.$4Z||!this.$Bh.$30(a))this.$111(b,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else{this.$Bh.$73(a);!this.$Bh.get_$14()&&this.$4Z.remove_$1pQ(this.$$d_$3mU);this.$1gd(b)}},$3mU:function(){if(this.$cD)this.$25.$66(this.$cD);else{var a=this;this.$cD=new Common.$1e(4,1,100,function(){a.$cD=null;a.onEvent()})}this.$25.$2f(this.$cD)},onEvent:function(){var a=this.$Bh.get_$2Ov().$$ge();while(a.$$mn()){var b=a.$$cu();b&&b({})}}};WEAFO.$sV=function(){WEAFO.$sV.initializeBase(this)};WEAFO.$sV.prototype={$4Z:null};WEAFO.$VK=function(a){WEAFO.$VK.initializeBase(this);this.$D5=a};WEAFO.$VK.prototype={$D5:false,$5ET:function(){var b="";if(!this.$D5)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{var a=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(a[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]){var f=null;if(a[OSF.DDA.Marshaling.BindingParameterKeys.Id])f=a[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();b=a[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();var c=null,d,e;this.$1z=(e=this.$4Z.$45e(this.$6e,f,b,d={val:c}),c=d.val,e);this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=c}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}WordEditor.$5S.$LL(3,this.$6e.$80,this.$1z,{BindingType:b});this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(16795285,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to AddAppBindingFromSelection api"});this.$Ar()}};WEAFO.$VJ=function(a){WEAFO.$VJ.initializeBase(this);this.$D5=a};WEAFO.$VJ.prototype={$D5:false,$5ET:function(){var b="";if(!this.$D5)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{var a=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(a[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]&&a[OSF.DDA.Marshaling.BindingParameterKeys.ItemName]){var f=null;if(a[OSF.DDA.Marshaling.BindingParameterKeys.Id])f=a[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();b=a[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();var g=a[OSF.DDA.Marshaling.BindingParameterKeys.ItemName].toString(),c=null,d,e;this.$1z=(e=this.$4Z.$45d(this.$6e,f,g,b,d={val:c}),c=d.val,e);this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=c}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}WordEditor.$5S.$LL(4,this.$6e.$80,this.$1z,{BindingType:b});this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(16795283,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to AddAppBindingFromNamedItem api"});this.$Ar()}};WEAFO.$VM=function(){WEAFO.$VM.initializeBase(this)};WEAFO.$VM.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.$Ar()}};WEAFO.$VZ=function(a){this.$$d_$3FI=Function.createDelegate(this,this.$3FI);WEAFO.$VZ.initializeBase(this);this.$D5=a};WEAFO.$VZ.prototype={$D5:false,$5ET:function(){var b=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(!this.$D5)b=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)b=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{var a=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];if(a[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&a[OSF.DDA.Marshaling.SetDataKeys.Data]){var g=a[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),c,d,e;if(a[OSF.DDA.Marshaling.SetDataKeys.Data].length>0){c=null;d=a[OSF.DDA.Marshaling.SetDataKeys.Data];e=false}else{var f=a[OSF.DDA.Marshaling.SetDataKeys.Data];c=f[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders];d=f[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows];e=true}this.$4Z.$3Ec(g,this.$6e,c,d,e,this.$$d_$3FI);return}else b=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}this.$3FI(b)},$2zW:function(){WordEditor.$5S.$LL(10,this.$6e.$80,this.$1z,null);this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(17580612,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to AddTableBindingColumnsAsync API"})},$3FI:function(a){this.$1z=a;this.$2zW();this.$Ar()}};WEAFO.$Va=function(a){this.$$d_$3FJ=Function.createDelegate(this,this.$3FJ);WEAFO.$Va.initializeBase(this);this.$D5=a};WEAFO.$Va.prototype={$D5:false,$5ET:function(){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(!this.$D5)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{var b=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];if(b[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&b[OSF.DDA.Marshaling.SetDataKeys.Data]){var c=b[OSF.DDA.Marshaling.SetDataKeys.Data],d=b[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();this.$4Z.$3FB(d,this.$6e,c,this.$$d_$3FJ);return}else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}this.$3FJ(a)},$2zW:function(){WordEditor.$5S.$LL(9,this.$6e.$80,this.$1z,null);this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(17580613,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to AddTableBindingRowsAsync API"})},$3FJ:function(a){this.$1z=a;this.$2zW();this.$Ar()}};WEAFO.$YS=function(a){this.$$d_$3NM=Function.createDelegate(this,this.$3NM);WEAFO.$YS.initializeBase(this);this.$D5=a};WEAFO.$YS.prototype={$D5:false,$5ET:function(){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(!this.$D5)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{var b=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(b[OSF.DDA.Marshaling.BindingParameterKeys.Id]){var c=b[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();this.$4Z.$3NF(c,this.$6e,this.$$d_$3NM);return}else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}this.$3NM(a)},$2zW:function(){WordEditor.$5S.$LL(11,this.$6e.$80,this.$1z,null);this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(17580614,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to deleteAllDataValuesAsync API"})},$3NM:function(a){this.$1z=a;this.$2zW();this.$Ar()}};WEAFO.$a6=function(a){WEAFO.$a6.initializeBase(this);this.$D5=a};WEAFO.$a6.prototype={$D5:false,$5ET:function(){if(!this.$D5)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{var a=[],b,c;this.$1z=(c=this.$4Z.$52h(this.$6e,b={val:a}),a=b.val,c);this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=a}WordEditor.$5S.$LL(12,this.$6e.$80,this.$1z,null);this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(9049033,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to getAllAsync api"});this.$Ar()}};WEAFO.$a8=function(a,b,c,d){WEAFO.$a8.initializeBase(this);this.$1L8=a;this.$D5=b;this.$cu=c;this.$Jb=d};WEAFO.$a8.prototype={$1L8:false,$D5:false,$cu:0,$Jb:null,$5ET:function(){var a=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData],b=null;if(!this.$D5)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else if(isNullOrUndefined(a[OSF.DDA.Marshaling.GetDataKeys.CoercionType])||isNullOrUndefined(a[OSF.DDA.Marshaling.BindingParameterKeys.Id]))this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{b=a[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();var c=a[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),d=null,e,j,k;k=this.$4Z.$2sx(c,this.$6e,j={val:d}),d=j.val,k;if(!d||!(e=d[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties]))this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;else{var f=e[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Text){var g,l,m;this.$1z=(m=this.$4Z.$3Wd(this.$6e,c,l={val:g}),g=l.val,m);this.$147(String,g)}else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Table)if(f===OSF.DDA.Marshaling.CoercionTypeKeys.Table){this.$3bL(a,e);var h=null,n,o;this.$1z=(o=this.$4Z.$53O(this.$6e,c,a,n={val:h}),h=n.val,o);this.$147(Object,h)}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)if(f===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix||f===OSF.DDA.Marshaling.CoercionTypeKeys.Table){this.$3bL(a,e);var i=null,p,q;this.$1z=(q=this.$4Z.$53L(this.$6e,c,a,p={val:i}),i=p.val,q);this.$147(Array,i)}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.$1L8){this.$59n(c);return}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}this.$Ub(b)},$3bL:function(a){var b=!!a&&(!!a[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||!!a[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]||!!a[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]||!!a[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]);a.isPartialTable=b;a[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]=!a[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]?0:a[OSF.DDA.Marshaling.BindingParameterKeys.StartRow];a[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]=!a[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]?0:a[OSF.DDA.Marshaling.BindingParameterKeys.StartCol];a[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]=!a[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]?0:a[OSF.DDA.Marshaling.BindingParameterKeys.RowCount];a[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]=!a[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]?0:a[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]},$59n:function(d){var a=new WEAFO.$K2(this.$Jb,this.$cu),b=this;a.$2NI(function(){b.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;b.$1UQ(null,a.$PQ)});var c=this;this.$4Z.$53N(this.$6e,d,function(b,d){if(a.get_$2Gu()){WEAFO.$5C.$2HZ(WEAFO.$5C.$Qn(a.$qc),true);return}a.$1gw();c.$1z=b;c.$1UQ(d,a.$PQ)})},$Ub:function(a){WordEditor.$5S.$LL(5,this.$6e.$80,this.$1z,{CoercionType:a});this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(16795287,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to GetAppBindingData api",CoercionType:a});this.$Ar()},$147:function(b,a){if(this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=a},$1UQ:function(a,b){WEAFO.$5C.$LL(true,this.$1z,(a||"").length,WEAFO.$5C.$Qn(b),this.$6e.$80);this.$147(String,a);this.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}};WEAFO.$a9=function(a){WEAFO.$a9.initializeBase(this);this.$D5=a};WEAFO.$a9.prototype={$D5:false,$5ET:function(){if(!this.$4Z)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{var d=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id]){var e=d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();if(this.$D5){var a={},b,c;this.$1z=(c=this.$4Z.$2sx(e,this.$6e,b={val:a}),a=b.val,c);this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=a}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}WordEditor.$5S.$LL(13,this.$6e.$80,this.$1z,null);this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(9000010,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to getAppBindingById api"});this.$Ar()}};WEAFO.$aD=function(){WEAFO.$aD.initializeBase(this)};WEAFO.$aD.prototype={$46:function(){var b=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],c=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(b);if(!isNullOrUndefined(c)){var a={};a.id=b;a.DataPartBuiltIn=c.$1v1;this.$AJ[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=a;this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound;this.$Ar()}};WEAFO.$aF=function(){WEAFO.$aF.initializeBase(this)};WEAFO.$aF.prototype={$46:function(){var f=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],d=Common.Utils.$8.get_$4().$J(WECX.$Ah).$52k(),e=[];this.$AJ[OSF.DDA.Marshaling.ListDescriptors.DataPartList]=e;this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound;for(var a=0;a<d.length;a++){var b=d[a];if(f===b.$zI){var c={};c.id=b.$y;c.DataPartBuiltIn=b.$1v1;e.push(c);this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}this.$Ar()}};WEAFO.$aG=function(){WEAFO.$aG.initializeBase(this)};WEAFO.$aG.prototype={$46:function(){var b=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],a=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(b);this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=isNullOrUndefined(a)?null:a.$1Ap;this.$1z=isNullOrUndefined(a)?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.$Ar()}};WEAFO.$aE=function(){WEAFO.$aE.initializeBase(this)};WEAFO.$aE.prototype={$46:function(){var a=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],c=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath],b=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(a);if(!isNullOrUndefined(b))try{var d=b.$3ti(c,null);this.$AJ[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=Common.Utils.$8.get_$4().$J(WEAFO.$FF).$40Z(a,d);this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(e){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.$Ar()}};WEAFO.$YP=function(){WEAFO.$YP.initializeBase(this)};WEAFO.$YP.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.$Ar()}};WEAFO.$aB=function(){WEAFO.$aB.initializeBase(this)};WEAFO.$aB.prototype={$46:function(){var f=this.$91[OSF.DDA.Marshaling.DataNodeProperties.Handle],a,b,c,d,e;this.$1z=(e=Common.Utils.$8.get_$4().$J(WEAFO.$FF).$2vM(f,c={val:a},d={val:b}),a=c.val,b=d.val,e);if(this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=a.$59e(b);this.$Ar()}};WEAFO.$aC=function(){WEAFO.$aC.initializeBase(this)};WEAFO.$aC.prototype={$46:function(){var f=this.$91[OSF.DDA.Marshaling.DataNodeProperties.Handle],a,b,c,d,e;this.$1z=(e=Common.Utils.$8.get_$4().$J(WEAFO.$FF).$2vM(f,c={val:a},d={val:b}),a=c.val,b=d.val,e);if(this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=a.$59f(b);this.$Ar()}};WEAFO.$aA=function(){WEAFO.$aA.initializeBase(this)};WEAFO.$aA.prototype={$46:function(){var f=this.$91[OSF.DDA.Marshaling.DataNodeProperties.Handle],g=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath],a,b,c,d,e;this.$1z=(e=Common.Utils.$8.get_$4().$J(WEAFO.$FF).$2vM(f,c={val:a},d={val:b}),a=c.val,b=d.val,e);if(this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)try{var h=a.$3ti(g,b);this.$AJ[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=Common.Utils.$8.get_$4().$J(WEAFO.$FF).$40Z(f.CustomXmlId,h)}catch(i){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}this.$Ar()}};WEAFO.$ge=function(a,b,c,d){this.$$d_$5vK=Function.createDelegate(this,this.$5vK);WEAFO.$ge.initializeBase(this);this.$1L8=a;this.$D5=b;this.$cu=c;this.$Jb=d};WEAFO.$ge.prototype={$1L8:false,$D5:false,$cu:0,$Jb:null,$5ET:function(){var a=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData],b=null;if(!this.$D5)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else if(isNullOrUndefined(a[OSF.DDA.Marshaling.SetDataKeys.CoercionType])||isNullOrUndefined(a[OSF.DDA.Marshaling.SetDataKeys.Data])||isNullOrUndefined(a[OSF.DDA.Marshaling.BindingParameterKeys.Id]))this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{b=a[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();var o=a[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),c=a[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),d=null,e,i,j;j=this.$4Z.$2sx(c,this.$6e,i={val:d}),d=i.val,j;if(!d||!(e=d[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties]))this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;else{var f=e[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.$1z=this.$4Z.$3vB(this.$6e,c,o);else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.$1L8){this.$5xX(c,o);return}else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Table)if(f===OSF.DDA.Marshaling.CoercionTypeKeys.Table){var g=null,k,l;if((this.$1z=(l=this.$418(a,e,k={val:g}),g=k.val,l))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.$4Z.$5vX(this.$6e,c,a[OSF.DDA.Marshaling.SetDataKeys.Data],g,this.$$d_$5vK);return}}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)if(f===OSF.DDA.Marshaling.CoercionTypeKeys.Table||f===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix){var h=null,m,n;if((this.$1z=(n=this.$418(a,e,m={val:h}),h=m.val,n))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.$4Z.$5vV(this.$6e,c,a[OSF.DDA.Marshaling.SetDataKeys.Data],h,this.$$d_$5vK);return}}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}this.$Ub(b)},$418:function(b,e,a){var f=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,j=e[OSF.DDA.Marshaling.AppBindingKeys.BindingId],k=e[OSF.DDA.Marshaling.AppBindingKeys.BindingType],h=e[OSF.DDA.Marshaling.AppBindingKeys.RowCount],i=e[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount],g=!!b&&(!!b[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||!!b[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]);a.val={};a.val.isPartialTable=g;if(g){var c,d;c=b[OSF.DDA.Marshaling.BindingParameterKeys.StartRow];d=b[OSF.DDA.Marshaling.BindingParameterKeys.StartCol];if(c<0||c>=h||d<0||d>=i)f=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn;else{a.val.startRow=c;a.val.startCol=d}}else{a.val.startRow=0;a.val.startCol=0}return f},$Ub:function(a){WordEditor.$5S.$LL(6,this.$6e.$80,this.$1z,{CoercionType:a});this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(16795289,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to SetAppBindingData API",CoercionType:a});this.$Ar()},$5xX:function(e,b){var a=new WEAFO.$K2(this.$Jb,this.$cu),c=this;a.$2NI(function(){c.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;c.$1UQ(a.$PQ,b.length)});var d=this;this.$4Z.$5vW(this.$6e,e,b,function(c){if(a.get_$2Gu()){WEAFO.$5C.$2HZ(WEAFO.$5C.$Qn(a.$qc),false);return}a.$1gw();d.$1z=c;d.$1UQ(a.$PQ,b.length)})},$1UQ:function(a,b){WEAFO.$5C.$LL(false,this.$1z,b,WEAFO.$5C.$Qn(a),this.$6e.$80);this.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)},$5vK:function(a,b){this.$1z=a;this.$Ub(b)}};WEAFO.$gf=function(){WEAFO.$gf.initializeBase(this)};WEAFO.$gf.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.$Ar()}};WEAFO.$gg=function(){WEAFO.$gg.initializeBase(this)};WEAFO.$gg.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.$Ar()}};WEAFO.$VL=function(){WEAFO.$VL.initializeBase(this)};WEAFO.$VL.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.$Ar()}};WEAFO.$aI=function(){WEAFO.$aI.initializeBase(this)};WEAFO.$aI.prototype={$46:function(){var b=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],c=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],a=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(b);if(!isNullOrUndefined(a)&&c===a.$3Zb(a.$zI)){this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=a.$zI;this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.$Ar()}};WEAFO.$aH=function(){WEAFO.$aH.initializeBase(this)};WEAFO.$aH.prototype={$46:function(){var c=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],b=this.$91[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],a=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(c);if(!isNullOrUndefined(a)&&b===a.$zI){this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=a.$3Zb(b);this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.$Ar()}};WEAFO.$Ge=function(a,b,c){this.$$d_$55e=Function.createDelegate(this,this.$55e);WEAFO.$Ge.initializeBase(this);this.$2aa=a;this.$2ab=b;this.$2ad=c};WEAFO.$Ge.$53n=function(a){return a.length*2+2};WEAFO.$Ge.$5CF=function(e,g){var b=new($$sc.$F.$$(String)),a=0,c=g/2;do{var d=a+(!b.get_$14()?c-1:c),f=Common.$9.$8I(e,a,d);b.$F(f);a=d}while(a<e.length);return b};WEAFO.$Ge.prototype={$2aa:false,$2ab:false,$2ad:false,$2Sx:null,$3DC:100,$5ET:function(){var b=false;this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.$4Z&&this.$4Z.get_$12e()&&!isNullOrUndefined(this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType])&&!isNullOrUndefined(this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize])){var a=this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType],c=this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize];if(this.$4Z.get_$12e().$3f4(this.$py))this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit;else if(c<=0){Diag.$2.$9(7123611,341,15,"Invalid slice size. It should be greater than 0.");this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize}else if(this.$5Ox(a))b=this.$5BG(a,c);else{Diag.$2.$9(7123612,341,15,"Requested file type {0} is not supported.",a);this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported}}!b&&this.$Ar()},$5Ox:function(a){return a===OSF.DDA.Marshaling.File.FileType.Compressed&&this.$2aa||a===OSF.DDA.Marshaling.File.FileType.Pdf&&this.$2ab||a===OSF.DDA.Marshaling.File.FileType.Text&&this.$2ad},$5BG:function(b,c){var a=this,d=function(e,f){var d={};d.FileType=b;d.SliceSize=c;WordEditor.$5S.$LL(8,a.$6e.$80,e,d);a.$5hZ(f);a.$55Z(e)};if(b===OSF.DDA.Marshaling.File.FileType.Text)return this.$55d(c,d);else this.$4Z.get_$12e().$55c(this.$py,b,c,d);return true},$55d:function(b,d){Diag.$2.$9(8914013,341,100,"Started to get document content in text format; sliceSize is "+b);var a=this.$5Dc();if(!a)return false;var c=this.$5CE(b,d,a);c.$6V();return true},$5CE:function(g,c,d){var f="",a=new WEAFO.$Ge.$55f;a.$1qj=d;a.$29M=f;a.$2OE=this.$572(d);var e=this;a.$2tT=function(b){var a=e.$55a(b,g);if(!a){c(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,null);Diag.$2.$9(8914014,341,10,"Cannot get DocumentFile object.");return}c(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,a);Diag.$2.$9(8914015,341,100,"Finished getting text content.")};var b=new Common.$4H(null,this.$$d_$55e,a);if(this.$2yG())b.$6y=true;return b},$2yG:function(){return!!this.$2Sx},$572:function(b){if(!this.$2yG()){var a=(new Box4.$5X).$59(3,0);a.$1o(b.get_$A());return a}else return null},$55e:function(f,e){for(var a=e,b=0;b<this.$3DC;b++)if(a.$1qj.$2j()){if(!a.$1qj.get_$A().get_$MR())continue;var d=Box4.$L.$8O(a.$1qj.get_$A()),c=this.$4Z.$2EG(d);if(c!=="\ufffc")a.$29M+=Box4.$y.$pI(c,"")}else{a.$2OE&&a.$2OE.dispose();a.$2tT(a.$29M);return false}return true},$5Dc:function(){var a=null;if(!this.$2yG()){if(!WordEditor.App.get_$7S()||!WordEditor.App.get_$7S().$1L||!WordEditor.App.get_$7S().$1L.$3o){Diag.$2.$9(8914016,341,10,"Cannot find ContentView in workspace of word frame.");this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext;return null}a=(new Box4.$4A).$1DL(WordEditor.App.get_$7S().$1L.$3o.get_$Bf(),7,7).get_$A()}else a=this.$2Sx;var b=new Box4.$4h;b.$h(a);var c=Box4.$1v.$Fq(b);c.$7y(Box4.$D.$1i7,null);return c},$55a:function(a,c){if(!a&&a!=="")return null;var b=WEAFO.$Ge.$53n(a);if(!this.$4Nj(c,b))return null;var e=WEAFO.$Ge.$5CF(a,c);if(!e)return null;var d=this.$4Z.get_$12e().$3LH(this.$py,b,c,e);d.$2ya=true;Diag.$2.$9(8914017,341,100,"Got DocumentFile; total bytes are "+b);return d},$4Nj:function(a,b){if(a<b&&a%2){Diag.$2.$9(8914018,341,15,"Invalid slice size. It should not be odd number.");this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;return false}return true},$5hZ:function(a){if(a){this.$AJ[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle]=a.$2AU;this.$AJ[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize]=a.$2AX}},$55Z:function(a){this.$1z=a;this.$Ar()}};WEAFO.$Ge.$55f=function(){};WEAFO.$Ge.$55f.prototype={$1qj:null,$29M:null,$2tT:null,$2OE:null};WEAFO.$aJ=function(){WEAFO.$aJ.initializeBase(this)};WEAFO.$aJ.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;Diag.$2.$m(7123608,341,!!this.$4Z.get_$12e(),null);if(this.$4Z&&!isNullOrUndefined(this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle])&&!isNullOrUndefined(this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex])){var f=this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle],a=this.$4Z.get_$12e().$55b(this.$py,f);if(!a)return;var b=this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex];if(b<0||b>=a.$1QV.get_$14()){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange;Diag.$2.$9(7123609,344,15,"The slice index {0} is out of index. File {1}:{2} only has {3} slices",b,this.$py,f,a.$1QV.get_$14());return}var e=false;if(a.$2ya){this.$AJ[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=a.$1QV.get_$5(b);e=true}else try{var c=window.self.atob(a.$1QV.get_$5(b));if(c){for(var g=new Array(c.length),d=0;d<c.length;d++)g[d]=c.charCodeAt(d);this.$AJ[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=g;e=true}}catch(h){Diag.$2.$9(7123610,341,15,"Error happens when converting string data to binary data. "+h.message)}if(e){this.$AJ[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize]=a.$1GI;this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}}};WEAFO.$fL=function(a){this.$$d_$5mK=Function.createDelegate(this,this.$5mK);WEAFO.$fL.initializeBase(this);this.$D5=a};WEAFO.$fL.prototype={$D5:false,$5ET:function(){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(!this.$D5)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else if(!this.$4Z)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{var b=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(b[OSF.DDA.Marshaling.BindingParameterKeys.Id]){var c=b[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();a=this.$4Z.$5mL(c,this.$6e,this.$$d_$5mK)}else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}WordEditor.$5S.$LL(14,this.$6e.$80,this.$1z,null);this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(9225408,341,10,"{0}",{error:a,appId:this.$6e.$80,errMsg:"unexpected error to releaseAppBindingById api"});if(a!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.$1z=a;this.$Ar()}},$5mK:function(a){this.$1z=a;this.$Ar()}};WEAFO.$fM=function(){WEAFO.$fM.initializeBase(this)};WEAFO.$fM.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;Diag.$2.$m(7123613,341,!!this.$4Z.get_$12e(),null);if(this.$4Z&&!isNullOrUndefined(this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle])){var a=this.$91[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle];this.$1z=this.$4Z.get_$12e().$5mO(this.$py,a)}}};WEAFO.$aK=function(){WEAFO.$aK.initializeBase(this)};WEAFO.$aK.prototype={$46:function(){var a=null,b,c;if(this.$4Z&&(c=this.$4Z.$66G(b={val:a}),a=b.val,c)){var d={};d[""+OSF.DDA.Marshaling.FilePropertiesKeys.Url]=a;this.$AJ[""+OSF.DDA.Marshaling.FilePropertiesKeys.Properties]=d;this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}};WEAFO.$aO=function(a,b,c,d){WEAFO.$aO.initializeBase(this);this.$2ac=a;this.$3H=b;this.$cu=c;this.$Jb=d};WEAFO.$aO.prototype={$2ac:false,$3H:null,$cu:0,$Jb:null,$5ET:function(){var k=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData],a=null;if(!this.$4Z)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else if(isNullOrUndefined(k[OSF.DDA.Marshaling.GetDataKeys.CoercionType]))this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{a=k[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();if(a===OSF.DDA.Marshaling.CoercionTypeKeys.Text){var b,e,f;this.$1z=(f=this.$4Z.$2us(e={val:b}),b=e.val,f);this.$147(String,b)}else if(a===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.$3H.$1A("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeTableIsEnabled")){var c,g,h;this.$1z=(h=this.$4Z.$5Bv(g={val:c}),c=g.val,h);this.$147(Object,c)}else if(a===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&this.$3H.$1A("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeMatrixIsEnabled")){var d,i,j;this.$1z=(j=this.$4Z.$5Bs(i={val:d}),d=i.val,j);this.$147(Array,d)}else if(a===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.$2ac){this.$5Bu();return}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}this.$Ub(a)},$5Bu:function(){var a=new WEAFO.$K2(this.$Jb,this.$cu),b=this;a.$2NI(function(){b.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;b.$1UQ(null,a.$PQ)});var c=this;this.$4Z.$5Bt(function(b,d){if(a.get_$2Gu()){WEAFO.$5C.$2HZ(WEAFO.$5C.$Qn(a.$qc),true);return}a.$1gw();c.$1z=b;c.$1UQ(d,a.$PQ)})},$147:function(b,a){if(this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=a},$1UQ:function(a,b){WEAFO.$5C.$LL(true,this.$1z,(a||"").length,WEAFO.$5C.$Qn(b),this.$6e.$80);this.$147(String,a);this.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)},$Ub:function(a){WordEditor.$5S.$LL(1,this.$6e.$80,this.$1z,{CoercionType:a});this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(17385222,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to GetSelectedDataAsync api",CoercionType:a});this.$Ar()},$46:function(){}};WEAFO.$gi=function(b,c,d,e,a){WEAFO.$gi.initializeBase(this);this.$2UR=b;this.$2UT=c;this.$cu=d;this.$Jb=e;this.$3Bx=a;this.$2b2=a.$1A("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeTableIsEnabled");this.$2b1=a.$1A("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeMatrixIsEnabled");this.$2b0=a.$1A("WordEditorAppsForOfficeImageCoercionTypeIsEnabled")};WEAFO.$gi.prototype={$2UR:false,$2UT:false,$2b2:false,$2b1:false,$2b0:false,$cu:0,$Jb:null,$3Bx:null,$5ET:function(){var a=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData],b="";if(!this.$4Z)this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else if(isNullOrUndefined(a[OSF.DDA.Marshaling.SetDataKeys.CoercionType])||isNullOrUndefined(a[OSF.DDA.Marshaling.SetDataKeys.Data]))this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{b=a[OSF.DDA.Marshaling.SetDataKeys.CoercionType].toString();if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Text){this.$5hz(a);return}else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.$2UR){this.$5hu(a);return}else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.$2UT){this.$5hx(a);return}else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.$2b2){this.$5hy(a);return}else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&this.$2b1){this.$5hw(a);return}else if(b===OSF.DDA.Marshaling.CoercionTypeKeys.Image&&this.$2b0){this.$5hv(a);return}else this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}this.$Ub(b)},$5hy:function(c){var b=c[OSF.DDA.Marshaling.SetDataKeys.Data],a=this;this.$4Z.$5yN(b,function(b){a.$1z=b;a.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Table)})},$5hw:function(c){var b=c[OSF.DDA.Marshaling.SetDataKeys.Data],a=this;this.$4Z.$5yL(b,function(b){a.$1z=b;a.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)})},$5hz:function(c){var b=c[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),a=this;this.$4Z.$5yO(b,function(b){a.$1z=b;a.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Text)})},$5hu:function(c){var b=c[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),a=this;this.$4Z.$5yJ(b,function(b){a.$1z=b;a.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})},$5hx:function(e){var b=e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),a=new WEAFO.$K2(this.$Jb,this.$cu),c=this;a.$2NI(function(){c.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;c.$3wT(a.$PQ,b.length)});var d=this;this.$4Z.$5yM(b,function(c){if(a.get_$2Gu()){WEAFO.$5C.$2HZ(WEAFO.$5C.$Qn(a.$qc),false);return}a.$1gw();d.$1z=c;d.$3wT(a.$PQ,b.length)})},$5hv:function(a){var e=a[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),c=a[OSF.DDA.Marshaling.SetDataKeys.ImageWidth],d=a[OSF.DDA.Marshaling.SetDataKeys.ImageHeight];if(c<0||d<0){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;this.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Image);return}var b=this;this.$4Z.$5yK(e,c,d,function(a){b.$1z=a;b.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Image)})},$3wT:function(a,b){WEAFO.$5C.$LL(false,this.$1z,b,WEAFO.$5C.$Qn(a),this.$6e.$80);this.$Ub(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)},$Ub:function(a){WordEditor.$5S.$LL(2,this.$6e.$80,this.$1z,{CoercionType:a});this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(17585946,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to setSelectedDataAsync API",CoercionType:a});this.$Ar()}};WEAFO.$cu=function(){WEAFO.$cu.initializeBase(this)};WEAFO.$cu.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.$4Z){var a=this.$3Rj(this.$4Z.$5Rb(this.$6e));if(a){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;var b={};b.Settings=a;this.$AJ[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=b}}},$3Rj:function(h){var c={},d=0,a=h;for(var b in a){var e={key:b,value:a[b]},f=e.key,g=e.value;c[""+d]=[f,g];d++}return c}};WEAFO.$5C=function(){};WEAFO.$5C.$LL=function(b,c,d,e,f){var a={type:b?"get":"set",error:c,xmlSize:d,latency:Math.max(e,0),appId:f};Diag.$2.$9(7886233,341,50,"{0}",a)};WEAFO.$5C.$2HZ=function(a,b){Diag.$2.$9(7886234,341,50,"{0}",{type:b?"get":"set",delay:Math.max(a,0)})};WEAFO.$5C.$Qn=function(a){return+new Date-a};WEAFO.$fy=function(){WEAFO.$fy.initializeBase(this)};WEAFO.$fy.prototype={$46:function(){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var a=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.SettingsRequest],b=$$as(Array,a[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]);if(this.$4Z)this.$1z=this.$4Z.$5rZ(this.$6e,this.$3Rj(b))},$3Rj:function(c){var d={};if(c)for(var b=0;b<c.length;b++){var a=$$as(Array,c[b]);if(a&&a.length>1)d[a[0]]=a[1]}return d}};WEAFO.$Z9=function(a){this.$$d_$4rM=Function.createDelegate(this,this.$4rM);WEAFO.$Z9.initializeBase(this);this.$2aw=a};WEAFO.$Z9.prototype={$2aw:false,$5ET:function(){if(!this.$2aw){Diag.$2.$9(9291534,341,15,"The Rich App API feature is not enabled.");this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.$Ar();return}if(!this.$4Z){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.$Ar();return}var a=this.$91[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData];if(!a){Diag.$2.$9(9204821,344,10,"The rich api executor input parameter should not be null.");this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;this.$Ar();return}try{var b="00000000-0000-0000-0000-000000000000";this.$4Z.$4rO(a,this.$6e.$80||b,this.$$d_$4rM)}catch(c){Diag.$2.$9(17126306,344,10,"{0}",c.message);this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.$Ar();return}},$4rM:function(a,b){this.$1z=b;if(this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)this.$AJ[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=a;this.$Ar()}};WEAFO.$Us=function(){};WEAFO.$Us.prototype={$5ym:function(a,b){return window.setTimeout(a,b)},$1gw:function(a){window.clearTimeout(a)}};WEAFO.$Ee=function(){WEAFO.$Ee.initializeBase(this)};WEAFO.$Ee.$2nG=function(b){var a=new WEAFO.$Ee;a.$1z=b;return a};WEAFO.$Ee.prototype={$4Z:null};WEAFO.$aQ=function(a,b,c,d){WEAFO.$aQ.initializeBase(this);this.$3Bf=a;this.$2TT=b;this.$2TS=c;this.$Lc=d};WEAFO.$aQ.prototype={$3Bf:null,$2TT:null,$2TS:null,$Lc:false,$5ET:function(){if(!this.$Lc){this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;return}var a=this.$91[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],c=a[OSF.DDA.Marshaling.NavigationKeys.Id].toString(),d=a[OSF.DDA.Marshaling.NavigationKeys.GoToType],b=a[OSF.DDA.Marshaling.NavigationKeys.SelectionMode];if(!this.$5PV(d)||!this.$5PY(b))this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration;else this.$1z=this.$4Z.$5EU(c,b,this.$2TT,this.$2TS,this.$6e);WordEditor.$5S.$LL(15,this.$6e.$80,this.$1z,null);this.$1z===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&Diag.$2.$9(17585945,341,10,"{0}",{error:this.$1z,appId:this.$6e.$80,errMsg:"unexpected error to goToByIdAsync api"})},$5PV:function(a){return a===OSF.DDA.Marshaling.GoToType.Binding},$5PY:function(a){return a===OSF.DDA.Marshaling.SelectionMode.Default||a===OSF.DDA.Marshaling.SelectionMode.Selected||a===OSF.DDA.Marshaling.SelectionMode.None}};WEAFO.$Vq=function(){WEAFO.$Vq.initializeBase(this)};WEAFO.$Vq.prototype={$46:function(){try{var a=this.$91.DdaMethod;OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(a.ControlId,this.$91);this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(b){Diag.$2.$9(17306273,341,10,"AppCommandInvocationCompletedMethod: unexpected exception {0}",b.message);this.$1z=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}this.$Ar()}};WEAFO.$K2=function(a,b){this.$Jb=a;this.$2i9=b;this.$10M=0;this.$PQ=0;this.$qc=0};WEAFO.$K2.prototype={$Jb:null,$2i9:0,$10M:0,$PQ:0,$qc:0,$2NI:function(b){this.$PQ=+new Date;this.$qc=0;var a=this;this.$10M=this.$Jb.$5ym(function(){a.$qc=+new Date;b()},this.$2i9)},$1gw:function(){this.$Jb.$1gw(this.$10M)},get_$2Gu:function(){return!!this.$qc}};WEAFO.$PK=function(a,b,c,d,e,f,g){this.$$d_$5YX=Function.createDelegate(this,this.$5YX);this.$HO=a;this.$AL=b;this.$f=c;this.$2g=d;this.$8d=e;this.$JY=f;this.$9k=g};WEAFO.$PK.prototype={$HO:null,$AL:null,$f:null,$1xJ:null,$2g:null,$8d:null,$JY:null,$9k:null,get_$3gY:function(){return Common.$0.$o.$1A("TableCellRowSelectionIsEnabled")},get_$DN:function(){return this.$8d.get_$Q()},get_$4r4:function(){if(!this.$1xJ)this.$1xJ=Common.Utils.$8.get_$4().$J(WEAFO.$G1);return this.$1xJ},$eJ:function(i,j,g){g.val={};var h=this.$HO.$1RX(j),b=h.$$lge();while(b.$$mn()){var e=b.$$cu();if(e.$VI===i){var a={},c,d,f=(d=this.$3Wc(e,c={val:a}),a=c.val,d);if(f!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return f;g.val[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties]=a;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist},$52z:function(e,f,c){var d=this.$HO.$1RX(f),a=d.$$lge();while(a.$$mn()){var b=a.$$cu();if(b.$VI===e){c.val=b;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}c.val=null;return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist},$3Wc:function(c,a){a.val={};var d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;a.val[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=c.$VI;a.val[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=c.$PD;if(c.$PD===WEAFO.$4E.$8J||c.$PD===WEAFO.$4E.$1Th){var b=null,e,f;d=(f=this.$3bJ(c,e={val:b}),b=e.val,f);if(d===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){a.val[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount]=Box4.$e.$CF(b);a.val[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=Box4.$e.$L6(b);if(c.$PD===WEAFO.$4E.$8J){var g=this.$JY.$1DE(b);a.val[OSF.DDA.Marshaling.AppBindingKeys.HasHeaders]=g>0;a.val[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=Box4.$e.$L6(b)-g}}}return d},$5Cu:function(d,e,c){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;c.val=null;var b=this.$HO.$eJ(d,e);if(!b)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;else a=this.$3bJ(b,c);return a},$3bJ:function(b,d){d.val=null;var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(!b)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;else if(b.$PD!==WEAFO.$4E.$8J&&b.$PD!==WEAFO.$4E.$1Th)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType;else{var c=this.$AL.$SJ(this.$12Y(b.$Qt));if(!c)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else a=this.$2EO(c,d)}return a},$2EO:function(e,b){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;b.val=null;var c=e.get_$9v(),d=e.get_$BP();if(!c||!d||!c.$w(d))a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else{b.val=this.get_$DN().$2C(c);if(!b.val||b.val.get_$19()!==14)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}return a},$2tL:function(j,k,d){var c=null,a=null,b=null,e=this.$HO.$eJ(k,j);if(!e)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;var f=this.$12Y(e.$Qt);c=this.$AL.$SJ(f);if(!c)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;a=c.get_$2k();b=c.get_$1P();if(!a||!b)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else if(a.get_$j0()===b.get_$j0())d.push(a);else if(a.$D.get_$E()===b.$D.get_$E()){d.push(a);d.push(b)}else{var g=a.$D,h=b.$D,i=Box4.$L.$2nQ(g,h);Array.addRange(d,i.$8V())}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$3WG:function(h,f){f.val=[];var e=this.$HO.$1RX(h);if(e){var b=e.$$lge();while(b.$$mn()){var g=b.$$cu(),a,c,d;(d=this.$3Wc(g,c={val:a}),a=c.val,d)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&f.val.push(a)}}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$3qZ:function(g,h){var b=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,d=this.$HO.$eJ(h,g);if(!d)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;var e=d.$Qt,c=this.$12Y(e),a=this.$AL.$SJ(c);if(!a){Diag.$2.$9(17581638,341,10,"The content control bound id : {0} did not exist.",c);return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}var f=this.$HO.$530(e);if(a.get_$3g0()&&f.get_$14()===1){if(this.$AL.$3qa(c))b=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else a.get_$2GW()&&f.get_$14()===1&&a.set_$2GW(false);b===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.$HO.$33H(h,g);return b},$4fN:function(d){var e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,f=2;d.val=0;var a=[],j=this.$f.get_$23().$3f();while(j.$$mn()){var o=j.$$cu();Array.addRange(a,o.$8V())}var b=a[0],c=a[a.length-1];if(a.length===2&&b.$1t===3&&c.$1t===19)c=b;var g=this.$AL.$Ol(b,c,0,false);if(g&&g.get_$14()>0){d.val=g.get_$5(0).get_$E();g.get_$5(0).set_$2GW(true);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(b.$1t===3&&(a.length===1||a.length===2)){e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;f=this.$AL.$26V(b,d)}else if(this.get_$3gY()||this.$f.get_$23().get_$N()===1)if(b.$1t===17&&c.$1t===17){var h,i,k,l,m,n;if(!(l=this.$419(b.$D,k={val:h}),h=k.val,l)||!(n=this.$419(c.$D,m={val:i}),i=m.val,n))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType;e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;f=this.$AL.$1Op(h.get_$E(),i.get_$E(),d)}if(e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return e;if(!f){var p=this.$AL.$SJ(d.val);p.set_$3g0(true);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else{Diag.$2.$9(17585562,341,15,"{0}",{ccError:f,errMsg:"Unable to create content control for selection"});return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType}},$419:function(a,c){c.val=a;if(!a||a.get_$19()!==12)return false;var b=Box4.$E.$13(a);if(b.$1X(14))if(this.$JY.$2Gr(b.$3Z(14)))c.val=b.get_$A();else return false;return true},$54b:function(d,b,c){var a=this.$AL.$SJ(d);if(!a){b.val=null;c.val=null;return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else{b.val=this.get_$DN().$2C(a.get_$9v());c.val=this.get_$DN().$2C(a.get_$BP());return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}},$54Z:function(c,b){var a=this.$AL.$53o(c);if(!a.get_$14()){b.val=0;return OSF.DDA.ErrorCodeManager.errorCodes.ooeNamedItemNotFound}else if(a.get_$14()>1){b.val=0;return OSF.DDA.ErrorCodeManager.errorCodes.ooeMultipleNamedItemFound}b.val=a.get_$5(0).get_$E();a.get_$5(0).set_$2GW(true);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$2DL:function(c,d,a){a.val=null;var b=this.$HO.$eJ(c,d);if(b){a.val=this.$AL.$SJ(this.$12Y(b.$Qt));return!a.val?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist},$3EW:function(d,a){var b=this.$HO.$eJ(d,a.$VI),c=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(b){if(!this.$AL.$SJ(this.$12Y(a.$Qt)))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(b.$Qt===a.$Qt){if(a.$PD===b.$PD)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else c=this.$3qZ(a.$VI,d);if(c!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return c}return this.$HO.$3e8(d,a)},$3Wd:function(e,f,d){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,b=this.$HO.$eJ(e,f);if(!b)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;else{var c=this.$AL.$SJ(this.$12Y(b.$Qt));if(c){d.val=c.$3bS();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}d.val=null;return a},$3vB:function(e,f,g){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,b=this.$HO.$eJ(e,f);if(!b)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;else if(b.$PD!==WEAFO.$4E.$2b)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType;else{var d=this.$12Y(b.$Qt),c=this.$AL.$SJ(d);if(c)if(!c.$3wi(g))a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return a},$3Wb:function(g,h,i,e,f){var b=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,a;f.val={};var c,d;if((d=this.$5Cu(g,h,c={val:a}),a=c.val,d)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)if(e.isPartialTable&&this.$JY.$3gb(a))b=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported;else b=this.$JY.$5Cv(a,i,e,f);return b},$3vA:function(s,t,f,o,p,q,r){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,c=null,b=null,g,h,i,j;if((a=(h=this.$2DL(s,t,g={val:c}),c=g.val,h))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(a=(j=this.$2EO(c,i={val:b}),b=i.val,j))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)if(q.isPartialTable&&this.$JY.$3gb(b))a=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialSetNotSupported;else{var d=null,k,l;a=(l=this.$JY.$66M(b,f,q,k={val:d}),d=k.val,l);if(a===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.$JY.$5P8(f,b,d,p,o)){var e=null,m,n;a=(n=this.$JY.$5gX(d,p,o,m={val:e}),e=m.val,n);if(a===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){r(this.$9k.$5vy(c,e[0],e[1])?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,f?"table":"matrix");return}}else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize}r(a,f?"table":"matrix")},$5Bp:function(){var o=new($$sc.$F.$$(Object)),d=new($$sc.$F.$$(WordEditor.$8O)),i=this.$f.get_$23().$3f();while(i.$$mn()){var p=i.$$cu();d.$1Oy(this.$AL.$Ol(p.get_$11(),p.get_$4i(),1,false))}if(d.get_$14()>0){var t=this.$HO.$531(),w=Box4.$E.$13(this.$f.get_$k5()),u=this.$5OY(),e={},j=d.$$lge();while(j.$$mn()){var q=j.$$cu();e[q.get_$E().toString()]=q}for(var l=Object.keys(e),s=l.length,c=0;c<s;++c){var v=l[c],f=e[v],k=t.$$lge();while(k.$$mn()){var g=k.$$cu(),b=g.appBindingData;if(this.$12Y(b.$Qt)===f.get_$E()){var a={appInstanceId:g.appInstanceId},r=this.$HO.$2ss(g.appInstanceId);if(r)a.appReferenceId=r.$80;a[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=b.$VI;a[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=b.$PD;if(b.$PD===WEAFO.$4E.$8J&&f.get_$9v()&&this.get_$3gY()&&u){var h=null,m,n;n=this.$JY.$5By(this.get_$DN().$2C(f.get_$9v()),true,m={val:h}),h=m.val,n;a[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=h}o.$F(a)}}}}return o},$5OY:function(){var a=Box4.$E.$13(this.$f.get_$k5());if(a.$L4()<=1)return true;var b=a.$3u(),c=null;while(b){var d=Box4.$E.$13(b);if(!d.$1X(16))return false;if(!c)c=d.$3Z(16);else if(c!==d.$3Z(16))return false;b=a.$QO()}return true},$3qu:function(c,d){var a=c.$1HS,b=this.get_$4r4().$2sp(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent);b.$2X(a,null,d)},$LL:function(d,e,f){var a=this.$HO.$2ss(d),b=this.$HO.$eJ(a,e),c={method:f,appId:!a?null:a.$80,bindingType:!b?null:b.$PD};Diag.$2.$9(16798856,341,50,"{0}",c)},$12Y:function(c){var a=Number.parseInvariant(c),b=-2147483648;return a<Math.abs(b)?a:a+b*2},$2sy:function(a){if(a>-1)return a.toString();var b=-2147483648;a=a-b*2;return a.toString()},$5lN:function(){var a=this.$$d_$5YX;this.$AL.$4B9(a)},$5YX:function(t,s){for(var d=this.$HO.$2sl(),e=new($$sc.$F.$$($$sc.$F.$$(Common.App.AppsForOfficeCommon.$AL))),g=0;g<d.get_$14();++g){var o=d.get_$5(g),p=this.$HO.$1RX(o);e.$F(p)}var f=this.$HO.$2sl(),b=new($$sc.$F.$$($$sc.$F.$$(Common.App.AppsForOfficeCommon.$AL))),i=s.$2QU.$$lge();while(i.$$mn())for(var q=i.$$cu(),r=this.$2sy(q.get_$E()),c=0;c<e.get_$14();++c){var h=new($$sc.$F.$$(Common.App.AppsForOfficeCommon.$AL)),j=e.get_$5(c).$$lge();while(j.$$mn()){var l=j.$$cu();r===l.$Qt&&h.$F(l)}if(h.get_$14()>0){f.$F(d.get_$5(c));b.$F(h)}}if(b.get_$14()>0){var m=this.$2g.$59(15,0);m.$1o(this.$HO.$eR());for(var a=0;a<b.get_$14();++a){var k=b.get_$5(a).$$lge();while(k.$$mn()){var n=k.$$cu();this.$3qu(f.get_$5(a),n.$VI);this.$HO.$33H(f.get_$5(a),n.$VI)}}m.dispose()}},$3NF:function(e,f,g){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,b=null,c,d;if((a=(d=this.$2DL(f,e,c={val:b}),b=c.val,d))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)a=this.$9k.$4la(b)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;g(a)},$3FB:function(j,k,h,l){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,b=null,c=null,d,e,f,g;if((a=(e=this.$2DL(k,j,d={val:b}),b=d.val,e))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(a=(g=this.$2EO(b,f={val:c}),c=f.val,g))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){var i=Box4.$e.$CF(c);if(this.$JY.$5Ko(i,h))a=this.$9k.$4Gi(b,h)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize}l(a)},$3Ec:function(m,n,o,p,q,r){var a=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,b=null,c=null,e,f,g,h;if((a=(f=this.$2DL(n,m,e={val:b}),b=e.val,f))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(a=(h=this.$2EO(b,g={val:c}),c=g.val,h))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){var l=Box4.$e.$L6(c),k=this.$JY.$1DE(c),d=null,i,j;if(j=this.$JY.$5Kn(k,l-k,o,p,q,i={val:d}),d=i.val,j)a=this.$9k.$4Gf(b,d)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else a=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize}r(a)}};WEAFO.$Y7=function(){};WEAFO.$Y7.prototype={CustomXmlId:null,NodeListCacheId:null,NodeIndex:0};WEAFO.$QD=function(){};WEAFO.$QD.prototype={$2vM:function(a,b,c){var d;c.val=null;b.val=null;try{d=Common.Utils.$8.get_$4().$J(WEAFO.$ML).$BQ(a.NodeListCacheId)}catch(e){return this.$564(e)}c.val=d[a.NodeIndex];b.val=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(a.CustomXmlId);return!isNullOrUndefined(b.val)&&!isNullOrUndefined(c.val)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError},$40Z:function(f,g){for(var h=[],i=Common.Utils.$8.get_$4().$J(WEAFO.$ML).$F(f,g),e=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(f),b,c=0;c<g.length;c++){b=g[c];var d=new WEAFO.$Y7;d.CustomXmlId=f;d.NodeListCacheId=i;d.NodeIndex=c;var a={};a.DataNodeHandle=d;a.DataNodeBaseName=e.$59Z(b);a.DataNodeNamespaceUri=e.$59c(b);a.DataNodeType=e.$59d(b);h.push(a)}return h},$564:function(a){return a.message.indexOf(":")<0?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:a.message.split(":")[1].trim()==="outOfDate"?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlOutOfDate:a.message.split(":")[1].trim()==="exceedQuota"?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlExceedQuota:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}};WEAFO.$QE=function(a,b){this.$1wR=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(a);this.$2j5=b};WEAFO.$QE.prototype={$1wR:null,$2j5:null,get_$4kw:function(){return this.$1wR.$y}};WEAFO.$QF=function(a){this.$YO=new(Common.Collections.$2d.$$(String,WEAFO.$QE));this.$1be=new($$sc.$F.$$(String));this.$2e3=new($$sc.$F.$$(String));this.$2XU=new($$sc.$F.$$(String));this.$2V8=a};WEAFO.$QF.prototype={$2V8:null,$F:function(d,c){if(!c)return null;if(this.$1be.get_$14()>=this.$2V8.get_$Q()){var b=this.$1be.get_$5(0);this.$3NG(b);this.$2XU.$F(b);Diag.$2.$9(9187593,341,50,"Put the first custom xml node list id: {0} in exceeded quota array as the added custom xml touches the quota which is 1024",b)}var a=Common.$1O.$x().toString();this.$YO.$F(a,new WEAFO.$QE(d,c));this.$1be.$F(a);return a},$BQ:function(a){var b=this.$YO.get_$5(a);if(isNullOrUndefined(b))if(this.$2e3.$2FS(a)>-1){Diag.$2.$9(9187594,341,50,"Custom xml node list id: {0} is in out of date array",a);throw Error.invalidOperation("outOfDate");}else if(this.$2XU.$2FS(a)>-1){Diag.$2.$9(9187595,341,50,"Custom xml node list id: {0} is in exceeded quota array where the quota is 1024",a);throw Error.invalidOperation("exceedQuota");}else return null;else{var c=Common.Utils.$8.get_$4().$J(WECX.$Ah).$uP(b.get_$4kw());if(c!==b.$1wR){this.$3NG(a);this.$2e3.$F(a);Diag.$2.$9(9187596,341,50,"Put custom xml node list id: {0} in out of date array as the custom xml document has been changed",a);throw Error.invalidOperation("outOfDate");}}return b.$2j5},$3NG:function(a){this.$YO.$73(a);this.$1be.$73(a)}};WEAFO.$LA=function(a,b,c,d){this.$2AU=a;this.$2AX=b;this.$1GI=c;this.$1QV=d};WEAFO.$LA.prototype={$2AU:0,$2AX:0,$1GI:0,$1QV:null,$2ya:false};WEAFO.$CF=function(a,b,c,d,e,f,g){this.$$d_$3ku=Function.createDelegate(this,this.$3ku);this.$$d_$5sy=Function.createDelegate(this,this.$5sy);this.$$d_$5mP=Function.createDelegate(this,this.$5mP);this.$qV=a;this.$Pp=b;this.$cy=c;this.$1Ic=d;this.$Yf=new($$sc.$3j.$$($$sc.$9P.$$(WEAFO.$LA)));this.$4A=e;this.$3H=f;this.$2cf=this.$3H.$5L("WordEditorAppsForOfficeGetFileApiMaxNumberOfCachedFile",1);this.$No=g;this.$No.add_$31F(this.$$d_$5mP)};WEAFO.$CF.$4IY=function(a){return new Box4.$Cn(1,a)};WEAFO.$CF.prototype={$lQ:null,$qV:null,$cy:null,$Pp:null,$1Ic:null,$4A:null,$3H:null,$No:null,$Lw:null,$2cf:0,$Yf:null,$55c:function(b,c,d,e){if(this.$4A)this.$Lw=this.$4A.$8G("UserAction","GetFileAgaveApi");var a=new WEAFO.$aL(b,c,d,e);this.$3Rb(a)},$3Rb:function(a){WordEditor.$3g.$ng(10,false,this.$$d_$5sy,this.$$d_$3ku,a,null,null)},$5sy:function(e){var a=e;if(this.$Pp&&this.$cy){var d=WEAFO.$Lo.$Jh(this.$Pp,this.$cy.$2Dg(this.$1Ic),a.$iP,a.$1GI);this.$lQ=new Box4.$Bm;this.$lQ.set_$MV(d);this.$lQ.$3I=1;var b=this,c=this.$qV(function(){b.$2p0();if(b.$lQ.$HF!==2||!b.$lQ.$8Z||!b.$lQ.$8Z.length||!b.$lQ.$8Z[0]){Diag.$2.$9(7123614,344,15,"Fail to obtain the file.");a.$Bt(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null);return}var c=b.$lQ.$8Z[0];if(typeof c.FileData==="undefined"){Diag.$2.$9(8426762,344,15,"Undefined error possibly because we failed to obtain or convert the file");a.$Bt(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null);return}if(b.$3f4(a.$1gC)){Diag.$2.$9(7123615,344,15,"App {0} has reach the limit of number of cached files.",a.$1gC);a.$Bt(OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit,null);return}var d=new($$sc.$F.$$(String));Array.forEach(c.FileData,function(a){d.$F(a.toString())});var e=b.$3LH(a.$1gC,c.FileSize,a.$1GI,d);a.$Bt(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,e)});c.$Rm(this.$lQ);c.$tP()}else{this.$2p0();a.$Bt(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)}},$3LH:function(c,d,e,f){var b=WEAFO.$CF.$3C3++,a=new WEAFO.$LA(b,d,e,f);this.$4BC(c,a);return a},$3ku:function(b){this.$2p0();Diag.$2.$9(7123616,344,15,"Fail to force save the file.");var a=b;a.$Bt(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)},$2p0:function(){if(this.$Lw){this.$Lw.$4x();this.$Lw=null}},$4BC:function(a,b){!this.$Yf.$30(a)&&this.$Yf.set_$5(a,new($$sc.$9P.$$(WEAFO.$LA)));this.$Yf.get_$5(a).set_$5(b.$2AU,b)},$55b:function(b,e){var a=null;if(this.$Yf.$30(b)){var c,d;d=this.$Yf.get_$5(b).$9F(e,c={val:a}),a=c.val,d}!a&&Diag.$2.$9(7123617,344,15,"File {0}:{1} doesn't exist",b,e);return a},$3f4:function(a){return!this.$Yf.$30(a)?false:this.$Yf.get_$5(a).get_$14()>=this.$2cf},$5mO:function(a,b){return this.$Yf.$30(a)?this.$Yf.get_$5(a).$73(b)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError},$5mP:function(b,a){this.$Yf.$30(a)&&this.$Yf.$73(a)}};WEAFO.$aL=function(a,b,c,d){this.$1gC=a;this.$iP=b;this.$1GI=c;this.$Bt=d};WEAFO.$aL.prototype={$1gC:null,$iP:0,$1GI:0,$Bt:null};WEAFO.$gV=function(a){this.AN=a};WEAFO.$gV.prototype={AN:null};WEAFO.$TN=function(a){this.$zS=a};WEAFO.$TN.prototype={$zS:null,$1Rs:function(b,c,d){var a=this.$3Hs(b,true);this.$zS.$3Zu(a,c,d)},$36T:function(b,c,d,e){var a=this.$3Hs(b,true);this.$zS.$3w8(a,c,d,e)},$3Hs:function(a,c){if(Common.$2l.$oX(a))return null;var b=[new Box4.$4S(a,c)];return new Box4.$4i(b,0,-1)}};WEAFO.$TO=function(a,b,c,d,e){this.$$d_$vY=Function.createDelegate(this,this.$vY);this.$$d_$1F8=Function.createDelegate(this,this.$1F8);this.$$d_$5gR=Function.createDelegate(this,this.$5gR);this.$$d_$5gM=Function.createDelegate(this,this.$5gM);this.$2gd=WordEditorIntl.WordEditorStrings.L_Inserting;this.$ZH=a;this.$1zG=b;this.$Pp=c;this.$WN=d;this.$1xl=e};WEAFO.$TO.prototype={$ZH:null,$1zG:null,$Pp:null,$WN:null,$1xl:null,$3Zu:function(a,b,c){var d=this;this.$3Pj(a,b,c,"ForceSaveAndGetOoXmlForSelection",false,this.$$d_$5gM,null,null,function(a,b,c){return Box4.$NH.$Jh(a,b,c)})},$3w8:function(d,b,c,a){if(isNullOrUndefined(b)){this.$oj("Agave sent NULL OOXML");a(4);return}if(!this.$1zG()){this.$oj("Document is non-coauthorable. Disabled for SET OOXML");a(6);return}var e=this;this.$3Pj(d,function(){c&&c()},a,"ForceSaveAndSetOoXmlForSelection",true,this.$$d_$5gR,b,this.$2gd,Box4.$NI.$Jh)},$3Pj:function(r,C,c,D,E,F,s,G,H){var b=this.$ZH.$8G("Task",D),a={};try{var i=0,j=0,k=0,l=0;if(!r){this.$oj("SelectionCollection is null");this.$dg(b);c(9);return}var d=r.get_$1Z();if(!d){this.$dg(b);c(2);return}if(Box4.$D.$un(d)){this.$oj("User has selected an anchored object and it's not yet supported.");this.$dg(b);c(8);return}var t=d.get_$11(),u=d.get_$4i(),f=t.$D,h=u.$D;i=f.$R(Number,Box4.AppProperties.$1.$3v,0);k=h.$R(Number,Box4.AppProperties.$1.$3v,0);j=Box4.$53.$2DN(d,true);l=Box4.$53.$2DN(d,false);a.startParaId=i;a.endParaId=k;a.cpBegin=j;a.cpEnd=l;if(!this.$WN){this.$oj("IWordTextOffsetTranslator is null as it did not resolve");this.$dg(b);c(5);return}var m=this.$WN.$14F(f.$55,f.$i),n=this.$WN.$1Gz(m,j),v=n;m=this.$WN.$14F(h.$55,h.$i);n=this.$WN.$1Gz(m,l);var w=n,o=f.$R(Number,Box4.AppProperties.$1.$C1,2147483646),p=h.$R(Number,Box4.AppProperties.$1.$C1,2147483646);a.textIdStart=o;a.textIdEnd=p;var e=f.$bb;a.documentKind=Box4.$BG.toString(e);if(e===-1||e===1||e===2){this.$oj("Unsupported DocumentKind is "+e);this.$dg(b);c(2);return}var x=new WEDOT.$Bz(1,i,o,v,k,p,w,e),y=new WEAFO.$gV(WEDOT.$AB.$3tr(x)),z=Common.$1s.$5B(y),A=H(this.$Pp,this.$1zG(),z,s),g,q=(g=new Box4.$Bm,g.set_$MV(A),g.$3I=1,g),B=new WEAFO.$do(C,c,q,b,s,F);this.$1xl(11,E,this.$$d_$1F8,this.$$d_$vY,B,G,q)}catch(I){this.$oj("failed in the call to GetOoxmlForSelection. most likely during ForceSave. [e:{0}] [logData: {1}] [callstack: {2}]",I.message,a,I.stack);this.$dg(b);c(0)}},$vY:function(b){var a=b;this.$dg(a.$1IC);a.$kM&&a.$kM(3)},$1F8:function(d){var a=d,b=a.$1YD.$8Z;if(!b){this.$1UP("response list is null",a,0);return}if(!b.length){this.$1UP("response list is empty",a,0);return}var c=a.$1YD.$8Z[0];if(!c){this.$1UP("ooxml response is null",a,0);return}if(c.StatusCode){if(!this.$5Ph(a.$2SL))this.$1UP("Agave sent malformated OOXML",a,7);else this.$1UP("ooxml failed for an unknown reason",a,0);return}a.$2Sb(a)},$1UP:function(b,a,c){this.$oj("[reason:{0}].",b);a.$kM&&a.$kM(c)},$5Ph:function(f){var a=true,d=this.$ZH.$8G("Task","SetOoxmlIsValidXML");try{var b=Sys.Net.XMLDOM(f);if(b.getElementsByTagName("parsererror").length>0)a=false;else{var c=b.parseError;if(!isNullOrUndefined(c)){var e=c.errorCode;if(e)a=false}}}catch(g){a=true;this.$oj("Failed in parsing the xml string: [message: {0}] [callstack: {1}]",g.message,g.stack)}finally{d.$4x()}return a},$dg:function(a){a&&a.$4x()},$5gM:function(a){var b=a.$1YD.$8Z[0];if(!b.OoXml){this.$1UP("ooxml is null",a,0);return}a.$kk&&a.$kk(b.OoXml);this.$dg(a.$1IC)},$5gR:function(b){var a=this;Common.$1J.get_$4().$2f(new Common.$1e(1,1,0,function(){a.$1xl(11,true,function(){Box4.App.$7j.$37y(function(){b.$kk(null)});a.$dg(b.$1IC)},function(d,c){a.$dg(b.$1IC);a.$oj("we succeeded to set ooxml but failed in the second save, most likely, the user can't see the change yet. [errorCode: {0}]",c);b.$kk(null)},null,a.$2gd,null)}))},$oj:function(c){for(var b=[],a=1;a<arguments.length;++a)b[a-1]=arguments[a];Diag.$2.$9.apply(null,[7902996,341,15,"OoXml Operation Failed. "+c].concat(b))}};WEAFO.$do=function(a,b,c,d,e,f){this.$kk=a;this.$kM=b;this.$1YD=c;this.$1IC=d;this.$2SL=e;this.$2Sb=f};WEAFO.$do.prototype={$kk:null,$kM:null,$1YD:null,$1IC:null,$2SL:null,$2Sb:null};WEAFO.$Jz=function(a,b){this.$K=a;this.$f=b};WEAFO.$Jz.prototype={$K:null,$f:null,$5NQ:function(){!this.$f.get_$k5()&&Diag.$2.$9(8452246,341,15,"Unexpected error to selectionManager and the selectionRoot cannot return");var a=Box4.$E.$13(this.$f.get_$k5());return a.$L4()>1},$39S:function(b){b.val=null;var a=Box4.$E.$13(this.$f.get_$k5());if(a.$3u()){var c=Box4.$E.$13(a.get_$A());if(a.get_$ux()&&a.$3u()&&Box4.$e.$Ed(a))b.val=a.get_$A();else if(c.$1X(14))b.val=c.$3Z(14)}return b.val?true:false},$66O:function(i,c,d){d.val="";for(var a=null,b=0;b<c.length;b++)if(i.$w(c[b].$D)){a=c[b];break}if(a){var e=Box4.$A.$2b(a.$D);switch(a.$1t){case 17:d.val+=e;break;case 3:var f=a.$j,h=a.$1i,g=h-f;if(g>0)d.val+=e.substr(f,g);break;case 19:break;default:Diag.$2.$9(8452249,341,15,"Unexpected context type when trying get selected text of paragraph node, context type is:"+a.$1t);return false}return true}return false},$40u:function(p,n,o,b){b.val="";for(var c=false,a=Box4.$E.$13(p),l=a.$L4(),d=0;d<l;d++){if(a.$1De(d)){a.$3u();if(a.get_$52()===12){if(o)b.val+=Box4.$A.$2b(a.get_$A());else{var e="",h,i;if(i=this.$66O(a.get_$A(),n,h={val:e}),e=h.val,i){b.val+=e;c=true}}if(d!==l-1)b.val+="\r"}else if(a.get_$52()===14){var m=a.$1J(1);while(m){var f=a.$1J(1);while(f){var g="",j,k;c=(k=this.$40u(f,n,o,j={val:g}),g=j.val,k)||c;b.val+=g;if(!a.get_$ux())b.val+="\t";f=a.$QO()}b.val+="\r\n";m=a.$QO()}}a.$1M()}a.$1M()}return c},$3as:function(t,b){b.val={};b.val.rows=[];b.val.headers=[];var c,j,k;if(!(k=this.$39S(j={val:c}),c=j.val,k))return OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionNotSupportCoercionType;var d=Box4.$E.$13(c),n=[],g={};if((g.isSelectionManagerNull=!this.$f)||(g.isSelectionCollectionNull=!this.$f.get_$23())){Diag.$2.$9(8452252,341,10,"Unexpected error to selectionManager and contigousSelection data cannot return.{0}",g);return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}var i=this.$f.get_$23().$3f();while(i.$$mn()){var s=i.$$cu();Array.addRange(n,s.$8V())}var e=[],a=false,r=this.$1DE(c),o=0,p=d.$1J(1);while(p){a=false;if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&o<r)a=true;var f=d.$1J(1);while(f){if(!Box4.$g.$LH(f)){var h="",l,m;((m=this.$40u(f,n,a,l={val:h}),h=l.val,m)||a)&&Array.add(e,h)}f=d.$QO()}if(e.length>0){var q=Array.clone(e);if(a)Array.add(b.val.headers,q);else Array.add(b.val.rows,q);Array.clear(e)}p=d.$QO();o++}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},$3wU:function(b,c,a){if(this.$5NQ())if(this.$5MH()){this.$2nW(b,c,a,false);return}else{a(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection);return}else{var d,h,i;if(i=this.$39S(h={val:d}),d=h.val,i){var f,n,g,e,j,k,l,m;this.$5Bw(d,j={val:f},k={val:n},l={val:g},m={val:e}),f=j.val,n=k.val,g=l.val,e=m.val;if(f){Diag.$2.$9(8458370,344,15,"SetSelectedTable failed due to the attempt to set data in a partially selected table");a(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection);return}else if(this.$5OU(e,g,c,b))this.$4sB(d,e,b,c,a);else this.$2nW(b,c,a,true)}else this.$2nW(b,c,a,false)}},$5DO:function(e,c){c.val="";if(Box4.$g.$LH(e))return false;for(var a=Box4.$E.$13(e),d=a.$L4(),b=0;b<d;b++){if(a.$1De(b)){a.$3u();if(a.get_$52()===12){c.val+=Box4.$A.$2b(a.get_$A());if(b!==d-1)c.val+="\r"}a.$1M()}a.$1M()}return true},$3gb:function(b){var a=false,c=this;Box4.$e.$3Rf(b,function(b){if(Box4.$g.$LH(b))a=true});return a},$5Cv:function(g,m,h,q){var n=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;q.val=null;var c={},i=this.$1DE(g),j=Box4.$e.$L6(g)-(m?i:0),k=Box4.$e.$CF(g),a,d,b,e,o,p;a=h[OSF.DDA.Marshaling.BindingParameterKeys.StartRow];d=h[OSF.DDA.Marshaling.BindingParameterKeys.RowCount];b=h[OSF.DDA.Marshaling.BindingParameterKeys.StartCol];e=h[OSF.DDA.Marshaling.BindingParameterKeys.ColCount];if(a<0||a>=j||a+d>j||b<0||b>=k||b+e>k)n=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn;else{o=!d?j:a+d-1;p=!e?k:b+e-1;var s=Box4.$E.$13(g),f=[],l;c.rows=[];c.headers=[];var r=this;Box4.$T.$Zq(s,function(h,d,j){var k=m&&d<i,n=m?i:0,q=d>=a+n&&d<=o+n,s=j>=b&&j<=p;if((k||q)&&s){var e,g;(g=r.$5DO(h.get_$A(),e={val:l}),l=e.val,g)&&Array.add(f,l)}if(h.get_$ux()&&f.length>0){var t=Array.clone(f);Array.add(k?c.headers:c.rows,t);Array.clear(f)}return true})}q.val=c;return n},$1DE:function(e){var f=Box4.$V.$4P.$2Dl(e);if(!(f&32))return 0;var b=0,c=false,d=Box4.$E.$13(e),a=d.$3u();while(a){if(a.$R(Boolean,Box4.AppProperties.$1.$2Gs,false)){c=true;b++}a=d.$QO()}return c?b:1},$Ed:function(a,b){if(a.get_$E()===b.get_$E())if(a.get_$19()===14)return true;return false},$2Gr:function(a){if(!a||a.get_$19()!==14)return false;var b=true,e=this.$2sn(),c=new Box4.$E;c.$h(a);var d=this;Box4.$T.$Zq(c,function(a){if(!Box4.$g.$LH(a.get_$A()))if(!d.$2xZ(a.get_$A(),e)){b=false;return false}return true});return b},$5OV:function(){var a,b,c;return!(c=this.$39S(b={val:a}),a=b.val,c)?false:this.$2Gr(a)},$4sB:function(d,e,f,g,c){var b=1110196777,a=[];Array.add(a,e);Array.add(a,f);Array.add(a,g);Array.add(a,d);if(this.$K.$2u(b,1)===32){var h=this;this.$K.$vj(null,b,2,a,function(a){a.$8Y!==32&&Diag.$2.$9(8458371,344,10,"SetSelectedTable failed with error {0}",a.$8Y);c(a.$8Y===32?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},null)}else{Diag.$2.$9(8458372,344,10,"SetSelectedTable failed due to the action is not enabled");c(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}},$2nW:function(e,f,c,g){if(g)this.$K.$2u(1819681963,2);else this.$K.$2u(2887293604,2);var d=this.$4RF(e,f),a=new Common.$3L;a.$M(Box4.AppProperties.$K.$fA,d);a.$M(Box4.AppProperties.$K.$pR,true);var b=1745735045;if(this.$K.$2u(b,1)===32){var h=this;this.$K.$vj(null,b,2,a,function(a){c(a.$8Y===32?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},null)}else c(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)},$4RF:function(a,o){var p="div",q="table",r="th",g="tr",s="td",t="border",u="1",h="",i=document.createElement(p),b=document.createElement(q),j=document.createAttribute(t);j.value=u;b.attributes.setNamedItem(j);i.appendChild(b);if(a&&a.length){var k=document.createElement(g);b.appendChild(k);for(var c=0;c<a.length;++c){var l=document.createElement(r);l.innerText=!a[c]?h:a[c].toString();k.appendChild(l)}}for(var e=0;e<o.length;++e){var f=o[e],m=document.createElement(g);b.appendChild(m);for(var d=0;d<f.length;++d){var n=document.createElement(s);n.innerText=!f[d]?h:f[d].toString();m.appendChild(n)}}return i.innerHTML},$5OU:function(a,k,d,e){if(a.length!==d.length+(!e?0:1))return false;if(e){var f=a[0];if(f.length<e.length)return false;for(var b=1;b<a.length;++b){var g=d[b-1],h=a[b];if(h.length<g.length)return false}}else for(var c=0;c<a.length;++c){var i=d[c],j=a[c];if(j.length<i.length)return false}return true},$2sn:function(){var b=[],a=this.$f.get_$23().$3f();while(a.$$mn()){var c=a.$$cu();Array.addRange(b,c.$8V())}return b},$5Bw:function(k,f,g,h,i){f.val=false;g.val=false;h.val=false;i.val=[];var j=this.$2sn(),a=Box4.$E.$13(k),c=a.$1J(1),d=true;while(c){var e=[],b=a.$1J(1);while(b){if(!Box4.$g.$LH(b))if(this.$2xZ(b,j)){if(d)h.val=true;Array.add(e,b)}else f.val=true;else g.val=true;b=a.$8j()}d=false;Array.add(i.val,e);a.$1M();c=a.$8j()}},$2xZ:function(h,c){for(var f=this.$3YD(h),g=this.$3Z7(h),a=0,b=false;a<c.length;++a){var d=c[a];if(d.$D===f)if(d.$1t===17||d.$1t===19){b=true;++a;break}else return false}if(!b||f===g)return b;for(;a<c.length;++a){var e=c[a];if(e.$D===g)if(e.$1t===17||e.$1t===19){b=true;break}else return false}return b},$Bv:function(e,c){for(var a,b=0;b<c.length;++b){var d=c[b].$D;a=Box4.$E.$13(d);if(a.$1X(16)&&a.$3Z(16)===e)return true}return false},$3Z7:function(e){for(var a=Box4.$E.$13(e),d=a.$L4(),b=d-1;b>-1;--b){if(a.$1De(b)){a.$3u();if(a.get_$52()===12)return a.get_$A();else if(a.get_$52()===14){var c=this.$3Z7(a.get_$A());if(c)return c}a.$1M()}a.$1M()}return null},$3YD:function(e){for(var a=Box4.$E.$13(e),d=a.$L4(),b=0;b<d;++b){if(a.$1De(b)){a.$3u();if(a.get_$52()===12)return a.get_$A();else if(a.get_$52()===14){var c=this.$3YD(a.get_$A());if(c)return c}a.$1M()}a.$1M()}return null},$5MH:function(){var b=null,c=null,a=Box4.$E.$13(this.$f.get_$k5());if(a.$L4()>0)if(a.$3u())if(a.$3u()&&a.get_$52()===14)b=a.get_$A();a=Box4.$E.$13(this.$f.get_$k5());if(a.$L4()>1)if(a.$UM())if(a.$3u()&&a.get_$52()===14)c=a.get_$A();return b&&!this.$2Gr(b)||c&&!this.$2Gr(c)?false:true},$5By:function(g,l,e){e.val={};var h=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(g.$j9())return OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported;var j=this.$2sn(),k=Box4.$E.$13(g),a=-1,b=-1,c=-1,d=-1,i=this;Box4.$T.$Zq(k,function(g,f,e){if(i.$Bv(g.get_$A(),j)){if(a===-1||b===-1){a=f;b=e}c=c<f?f:c;d=d<e?e:d}else if(b>-1&&e>=b&&e<=d)return false;return true});if(h===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){var f=l?this.$1DE(g):0;if(c>=f){a=a>=f?a-f:0;e.val[OSF.DDA.Marshaling.TableSubsetKeys.StartRow]=a;e.val[OSF.DDA.Marshaling.TableSubsetKeys.RowCount]=c-f-a+1}e.val[OSF.DDA.Marshaling.TableSubsetKeys.StartColumn]=b;e.val[OSF.DDA.Marshaling.TableSubsetKeys.ColumnCount]=d-b+1}return h},$5Ko:function(d,c){for(var b=0,a=0;a<c.length;a++)if(c[a].length>b)b=c[a].length;return b===d},$5Kn:function(b,e,a,c,f,d){d.val=[];if(!f)a=new Array(b);if(!a&&!b||a&&a.length===b)if(e===c.length){d.val=a.concat(c);return true}return false},$5P8:function(k,l,e,b,f){var c=k?this.$1DE(l):0;if(!e||!b||e.length<b.length+c)return false;if(f){if(f.length!==c)return false;for(var a=0;a<b.length+c;a++){var g=e[a],h=a<c?f[a]:b[a-c];if(g.length<h.length)return false}}else for(var d=0;d<b.length;d++){var i=e[d],j=b[d];if(i.length<j.length)return false}return true},$66M:function(g,h,i,j){var k=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;j.val=[];var b=0,c=0;b=i.startRow;c=i.startCol;var d=this.$1DE(g),l=h?d:0,a=[],e=[],f=Box4.$E.$13(g),m=this;Box4.$T.$Zq(f,function(g,i,j){if(!Box4.$g.$An(f)){var k=h&&i<d,m=i>=b+l,n=j>=c;(k||m)&&n&&a.push(g.get_$A());if(g.get_$ux()&&a.length>0){var o=Array.clone(a);Array.add(e,o);Array.clear(a)}}return true});j.val=e;return k},$5gX:function(l,i,d,e){var j=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;e.val=[];for(var f=[],g=[],c=!d?0:d.length,a=0;a<i.length+c;a++)for(var h=a<c?d[a]:i[a-c],k=l[a],b=0;b<h.length;b++){Array.add(f,k[b]);Array.add(g,h[b])}Array.add(e.val,f);Array.add(e.val,g);return j}};WEAFO.$Lo=function(){WEAFO.$Lo.initializeBase(this)};WEAFO.$Lo.$Jh=function(b,c,d,e){var a=new WEAFO.$Lo;a.FileId=b;a.IsCoauthorable=c;a.FileType=d;a.SliceSize=e;return a};WEAFO.$Lo.prototype={FileId:null,IsCoauthorable:false,FileType:0,SliceSize:0,$12a:function(){return 40}};WEAFO.$sY=function(){WEAFO.$sY.initializeBase(this)};WEAFO.$sY.prototype={FileData:null,FileSize:0};WEAFO.$4E.registerClass("WEAFO.$4E");WEAFO.$KW.registerClass("WEAFO.$KW");WEAFO.$W6.registerClass("WEAFO.$W6",Common.App.AppsForOfficeCommon.$rT);WEAFO.$qL.registerClass("WEAFO.$qL");WEAFO.$Oo.registerClass("WEAFO.$Oo",null,Common.App.AppsForOfficeCommon.$ak);WEAFO.$Ux.registerClass("WEAFO.$Ux",null,Common.App.AppsForOfficeCommon.$R9,Sys.IDisposable);WEAFO.$KB.registerClass("WEAFO.$KB",B4Apps.$qt,WEAFO.$cS,B4Apps.$k1);WEAFO.$Ho.registerClass("WEAFO.$Ho",null,Common.App.AppsForOfficeCommon.$ap);WEAFO.$Op.registerClass("WEAFO.$Op",Common.App.AppsForOfficeCommon.$rR);WEAFO.$Oq.registerClass("WEAFO.$Oq",null,Common.App.AppsForOfficeCommon.$MC,Sys.IDisposable);WEAFO.$G0.registerClass("WEAFO.$G0",Common.App.AppsForOfficeCommon.$9i);WEAFO.$G1.registerClass("WEAFO.$G1",Common.App.AppsForOfficeCommon.$rN);WEAFO.$9d.registerClass("WEAFO.$9d",Common.App.AppsForOfficeCommon.$rP);WEAFO.$sV.registerClass("WEAFO.$sV",Common.App.AppsForOfficeCommon.$Vo);WEAFO.$BA.registerClass("WEAFO.$BA",WEAFO.$sV);WEAFO.$BH.registerClass("WEAFO.$BH",WEAFO.$sV);WEAFO.$Ee.registerClass("WEAFO.$Ee",Common.App.AppsForOfficeCommon.$rO);WEAFO.$VK.registerClass("WEAFO.$VK",WEAFO.$Ee);WEAFO.$VJ.registerClass("WEAFO.$VJ",WEAFO.$Ee);WEAFO.$VM.registerClass("WEAFO.$VM",WEAFO.$Ee);WEAFO.$VZ.registerClass("WEAFO.$VZ",WEAFO.$Ee);WEAFO.$Va.registerClass("WEAFO.$Va",WEAFO.$Ee);WEAFO.$YS.registerClass("WEAFO.$YS",WEAFO.$Ee);WEAFO.$a6.registerClass("WEAFO.$a6",WEAFO.$Ee);WEAFO.$a8.registerClass("WEAFO.$a8",WEAFO.$Ee);WEAFO.$a9.registerClass("WEAFO.$a9",WEAFO.$Ee);WEAFO.$aD.registerClass("WEAFO.$aD",WEAFO.$Ee);WEAFO.$aF.registerClass("WEAFO.$aF",WEAFO.$Ee);WEAFO.$aG.registerClass("WEAFO.$aG",WEAFO.$Ee);WEAFO.$aE.registerClass("WEAFO.$aE",WEAFO.$Ee);WEAFO.$YP.registerClass("WEAFO.$YP",WEAFO.$Ee);WEAFO.$aB.registerClass("WEAFO.$aB",WEAFO.$Ee);WEAFO.$aC.registerClass("WEAFO.$aC",WEAFO.$Ee);WEAFO.$aA.registerClass("WEAFO.$aA",WEAFO.$Ee);WEAFO.$ge.registerClass("WEAFO.$ge",WEAFO.$Ee);WEAFO.$gf.registerClass("WEAFO.$gf",WEAFO.$Ee);WEAFO.$gg.registerClass("WEAFO.$gg",WEAFO.$Ee);WEAFO.$VL.registerClass("WEAFO.$VL",WEAFO.$Ee);WEAFO.$aI.registerClass("WEAFO.$aI",WEAFO.$Ee);WEAFO.$aH.registerClass("WEAFO.$aH",WEAFO.$Ee);WEAFO.$Ge.registerClass("WEAFO.$Ge",WEAFO.$Ee);WEAFO.$Ge.$55f.registerClass("WEAFO.$Ge.$55f");WEAFO.$aJ.registerClass("WEAFO.$aJ",WEAFO.$Ee);WEAFO.$fL.registerClass("WEAFO.$fL",WEAFO.$Ee);WEAFO.$fM.registerClass("WEAFO.$fM",WEAFO.$Ee);WEAFO.$aK.registerClass("WEAFO.$aK",WEAFO.$Ee);WEAFO.$aO.registerClass("WEAFO.$aO",WEAFO.$Ee);WEAFO.$gi.registerClass("WEAFO.$gi",WEAFO.$Ee);WEAFO.$cu.registerClass("WEAFO.$cu",WEAFO.$Ee);WEAFO.$5C.registerClass("WEAFO.$5C");WEAFO.$fy.registerClass("WEAFO.$fy",WEAFO.$Ee);WEAFO.$Z9.registerClass("WEAFO.$Z9",WEAFO.$Ee);WEAFO.$Us.registerClass("WEAFO.$Us",null,WEAFO.$Sv);WEAFO.$aQ.registerClass("WEAFO.$aQ",WEAFO.$Ee);WEAFO.$Vq.registerClass("WEAFO.$Vq",WEAFO.$Ee);WEAFO.$K2.registerClass("WEAFO.$K2");WEAFO.$PK.registerClass("WEAFO.$PK",null,WEAFO.$Ih);WEAFO.$Y7.registerClass("WEAFO.$Y7");WEAFO.$QD.registerClass("WEAFO.$QD",null,WEAFO.$FF);WEAFO.$QE.registerClass("WEAFO.$QE");WEAFO.$QF.registerClass("WEAFO.$QF",null,WEAFO.$ML);WEAFO.$LA.registerClass("WEAFO.$LA");WEAFO.$CF.registerClass("WEAFO.$CF",null,WEAFO.$bN);WEAFO.$aL.registerClass("WEAFO.$aL");WEAFO.$gV.registerClass("WEAFO.$gV");WEAFO.$TN.registerClass("WEAFO.$TN",null,WordEditor.$Mj);WEAFO.$TO.registerClass("WEAFO.$TO",null,WordEditor.$Mk);WEAFO.$do.registerClass("WEAFO.$do");WEAFO.$Jz.registerClass("WEAFO.$Jz");WEAFO.$Lo.registerClass("WEAFO.$Lo",Box4.$I8);WEAFO.$sY.registerClass("WEAFO.$sY",Box4.$ry);WEAFO.$4E.$2b="text";WEAFO.$4E.$8J="table";WEAFO.$4E.$1Th="matrix";WEAFO.$9d.$2js="WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled";WEAFO.$9d.$3Fu="WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled";WEAFO.$BA.$T=null;WEAFO.$BH.$T=null;WEAFO.$CF.$3C3=0;WEAFO.$qL.$5Sr();Type.registerNamespace("WordEditor.AddInCommands");WordEditor.AddInCommands.$MA=function(){};WordEditor.AddInCommands.$MA.registerInterface("WordEditor.AddInCommands.$MA");WordEditor.AddInCommands.$MB=function(){};WordEditor.AddInCommands.$MB.registerInterface("WordEditor.AddInCommands.$MB");WordEditor.AddInCommands.$KJ=function(a,b){this.$$d_$65i=Function.createDelegate(this,this.$65i);this.$K=a;this.$xb=b};WordEditor.AddInCommands.$KJ.prototype={$K:null,$xb:null,$3F:function(){this.$K.$P(407117407,1,this.$$d_$65i);this.$K.$P(1402209562,1,this.$$d_$65i);this.$K.$P(1309495434,1,this.$$d_$65i);this.$K.$P(516359383,1,this.$$d_$65i);this.$K.$P(1782110672,1,this.$$d_$65i);this.$K.$P(543799107,1,this.$$d_$65i)},$65i:function(b,c,d,e,a){if(c.get_$3t()!==1)return 2;if(d===1)return 32;if(!a)return 8;switch(b){case 407117407:this.$xb.$3hC(a);break;case 1402209562:this.$xb.$5Eq(a);break;case 1309495434:this.$xb.$5iT(a);break;case 516359383:this.$xb.$60a(a);break;case 1782110672:this.$xb.$3sf(a);break;case 543799107:this.$xb.$5ky()}return 32}};WordEditor.AddInCommands.$VR=function(a,b){WordEditor.AddInCommands.$VR.initializeBase(this,[b]);this.$K=a;Common.$DR.$1sI="WAC_Word"};WordEditor.AddInCommands.$VR.prototype={$K:null,$66S:function(){this.$5Hf()},$52p:function(){return this.$3WW()},$3WW:function(){var a=new($$sc.$F3.$$(Common.$5n,Common.$4z));if(Common.$0.$o.$1A("AppsForOfficeAllowExternalMarketplace"))if(Common.$0.$o.$1A("AddInCommandsRoamingStoreIsEnabled"))a.set_$5(0,2);else a.set_$5(0,1);Common.$0.$o.$1A("InsertAgaveMyOrgEnabledForHost")&&a.set_$5(1,1);Common.$0.$o.$1A("AddInCommandsIsEnabled")&&a.set_$5(8,1);return a},$5hR:function(a,b){this.$K.$4J(a,2,b)}};WordEditor.AddInCommands.$VV=function(a,b,c,d,e,f){this.$$d_$5aD=Function.createDelegate(this,this.$5aD);this.$$d_$5Er=Function.createDelegate(this,this.$5Er);this.$$d_$4OL=Function.createDelegate(this,this.$4OL);this.$1vy=a;this.$Eq=b;this.$c3=c;this.$xc=d;this.$23d=e;this.$No=f;this.$No&&this.$No.add_$5a0(this.$$d_$4OL);this.$c3&&this.$c3.add_$4BY(this.$$d_$5Er);Common.$DR.$1sI="WAC_Word"};WordEditor.AddInCommands.$VV.prototype={$1vy:null,$Eq:null,$c3:null,$xc:null,$23d:null,$No:null,$4JZ:function(c,e,f){if(!c)return;var a=null,d=this.$5C7(e,f);switch(d){case 1:a="ContextMenuText";break;default:return}var b=this.$1vy.$4Jp(a);b&&c.append(b)},$3hC:function(c){var a=c;Diag.$2.$9(17306649,220,50,"LaunchOperationType {0}.",a.ack0);var b=new CommandUI.AddInCommands.$ck(this.$xc,this.$1vy,new CommandUI.AddInCommands.$Kv(this.$Eq.get_$Q()),new CommandUI.AddInCommands.$iZ("",1402209562,this.$xc.get_$63h()),this.$c3,CommandUI.AddInCommands.$8W.get_$4());b.add_$4BW(this.$$d_$5aD);b.$3hB(this.$23d,Box4.App.get_$X().$o6(),a);Diag.$2.$9(17319382,220,50,"LaunchAddinCommands success.")},$5Eq:function(f){var d=f,a=d[this.$xc.get_$4R7()],b=new CommandUI.AddInCommands.$VN,c=b.get_$43z()(a),e=new WordEditor.AddInCommands.$iz(this.$No,c.ownerAddinInfo);b.$5Ep(a,this.$c3,e,new CommandUI.AddInCommands.$Kv(this.$Eq.get_$Q()),c,null)},$5iT:function(c){var a=c,b=new CommandUI.AddInCommands.$KL;b.$5j0(this.$c3,a)},$60a:function(){var a=new CommandUI.AddInCommands.$KL;a.$3xy(this.$c3,Box4.App.get_$X().$o6(),"AddInCommandsLoadStatus-Medium14",WoncaIntl.WoncaStrings.L_TabInsert)},$3sf:function(c){var a=c;Diag.$2.$9(17408930,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",a.ack0,a.ack1);this.$c3.$5vU(false);var b=this;window.setTimeout(function(){var c=new CommandUI.AddInCommands.$VT(new CommandUI.AddInCommands.$Kv(b.$Eq.get_$Q()),CommandUI.AddInCommands.$8W.get_$4(),CommandUI.AddInCommands.$8D.get_$4());if(c){c.add_$4BU(function(c,a){b.$3hC(a.$R3)});c.$66o(a)}},0)},$5ky:function(){if(this.$c3.$2zL()){var b=Common.Utils.$8.get_$4().$J(WordEditor.AddInCommands.$MA).$52p();if(b){var a=b.$$ge();while(a.$$mn()){var c=a.$$cu(),d={ack1:c.get_$Ao(),ack0:4,ak0:+new Date};this.$3sf(d)}}}},$5C7:function(f,b){var a=0;if(!f||!b)return a;for(var c=0;c<b.$L4();c++){if(b.$1De(c)){if(b.$3u()&&b.get_$52()===14){a=a|4;break}b.$1M()}b.$1M()}for(var d=0;d<f.get_$N();++d){var e=f.get_$5(d),g=e.$D;if(e.$1t===3||e.$1t===17)if(Box4.$1M.$di(g,5))a=a|2;else a=a|1}return a},$5Er:function(){var a=Common.Utils.$8.get_$4().$2S(WordEditor.$BS);a.$3oJ();var b=new CommandUI.AddInCommands.$KL;b.$3xy(this.$c3,Box4.App.get_$X().$o6(),"AddInCommandsLoadStatus-Medium14",WoncaIntl.WoncaStrings.L_TabInsert)},$4OL:function(){this.$c3.$4Nv()},$5aD:function(){this.$23d.$8T()}};WordEditor.AddInCommands.$VX=function(){this.$3Dw={tabhome:"tabHome",tabinsert:"tabInsert",tabpagelayoutword:"tabPageLayout",tabreviewword:"tabReview",tabview:"tabView"}};WordEditor.AddInCommands.$VX.prototype={get_$4R7:function(){return"SourceControlId"},get_$2wN:function(){return"Document"},get_$4uS:function(){return"DesktopFormFactor"},get_$63h:function(){return this.$3Dw}};WordEditor.AddInCommands.$47=function(){};WordEditor.AddInCommands.$47.$5Sr=function(){Common.App.$f.get_$4().$3M(new WordEditor.AddInCommands.$47)};WordEditor.AddInCommands.$47.prototype={$U:null,get_$5j:function(){return"WordEditor.AddInCommands"},$t9:function(a){this.$U=a;var b=this;this.$U.$e(CommandUI.AddInCommands.$Kw).$p().$n(function(){return new CommandUI.AddInCommands.$Kw});var c=this;this.$U.$e(CommandUI.AddInCommands.$KK).$p().$n(function(){return new CommandUI.AddInCommands.$KK});var d=this;this.$U.$e(CommandUI.AddInCommands.$R4).$p().$n(function(){return new WordEditor.AddInCommands.$VX});var e=this;this.$U.$e(WordEditor.AddInCommands.$MB).$p().$n(function(){return new WordEditor.AddInCommands.$VV(a.$J(CommandUI.AddInCommands.$Kw),a.$7a(Common.App.AppsForOfficeCommon.$MI),a.$J(CommandUI.AddInCommands.$KK),a.$J(CommandUI.AddInCommands.$R4),Wonca.$8F.$AB().$FW.$Bk,a.$J(Common.App.AppsForOfficeCommon.$Ii))});var f=this;this.$U.$e(WordEditor.AddInCommands.$KJ).$p().$n(function(){return new WordEditor.AddInCommands.$KJ(Common.$0.get_$r(),a.$J(WordEditor.AddInCommands.$MB))});var g=this;this.$U.$e(WordEditor.AddInCommands.$MA).$p().$n(function(){return new WordEditor.AddInCommands.$VR(Common.$0.get_$r(),Common.$0.get_$1Y().get_$CN())})},$7Y:function(){if(Common.$0.$o.$1A("AddInCommandsIsEnabled")){this.$U.$J(WordEditor.AddInCommands.$KJ).$3F();var b=this.$U.$J(WEUI.$2H),a=this.$U.$J(WordEditor.AddInCommands.$MB);b.$5lE(a.$$d_$4JZ||(a.$$d_$4JZ=Function.createDelegate(a,a.$4JZ)));Common.$0.$o.$1A("AddInCommandsLoadedInBootingIsEnabled")&&this.$U.$J(WordEditor.AddInCommands.$MA).$66S()}},$d:function(){}};WordEditor.AddInCommands.$iz=function(a,b){WordEditor.AddInCommands.$iz.initializeBase(this);this.$No=a;this.$21y=b};WordEditor.AddInCommands.$iz.prototype={$No:null,$21y:null,showTaskpane:function(c,e,d){Diag.$2.$9(17306651,220,50,"ShowTaskpane action called.");var a=this.$3Hi(c,this.$21y,e);a.addinCommandsActionType=2;this.$No.$2Fa(a);var b=this.$No.$2px(c.assetId);if(b)d(b,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);else{Diag.$2.$9(17306652,220,10,"ShowTaskpane: instance id is null.");d(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},showDialog:function(){},createUILessSandbox:function(b,e,d){Diag.$2.$9(17306653,220,50,"UILess action called.");var a=this.$No.$2px(b.assetId);if(!a){var c=this.$3Hi(b,this.$21y,e);c.addinCommandsActionType=3;this.$No.$2Fa(c);a=this.$No.$2px(b.assetId)}if(a)d(a,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);else{Diag.$2.$9(17306654,220,10,"UILess: instance id is null.");d(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},disposeHost:function(){},$3Hi:function(b,c,d){var a={};a.assetId=b.assetId;a.appVersion=b.appVersion;a.storeId=b.storeId;a.assetStoreId=b.storeType;a.targetType=OSF.OsfControlTarget.TaskPane;a.displayName=d.getDefaultDisplayName();a.currentStoreType=c.storeType;a.ownerAddinAssetId=c.assetId;a.isAddinCommands=true;return a}};WordEditor.AddInCommands.$KJ.registerClass("WordEditor.AddInCommands.$KJ");WordEditor.AddInCommands.$VR.registerClass("WordEditor.AddInCommands.$VR",Common.App.AddinCommands.$rB,WordEditor.AddInCommands.$MA);WordEditor.AddInCommands.$VV.registerClass("WordEditor.AddInCommands.$VV",null,WordEditor.AddInCommands.$MB);WordEditor.AddInCommands.$VX.registerClass("WordEditor.AddInCommands.$VX",null,CommandUI.AddInCommands.$R4);WordEditor.AddInCommands.$47.registerClass("WordEditor.AddInCommands.$47",null,Common.App.$jx,Common.Utils.$l6);WordEditor.AddInCommands.$iz.registerClass("WordEditor.AddInCommands.$iz",CommandUI.AddInCommands.$rs);WordEditor.AddInCommands.$47.$5Sr()